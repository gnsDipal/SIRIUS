var SPTaskLib =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "mwqp");
/******/ })
/************************************************************************/
/******/ ({

/***/ "+01b":
/*!*************************************************************!*\
  !*** ./lib/SPTaskLib/Controls/HighlightedContentWebPart.js ***!
  \*************************************************************/
/*! exports provided: ContentRollupLayout, HighlightedContentWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContentRollupLayout", function() { return ContentRollupLayout; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HighlightedContentWebPart", function() { return HighlightedContentWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Pages */ "JWtQ");
var _a, _b, _c;





// !!!This should be consistent with the enum ContentRollupLayout in file:
// sp-client\webparts\sp-publishing-webparts\src\webparts\contentRollup\enums\ContentRollupLayout.ts
/**
 * @public
 */
var ContentRollupLayout;
(function (ContentRollupLayout) {
    ContentRollupLayout[ContentRollupLayout["Card"] = 1] = "Card";
    ContentRollupLayout[ContentRollupLayout["List"] = 2] = "List";
    ContentRollupLayout[ContentRollupLayout["Carousel"] = 3] = "Carousel";
    ContentRollupLayout[ContentRollupLayout["FilmStrip"] = 4] = "FilmStrip";
    ContentRollupLayout[ContentRollupLayout["Masonry"] = 5] = "Masonry";
    ContentRollupLayout[ContentRollupLayout["Custom"] = 999] = "Custom";
})(ContentRollupLayout || (ContentRollupLayout = {}));
// copied from webparts\sp-contentrollup-webpart\src\settings\ContentRollupPropertyPaneContent.ts
var ContentLocationField = 0;
var PropertyPaneFields = [ContentLocationField];
// @todo: Masonry and Custom is not used yet, maybe need to add test code later
var LayoutNames = (_a = {},
    _a[ContentRollupLayout.Card] = 'ms-CardList',
    _a[ContentRollupLayout.List] = 'ms-DetailsList',
    _a[ContentRollupLayout.Carousel] = '[data-automation-id="carouselOuterContainer"]',
    _a[ContentRollupLayout.FilmStrip] = '[data-automation-id="liteFilmStripContainer"]',
    _a[ContentRollupLayout.Masonry] = '[data-automation-id="masonryContainer"]',
    _a[ContentRollupLayout.Custom] = 'ms-CustomFieldHost',
    _a);
var LayoutSearchBy = (_b = {},
    _b[ContentRollupLayout.Card] = TAB.searchBy.className,
    _b[ContentRollupLayout.List] = TAB.searchBy.hasClassName,
    _b[ContentRollupLayout.Carousel] = TAB.searchBy.customQuery,
    _b[ContentRollupLayout.FilmStrip] = TAB.searchBy.customQuery,
    _b[ContentRollupLayout.Masonry] = TAB.searchBy.customQuery,
    _b[ContentRollupLayout.Custom] = TAB.searchBy.className,
    _b);
// copied from webparts\sp-contentrollup-webpart\src\settings\ContentRollupPropertyPaneContent.ts
var ContentSourceDropdownOptions = (_c = {},
    _c[1 /* CurrentSite */] = 0,
    _c[4 /* CurrentSiteDocumentLibrary */] = 1,
    _c[2 /* CurrentSiteCollection */] = 2,
    _c[6 /* CurrentSitePageLibrary */] = 3,
    _c);
/**
 * @public
 */
var HighlightedContentWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(HighlightedContentWebPart, _super);
    function HighlightedContentWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].HighlightedContent, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].HighlightedContent.toString()) || this;
    }
    HighlightedContentWebPart._getLayoutQuery = function (id) {
        var query = LayoutNames[id];
        switch (id) {
            case ContentRollupLayout.Carousel:
                query = '[data-automation-id="carouselOuterContainer"]';
                break;
            case ContentRollupLayout.FilmStrip:
                query = '[data-automation-id="liteFilmStripContainer"]';
                break;
        }
        return query;
    };
    HighlightedContentWebPart._getPropertyPanyLayoutQuery = function (optionId) {
        return "[data-automation-id=\"PropertyPaneChoiceGroup-" + optionId + "\"]";
    };
    HighlightedContentWebPart.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(_this);
        }), this._waitForLayout(ContentRollupLayout.Card));
    };
    // Wait for full PropertyPane display which can't be done by SPTaskLib.PropertyPane.AddTaskOpenPropertyPane().
    HighlightedContentWebPart.prototype.AddTaskOpenPropertyPane = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Open Property pane');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].SelectedWebpart.AddTaskClickConfigureButton();
        }), 
        // There is a delay before the property pane is actually opened. Wait until the layout pane shows.
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, HighlightedContentWebPart._getPropertyPanyLayoutQuery(ContentRollupLayout.Card)));
    };
    HighlightedContentWebPart.prototype.AddTaskSelectContentSitePageOption = function () {
        var propertyPaneContainer;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get property pane container');
            propertyPaneContainer = _Pages__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].GetPropertyPane();
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(propertyPaneContainer, TAB.searchBy.hasClassName, 'ms-Dropdown');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Select Content Source');
            var dropdowns = TAB.GetElements(propertyPaneContainer, TAB.searchBy.hasClassName, 'ms-Dropdown');
            TAB.ClickElement(dropdowns[PropertyPaneFields[ContentLocationField]]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-items');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click The Page Library on this site');
            var dropdownItems = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-item');
            TAB.ClickElement(dropdownItems[ContentSourceDropdownOptions[6 /* CurrentSitePageLibrary */]]);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-items');
        }));
    };
    HighlightedContentWebPart.prototype.displayLayout = function (id) {
        this._displayLayout(id, this._waitForLayout(id));
    };
    HighlightedContentWebPart.prototype.switchToLayout = function (id) {
        return this._selectLayout(id);
    };
    HighlightedContentWebPart.prototype._waitForLayout = function (id) {
        var query = HighlightedContentWebPart._getLayoutQuery(id);
        TAB.Log.AddTaskComment("Looking for layout via " + query);
        return TAB.WaitForElementToExist(TAB.Win, LayoutSearchBy[id], query);
    };
    HighlightedContentWebPart.prototype._displayLayout = function (id, waiter) {
        TAB.AddTask(this._selectLayout(id), waiter);
    };
    HighlightedContentWebPart.prototype._selectLayout = function (optionId) {
        return TAB.MakeTask(function () {
            var dataAutoId = HighlightedContentWebPart._getPropertyPanyLayoutQuery(optionId);
            // use data-automation-id to identify the input element which is consistent with ContentRollupLayout.ts
            TAB.Log.AddTaskComment("Looking for input via " + dataAutoId);
            var input = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, dataAutoId);
            TAB.Log.AddTaskComment("Clicking on input");
            input.click();
        });
    };
    return HighlightedContentWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "+rIA":
/*!*******************************************!*\
  !*** ./lib/SPTaskLib/MemoryTest/index.js ***!
  \*******************************************/
/*! exports provided: MemoryTestWebPartType, MemoryTestUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _MemoryTestUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MemoryTestUtil */ "Y4ae");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MemoryTestWebPartType", function() { return _MemoryTestUtil__WEBPACK_IMPORTED_MODULE_0__["MemoryTestWebPartType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MemoryTestUtils", function() { return _MemoryTestUtil__WEBPACK_IMPORTED_MODULE_0__["MemoryTestUtils"]; });




/***/ }),

/***/ "06bY":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/TenantAdmin/index.js ***!
  \********************************************/
/*! exports provided: TenantAdminHomePage, TenantAdminContentTypeGallery, TenantAdminTermStoreAdminCenter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _HomePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HomePage */ "W/DA");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TenantAdminHomePage", function() { return _HomePage__WEBPACK_IMPORTED_MODULE_0__["HomePage"]; });

/* harmony import */ var _ContentTypeGallery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ContentTypeGallery */ "itp8");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TenantAdminContentTypeGallery", function() { return _ContentTypeGallery__WEBPACK_IMPORTED_MODULE_1__["ContentTypeGallery"]; });

/* harmony import */ var _TermStoreAdminCenter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TermStoreAdminCenter */ "11jz");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TenantAdminTermStoreAdminCenter", function() { return _TermStoreAdminCenter__WEBPACK_IMPORTED_MODULE_2__["TermStoreAdminCenter"]; });

// Rename "TenantAdmin.HomePage" to "TenantAdminHomePage" until api-extractor
// supports "import * as x from ..."



 // tslint:disable-line:export-name


/***/ }),

/***/ "0FqO":
/*!********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/GroupMembershipPanel.js ***!
  \********************************************************/
/*! exports provided: GroupMembershipPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupMembershipPanel", function() { return GroupMembershipPanel; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

/**
 * @public
 */
var GroupMembershipPanel = /** @class */ (function () {
    function GroupMembershipPanel() {
    }
    GroupMembershipPanel.prototype.AddTaskLaunchGroupMembershipPanelFromHeader = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Launch group membership panel from Group header');
        TAB.Log.AddTaskComment('Waiting for Group header');
        var groupHeader = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                groupHeader = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'SiteHeader');
                return Boolean(groupHeader);
            }
            catch (e) {
                return false;
            }
        }));
        // Wait for member count separately because it can take a few extra moments to appear
        TAB.Log.AddTaskComment('Waiting for member count to appear in group header');
        var memberCount = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                memberCount = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'MemberCountButton');
                return Boolean(memberCount);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the member count in the header');
            TAB.ClickElement(memberCount);
        }), TAB.MakeWaiter(function () {
            _this._root = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'GroupMembershipPanelContents');
            return Boolean(_this._root);
        }));
    };
    GroupMembershipPanel.prototype.WaitForGroupMemberPersonaCount = function () {
        return TAB.WaitForElementToExist(this._root, TAB.searchBy.customQuery, "[data-automationid='GroupMemberPersona']");
    };
    GroupMembershipPanel.prototype.getMemberCount = function () {
        return TAB.GetTextContent(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._root, 'PanelNumberOfMembersText'));
    };
    GroupMembershipPanel.prototype.getAddMembersButtonText = function () {
        // same as in ODSP-next. VSO:381893 - for any future cleanup.
        return this._root.querySelector('[data-automationid=AddMembersButton] .ms-Button-label').textContent;
    };
    GroupMembershipPanel.prototype.getGroupMemberPersonaCount = function () {
        var groupMemberPersonas = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(this._root, 'GroupMemberPersona');
        return groupMemberPersonas.length;
    };
    GroupMembershipPanel.prototype.AddTaskSwitchToAddMembers = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Switch from the members list view to the add members experience');
        var addMembersView = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the Add members button');
            TAB.AddTaskClickElement(_this._root, TAB.searchBy.customQuery, '[data-automationid="AddMembersButton"]', TAB.MakeWaiter(function () {
                addMembersView = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this._root, 'AddMembersView');
                return Boolean(addMembersView);
            }));
        }));
    };
    GroupMembershipPanel.prototype.getPeoplePicker = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._root, 'AddMembersPeoplePicker');
    };
    GroupMembershipPanel.prototype.getSaveButtonText = function () {
        return TAB.GetTextContent(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._root, 'AddMembersSaveButton'));
    };
    GroupMembershipPanel.prototype.getCancelButtonText = function () {
        return TAB.GetTextContent(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._root, 'AddMembersCancelButton'));
    };
    GroupMembershipPanel.prototype.AddTaskDismissPanel = function () {
        TAB.Log.AddTaskComment('Dismissing the panel');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the panel close button');
            // We just click this close button, but removed the waiter, because Phamton JS has issue with the waiter.
            TAB.AddTaskClickElement(TAB.Win.document.body, TAB.searchBy.partialClassName, 'ms-Panel-closeButton');
        }));
    };
    return GroupMembershipPanel;
}());



/***/ }),

/***/ "11jz":
/*!***********************************************************!*\
  !*** ./lib/SPTaskLib/TenantAdmin/TermStoreAdminCenter.js ***!
  \***********************************************************/
/*! exports provided: TermStoreAdminCenter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TermStoreAdminCenter", function() { return TermStoreAdminCenter; });
/**
 * @public
 */
var TermStoreAdminCenter = /** @class */ (function () {
    function TermStoreAdminCenter() {
    }
    TermStoreAdminCenter.AddTaskCheckTreeLoaded = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var tree = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[class*='treeContainer']");
            return tree.length > 0;
        }));
        TAB.Log.AddTaskPass('Tree loaded');
    };
    return TermStoreAdminCenter;
}());



/***/ }),

/***/ "1A/J":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/ListItemLibrary.js ***!
  \******************************************/
/*! exports provided: ListItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItem", function() { return ListItem; });
/* harmony import */ var _CsomUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CsomUtil */ "UXDa");

/**
 * @public
 */
var ListItem = /** @class */ (function () {
    function ListItem() {
    }
    ListItem.AddCsomTaskGetListItemByUrl = function (siteUrl, serverRelativeUrl, listItemResult) {
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(function () {
            var context = new SP.ClientContext(siteUrl);
            var site = context.get_site();
            var web = context.get_web();
            context.load(site);
            context.load(web);
            context.executeQueryAsync(function () {
                var file = web.getFileByServerRelativeUrl(serverRelativeUrl);
                context.load(file);
                context.executeQueryAsync(function () {
                    var listItem = file.get_listItemAllFields();
                    context.load(listItem);
                    context.executeQueryAsync(function () {
                        TAB.Log.Pass("Got list item for url: " + serverRelativeUrl);
                        listItemResult.uniqueId = listItem.get_item('UniqueId').toString();
                        listItemResult.webId = String(web.get_id());
                        listItemResult.siteId = String(site.get_id());
                    });
                });
            });
            return context;
        });
    };
    return ListItem;
}());



/***/ }),

/***/ "1AE4":
/*!*************************************************!*\
  !*** ./lib/SPTaskLib/Controls/FieldsWebPart.js ***!
  \*************************************************/
/*! exports provided: FieldsWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FieldsWebPart", function() { return FieldsWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");





/**
 * @public
 */
var FieldsWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(FieldsWebPart, _super);
    function FieldsWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Fields, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Fields.toString()) || this;
    }
    FieldsWebPart.prototype.AddTaskAddWebPart = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Add Page Properties web part');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), 
        // Expect the web part placeholder is rendered by default.
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='placeholderButton']"));
    };
    FieldsWebPart.prototype.AddTaskOpenPropertyPaneByPlaceholderButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click "Add Properties" button in placeholder');
            var placeholderButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='placeholderButton']");
            TAB.ClickElement(placeholderButton);
        }), TAB.MakeWaiter(function () {
            try {
                return !!_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].GetPropertyPane();
            }
            catch (e) {
                return false;
            }
        }));
    };
    FieldsWebPart.prototype.AddTaskAddNewFieldInPropertyPane = function () {
        var _this = this;
        var countBeforeAdded;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean(_this.AddButton);
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Add a new field to the web part by clicking +Add button in property pane.');
            countBeforeAdded = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='field']")
                .length;
            TAB.ClickElement(_this.AddButton);
        }), TAB.MakeWaiter(function () {
            var fields = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='field']");
            var countAfterAdded = fields.length;
            return countAfterAdded === countBeforeAdded + 1;
        }));
    };
    FieldsWebPart.prototype.AddTaskSelectFieldInPropertyPane = function (fieldIndex, fieldName) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Change the property selection at position of " + fieldIndex + " to be " + fieldName);
            var propertyPane = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].GetPropertyPane();
            TAB.Log.Comment("Find and click dropdown at position " + fieldIndex);
            var dropdown = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(propertyPane, 'fields-property-dropdown')[fieldIndex];
            TAB.ClickElement(dropdown);
            TAB.Log.Comment("Find and click the dropdown options " + fieldName);
            var dropdownCallout = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-callout');
            var dropdownOptions = [].slice.call(
            // Convert NodeList to Array
            TAB.GetElements(dropdownCallout, TAB.searchBy.hasClassName, 'ms-Dropdown-item'));
            var fieldDropdownOption = dropdownOptions.filter(function (element) { return element.textContent.indexOf(fieldName) > -1; })[0];
            TAB.ClickElement(fieldDropdownOption);
        }), this.WaitForFieldToExist());
    };
    FieldsWebPart.prototype.AddTaskRemoveFieldInPropertyPane = function (index) {
        var countBeforeRemoved;
        TAB.AddTask(TAB.MakeTask(function () {
            var fields = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='field']");
            countBeforeRemoved = fields.length;
            TAB.Log.Comment("Try to delete a field from existing " + countBeforeRemoved + " fields");
            var propertyPane = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].GetPropertyPane();
            var removeButton = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(propertyPane, 'fields-remove-button')[index];
            TAB.ClickElement(removeButton);
        }), TAB.MakeWaiter(function () {
            var fields = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='field']");
            var countAfterRemoved = fields.length;
            return countAfterRemoved === countBeforeRemoved - 1;
        }));
    };
    FieldsWebPart.prototype.WaitForFieldToExist = function () {
        return TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='fields']");
        });
    };
    FieldsWebPart.prototype.AddTaskWaitForFieldToUpdateToValue = function (fieldName, value) {
        var _this = this;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var valueUpdated = false;
            var fields = _this.GetFields();
            if (fields) {
                fields.forEach(function (field) {
                    var title = TAB.GetElement(field, TAB.searchBy.customQuery, '[data-automation-id="captionElement"]');
                    // tslint:disable-next-line:no-string-literal
                    if (title.children[0]['placeholder'].indexOf(fieldName) > -1) {
                        if (field.textContent.indexOf(value) > -1) {
                            valueUpdated = true;
                        }
                    }
                });
            }
            return valueUpdated;
        }));
    };
    Object.defineProperty(FieldsWebPart.prototype, "AddButton", {
        get: function () {
            var propertyPane = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].GetPropertyPane();
            return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(propertyPane, 'fields-add-button');
        },
        enumerable: true,
        configurable: true
    });
    // This returns divs containing both label and textfield
    FieldsWebPart.prototype.GetFields = function () {
        try {
            var fields = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='fields']");
            return fields;
        }
        catch (error) {
            return undefined;
        }
    };
    return FieldsWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "2JS8":
/*!**************************************!*\
  !*** ./lib/SPTaskLib/SiteLibrary.js ***!
  \**************************************/
/*! exports provided: Site */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Site", function() { return Site; });
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pages/TeamSitePage */ "UjPA");

/**
 * @public
 */
// tslint:disable-next-line:export-name
var Site = /** @class */ (function () {
    function Site() {
    }
    Site.AddTaskDeleteSiteCollection = function (siteUrl) {
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskDeleteSite(siteUrl);
    };
    return Site;
}());



/***/ }),

/***/ "2ZRy":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/Controls/NewsDigest.js ***!
  \**********************************************/
/*! exports provided: NewsDigest */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewsDigest", function() { return NewsDigest; });
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");



var NewsDigestAutomationId;
(function (NewsDigestAutomationId) {
    NewsDigestAutomationId["CreateNewsDigest"] = "createNewsDigest";
    NewsDigestAutomationId["ContinueNewsDigestCreation"] = "continueNewsDigestCreation";
    NewsDigestAutomationId["SendNewsDigestButton"] = "sendNewsDigestButton";
    NewsDigestAutomationId["ListNewsLayout"] = "listNewsLayout";
    NewsDigestAutomationId["CustomMessage"] = "customMessage";
    NewsDigestAutomationId["DigestNewsLayout"] = "digestNewsLayout";
    NewsDigestAutomationId["NewsItem"] = "newsItem";
    NewsDigestAutomationId["PeoplePicker"] = "peoplePicker";
})(NewsDigestAutomationId || (NewsDigestAutomationId = {}));
var NewsDigestClassName;
(function (NewsDigestClassName) {
    NewsDigestClassName["Checkbox"] = "ms-Checkbox";
    NewsDigestClassName["BasePickerInput"] = "ms-BasePicker-input";
    NewsDigestClassName["PeoplePickerPersonaContent"] = "ms-PeoplePicker-personaContent";
    NewsDigestClassName["PickerPersonaContainer"] = "ms-PickerPersona-container";
})(NewsDigestClassName || (NewsDigestClassName = {}));
var NewsPageURL = '_layouts/15/news.aspx';
/**
 * @public
 */
var NewsDigest = /** @class */ (function () {
    function NewsDigest() {
        this._numCheckedNewsArticles = 0;
    }
    NewsDigest.prototype.AddTaskClickCreateNewsDigestButton = function () {
        var _this = this;
        this._waitForElementToExist(NewsDigestAutomationId.CreateNewsDigest);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking "Create News Digest" button');
            TAB.ClickElement(_this._getElementByDataAutomationId(NewsDigestAutomationId.CreateNewsDigest));
            TAB.Log.Comment('Waiting to navigate to News Digest creation page');
        }), this._waitForElementToExist(NewsDigestAutomationId.ContinueNewsDigestCreation));
    };
    NewsDigest.prototype.AddTaskSelectNewsForDigest = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for news selection checkboxes');
        }), TAB.MakeWaiter(function () {
            var checkboxes = _this._getNewsCheckboxes();
            return Boolean(checkboxes && checkboxes.length);
        }));
    };
    NewsDigest.prototype.AddTaskClickNewsCheckBox = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking news checkboxes');
            var checkboxes = _this._getNewsCheckboxes();
            if (checkboxes && checkboxes.length > 0) {
                var checkbox = checkboxes[0].getElementsByTagName('input')[0];
                if (checkbox) {
                    TAB.Log.Comment('check box clicked');
                    TAB.ClickElement(checkbox);
                    _this._numCheckedNewsArticles++;
                }
                else {
                    TAB.Log.Comment('no check box to be clicked');
                }
            }
            else {
                TAB.Log.Comment('Checkboxes not found');
            }
        }));
    };
    NewsDigest.prototype.AddTaskClickContinueWithNewsDigestButton = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking "Next" (Continue Create News Digest) button');
            TAB.ClickElement(_this._getElementByDataAutomationId(NewsDigestAutomationId.ContinueNewsDigestCreation));
            TAB.Log.Comment('Waiting to navigate to News Digest send page');
        }), TAB.MakeWaiter(function () {
            try {
                return _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].editMode;
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsDigest.prototype.AddTaskFillNewsDigestSendPage = function () {
        var _this = this;
        // Check number of news articles
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            TAB.Log.Comment('Checking number of selected news items');
            try {
                return (_this._countSelectedNewsItems() && _this._countSelectedNewsItems() === _this._numCheckedNewsArticles);
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsDigest.prototype.AddTaskClickSendNewsDigestButton = function () {
        var _this = this;
        this._addTaskWaitForElementToExist(NewsDigestAutomationId.SendNewsDigestButton);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking Send News Digest button');
            TAB.ClickElement(_this._getElementByDataAutomationId(NewsDigestAutomationId.SendNewsDigestButton));
            TAB.Log.Comment('Waiting to redirect back to News L2 page');
        }), TAB.AndWaiters(this._waitForPageToExist(NewsPageURL), this._waitForElementToExist(NewsDigestAutomationId.ListNewsLayout)));
    };
    NewsDigest.prototype.AddTaskAddPeople = function (name) {
        var _this = this;
        var addPersonInput;
        this._addTaskWaitForElementToExist(NewsDigestAutomationId.PeoplePicker);
        TAB.AddTask(TAB.MakeTask(function () {
            addPersonInput = _this.getPeoplePicker();
            TAB.Log.Comment('Inputting name for Person Picker');
            // input the people name
            _ReactUtil__WEBPACK_IMPORTED_MODULE_2__["ReactUtil"].TriggerOnChange(addPersonInput, name);
        }), this._waitForElementToExistByClassName(NewsDigestClassName.PeoplePickerPersonaContent));
        TAB.AddTask(TAB.MakeTask(function () {
            // press Enter to select the person
            TAB.Log.Comment('Selecting profile from Person Picker');
            TAB.FireKeyboardEvent(addPersonInput, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_0__["KeyCodes"].enter);
        }), this._waitForElementToExistByClassName(NewsDigestClassName.PickerPersonaContainer));
    };
    NewsDigest.prototype.getPeoplePicker = function () {
        var peoplePickerWrapper = this._getElementByDataAutomationId(NewsDigestAutomationId.PeoplePicker);
        return this._getElementByClassName(NewsDigestClassName.BasePickerInput, peoplePickerWrapper);
    };
    NewsDigest.prototype.AddTaskAddCustomMessage = function (text) {
        var _this = this;
        this._addTaskWaitForElementToExist(NewsDigestAutomationId.CustomMessage);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Adding custom message');
            var textAreaElement = (_this._getElementByDataAutomationId(NewsDigestAutomationId.CustomMessage));
            textAreaElement.value = text;
            TAB.FireChangeEvent(textAreaElement);
        }), this._waitForText(text));
    };
    NewsDigest.prototype.AddTaskWaitForCheckedBox = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for checked box found is-checked");
        }), this._waitForCheckedBoxToExistByClassName('is-checked'));
    };
    NewsDigest.prototype._addTaskWaitForElementToExist = function (dataAutomationId) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for element " + dataAutomationId);
        }), this._waitForElementToExist(dataAutomationId));
    };
    NewsDigest.prototype._waitForCheckedBoxToExistByClassName = function (className) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var _a;
            try {
                var listNewsLayout = _this._getElementByDataAutomationId(NewsDigestAutomationId.ListNewsLayout);
                return Boolean(((_a = _this._getElementsByClassName(className, listNewsLayout)) === null || _a === void 0 ? void 0 : _a.length) > 0);
            }
            catch (error) {
                return false;
            }
        });
    };
    NewsDigest.prototype._waitForElementToExistByClassName = function (className) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._getElementByClassName(className));
            }
            catch (error) {
                return false;
            }
        });
    };
    NewsDigest.prototype._waitForElementToExist = function (dataAutomationId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._getElementByDataAutomationId(dataAutomationId));
            }
            catch (error) {
                return false;
            }
        });
    };
    NewsDigest.prototype._waitForPageToExist = function (pageUrl) {
        return TAB.MakeWaiter(function () {
            try {
                return TAB.Win.location.href.indexOf(pageUrl) > -1;
            }
            catch (error) {
                return false;
            }
        });
    };
    NewsDigest.prototype._waitForText = function (text) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            TAB.Log.Comment('Checking custom message');
            var textAreaElement = (_this._getElementByDataAutomationId(NewsDigestAutomationId.CustomMessage));
            if (!textAreaElement) {
                return false;
            }
            return textAreaElement.value === text;
        });
    };
    NewsDigest.prototype._countSelectedNewsItems = function () {
        try {
            var digestNewsLayout = this._getElementByDataAutomationId(NewsDigestAutomationId.DigestNewsLayout);
            if (digestNewsLayout) {
                var newsItems = this._getElementsByDataAutomationId(NewsDigestAutomationId.NewsItem, digestNewsLayout);
                return newsItems.length;
            }
        }
        catch (e) {
            TAB.Log.Comment('Failed to locate selected news digest items');
            return undefined;
        }
    };
    NewsDigest.prototype._getNewsCheckboxes = function () {
        this._addTaskWaitForElementToExist(NewsDigestAutomationId.ListNewsLayout);
        try {
            var listNewsLayout = this._getElementByDataAutomationId(NewsDigestAutomationId.ListNewsLayout);
            if (listNewsLayout) {
                var checkBoxes = this._getElementsByClassName(NewsDigestClassName.Checkbox, listNewsLayout);
                return checkBoxes;
            }
        }
        catch (e) {
            TAB.Log.Comment('Failed to get Checkboxes on List NewsPage');
            return undefined;
        }
    };
    NewsDigest.prototype._getElementByDataAutomationId = function (dataAutomationId, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElement(searchObj, TAB.searchBy.customQuery, "[data-automation-id=" + dataAutomationId + "]");
        }
        catch (e) {
            return undefined;
        }
    };
    NewsDigest.prototype._getElementsByDataAutomationId = function (dataAutomationId, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElements(searchObj, TAB.searchBy.customQuery, "[data-automation-id=" + dataAutomationId + "]");
        }
        catch (e) {
            return undefined;
        }
    };
    NewsDigest.prototype._getElementByClassName = function (className, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElement(searchObj, TAB.searchBy.hasClassName, className);
        }
        catch (e) {
            return undefined;
        }
    };
    NewsDigest.prototype._getElementsByClassName = function (className, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElements(searchObj, TAB.searchBy.hasClassName, className);
        }
        catch (e) {
            return undefined;
        }
    };
    return NewsDigest;
}());



/***/ }),

/***/ "35UN":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Controls/BaseWebpart.js ***!
  \***********************************************/
/*! exports provided: WebpartType, KeyCodes, FireKeyboardEvent, BaseWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebpartType", function() { return WebpartType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KeyCodes", function() { return KeyCodes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FireKeyboardEvent", function() { return FireKeyboardEvent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseWebpart", function() { return BaseWebpart; });
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../PageUtil */ "jK1H");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");




/**
 * @public
 */
var WebpartType;
(function (WebpartType) {
    // The value is the web part's entry ID. The `_0` suffix means it is the first entry of the web part manifest.
    WebpartType["RTE"] = "RTE";
    WebpartType["Image"] = "d1d91016-032f-456d-98a4-721247c305e8_0";
    WebpartType["Document"] = "b7dd04e1-19ce-4b24-9132-b60a1c2b910d_0";
    WebpartType["Link"] = "6410b3b6-d440-4663-8744-378976dc041e_0";
    WebpartType["ContentEmbed"] = "490d7c76-1824-45b2-9de3-676421c997fa_0";
    WebpartType["EmbeddedVideo"] = "275c0095-a77e-4f6d-a2a0-6a7626911518_0";
    WebpartType["Fields"] = "cf91cf5d-ac23-4a7a-9dbc-cd9ea2a4e859_0";
    WebpartType["HighlightedContent"] = "daf0b71c-6de8-4ef7-b511-faae7c388708_0";
    WebpartType["ImageGallery"] = "af8be689-990e-492a-81f7-ba3e4cd3ed9c_0";
    WebpartType["ListView"] = "f92bf067-bc19-489e-a556-7fe95f508720_0";
    WebpartType["ListViewDocLib"] = "f92bf067-bc19-489e-a556-7fe95f508720_1";
    WebpartType["People"] = "7f718435-ee4d-431c-bdbf-9c4ff326f46e_0";
    WebpartType["OrgChart"] = "e84a8ca2-f63c-4fb9-bc0b-d8eef5ccb22b_0";
    WebpartType["QuickLinks"] = "c70391ea-0b10-4ee9-b2b4-006d3fcad0cd_0";
    WebpartType["QuickChart"] = "91a50c94-865f-4f5c-8b4e-e49659e69772_0";
    WebpartType["Events"] = "20745d7d-8581-4a6c-bf26-68279bc123fc_0";
    WebpartType["Hero"] = "c4bd7b2f-7b6e-4599-8485-16504575f590_0";
    WebpartType["Connector"] = "893a257e-9c92-49bc-8a36-2f6bb058da34_0";
    WebpartType["RSSConnector"] = "893a257e-9c92-49bc-8a36-2f6bb058da34_1";
    WebpartType["Forms"] = "b19b3b9e-8d13-4fec-a93c-401a091c0707_0";
    WebpartType["News"] = "8c88f208-6c77-4bdb-86a0-0c47b4316588_0";
    WebpartType["YouTube"] = "544dd15b-cf3c-441b-96da-004d5a8cea1d_0";
    WebpartType["TitleRegion"] = "cbe7b0a9-3504-44dd-a3a3-0e5cacd07788";
    WebpartType["Unknown"] = "Unknown";
    WebpartType["YammerConversations"] = "cb3bfe97-a47f-47ca-bffb-bb9a5ff83d75_0";
    WebpartType["YammerHighlights"] = "31e9537e-f9dc-40a4-8834-0e3b7df418bc_0";
    WebpartType["Sites"] = "7cba020c-5ccb-42e8-b6fc-75b3149aba7b_0";
    WebpartType["BingMap"] = "e377ea37-9047-43b9-8cdb-a761be2f8e09_0";
    WebpartType["SiteActivity"] = "eb95c819-ab8f-4689-bd03-0c2d65d47b1f_0";
    WebpartType["Planner"] = "39c4c1c2-63fa-41be-8cc2-f6c0b49b253d_0";
    WebpartType["GroupCalendar"] = "6676088b-e28e-4a90-b9cb-d0d0303cd2eb_0";
    WebpartType["Twitter"] = "f6fdf4f8-4a24-437b-a127-32e66a5dd9b4_0";
    WebpartType["Weather"] = "868ac3c3-cad7-4bd6-9a1c-14dc5cc8e823_0";
    WebpartType["WorldClock"] = "81b57906-cbed-4bb1-9823-2e3314f46f28_0";
    WebpartType["Text2D"] = "e30ff702-e1a4-4e02-8c11-3cce0139727a_0";
    WebpartType["SPMRDocLib"] = "6ee6fe3d-ed5f-4c42-b663-b1df52a8ae3b_0";
    WebpartType["DynamicDataStaticConsumer"] = "e0d5a85a-e2ba-4433-8d83-f8d38b723d32_0";
    WebpartType["SPMRTestWebPart"] = "b3a690f0-bed6-4ccb-a186-ed70412fc35b_0";
    WebpartType["OfficeFeed"] = "2f3b693c-1054-419c-af04-fee2782b414f_0";
})(WebpartType || (WebpartType = {}));
/**
 * @public
 */
var KeyCodes;
(function (KeyCodes) {
    KeyCodes[KeyCodes["a"] = 65] = "a";
    KeyCodes[KeyCodes["backspace"] = 8] = "backspace";
    KeyCodes[KeyCodes["comma"] = 188] = "comma";
    KeyCodes[KeyCodes["del"] = 46] = "del";
    KeyCodes[KeyCodes["down"] = 40] = "down";
    KeyCodes[KeyCodes["end"] = 35] = "end";
    KeyCodes[KeyCodes["enter"] = 13] = "enter";
    KeyCodes[KeyCodes["escape"] = 27] = "escape";
    KeyCodes[KeyCodes["home"] = 36] = "home";
    KeyCodes[KeyCodes["left"] = 37] = "left";
    KeyCodes[KeyCodes["pageDown"] = 34] = "pageDown";
    KeyCodes[KeyCodes["pageUp"] = 33] = "pageUp";
    KeyCodes[KeyCodes["right"] = 39] = "right";
    KeyCodes[KeyCodes["semicolon"] = 186] = "semicolon";
    KeyCodes[KeyCodes["space"] = 32] = "space";
    KeyCodes[KeyCodes["tab"] = 9] = "tab";
    KeyCodes[KeyCodes["up"] = 38] = "up";
    KeyCodes[KeyCodes["shift"] = 16] = "shift";
    KeyCodes[KeyCodes["ctrl"] = 17] = "ctrl";
})(KeyCodes || (KeyCodes = {}));
/**
 * @public
 */
function FireKeyboardEvent(element, eventName, keyCode, option) {
    if (!element) {
        throw new Error('Null element passed to TAB.FireKeyboardEvent method!');
    }
    if (!eventName || !(eventName === 'keypress' || eventName === 'keydown' || eventName === 'keyup')) {
        throw new Error('You need to pass eventName argument as keyboard event: keypress or keydown or keyup');
    }
    TAB.Log.Verbose('Firing keyboard event ' + eventName + ' key=' + keyCode.toString());
    if (element.dispatchEvent) {
        var keyEvent = TAB.Win.document.createEvent('Events');
        keyEvent.initEvent(eventName, true, true);
        keyEvent.keyCode = keyCode;
        keyEvent.which = keyCode;
        if (option) {
            keyEvent[option] = true;
        }
        element.dispatchEvent(keyEvent);
    }
}
/**
 * @public
 */
var BaseWebpart = /** @class */ (function () {
    function BaseWebpart(type, entryId) {
        this._entryId = entryId;
        this.type = type;
    }
    Object.defineProperty(BaseWebpart.prototype, "entryId", {
        /**
         * The manifest entry ID of the web part.
         */
        get: function () {
            return this._entryId;
        },
        enumerable: true,
        configurable: true
    });
    BaseWebpart.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].AddTaskCreateWebPart(_this);
        }), this._hasPlaceHolder ? this._waitForPlaceholder() : undefined);
    };
    BaseWebpart.prototype.SetWebpartRoot = function (getRoot, isAddingFromToolbox) {
        if (isAddingFromToolbox === void 0) { isAddingFromToolbox = true; }
        this._getRoot = getRoot;
        this._configureButton = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(this.root, 'configureButton')[0];
        this._deleteButton = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(this.root, 'deleteButton')[0];
        if (isAddingFromToolbox && this._hasFilePicker) {
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskCreateFilePicker();
        }
    };
    Object.defineProperty(BaseWebpart.prototype, "root", {
        get: function () {
            var _a, _b;
            return (_b = (_a = this)._getRoot) === null || _b === void 0 ? void 0 : _b.call(_a);
        },
        enumerable: true,
        configurable: true
    });
    BaseWebpart.prototype.AddTaskClickFilePickerButton = function () {
        var _this = this;
        if (!this._hasFilePicker) {
            return;
        }
        TAB.AddTask(TAB.MakeTask(function () {
            var filePickerButton = (TAB.GetElement(_this._placeholder, TAB.searchBy.tag, 'button'));
            TAB.ClickElement(filePickerButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']"));
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskCreateFilePicker();
    };
    BaseWebpart.prototype.AddTaskClickConfigureButton = function () {
        var _this = this;
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='configureButton']"));
        TAB.AddTask(TAB.MakeTask(function () {
            _this._configureButton = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(_this.root, 'configureButton')[0];
            TAB.ClickElement(_this._configureButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']"));
    };
    BaseWebpart.prototype.AddTaskClickDuplicateButton = function (id) {
        var _this = this;
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='duplicateButton']"));
        TAB.AddTask(TAB.MakeTask(function () {
            _this._duplicateButton = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(_this.root, 'duplicateButton');
            TAB.ClickElement(_this._duplicateButton);
        }), TAB.MakeWaiter(function () {
            try {
                if (!id) {
                    return true;
                }
                var featureId = "[data-sp-feature-tag='" + id + "']";
                var webpartCount = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, featureId).length;
                if (webpartCount === 2) {
                    TAB.Log.AddTaskComment('Duplicated web part successfully');
                    return true;
                }
                return false;
            }
            catch (error) {
                return false;
            }
        }));
    };
    BaseWebpart.prototype.AddTaskCheckDuplicateWebpart = function (id) {
        TAB.AddTask(TAB.MakeTask(function () {
            var featureId = "[data-sp-feature-tag='" + id + "']";
            var webpartCount = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, featureId).length;
            if (webpartCount === 2) {
                TAB.Log.AddTaskPass('Page has duplicate web parts');
            }
            else {
                TAB.Log.AddTaskFail('Page does not have duplicate web parts');
            }
        }));
    };
    BaseWebpart.prototype.IsWebpartReady = function () {
        if (this._hasFilePicker) {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']");
        }
        else {
            return true;
        }
    };
    BaseWebpart.prototype.AddTaskSetupNewPage = function (site) {
        if (site) {
            _PageUtil__WEBPACK_IMPORTED_MODULE_2__["PageUtil"].AddTaskCreatePageOnSite(site);
        }
        else {
            _PageUtil__WEBPACK_IMPORTED_MODULE_2__["PageUtil"].AddTaskCreateSitePage();
        }
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskEditPage();
    };
    BaseWebpart.prototype.WaitForElementsByDataAutomationId = function (id, numberOfInstances) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var root = _this.root || TAB.Win.window.document.body;
            try {
                var automationId = "[data-automation-id='" + id.toString() + "']";
                var elementCollection = TAB.GetElements(root, TAB.searchBy.customQuery, automationId);
                if (isNaN(numberOfInstances)) {
                    return elementCollection.length > 0;
                }
                else {
                    return elementCollection.length === numberOfInstances;
                }
            }
            catch (e) {
                return false;
            }
        });
    };
    BaseWebpart.prototype.ValidationMobileViewParameters = function (args, expectedArgs) {
        var parsedArgs = JSON.parse(args);
        if (!parsedArgs) {
            TAB.Log.AddTaskFail('No link interception arguments found');
        }
        if (this._type === WebpartType.People) {
            TAB.Log.Comment('Inside the people webpart callback handler!');
            if (parsedArgs.args.upn.indexOf(expectedArgs) === -1) {
                TAB.Log.AddTaskFail('User not found in link interception arguments');
            }
            else {
                TAB.Log.AddTaskPass('Task complete');
            }
        }
        else if (this._type === WebpartType.Document) {
            TAB.Log.Comment('Inside the DocumentEmbed webpart callback handler!');
            if (parsedArgs.baseUrl !== expectedArgs) {
                TAB.Log.AddTaskFail('baseUrl does not match');
            }
            else if (parsedArgs.key !== 'openDocument') {
                TAB.Log.AddTaskFail('args key is not correct');
            }
            else {
                TAB.Log.AddTaskPass('Task complete');
            }
        }
    };
    Object.defineProperty(BaseWebpart.prototype, "type", {
        set: function (webpartType) {
            this._type = webpartType;
            switch (webpartType) {
                case WebpartType.Image:
                case WebpartType.Document:
                    this.setProperties(true, true);
                    break;
                case WebpartType.EmbeddedVideo:
                case WebpartType.ContentEmbed:
                case WebpartType.ListView:
                case WebpartType.Forms:
                    this.setProperties(true, false);
                    break;
                case WebpartType.Unknown:
                case WebpartType.RTE:
                case WebpartType.Link:
                case WebpartType.HighlightedContent:
                case WebpartType.QuickLinks || WebpartType.Events:
                case WebpartType.BingMap:
                case WebpartType.DynamicDataStaticConsumer:
                    this.setProperties(false, false);
                    break;
            }
        },
        enumerable: true,
        configurable: true
    });
    BaseWebpart.prototype._waitForPlaceholder = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            TAB.Log.Comment('Placeholder should show when adding webpart to the page');
            try {
                return !!_this._placeholder;
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    Object.defineProperty(BaseWebpart.prototype, "_placeholder", {
        get: function () {
            try {
                var placeholder = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'Placeholder');
                return placeholder;
            }
            catch (e) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    BaseWebpart.prototype.setProperties = function (hasPlaceholder, hasFilePicker) {
        this._hasPlaceHolder = hasPlaceholder;
        this._hasFilePicker = hasFilePicker;
    };
    return BaseWebpart;
}());



/***/ }),

/***/ "37hx":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/PerformancePageUtil.js ***!
  \**********************************************/
/*! exports provided: PerformancePageUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PerformancePageUtil", function() { return PerformancePageUtil; });
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PageUtil */ "jK1H");

var VROOM_META_CACHE_REGEX = /(\/thumbnails\/\d\/(.*?)\/content\/?\?(.*?)preferNoRedirect=(.*?)$)/i;
var VROOM_META_REGEX = /(\/thumbnails\/\d\/(.*?)\/content\/?(|(\?(.*?)))$)/i;
var META_REGEX = /(.svc.ms\/transform\/thumbnail\/?(|(\?(.*?)))$)/i;
var DOCVIZ_REGEX = /(\/_layouts\/15\/getpreview.ashx\/?(|(\?(.*?)))$)/i;
/**
 * @public
 */
var PerformancePageUtil = /** @class */ (function () {
    function PerformancePageUtil() {
    }
    /**
     * API to load a page for performance summary. Caller is responsible for creation of the page.
     * @param pageRelativeUrl - Relative Url of the page under test. e.g. /performance/BlankPage.aspx
     */
    PerformancePageUtil.AddtaskPageLoadPerformanceReport = function (pageRelativeUrl, noOfHits) {
        var _this = this;
        if (noOfHits === void 0) { noOfHits = 5; }
        if (!this._isSetupOkay) {
            TAB.Log.Warning('This environment is not pre configured for performance test, tests are skipped.');
            return;
        }
        var pageUrl = "" + TAB.Settings.Get('ProductServer') + pageRelativeUrl;
        this.isPullRequest = false;
        TAB.AddTask(TAB.MakeTask(function () {
            _this.performanceData[pageUrl] = [];
            var index;
            for (index = 0; index < noOfHits; index++) {
                var query = _this._getRandomQuery();
                var urlUnderTest = pageUrl.indexOf('?') === -1 ? pageUrl + "?" + query : pageUrl + "&" + query;
                _this._addTaskLoadUrlUnderTest(_this.performanceData[pageUrl], urlUnderTest, index, false, query);
            }
        }));
    };
    /**
     * API to compare given page performance for current change with last known state of master.
     * Caller is responsible for creation of the page under test.
     * @param fciApprovedNetworkCalls - List of JS expected to be loaded before FCU. Any other JS before TTI will cause test failure.
     * @param noOfHits - Number of times page will be loaded before compare result.
     */
    PerformancePageUtil.AddtaskLoadSitePageForPerfTest = function (pageRelativeUrl, fciApprovedNetworkCalls, noOfHits) {
        var _this = this;
        if (noOfHits === void 0) { noOfHits = 3; }
        if (!this._isSetupOkay) {
            TAB.Log.Warning('This environment is not pre configured for performance test, tests are skipped.');
            return;
        }
        var whitelistedNetworkCalls = [];
        if (fciApprovedNetworkCalls && fciApprovedNetworkCalls.indexOf('sp-pages-assembly') >= 0) {
            // When component versions changes, there is possiblity that loader might download individual js for version mismatch.
            // Whitelist explicitly all assembly component here to ensure test does not fails in those situations.
            whitelistedNetworkCalls = fciApprovedNetworkCalls.concat(this._pagesAssemblyComponents);
        }
        else {
            whitelistedNetworkCalls = fciApprovedNetworkCalls;
        }
        var azurePath = TAB.Settings.Get('AzurePath');
        this.isPullRequest = azurePath.indexOf('refs_pull_') >= 0;
        var pageUrl = pageRelativeUrl.indexOf('?') > -1
            ? "" + TAB.Settings.Get('ProductServer') + pageRelativeUrl + "&istabtest=true"
            : "" + TAB.Settings.Get('ProductServer') + pageRelativeUrl + "?istabtest=true";
        // Load the page for noOfHits time
        TAB.AddTask(TAB.MakeTask(function () {
            _this.performanceData[pageUrl] = [];
            _this.baselinePerformanceData[pageUrl] = [];
            var index;
            for (index = 0; index < noOfHits; index++) {
                if (_this.isPullRequest) {
                    var isBaseline = true;
                    TAB.Log.AddTaskPass("Iteration " + index + ": loading baseline");
                    _this._addTaskLoadSingleSitePage(pageUrl, index, isBaseline);
                    isBaseline = false;
                    TAB.Log.AddTaskPass("Iteration " + index + ": loading actual");
                    _this._addTaskLoadSingleSitePage(pageUrl, index, isBaseline);
                    TAB.Log.AddTaskPass("Iteration " + index + ": done loading baseline and actual");
                }
                else {
                    _this._addTaskLoadSingleSitePage(pageUrl, index, false);
                }
            }
        }));
        if (this.isPullRequest) {
            // Print summary of the performance compare with baseline
            TAB.AddTask(TAB.MakeTask(function () {
                // Compute Compare summary from very first iteration with cold cache
                var coldCacheBaseline = _this._computePagePerfSummary(_this.baselinePerformanceData[pageUrl], 0, 0);
                var coldCacheActual = _this._computePagePerfSummary(_this.performanceData[pageUrl], 0, 0);
                TAB.Log.Pass("SharePoint Server Version: " + _this.performanceData[pageUrl][0].perfData.SharePointServerVersion);
                TAB.Log.Pass("*****************  Cold Cache Comparision Summary for iteration 1 *******");
                _this._printComparisionSummary(coldCacheBaseline, coldCacheActual, true);
                _this._ensureNetworkCallsAreApproved(coldCacheActual, whitelistedNetworkCalls, 0);
                if (noOfHits > 1) {
                    // Compute Compare summary from second iteration onwards using warmed cache
                    var lastIteration = _this.performanceData[pageUrl].length - 1;
                    var baseline = _this._computePagePerfSummary(_this.baselinePerformanceData[pageUrl], lastIteration);
                    var actual = _this._computePagePerfSummary(_this.performanceData[pageUrl], lastIteration);
                    TAB.Log.Pass("*****************  Warm Cache Comparision Summary for iteration " + (lastIteration + 1) + " *******");
                    _this._printComparisionSummary(baseline, actual);
                    _this._ensureNetworkCallsAreApproved(actual, whitelistedNetworkCalls, lastIteration);
                }
            }));
        }
        else {
            // Print performance result
            TAB.AddTask(TAB.MakeTask(function () {
                // Compute Compare summary from very first iteration with cold cache
                var coldCacheActual = _this._computePagePerfSummary(_this.performanceData[pageUrl], 0, 0);
                TAB.Log.Pass("SharePoint Server Version: " + _this.performanceData[pageUrl][0].perfData.SharePointServerVersion);
                TAB.Log.Pass("*****************  Cold Cache Performance Summary for iteration 1 *******");
                _this._printPerformanceSummary(coldCacheActual, true);
                _this._ensureNetworkCallsAreApproved(coldCacheActual, whitelistedNetworkCalls, 0);
                if (noOfHits > 1) {
                    var lastIteration = _this.performanceData[pageUrl].length - 1;
                    // Compute Compare summary from second iteration onwards using warmed cache
                    var actual = _this._computePagePerfSummary(_this.performanceData[pageUrl], lastIteration);
                    TAB.Log.Pass("*****************  Warm Cache Comparision Summary for iteration " + (lastIteration + 1) + " *******");
                    _this._printPerformanceSummary(actual);
                    _this._ensureNetworkCallsAreApproved(actual, whitelistedNetworkCalls, lastIteration);
                }
            }));
        }
    };
    PerformancePageUtil._addTaskLoadSingleSitePage = function (pageUrl, index, isBaseline) {
        var query = this._getRandomQuery();
        var urlUnderTest = pageUrl.indexOf('?') > -1 ? pageUrl + "&" + query : pageUrl + "?" + query;
        var urlPerfData = isBaseline
            ? this.baselinePerformanceData[pageUrl]
            : this.performanceData[pageUrl];
        this._addTaskLoadUrlUnderTest(urlPerfData, urlUnderTest, index, isBaseline, query);
    };
    PerformancePageUtil._addTaskLoadUrlUnderTest = function (urlPerfData, urlUnderTest, index, isBaseLine, query) {
        var _this = this;
        var PageReadyOnInteractiveState = 'PageReadyOnInteractiveState';
        var oldPageReference = 'isOldPage';
        var options = {};
        if (isBaseLine) {
            options.manifestsFileUrl = this.masterManifestsUrl;
        }
        TAB[PageReadyOnInteractiveState] = true;
        TAB.Log.AddTaskComment("Iteration " + index + ": starting to load page:" + urlUnderTest);
        TAB.AddTask(TAB.MakeTask(function () { return _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].AddTaskSetDebugManifests(options); }));
        TAB.Log.AddTaskComment("spfx-debug=" + TAB.Win.window.sessionStorage.getItem('spfx-debug'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Win.document[oldPageReference] = true;
        }));
        TAB.AddTask(TAB.LoadPage(urlUnderTest));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.Win.document[oldPageReference] !== true && _this._PageReady();
        }));
        TAB.Log.AddTaskComment('Wait for RumOneLogger to be initialized');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return !!_this._getPerformanceLogger();
            }
            catch (error) {
                return false;
            }
        }));
        TAB.Log.AddTaskComment("Waiting for EUPL and TTI to complete for current iteration " + index);
        var startTime;
        var timeout = 30000; // 30 seconds for timeout.
        TAB.AddTask(TAB.MakeTask(function () {
            startTime = performance.now();
            TAB.Log.Comment('RumOneLogger settings: ' + JSON.stringify(_this._getPerformanceLogger()._settings));
        }), TAB.MakeWaiter(function () {
            try {
                return (performance.now() - startTime >= timeout ||
                    (TAB.Win.window.location.href.indexOf(query) > -1 && _this._isFCIComplete(startTime)));
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            // tslint:disable-next-line:no-any
            var performanceData = _this._getPerformanceLogger().getPerformanceData();
            if (!performanceData.EUPL || performanceData.EUPL <= 0) {
                TAB.Log.Fail('EUPL is not available');
            }
            if (!performanceData.TTI || performanceData.TTI <= 0) {
                TAB.Log.Fail('TTI is not available');
            }
        }));
        TAB.Log.AddTaskComment("Collecting performance data for current iteration " + index);
        TAB.AddTask(TAB.MakeTask(function () {
            var logger = _this._getPerformanceLogger();
            var perfData;
            if (!logger) {
                TAB.Log.Warning("Failed to retrieve performance data for the page.");
            }
            else {
                perfData = logger.getPerformanceData && logger.getPerformanceData();
                if (!perfData) {
                    TAB.Log.Warning("Failed to retrieve EUPLBreakdown data for the page.");
                }
            }
            var testPerformanceData = {
                perfData: perfData,
                resourceTimings: TAB.Win.window.performance.getEntriesByType('resource')
            };
            urlPerfData[index] = testPerformanceData;
            if (testPerformanceData.perfData.EUPL) {
                TAB.Log.AddTaskComment((isBaseLine ? 'Baseline ' : 'Actual ') + " page EUPL: " + testPerformanceData.perfData.EUPL);
            }
            else {
                TAB.Log.Fail("EUPL is not computed for the " + (isBaseLine ? 'baseline ' : 'actual ') + "page: " + urlUnderTest);
            }
        }));
        TAB.Log.AddTaskComment("Waiting for performance data to be uploaded for iteration " + index);
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            // Wait for the EUPL data to be uploaded for measurement purpose
            return _this._isPerfComplete();
        }));
        PerformancePageUtil._addTaskVerifyMarkers();
        TAB.Log.AddTaskComment("Resetting page to neutral domain Url for current iteration " + index);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Win.document[oldPageReference] = true;
        }));
        TAB.AddTask(TAB.LoadPage(TAB.NeutralDomainURL()), TAB.MakeWaiter(function () {
            return TAB.Win.document[oldPageReference] !== true && _this._PageReady();
        }));
        TAB.AddTask(TAB.MakeTask(function () { return _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].ResetDebugManifests(); }));
    };
    PerformancePageUtil._addTaskVerifyMarkers = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            PerformancePageUtil.KEY_MARKERS_LIST.forEach(function (marker) {
                var actualCount = PerformancePageUtil._getMarkerCount(marker[0]);
                if (actualCount <= marker[1]) {
                    TAB.Log.Pass(marker[0] + " is within an acceptable range. The count is " + actualCount + ", which is <= to the maximum count of " + marker[1]);
                }
                else {
                    TAB.Log.Fail("Expected count of " + marker[0] + " is less than or equal to " + marker[1] + ", the actual count is " + actualCount);
                }
            });
        }));
    };
    /**
     * Get EUPL for the current page
     * returns undefined when page is still loading
     * reutrns number when page load completed with EUPL set to non zero number
     * returns null when EUPL could not be set within defined time for timeout
     */
    PerformancePageUtil._getPerformanceLogger = function () {
        // tslint:disable-next-line:any
        var logger = TAB.Win.window[this.spModuleLoader]._bundledComponents[this.spTelemetryComponentId]._PerformanceLogger
            ._staticLogger;
        if (!logger) {
            TAB.Log.Warning("Performance logger is undefined when requesting performance data.");
        }
        return logger;
    };
    PerformancePageUtil._isFCIComplete = function (startTime) {
        // tslint:disable-next-line:any
        var logger = this._getPerformanceLogger();
        // tslint:disable-next-line:any
        if (logger && logger.getPerformanceData) {
            var performanceData = logger.getPerformanceData();
            if (performanceData && performanceData.RUMOneError) {
                TAB.Log.Fail("RUMOneError occurred: " + performanceData.RUMOneError);
                throw new Error(performanceData.RUMOneError);
            }
            // Wait until deferred Render has started to collect any perf regression by this time.
            return performanceData
                ? performanceData.EUPL > 0 &&
                    performanceData.TTI > 0 &&
                    TAB.Win.window.performance.getEntriesByName('renderDeferredStart', 'mark').length > 0
                : false;
        }
        else {
            return false;
        }
    };
    PerformancePageUtil._getMarkerCount = function (name) {
        return TAB.Win.window.performance.getEntriesByName(name).length;
    };
    PerformancePageUtil._isPerfComplete = function () {
        // tslint:disable-next-line:any
        var logger = this._getPerformanceLogger();
        if (!logger) {
            TAB.Log.Warning("Performance logger is undefined when checking Perf completele");
        }
        return logger && logger.dataState > 2; // State above 2 indicates either perf data upload, timeout or skipped.
    };
    /**
     * Ensure that all network calls started before deferred render are whitelisted.
     * If not that it makes TAB test to fail with error message.
     */
    PerformancePageUtil._ensureNetworkCallsAreApproved = function (perfData, fciApprovedJs, iteration) {
        var _this = this;
        if (!fciApprovedJs || fciApprovedJs.length === 0) {
            return; // Whitelist check is not enabled
        }
        fciApprovedJs = fciApprovedJs.concat(this._baseFCIApprovedNetwork);
        var fciApprovedJsLowerCase = new Set();
        fciApprovedJs.map(function (name) { return fciApprovedJsLowerCase.add(name.toLowerCase()); });
        // Initialize TTI approved info for each iteration as we manipulate count of network requests found.
        this._initFCIApprovedInfo();
        var networkBeforeFCI = perfData.resourceRequests
            .filter(function (request) {
            var nameLowerCase = request.name.toLowerCase();
            return (request.entryType === 'resource' &&
                !isNaN(request.startTime) &&
                request.startTime < perfData.TTI[iteration] &&
                nameLowerCase.indexOf('browser.pipe.aria.microsoft.com') === -1 && // telemetry
                nameLowerCase.indexOf('completenesss.svc.ms/api/collection') === -1 && // telemetry
                nameLowerCase.indexOf('fabric/assets/icons/fabric-icons-') === -1 && // fabric icons
                nameLowerCase.indexOf('_api/sp.oauth.token/acquire') === -1 && // Acquire token for Media service
                nameLowerCase.indexOf('/wsaupload.ashx') === -1 && // telemetry
                nameLowerCase.indexOf('manifests.js') === -1 &&
                nameLowerCase.indexOf('graph.microsoft.com/v1.0/users') === -1 &&
                !nameLowerCase.match(META_REGEX) && // Meta thumbnail
                !nameLowerCase.match(DOCVIZ_REGEX) && // getPreview thumbnail
                !nameLowerCase.match(VROOM_META_CACHE_REGEX) && // VROOM thumbnail with cache
                !nameLowerCase.match(VROOM_META_REGEX)); // VROOM thumbnail
        })
            .map(function (value) {
            var paths = value.name.split('?')[0].split('/');
            var resourceName = paths[paths.length - 1];
            resourceName = resourceName.split('_')[0]; // Drop Guid from the name
            // remove stamp from end of chunk name, e.g., ~8adb2671
            if (resourceName.indexOf('chunk.') === 0) {
                var parts = resourceName.split('~');
                if (parts.length > 0 && parts[parts.length - 1].length === 8) {
                    parts.pop();
                    resourceName = parts.join('~');
                }
            }
            var dotIndex = resourceName.indexOf('.');
            if (dotIndex >= 0 && dotIndex < 3 && dotIndex + 1 < resourceName.length) {
                // Drop Chunk number prefix as it can keep changing over time e.g. 0.sp-client-telemetry-aria
                resourceName = resourceName.substring(dotIndex + 1);
            }
            var networkCall = { name: value.name, shortName: resourceName.replace('.js', '') };
            return networkCall;
        });
        if (networkBeforeFCI.length === 0) {
            TAB.Log.DidNotRun('Network files before TTI not captured. Test did not complete.');
            return;
        }
        networkBeforeFCI.forEach(function (networkCall) {
            var _a;
            var shortNameLowerCase = (_a = networkCall) === null || _a === void 0 ? void 0 : _a.shortName.toLowerCase();
            if (!fciApprovedJsLowerCase.has(shortNameLowerCase) && !_this._isApprovedNetworkCall(networkCall.name)) {
                TAB.Log.Fail("[" + shortNameLowerCase + "] " + networkCall.name + " network call started before deferred render. If you consider this as required before deferred render, get it reviewed with performance crew and add it into fciApprovedNetwork array.");
            }
            else {
                TAB.Log.Comment("[" + shortNameLowerCase + "] " + networkCall.name + " expected network call.");
            }
        });
    };
    PerformancePageUtil._isApprovedNetworkCall = function (networkCall) {
        if (networkCall) {
            var networkCallLowerCase_1 = networkCall.toLowerCase();
            var match = this._approvedNetworkCallsByCount.filter(function (approvedInfo) { return networkCallLowerCase_1.indexOf(approvedInfo.networkName) >= 0; });
            if (match && match.length > 0) {
                if (match[0].maxAllowed > 0) {
                    match[0].maxAllowed--;
                    return true;
                }
                else {
                    TAB.Log.Warning("Exceeded maximum number of allowed network calls for : " + match[0].networkName);
                    return false;
                }
            }
        }
        return false;
    };
    PerformancePageUtil._printComparisionSummary = function (baseline, actual, singleIteration) {
        if (singleIteration === void 0) { singleIteration = false; }
        this._printCompareLine(baseline.euplPostHead, actual.euplPostHead, 'EUPL post head start');
        this._printCompareLine(baseline.renderTime, actual.renderTime, 'Page Render');
        this._printCompareLine(baseline.webPartLoadTime, actual.webPartLoadTime, 'loadWebPart API sync time');
        this._printCompareLine(baseline.pagesAssemblyLoad, actual.pagesAssemblyLoad, 'Pages assembly eval & exec');
        this._printCompareLine(baseline.appStartPostHead, actual.appStartPostHead, 'App start post head start');
        this._printCompareLine(baseline.pageComponentStart, actual.pageComponentStart, 'Start Page render post App Start');
        this._printCompareLine(baseline.pageComponentRender, actual.pageComponentRender, 'Page Component Mount');
        this._printCompareLine(baseline.canvasRender, actual.canvasRender, 'Canvas Render');
        this._printCompareLine(baseline.layoutRender75Percentile, actual.layoutRender75Percentile, 'Layout Render');
        this._printCompareLine(baseline.apiCalls, actual.apiCalls, 'API call Count');
        this._printCompareLine(baseline.cdnRequests, actual.cdnRequests, 'CDN Requests');
        this._printCompareLine(baseline.resourceRequests.length, actual.resourceRequests.length, 'Resources request before EUPL');
        this._printCompareLine(baseline.headStart, actual.headStart, 'Browser start rendering <head>');
        if (this._isRegressed(actual.resourceRequests.length, baseline.resourceRequests.length, 1)) {
            var nameBaselineIndex_1 = [];
            var azurePath_1 = (TAB.Settings.Get('AzurePath') || '').replace(/\/+$/, '') + '/';
            var baselinePath_1 = 'https://resourceseng.blob.core.windows.net/files/refs_heads_master/';
            baseline.resourceRequests.forEach(function (value, index, array) {
                if (value.name.indexOf(azurePath_1) >= 0) {
                    nameBaselineIndex_1[value.name.replace(azurePath_1, '')] = value;
                }
                else if (value.name.indexOf(baselinePath_1) >= 0) {
                    nameBaselineIndex_1[value.name.replace(baselinePath_1, '')] = value;
                }
                else {
                    nameBaselineIndex_1[value.name] = value;
                }
            });
            var nameActualIndex_1 = [];
            actual.resourceRequests.forEach(function (value, index, array) {
                nameActualIndex_1[value.name] = value;
                var name = value.name;
                if (name.indexOf(azurePath_1) >= 0) {
                    name = name.replace(azurePath_1, '');
                }
                else if (name.indexOf(baselinePath_1) >= 0) {
                    name = name.replace(baselinePath_1, '');
                }
                if (!nameBaselineIndex_1[name]) {
                    // this resource was not requested for base line
                    TAB.Log.Warning(" Request " + name + " initiated by " + value.initiatorType + " not found in baseline.");
                }
            });
        }
    };
    PerformancePageUtil._printCompareLine = function (baseline, actual, msg) {
        baseline = Math.round(baseline);
        actual = Math.round(actual);
        var change = actual - baseline;
        var message = msg + ": [delta:" + change + "] [baseline:" + baseline + "] vs [actual:" + actual + "]";
        change <= 0 ? TAB.Log.Pass(message) : TAB.Log.Warning(message);
    };
    PerformancePageUtil._printPerformanceSummary = function (actual, singleIteration) {
        if (singleIteration === void 0) { singleIteration = false; }
        if (!singleIteration) {
            TAB.Log.Pass("EUPL Post Head Start 75 percentile: [" + Math.round(actual.euplPostHead) + "]");
            TAB.Log.Pass("Render Time 75 percentile: [" + Math.round(actual.renderTime) + "]");
            TAB.Log.Pass("Maximum EUPL Post Head: [" + Math.round(actual.maxEUPLPostHead) + "]");
            TAB.Log.Pass("Minimum EUPL Post Head: [" + Math.round(actual.minEUPLPostHead) + "]");
        }
        else {
            TAB.Log.Pass("EUPL Post Head Start: [" + Math.round(actual.euplPostHead) + "]");
            TAB.Log.Pass("Render Time: [" + Math.round(actual.renderTime) + "]");
        }
        TAB.Log.Pass("$Pages assembly eval and execution Time: [" + Math.round(actual.pagesAssemblyLoad) + "]");
        TAB.Log.Pass("$AppStart since Head Start: [" + Math.round(actual.appStartPostHead) + "]");
        TAB.Log.Pass("$Start Page Component post App Start: [" + Math.round(actual.pageComponentStart) + "]");
        TAB.Log.Pass("$Render Page Component: [" + Math.round(actual.pageComponentRender) + "]");
        TAB.Log.Pass("$Render Canvas: [" + Math.round(actual.canvasRender) + "]");
        TAB.Log.Pass("loadWebPart API total sync time : [" + Math.round(actual.webPartLoadTime) + "]");
        TAB.Log.Pass("$Layout render: [" + Math.round(actual.layoutRender75Percentile) + "]");
        TAB.Log.Pass("$API Requests Count: [" + actual.apiCalls + "]");
        TAB.Log.Pass("$CDN Requests Count: [" + actual.cdnRequests + "]");
        TAB.Log.Pass("$Total resource requests Count: [" + actual.resourceRequests.length + "]");
        TAB.Log.Pass("$Head Start: [" + Math.round(actual.headStart) + "]");
    };
    PerformancePageUtil._isRegressed = function (actual, baseline, threshold) {
        if (actual - baseline > threshold) {
            return true;
        }
    };
    PerformancePageUtil._computePagePerfSummary = function (pagePerfData, startIndex, maxIndex) {
        if (startIndex === void 0) { startIndex = 0; }
        var perfSummary = {};
        perfSummary.EUPL = [];
        perfSummary.renderDeferredStart = [];
        perfSummary.TTI = [];
        var minEUPLPostHead = Date.now();
        var maxEUPLPostHead = 1 - Date.now();
        var renderPostPageStart = [];
        var moduleLoaderScript = [];
        var appStartAfterhead = [];
        // Time taken from AppStart to PageComponent.start
        var pageComponentStart = [];
        // Time taken between PageComponent.start to PageComponent.end
        var pageComponentRender = [];
        // Time taken between CanvasComponent.start to CanvasComponent.end
        var canvasRender = [];
        // Time taken between LayoutComponent.start to LayoutComponent.end
        var layoutRender = [];
        var headStart = [];
        var apiCalls = [];
        var cdnRequests = [];
        var resourcesCount = [];
        var webPartLoadTime = [];
        var headStartKey = 'headStart';
        var appStartKey = 'appStart';
        var moduleLoaderScriptStartKey = 'moduleLoaderScriptStart';
        var moduleLoaderScriptEndKey = 'moduleLoaderScriptEnd';
        var pageComponentStartKey = 'PageComponent.start';
        var pageComponentEndKey = 'PageComponent.end';
        var canvasComponentStartKey = 'CanvasComponent.start';
        var canvasComponentEndKey = 'CanvasComponent.end';
        var layoutComponentStartKey = 'LayoutComponent.start';
        var layoutComponentEndKey = 'LayoutComponent.end';
        var nameKey = 'name';
        var durationKey = 'duration';
        var startTimekey = 'startTime';
        var spPagesAssemblyKey = 'sp-pages-assembly';
        var renderDeferredStartKey = 'renderDeferredStart';
        var webPartLoadKey = 'spLoadWebPartTime';
        var euplsPostHead = [];
        var lastIndex = !isNaN(maxIndex)
            ? Math.min(pagePerfData.length - 1, maxIndex)
            : pagePerfData.length - 1;
        var resourceRequests = pagePerfData[lastIndex].resourceTimings.filter(function (expected) {
            return expected.startTime < pagePerfData[lastIndex].perfData[renderDeferredStartKey];
        });
        for (var index = startIndex; index <= lastIndex; index++) {
            var pagePerfDataIteration = pagePerfData[index];
            var eupl = pagePerfDataIteration.perfData.EUPL;
            var fci = pagePerfDataIteration.perfData.TTI;
            perfSummary.EUPL[index] = eupl;
            perfSummary.renderDeferredStart[index] = pagePerfDataIteration.perfData[renderDeferredStartKey];
            perfSummary.TTI[index] = fci;
            var euplBreakdown = JSON.parse(pagePerfDataIteration.perfData.EUPLBreakdown);
            var headStartInstance = euplBreakdown[headStartKey];
            var appStartInstance = euplBreakdown[appStartKey];
            var webPartLoadInstance = pagePerfDataIteration.perfData[webPartLoadKey] || 0;
            var pageComponentStartInstance = euplBreakdown[pageComponentStartKey] - appStartInstance;
            var assemblyDownloadTime = 0;
            var assemblyDownloadStartTime = 0;
            if (pagePerfDataIteration.perfData.CDNRequestNames) {
                for (var cdnIndex = 0; cdnIndex < pagePerfDataIteration.perfData.CDNRequestNames.length; cdnIndex++) {
                    var cdnRequestData = pagePerfDataIteration.perfData.CDNRequestNames[cdnIndex];
                    if (cdnRequestData[nameKey] &&
                        !isNaN(cdnRequestData[durationKey]) &&
                        cdnRequestData[nameKey].indexOf(spPagesAssemblyKey) > 0) {
                        assemblyDownloadTime = cdnRequestData[durationKey];
                        assemblyDownloadStartTime = cdnRequestData[startTimekey];
                        break;
                    }
                }
            }
            resourcesCount.push(pagePerfDataIteration.resourceTimings.length);
            if (assemblyDownloadStartTime < headStartInstance) {
                // Browsers are smmart, triggering script download before script execution under <head>.
                assemblyDownloadTime = assemblyDownloadTime - (headStartInstance - assemblyDownloadStartTime);
                assemblyDownloadTime = Math.max(0, assemblyDownloadTime); // In rare case assembly download finished before head
            }
            // Off set the time spent during network for aspx page and loading assembly.
            var networkOffset = headStartInstance + assemblyDownloadTime;
            var appStartPostHead = appStartInstance - networkOffset;
            var euplPostHead = eupl - networkOffset;
            appStartAfterhead.push(appStartPostHead);
            headStart.push(headStartInstance);
            webPartLoadTime.push(webPartLoadInstance);
            pageComponentStart.push(pageComponentStartInstance);
            moduleLoaderScript.push(euplBreakdown[moduleLoaderScriptEndKey] -
                euplBreakdown[moduleLoaderScriptStartKey] -
                assemblyDownloadTime);
            pageComponentRender.push(euplBreakdown[pageComponentEndKey] - euplBreakdown[pageComponentStartKey]);
            canvasRender.push(euplBreakdown[canvasComponentEndKey] - euplBreakdown[canvasComponentStartKey]);
            layoutRender.push(euplBreakdown[layoutComponentEndKey] - euplBreakdown[layoutComponentStartKey]);
            renderPostPageStart.push(eupl - pageComponentStartInstance);
            euplsPostHead.push(euplPostHead);
            apiCalls.push(pagePerfDataIteration.perfData.APICallCount);
            cdnRequests.push(pagePerfDataIteration.perfData.CDNRequestCountTotal);
            if (euplPostHead < minEUPLPostHead) {
                minEUPLPostHead = euplPostHead;
            }
            if (euplPostHead > maxEUPLPostHead) {
                maxEUPLPostHead = euplPostHead;
            }
        }
        perfSummary.maxEUPLPostHead = maxEUPLPostHead;
        perfSummary.minEUPLPostHead = minEUPLPostHead;
        moduleLoaderScript.sort(function (a, b) {
            return a - b;
        });
        perfSummary.pagesAssemblyLoad = moduleLoaderScript[lastIndex - startIndex];
        appStartAfterhead.sort(function (a, b) {
            return a - b;
        });
        perfSummary.appStartPostHead = appStartAfterhead[lastIndex - startIndex];
        headStart.sort(function (a, b) {
            return a - b;
        });
        perfSummary.headStart = headStart[lastIndex - startIndex];
        webPartLoadTime.sort(function (a, b) {
            return a - b;
        });
        perfSummary.webPartLoadTime = webPartLoadTime[lastIndex - startIndex];
        pageComponentStart.sort(function (a, b) {
            return a - b;
        });
        perfSummary.pageComponentStart = pageComponentStart[lastIndex - startIndex];
        pageComponentRender.sort(function (a, b) {
            return a - b;
        });
        perfSummary.pageComponentRender = pageComponentRender[lastIndex - startIndex];
        canvasRender.sort(function (a, b) {
            return a - b;
        });
        perfSummary.canvasRender = canvasRender[lastIndex - startIndex];
        layoutRender.sort(function (a, b) {
            return a - b;
        });
        perfSummary.layoutRender75Percentile = layoutRender[lastIndex - startIndex];
        renderPostPageStart.sort(function (a, b) {
            return a - b;
        });
        perfSummary.renderTime = renderPostPageStart[lastIndex - startIndex];
        euplsPostHead.sort(function (a, b) {
            return a - b;
        });
        perfSummary.euplPostHead = euplsPostHead[lastIndex - startIndex];
        apiCalls.sort(function (a, b) {
            return a - b;
        });
        perfSummary.apiCalls = apiCalls[lastIndex - startIndex];
        cdnRequests.sort(function (a, b) {
            return a - b;
        });
        perfSummary.cdnRequests = cdnRequests[lastIndex - startIndex];
        perfSummary.resourceRequests = resourceRequests;
        return perfSummary;
    };
    PerformancePageUtil._PageReady = function () {
        return (TAB.Win.window.document.readyState === 'complete' ||
            TAB.Win.window.document.readyState === 'interactive');
    };
    /**
     * Returns true for the environment where test pages are available for test
     */
    PerformancePageUtil._isSetupOkay = function () {
        return this.whiteListedEnvironments.indexOf(TAB.Settings.Get('ProductServer').toLowerCase()) >= 0;
    };
    PerformancePageUtil._getRandomQuery = function () {
        return "guid=" + Math.ceil(Math.random() * 1000000);
    };
    PerformancePageUtil._initFCIApprovedInfo = function () {
        this._approvedNetworkCallsByCount = [
            { networkName: '/api/shellbootinfo/business/oneshell/', maxAllowed: 2 },
            { networkName: '/shellux/o365/versionless/', maxAllowed: 15 },
            { networkName: 'sp-suite-nav-search-common', maxAllowed: 2 },
            { networkName: '_api/contextinfo', maxAllowed: 1 },
            { networkName: 'search/configuration', maxAllowed: 1 } // VSO#710127: Requested by search
        ];
    };
    PerformancePageUtil.spModuleLoader = 'spModuleLoader';
    PerformancePageUtil.spTelemetryComponentId = '8217e442-8ed3-41fd-957d-b112e841286a';
    PerformancePageUtil.performanceData = {};
    PerformancePageUtil.baselinePerformanceData = {};
    // List of environments where pages are preconfigured for performance test
    PerformancePageUtil.whiteListedEnvironments = [
        'https://testtab.spoppe.com',
        'https://a830edad9050849sherwintest.sharepoint.com',
        'https://a830edad9050849testss01.sharepoint.com'
    ];
    PerformancePageUtil.masterManifestsUrl = 'https://resourceseng.blob.core.windows.net/files/refs_heads_master/manifests.js';
    PerformancePageUtil.isPullRequest = false;
    // All components in sp-pages-assembly.
    PerformancePageUtil._pagesAssemblyComponents = [
        'sp-core-library',
        'office-ui-fabric-react-bundle',
        'sp-diagnostics',
        'sp-load-themed-styles',
        'sp-telemetry',
        'sp-component-utilities',
        'sp-webpart-base',
        'sp-lodash-subset',
        'sp-loader',
        'odsp-utilities-bundle',
        'sp-page-context',
        'sp-http',
        'sp-canvas',
        'sp-application-base',
        'sp-a11y',
        'sp-suite-nav',
        'sp-webpart-shared',
        'i18n-utilities-bundle',
        'sp-safehtml',
        'oneshell',
        // 681598 to remove rte and deferred-component
        'sp-rte',
        'sp-deferred-component'
    ];
    PerformancePageUtil._baseFCIApprovedNetwork = [
        'chunk.FiftyKBChunk' /* WEXHundredKBSizePerfExperiment */,
        'chunk.HundredKBChunk' /* WEXHundredKBSizePerfExperiment */,
        'chunk.shared-react-shyconductor',
        'chunk.sp-search-common-scopingcontrolmanager',
        'chunk.sp-search-common-searchpageprovider',
        'chunk.sp-suite-nav-searchBoxProvider',
        'chunk.spcx-cache-executor',
        'chunk.vendors~sp-page-versions~sp-pages-panels~',
        'chunk.sp-page-versions~sp-pages-socialpanels~sp',
        'chunk.spcx-cache-provider',
        'chunk.vendors~shared-react-shyconductor',
        'chunk.vendors~sp-client-telemetry-aria',
        'chunk.vendors~sp-page-versions~spcx-cache-provider',
        'chunk.vendors~spcx-cache-executor',
        'chunk.vendors~spcx-cache-provider',
        'debug-application-customizer',
        'favicon.ico',
        'getsitelogo',
        'globalize-bundle',
        'i18n-utilities-bundle',
        'Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData',
        'odsp-core-bundle',
        'odsp-utilities-bundle',
        'OneShell',
        'sp-client-telemetry-aria',
        'sp-flight-inspector',
        'sp-loader-assembly',
        'sp-pages-assembly',
        'sp-pages-navigation',
        'spappbar.aspx',
        'spappbarwebpack',
        'spdefaultbanner',
        'SpoSuiteLinks.ashx',
        'userphoto.aspx',
        'userphoto.jpg',
        'spwebworkerproxy.ashx',
        // Post TTI files (in chronological order) included here in case the TTI marker is moved
        // due to resource constraints in the TAB test environment.
        'chunk.sp-pages-statemanager',
        'suiteux.shell.responsive',
        'chunk.vendors~spcx-siteheaderstatemanager',
        'chunk.vendors~shared-react-splivepersonacard~sp',
        'chunk.vendors~sp-pages-dwell-time',
        'chunk.vendors~shared-react-sitescriptprogressin',
        'chunk.shared-react-sitescriptprogressindicator',
        'suiteux.shell.core',
        'suiteux.shell.searchbox',
        'suiteux.shell.plus',
        'fp-min',
        'suiteux.shell.chat',
        'chunk.vendors~sp-suite-nav-search-common',
        'chunk.sp-suite-nav-search-common',
        'suiteux.shell.tokenfactoryiframe',
        'chunk.vendors~search-page-main~search-page-pfp~',
        'chunk.vendors~sp-pages-search-box~sp-pages-search-init',
        'chunk.sp-pages-search-box'
    ];
    // A list of the marks and their expected hit count.
    PerformancePageUtil.KEY_MARKERS_LIST = [
        ['Page.Mounted', 1],
        ['SPCanvas.Mounted', 1],
        ['PageLayoutScrollRegion.Mounted', 1],
        ['leftNav_EUPL_renderCount', 1],
        ['leftNav_renderCount', 4],
        ['SiteHeader_HorizontalNav_EUPL_renderCount', 3],
        ['SiteHeader_HorizontalNav_renderCount', 4],
        ['SiteHeader_EUPL_renderCount', 1],
        ['SiteHeader_renderCount', 2]
    ];
    return PerformancePageUtil;
}());



/***/ }),

/***/ "47KH":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ScopingControl.js ***!
  \**************************************************/
/*! exports provided: ScopingControl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScopingControl", function() { return ScopingControl; });
var SCOPINGCONTROL_DROPDOWNWRAPPER_PARTIAL_CLASS = 'dropdownWrapper-';
var SCOPINGCONTROL_ACTIVENTRY_PARTIAL_CLASS = 'ms-Dropdown-title';
var SCOPINGCONTROL_FOCUSABLE_PARTIAL_CLASS = 'ms-Dropdown dropdown-';
var SCOPINGCONTROL_DROPDOWNBUTTONS_PARTIAL_CLASS = 'ms-Button ms-Button--action';
var SCOPINGCONTROL_DROPDOWNBUTTONCONTENT_PARTIAL_CLASS = 'dropdownItemContent';
/**
 * @public
 */
var ScopingControl = /** @class */ (function () {
    function ScopingControl() {
    }
    ScopingControl.AddTaskFocusSearchBoxAndWaitForScopingControl = function () {
        this.AddTaskFocusInput();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var scopingControlDropdownContainer = ScopingControl.GetScopingControlDropdownWrapper();
            return !!scopingControlDropdownContainer;
        }));
    };
    ScopingControl.AddTaskClickScopingControlAndWaitForDropDownButtons = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var scopingControlFocusable = ScopingControl.GetScopingControlFocusable();
            scopingControlFocusable.click();
        }), TAB.MakeWaiter(function () {
            var scopingControlDropdownButtons = ScopingControl.GetScopingControlDropdownButtons();
            return scopingControlDropdownButtons.length > 0;
        }));
    };
    ScopingControl.AddTaskVerifyScopingControlWithActiveScope = function (expectedActiveScope) {
        TAB.AddTask(TAB.MakeTask(function () {
            var scopingControlActiveEntry = ScopingControl.GetScopingControlActiveEntry();
            var activeScopeControlText = TAB.GetTextContent(scopingControlActiveEntry);
            TAB.Log.VerifyEquals(activeScopeControlText, expectedActiveScope, 'Verifying the active scope.');
        }));
    };
    ScopingControl.AddTaskVerifyScopingControlWithScopeOptions = function (scopeOptions) {
        TAB.AddTask(TAB.MakeTask(function () {
            var scopingControlScopeOptionButtons = ScopingControl.GetScopingControlDropdownButtons();
            TAB.Log.VerifyEquals(scopingControlScopeOptionButtons.length, scopeOptions.length, 'Verifying scoping control dropdown options has correct count.');
            if (scopingControlScopeOptionButtons.length === scopeOptions.length) {
                for (var i = 0; i < scopingControlScopeOptionButtons.length; i++) {
                    var scopingControlOptionContent = TAB.GetElements(scopingControlScopeOptionButtons[i], TAB.searchBy.partialClassName, SCOPINGCONTROL_DROPDOWNBUTTONCONTENT_PARTIAL_CLASS)[0];
                    var scopingControlOptionText = TAB.GetTextContent(scopingControlOptionContent);
                    TAB.Log.VerifyEquals(scopingControlOptionText, scopeOptions[i], 'Verifying scoping control option text.');
                }
            }
        }));
    };
    ScopingControl.AddTaskFocusInput = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var searchBox = _this.GetSearchBoxContainer();
            TAB.GetElements(searchBox, TAB.searchBy.tag, 'input')[0].focus();
        }));
    };
    ScopingControl.GetSearchBoxContainer = function () {
        var searchBox = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365_SearchBoxContainer_container');
        if (!searchBox || !searchBox[0]) {
            searchBox = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365_SearchBoxContainer');
        }
        return searchBox[0];
    };
    ScopingControl.GetSearchBoxForm = function () {
        var searchBox = this.GetSearchBoxContainer();
        return TAB.GetElements(searchBox, TAB.searchBy.tag, 'form')[0];
    };
    ScopingControl.GetScopingControlDropdownWrapper = function () {
        var searchBoxForm = this.GetSearchBoxForm();
        return TAB.GetElements(searchBoxForm, TAB.searchBy.partialClassName, SCOPINGCONTROL_DROPDOWNWRAPPER_PARTIAL_CLASS)[0];
    };
    ScopingControl.GetScopingControlActiveEntry = function () {
        var scopingControlDropdownContainer = ScopingControl.GetScopingControlDropdownWrapper();
        return TAB.GetElements(scopingControlDropdownContainer, TAB.searchBy.partialClassName, SCOPINGCONTROL_ACTIVENTRY_PARTIAL_CLASS)[0];
    };
    ScopingControl.GetScopingControlFocusable = function () {
        var searchBoxForm = this.GetSearchBoxForm();
        var scopingControlFocusable = TAB.GetElements(searchBoxForm, TAB.searchBy.partialClassName, SCOPINGCONTROL_FOCUSABLE_PARTIAL_CLASS)[0];
        return scopingControlFocusable;
    };
    ScopingControl.GetScopingControlDropdownButtons = function () {
        var searchBoxForm = this.GetSearchBoxForm();
        var scopingControlDropdownButtons = TAB.GetElements(searchBoxForm, TAB.searchBy.partialClassName, SCOPINGCONTROL_DROPDOWNBUTTONS_PARTIAL_CLASS);
        return scopingControlDropdownButtons;
    };
    return ScopingControl;
}());



/***/ }),

/***/ "4VGn":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/MuiSettingsPage.js ***!
  \******************************************/
/*! exports provided: MuiSettingsPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MuiSettingsPage", function() { return MuiSettingsPage; });
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Next */ "BJbA");


/**
 * @public
 */
var MuiSettingsPage = /** @class */ (function () {
    function MuiSettingsPage() {
    }
    MuiSettingsPage.AddTaskCreateSite = function (siteName, result) {
        TAB.SetWaitTime(2 * 60 * 1000);
        var d = new Date();
        var uniqueSiteName = TAB.GetUniqueName('delete_' + siteName + '_' + d.getHours() + '_' + d.getMinutes() + '_');
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskCreateCommSite(uniqueSiteName, result, _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["SiteDesignId"].BlankDesignId, 1036 /* French */);
        TAB.AddTask(TAB.MakeTask(function () {
            /* tslint:disable-next-line:no-string-literal */
            result.SiteUrl = result['retVal'].d.Create.SiteUrl;
            result.SiteName = uniqueSiteName;
        }));
    };
    MuiSettingsPage.AddTaskLoadSettingsPage = function (siteInfo, pageName) {
        TAB.AddTask(TAB.MakeTask(function () {
            var muiPageUrl = siteInfo.SiteUrl + "/_layouts/15/" + pageName + ".aspx";
            TAB.AddTask(TAB.LoadPage(muiPageUrl));
        }), TAB.MakeWaiter(function () {
            return TAB.Win.location.href.indexOf("/_layouts/15/" + pageName + ".aspx") > 0;
        }));
    };
    MuiSettingsPage.AddTaskTurnMultilingualOn = function () {
        TAB.AddTask(undefined, TAB.AndWaiters(
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'multilingualSupportToggle'), TAB.MakeWaiter(function () {
            /* tslint:disable-next-line:no-any */
            var toggle = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'multilingualSupportToggle');
            return !!toggle && !toggle.hasAttribute('disabled');
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            /* tslint:disable-next-line:no-any */
            var toggle = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'multilingualSupportToggle');
            if (toggle.attributes['aria-checked'].value === 'false') {
                toggle.click();
            }
        }), 
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'MuiMLPLanguageList'));
    };
    MuiSettingsPage.GetAddLanguageElement = function () {
        /* tslint:disable-next-line:no-any */
        return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'MuiAddLanguage');
    };
    MuiSettingsPage.GetMLPLanguageList = function () {
        /* tslint:disable-next-line:no-any */
        return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'MuiMLPLanguageList');
    };
    MuiSettingsPage.GetMLPLanguageCount = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(MuiSettingsPage.GetMLPLanguageList(), 'DetailsRow').length;
    };
    MuiSettingsPage.WaitForLanguageCount = function (numLanguages) {
        return TAB.MakeWaiter(function () {
            return numLanguages === MuiSettingsPage.GetMLPLanguageCount();
        });
    };
    MuiSettingsPage.AddTaskAddRandomLanguage = function () {
        var numLanguages = 0;
        TAB.AddTask(TAB.MakeTask(function () {
            numLanguages = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(MuiSettingsPage.GetMLPLanguageList(), 'DetailsRow')
                .length;
            TAB.AddTask(TAB.MakeTask(function () {
                // First, we try to enter the pseudoloc version of the language
                MuiSettingsPage.enterRandomLanguage();
            }), 
            /* tslint:disable-next-line:no-any */
            TAB.AndWaiters(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'MuiAddLanguage'), MuiSettingsPage.WaitForLanguageCount(numLanguages + 1)));
        }), 
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'MuiAddLanguage'));
    };
    MuiSettingsPage.AddTaskSaveSettingsPage = function () {
        TAB.AddTask(undefined, TAB.AndWaiters(
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'MuiSaveButton'), TAB.MakeWaiter(function () {
            /* tslint:disable-next-line:no-any */
            var button = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'MuiSaveButton');
            return !!button && !button.hasAttribute('disabled');
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            /* tslint:disable-next-line:no-any */
            var button = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'MuiSaveButton');
            button.click();
        }), 
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'MuiSaveSuccess'));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () { return TAB.Win.location.href.endsWith('settings.aspx'); }));
    };
    MuiSettingsPage.enterRandomLanguage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var addLangButton = TAB.GetElements(MuiSettingsPage.GetAddLanguageElement(), TAB.searchBy.tag, 'button')[0];
            addLangButton.click();
        }), TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-ComboBox-callout'), TAB.MakeWaiter(function () {
            var callout = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-ComboBox-callout');
            return TAB.ElementExists(callout, TAB.searchBy.tag, 'button');
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            var callout = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-ComboBox-callout');
            var languageOptions = TAB.GetElements(callout, TAB.searchBy.tag, 'button');
            if (!languageOptions || languageOptions.length === 0) {
                TAB.Log.AddTaskFail("Couldn't find languages in the MUI settings page language dropdown");
            }
            var languageOption = languageOptions[Math.floor(Math.random() * languageOptions.length)];
            languageOption.focus();
            languageOption.click();
        }), TAB.MakeWaiter(function () { return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ComboBox-callout'); }));
    };
    return MuiSettingsPage;
}());



/***/ }),

/***/ "4upd":
/*!**************************************!*\
  !*** ./lib/SPTaskLib/Mocks/index.js ***!
  \**************************************/
/*! exports provided: SessionStorageKey, CortexMockData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _CortexMockData__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CortexMockData */ "Fp7G");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SessionStorageKey", function() { return _CortexMockData__WEBPACK_IMPORTED_MODULE_0__["SessionStorageKey"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CortexMockData", function() { return _CortexMockData__WEBPACK_IMPORTED_MODULE_0__["CortexMockData"]; });




/***/ }),

/***/ "7fnt":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ImageWebpart.js ***!
  \************************************************/
/*! exports provided: ImageWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageWebpart", function() { return ImageWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _FilePicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./FilePicker */ "8uLm");
/* harmony import */ var _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Pages/PropertyPane */ "M/CL");







var IMAGE_EDIT_PREVIEW_AUTOMATION_ID = 'imageEditPreview';
/**
 * @public
 */
var ImageWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(ImageWebpart, _super);
    function ImageWebpart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Image, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Image.toString()) || this;
    }
    ImageWebpart.prototype.IsWebpartUpdated = function () {
        return TAB.ElementExists(this.root, TAB.searchBy.tag, 'img');
    };
    ImageWebpart.prototype.AddTaskOpenFilePicker = function (filePicker) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (!_this._filePicker && _this._placeHolderButton) {
                TAB.Log.Comment('Clicking placeholder button to open File Picker for Image Web Part');
                TAB.ClickElement(_this._placeHolderButton);
            }
        }), _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, _FilePicker__WEBPACK_IMPORTED_MODULE_5__["FILE_PICKER_AUTOMATION_ID"]));
        TAB.AddTask(TAB.MakeTask(function () {
            filePicker.SetRoot(_this._filePicker);
        }), filePicker.WaitForViewLoad(_FilePicker__WEBPACK_IMPORTED_MODULE_5__["FilePickerView"].Recent));
    };
    ImageWebpart.prototype.AddTaskOpenCrop = function () {
        var _this = this;
        TAB.AddTask(undefined, TAB.AndWaiters(this.WaitForElementsByDataAutomationId(IMAGE_EDIT_PREVIEW_AUTOMATION_ID, 1), this.WaitForElementsByDataAutomationId('localFilePreview', 0)));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking Image Edit Preview to open Image Cropper');
            TAB.ClickElement(_this._imageEditPreview);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(_this.root, TAB.searchBy.className, 'cropper-container cropper-bg');
        }));
    };
    ImageWebpart.prototype.AddTaskCheckCroppingResult = function (listName) {
        var _this = this;
        var imageRatio, imageAreaRatio;
        TAB.AddTask(TAB.MakeTask(function () {
            var image = TAB.GetElement(_this._imageEditPreview, TAB.searchBy.tag, 'img');
            imageRatio = image.clientWidth / image.clientHeight;
            imageAreaRatio = image.parentElement.clientWidth / (image.parentElement.clientHeight - 4) /*padding*/;
        }), TAB.MakeWaiter(function () {
            // either img or imageArea will have same aspect ratio as cropBox depending on service type
            return (Math.round(_this._cropBoxRatio * 100) / 100 === Math.round(imageRatio * 100) / 100 ||
                Math.round(_this._cropBoxRatio * 100) / 100 === Math.round(imageAreaRatio * 100) / 100);
        }));
        this.AddTaskPushImageToDeleteArray(listName);
    };
    /**
     * For image that uploaded to SharePoint, we are maintaining a list of file name.
     * After tab tests finishes, those image need to be deleted to release space for future tests.
     * @param listName - the name of the list that containing all uploaded images
     */
    ImageWebpart.prototype.AddTaskPushImageToDeleteArray = function (listName) {
        var _this = this;
        var imageUrl;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                imageUrl = _this.imageUrl;
                return Boolean(imageUrl);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (TAB[listName]) {
                TAB[listName].push(imageUrl);
            }
        }));
    };
    ImageWebpart.prototype.AddTaskCropImageByKeyboard = function (steps) {
        var _this = this;
        for (var i = 0; i < steps; i++) {
            TAB.AddTask(TAB.MakeTask(function () {
                // mouse down on the NW corner
                _this._cropBoxRatio = _this._cropperBox.clientWidth / _this._cropperBox.clientWidth;
                // Add some randomization to shift/ctrl + arrow Keys
                TAB.Log.Comment('Keydown on shift + left arrow to reduce cropper box size');
                Object(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["FireKeyboardEvent"])(_this._cropWrapper, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].left, 'shiftKey');
            }), TAB.MakeWaiter(function () {
                // If crop reached the end of one dimension or the ratio has changed because of a crop action
                return (_this._cropperBox.clientWidth === 0 ||
                    _this._cropperBox.clientWidth === 0 ||
                    _this._cropBoxRatio !== _this._cropperBox.clientWidth / _this._cropperBox.clientHeight);
            }));
        }
        TAB.AddTask(TAB.MakeTask(function () {
            // recalculate cropBox ratio
            _this._cropBoxRatio = _this._cropperBox.clientWidth / _this._cropperBox.clientHeight;
            // Add some randomization to shift/ctrl + arrow Keys
            TAB.Log.Comment('result image aspect ratio is ' + _this._cropBoxRatio);
        }), undefined);
    };
    ImageWebpart.prototype.AddTaskCloseCrop = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking Saving button to close cropper');
            var imageSaveButton = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(_this.root, 'imageSaveButton');
            TAB.ClickElement(imageSaveButton);
        }), this.WaitForElementsByDataAutomationId(IMAGE_EDIT_PREVIEW_AUTOMATION_ID, 1));
    };
    /**
     * Test image web part upload image. In Edge, it will use bing search instance. In other case, provided file and
     * file name will be uploaded.
     * @param filePicker - file picker tab test instance
     * @param file - file instance that been uploaded
     * @param listName - the name of the list that containing all uploaded images
     */
    ImageWebpart.prototype.AddTaskUploadImage = function (filePicker, file, listName) {
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskComment('Using bing search file for testing in Edge');
            this.AddTaskUploadImageFromBingSearch(filePicker, listName);
        }
        else {
            filePicker.AddTaskUploadItem(file);
            this.AddTaskPushImageToDeleteArray(listName);
        }
    };
    ImageWebpart.prototype.AddTaskUploadImageFromBingSearch = function (filePicker, listName) {
        filePicker.AddTaskSelectView(_FilePicker__WEBPACK_IMPORTED_MODULE_5__["FilePickerView"].Search);
        filePicker.AddTaskOpenFile(0);
        this.AddTaskPushImageToDeleteArray(listName);
    };
    /**
     * Change image to another one using file picker bing search.
     * @param filePicker - file picker tab task instance
     * @param listName - the name of the list that containing all uploaded images
     */
    ImageWebpart.prototype.AddTaskChangeImageUseBingSearch = function (filePicker, listName) {
        var _this = this;
        var imageUrl;
        this.AddTaskClickConfigureButton();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._changeImageButton);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            imageUrl = _this.imageUrl;
            TAB.ClickElement(_this._changeImageButton);
            TAB.Log.Comment('Click change image button');
        }), _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, _FilePicker__WEBPACK_IMPORTED_MODULE_5__["FILE_PICKER_AUTOMATION_ID"]));
        TAB.AddTask(TAB.MakeTask(function () {
            filePicker.SetRoot(_this._filePicker);
            TAB.Log.Comment('Set file picker root');
        }), filePicker.WaitForViewLoad(_FilePicker__WEBPACK_IMPORTED_MODULE_5__["FilePickerView"].Recent));
        filePicker.AddTaskSelectView(_FilePicker__WEBPACK_IMPORTED_MODULE_5__["FilePickerView"].Search);
        filePicker.AddTaskOpenFile(0);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Compare image URL');
        }), TAB.MakeWaiter(function () {
            try {
                return _this.imageUrl !== imageUrl;
            }
            catch (e) {
                return false;
            }
        }));
        this.AddTaskPushImageToDeleteArray(listName);
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_6__["PropertyPane"].AddTaskClosePropertyPane();
    };
    /**
     * Add specific link url to image web part.
     * @param linkUrl - Link Url to add
     */
    ImageWebpart.prototype.AddTaskAddLink = function (linkUrl) {
        var _this = this;
        this.AddTaskClickConfigureButton();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._linkInput);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var inputField = _this._linkInput;
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(inputField, linkUrl);
            TAB.Log.Comment('Add link Url to image property pane');
        }), TAB.MakeWaiter(function () {
            try {
                return _this._linkInput.value === linkUrl;
            }
            catch (e) {
                return false;
            }
        }));
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskSavePage();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var LinkHref = TAB.GetElement(_this.root, TAB.searchBy.tag, 'A').getAttribute('href');
                return LinkHref === linkUrl;
            }
            catch (e) {
                return false;
            }
        }));
    };
    /**
     * Upload a small width image and check whether 'add text over image' toggle button is disabled.
     * @param filePicker - tab test filepicker instance
     * @param file - image file that need to be uploaded
     * @param listName - Name of the list that would maintain the source of all uploaded image to be deleted after test complete.
     */
    ImageWebpart.prototype.AddTaskDisableTextOverlay = function (filePicker, file, listName) {
        // Edge browser does not support uploading specific file.
        if (navigator.userAgent.toLowerCase().indexOf('edge') === -1) {
            filePicker.AddTaskUploadItem(file);
            this.AddTaskCheckToggleDisabled(true /* isDisabled */);
            this.AddTaskPushImageToDeleteArray(listName);
        }
    };
    ImageWebpart.prototype.AddTaskCheckToggleDisabled = function (isDisabled) {
        var _this = this;
        this.AddTaskClickConfigureButton();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return _this._textOverlayToggle.disabled === isDisabled;
            }
            catch (e) {
                return false;
            }
        }));
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_6__["PropertyPane"].AddTaskClosePropertyPane();
    };
    ImageWebpart.prototype.AddTaskTurnOnTextOverlay = function () {
        var _this = this;
        this.AddTaskClickConfigureButton();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._textOverlayToggle);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this._textOverlayToggle.disabled === true) {
                throw new Error('Toggle button is not enabled');
            }
            if (_this._textOverlayToggle.getAttribute('aria-pressed') === 'false') {
                TAB.ClickElement(_this._textOverlayToggle);
                TAB.Log.Comment('Enable add text over image toggle button');
            }
        }), TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._overlayTextField);
            }
            catch (e) {
                return false;
            }
        }));
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_6__["PropertyPane"].AddTaskClosePropertyPane();
    };
    /**
     * Open setting for text overlay and add some text to web part. Page will be saved after the test.
     * @param text - string added to web part, its length should be less than 48.
     */
    ImageWebpart.prototype.AddTaskAddTextOverlay = function (text) {
        var _this = this;
        try {
            this.AddTaskTurnOnTextOverlay();
            TAB.AddTask(TAB.MakeTask(function () {
                var overlayTextField = _this._overlayTextField;
                _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(overlayTextField, text);
                TAB.Log.Comment("Change text over image to " + text);
            }), TAB.MakeWaiter(function () {
                try {
                    return _this._overlayTextField.value === text;
                }
                catch (e) {
                    return false;
                }
            }));
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskSavePage();
            TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                try {
                    return _this._overlayTextField.textContent === text;
                }
                catch (e) {
                    return false;
                }
            }));
        }
        catch (e) {
            // Current image is too small to add text over it. Do nothing here.
            TAB.Log.Comment('Image size is too small to add text over image');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskSavePage();
        }
    };
    Object.defineProperty(ImageWebpart.prototype, "imageUrl", {
        get: function () {
            return TAB.GetElement(this._imageEditPreview, TAB.searchBy.tag, 'img').getAttribute('data-sp-originalimgsrc');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_placeHolderButton", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this.root, 'placeholderButton');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_cropperBox", {
        get: function () {
            return TAB.GetElement(this.root, TAB.searchBy.className, 'cropper-crop-box');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_filePicker", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, _FilePicker__WEBPACK_IMPORTED_MODULE_5__["FILE_PICKER_AUTOMATION_ID"]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_cropWrapper", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this.root, 'imageCropWrapper');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_imageEditPreview", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this.root, IMAGE_EDIT_PREVIEW_AUTOMATION_ID);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_propertyPane", {
        get: function () {
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='showPane']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_changeImageButton", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this._propertyPane, 'change-image-button');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_linkInput", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this._propertyPane, 'image-link-input');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_textOverlayToggle", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this._propertyPane, 'text-over-image-toggle');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageWebpart.prototype, "_overlayTextField", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(this.root, 'image-overlay-text');
        },
        enumerable: true,
        configurable: true
    });
    ImageWebpart.logoMS = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAAAuCAYAAABK69fpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTAwQkM2Mzk4NDBBMTFFNjhDQkVCOTdDMjE1NkM3RkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTAwQkM2Mzg4NDBBMTFFNjhDQkVCOTdDMjE1NkM3RkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMkM5MzFBNDcwQTExMUU2QUVERkExNDU3ODU1M0I3QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMkM5MzFBNTcwQTExMUU2QUVERkExNDU3ODU1M0I3QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgQJy/MAAAxESURBVHja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';
    return ImageWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "7on5":
/*!**************************************!*\
  !*** ./lib/SPTaskLib/ListLibrary.js ***!
  \**************************************/
/*! exports provided: List */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "List", function() { return List; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Next */ "BJbA");
/* harmony import */ var _CsomUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CsomUtil */ "UXDa");


/**
 * @public
 */
var List = /** @class */ (function () {
    function List(listName, subwebUrl) {
        if (subwebUrl) {
            this._subwebUrl = this._fixSubWebUrl(subwebUrl);
        }
        this.listName = listName;
        this.listItemsTitle = [];
    }
    // this API works with site collection i.e. sites/sitename
    List.addRestTaskDeleteItem2 = function (siteUrl, fileServerRelativeUrl) {
        var targetUrl = siteUrl + '/_api/web/GetFileByServerRelativePath(DecodedUrl=@a1)/recycle';
        targetUrl += '?@a1=' + "'" + encodeURI(fileServerRelativeUrl) + "'";
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendRestRequest(siteUrl, targetUrl, '', result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result.retVal &&
                result.retVal.d &&
                result.retVal.d.Recycle !== '00000000-0000-0000-0000-000000000000') {
                TAB.Log.Comment('Deleted item: ' + fileServerRelativeUrl + '.');
            }
            else {
                TAB.Log.Warning('Could not delete the item. Did the copy actually finish?');
            }
        }));
    };
    // this API works without site collection
    List.addRestTaskDeleteItem = function (siteUrl, webUrl, fileServerRelativeUrl, fetchCanary) {
        var targetUrl = siteUrl + '/_api/SP.RemoteWeb(@remoteWeb)/GetFileByServerRelativeUrl(@url)/recycle';
        targetUrl += '?@remoteWeb=' + "'" + encodeURI(webUrl) + "'";
        targetUrl += '&@url=' + "'" + encodeURI(fileServerRelativeUrl) + "'";
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendRestRequest(siteUrl, targetUrl, '', result, fetchCanary);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result.retVal &&
                result.retVal.d &&
                result.retVal.d.Recycle !== '00000000-0000-0000-0000-000000000000') {
                TAB.Log.Comment('Deleted item: ' + fileServerRelativeUrl + '.');
            }
            else {
                TAB.Log.Warning('Could not delete the item. Did the copy actually finish?');
            }
        }));
    };
    List.addCsomTaskAddDocument = function (fileName, folder, siteUrl) {
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(function () {
            var clientContext = siteUrl
                ? new SP.ClientContext(siteUrl)
                : SP.ClientContext.get_current();
            var oWebsite = clientContext.get_web();
            var oList = oWebsite.get_lists().getByTitle(folder);
            var fileCreateInfo = new SP.FileCreationInformation();
            fileCreateInfo.set_url(fileName);
            fileCreateInfo.set_content(new SP.Base64EncodedByteArray());
            fileCreateInfo.set_overwrite(true);
            var doc = oList.get_rootFolder().get_files().add(fileCreateInfo);
            clientContext.load(doc);
            clientContext.executeQueryAsync(function () {
                TAB.Log.Comment('Success uploading document ' + fileName);
            }, function () {
                // tslint:disable-line:no-function-expression
                TAB.Log.Fail('Error uploading document ' + fileName + arguments[1].get_message()); // tslint:disable-line:use-named-parameter
            });
            return clientContext;
        });
    };
    /**
     * @param filepath - Path to file including filename, e.g. '/Shared Documents/file.txt'
     */
    List.addCsomTaskDeleteDocument = function (filepath, siteUrl) {
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(function () {
            var clientContext = siteUrl
                ? new SP.ClientContext(siteUrl)
                : SP.ClientContext.get_current();
            var oWebsite = clientContext.get_web();
            clientContext.load(oWebsite);
            clientContext.executeQueryAsync(function () {
                var fileUrl = oWebsite.get_serverRelativeUrl() + filepath;
                var file = oWebsite.getFileByServerRelativeUrl(fileUrl);
                clientContext.load(file);
                file.deleteObject();
                clientContext.executeQueryAsync(function () {
                    TAB.Log.Comment('Success deleting document ' + filepath);
                }, function () {
                    // tslint:disable-line:no-function-expression
                    TAB.Log.Fail('Error deleting document ' + filepath + arguments[1].get_message()); // tslint:disable-line:use-named-parameter
                });
            });
            return clientContext;
        });
    };
    List.addCsomTaskEditDocumentTitle = function (id, newTitle) {
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(function () {
            var clientContext = SP.ClientContext.get_current();
            var oWebsite = clientContext.get_web();
            var oList = oWebsite.get_lists().getByTitle('Documents');
            var doc = oList.getItemById(id);
            doc.set_item('Title', newTitle);
            doc.update();
            clientContext.load(doc);
            clientContext.executeQueryAsync(function () {
                TAB.Log.Comment('Success updating document title to ' + newTitle);
            }, function () {
                TAB.Log.Fail('Error updating document title to ' + newTitle);
            });
            return clientContext;
        });
    };
    List.addCsomTaskAddQuickLaunchLink = function (webUrl, url, title, isExternal, asLastNode) {
        var AddQuickLaunchLink = function () {
            var context = new SP.ClientContext(webUrl);
            var currentWeb = context.get_web();
            var quicklaunch = currentWeb.get_navigation().get_quickLaunch();
            context.load(quicklaunch);
            var listLinkNode = new SP.NavigationNodeCreationInformation();
            listLinkNode.set_url(url);
            listLinkNode.set_title(title);
            listLinkNode.set_isExternal(isExternal);
            listLinkNode.set_asLastNode(asLastNode);
            quicklaunch.add(listLinkNode);
            return context;
        };
        var OnFailedAddQuickLaunchLink = function () {
            TAB.Log.Fail('Failed to add quicklaunch link.');
        };
        var OnSuccessAddQuickLaunchLink = function () {
            TAB.Log.Comment('Add quicklaunch link.');
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(AddQuickLaunchLink, OnSuccessAddQuickLaunchLink, OnFailedAddQuickLaunchLink);
    };
    List.prototype.addCsomTaskCreateList = function (params) {
        var _this = this;
        var numberOfItems = params.numberOfItems, template = params.template, additionalFields = params.additionalFields, fieldValues = params.fieldValues;
        var createList = function () {
            _this._initializeClientContext();
            var web = _this._clictx.get_web();
            var listCol = web.get_lists();
            var listCreateInfo = new SP.ListCreationInformation();
            listCreateInfo.set_title(_this.listName);
            if (template) {
                listCreateInfo.set_templateType(template);
            }
            else {
                listCreateInfo.set_templateType(SP.ListTemplateType.genericList);
            }
            _this._listObj = listCol.add(listCreateInfo);
            _this._clictx.load(_this._listObj, 'Id', 'DefaultViewUrl', 'DefaultView');
            TAB.Log.Verbose("About to CreateList '" + _this.listName + "'");
            if (additionalFields) {
                TAB.Log.Verbose('About to add new fields');
                var fields = _this._listObj.get_fields();
                for (var _i = 0, additionalFields_1 = additionalFields; _i < additionalFields_1.length; _i++) {
                    var newField = additionalFields_1[_i];
                    var schemaXml = newField.ConstructXml();
                    TAB.Log.Verbose("Creating new field '" + newField.Name + "'");
                    fields.addFieldAsXml(schemaXml, true /*addToDefaultView*/, 16 /*SP.AddFieldOptions.prototype.addFieldToDefaultView*/);
                }
            }
            return _this._clictx;
        };
        var onSucceededCreateList = function () {
            TAB.Log.Comment("Created list named " + _this.listName + " successfully.");
        };
        var onFailedCreateList = function (sender, args) {
            _this._listObj = undefined;
            TAB.Log.Fail("Failed to create list: '" + _this.listName + "', error: " + args.get_message() + ", stack: " + args.get_stackTrace());
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(createList, onSucceededCreateList, onFailedCreateList);
        if (numberOfItems) {
            if (additionalFields && additionalFields.length > 0) {
                var fieldNames = additionalFields.map(function (field) { return field.Name; });
                this.addCsomTaskCreateListItems(numberOfItems, fieldNames, fieldValues);
            }
            else {
                this.addCsomTaskCreateListItems(numberOfItems);
            }
        }
    };
    List.prototype.addCsomTaskCreateListItems = function (numberOfItems, fieldNames, fieldValues) {
        var _this = this;
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(function () { return _this._createItemsInList(numberOfItems, fieldNames, fieldValues); }, this._onSucceededCreateItems, this._onFailedCreateItems);
    };
    List.prototype.addCsomTaskDelete = function () {
        var _this = this;
        var deleteList = function () {
            _this._listObj.deleteObject();
            return _this._clictx;
        };
        var onSucceededDeleteList = function () {
            _this._listObj = undefined;
            TAB.Log.Comment("Deleted List '" + _this.listName + "' successfully.");
        };
        var onFailedDeleteList = function (sender, args) {
            TAB.Log.Verbose("Failed to delete List '" + _this.listName + "', error: " + args.get_message());
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(deleteList, onSucceededDeleteList, onFailedDeleteList);
    };
    /**
     * Load the given list. If loadResult is NOT provided, this will log a failure if the list
     * doesn't exist or there's some other error. If loadResult IS provided (for example if you
     * want to check if a list exists or not), it will be updated to reflect whether the list
     * exists and failures won't be logged.
     */
    List.prototype.addCsomTaskLoadList = function (loadResult) {
        var _this = this;
        var getList = function () {
            if (_this._subwebUrl) {
                _this._clictx = new SP.ClientContext(_this._subwebUrl);
            }
            else {
                _this._clictx = SP.ClientContext.get_current();
            }
            var web = _this._clictx.get_web();
            _this._listObj = web.get_lists().getByTitle(_this.listName);
            _this._clictx.load(_this._listObj, 'Id', 'DefaultViewUrl', 'DefaultView');
            _this._clictx.load(_this._listObj.get_rootFolder().get_folders()); // Also load folders in root folder
            TAB.Log.Verbose('About to get list: ' + _this.listName);
            return _this._clictx;
        };
        var onSucceededGetList = function () {
            TAB.Log.Comment("Retrieved list named " + _this.listName + " successfully.");
            if (loadResult) {
                loadResult.success = true;
            }
        };
        var onFailedGetList = function (sender, args) {
            if (loadResult) {
                loadResult.success = false;
            }
            else {
                TAB.Log.Fail('Failed to get list.' + args.get_message());
            }
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(getList, onSucceededGetList, onFailedGetList);
    };
    List.prototype.addCsomTaskAddNewColumn = function (field) {
        var _this = this;
        var schemaXml = field.ConstructXml();
        var addNewField = function () {
            TAB.Log.Comment('Adding a new field ' + field.Name);
            var fields = _this._listObj.get_fields();
            fields.addFieldAsXml(schemaXml, true, 32 /* AddFieldCheckDisplayName */);
            return _this._clictx;
        };
        var onSucceededAddNewField = function () {
            TAB.Log.Comment('Successfully added field to list.');
        };
        // The addFieldAsXml call will fail if a column with the name of the given field already exists
        var onFailedAddNewField = function (sender, args) {
            TAB.Log.Comment('Did not add field to list. ' + args.get_message());
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_1__["Csom"].AddTask(addNewField, onSucceededAddNewField, onFailedAddNewField);
    };
    List.prototype._initializeClientContext = function () {
        if (!this._clictx) {
            if (this._subwebUrl) {
                this._clictx = new SP.ClientContext(this._subwebUrl);
            }
            else {
                this._clictx = SP.ClientContext.get_current();
            }
        }
    };
    List.prototype._createItemsInList = function (numItems, fieldNames, fieldValues) {
        TAB.Log.Verbose('About to create items in list');
        if (!this._listObj) {
            TAB.Log.Fail("List does not exist: Can't create items");
            return undefined;
        }
        if (fieldValues && fieldValues.length !== numItems) {
            TAB.Log.Fail("Provided field values doesn't match number of Items, can not create items");
            return undefined;
        }
        this._initializeClientContext();
        this._clictx.load(this._listObj);
        for (var i = 0; i < numItems; i++) {
            var fieldValue = fieldValues && fieldValues[i];
            this._addSingleItem(fieldNames, fieldValue);
        }
        return this._clictx;
    };
    List.prototype._addSingleItem = function (fieldNames, fieldValues) {
        var title = TAB.GetUniqueName('Test_Item');
        this.listItemsTitle.push(title);
        TAB.Log.Comment("Creating new list item with title '" + title + "'.");
        var ici = new SP.ListItemCreationInformation();
        var listItem = this._listObj.addItem(ici);
        listItem.set_item('Title', title);
        listItem.update();
        if (fieldNames && fieldValues && fieldNames.length === fieldValues.length) {
            var needUpdate = false;
            for (var i = 0; i < fieldNames.length; i++) {
                if (fieldValues[i]) {
                    listItem.set_item(fieldNames[i], fieldValues[i]);
                    needUpdate = true;
                }
            }
            if (needUpdate) {
                listItem.update();
            }
        }
    };
    List.prototype._onSucceededCreateItems = function () {
        TAB.Log.Verbose('Created items successfully.');
    };
    List.prototype._onFailedCreateItems = function (sender, args) {
        TAB.Log.Warning('Failed to create items: ' + args.get_message());
    };
    List.prototype._fixSubWebUrl = function (subWebUrl) {
        if (subWebUrl.indexOf('http') !== 0 && subWebUrl.indexOf('/') !== 0) {
            return '/' + subWebUrl;
        }
        return subWebUrl;
    };
    return List;
}());



/***/ }),

/***/ "8oVI":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/SPCoachmarkUtil.js ***!
  \******************************************/
/*! exports provided: SPCoachmarkUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SPCoachmarkUtil", function() { return SPCoachmarkUtil; });
/**
 * @public
 */
var SPCoachmarkUtil = /** @class */ (function () {
    function SPCoachmarkUtil() {
    }
    /**
     * Disable all coach marks that might make tests flaky.
     */
    SPCoachmarkUtil.disable = function () {
        return TAB.Win.window[SPCoachmarkUtil._spModuleLoader]._bundledComponents[SPCoachmarkUtil._spCoreLibraryComponentId].CoachmarkUtility._internalAutomationDisable();
    };
    SPCoachmarkUtil._spModuleLoader = 'spModuleLoader';
    SPCoachmarkUtil._spCoreLibraryComponentId = '6da60671-741f-47c5-b35b-5078edaf312f';
    return SPCoachmarkUtil;
}());



/***/ }),

/***/ "8uLm":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/Controls/FilePicker.js ***!
  \**********************************************/
/*! exports provided: FILE_PICKER_AUTOMATION_ID, FilePickerView, FilePicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FILE_PICKER_AUTOMATION_ID", function() { return FILE_PICKER_AUTOMATION_ID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FilePickerView", function() { return FilePickerView; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FilePicker", function() { return FilePicker; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Upload__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Upload */ "dAVj");



/**
 * @public
 */
var FILE_PICKER_AUTOMATION_ID = 'sp-filepicker';
/**
 * @public
 */
var FilePickerView;
(function (FilePickerView) {
    FilePickerView["Recent"] = "Recent";
    FilePickerView["OneDrive"] = "OneDrive";
    FilePickerView["Search"] = "WebSearch";
    FilePickerView["Site"] = "Site";
    FilePickerView["Local"] = "Upload";
    FilePickerView["Link"] = "FromALink";
})(FilePickerView || (FilePickerView = {}));
/**
 * @public
 */
var FilePicker = /** @class */ (function () {
    function FilePicker(root) {
        if (root) {
            this._root = root;
        }
    }
    FilePicker.prototype.SetRoot = function (root) {
        this._root = root;
    };
    FilePicker.prototype.AddTaskSelectView = function (selectedView) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var pickerViewTab = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this._root, "filePicker" + selectedView + "Tab");
            var pickerViewButton = TAB.GetElement(pickerViewTab, TAB.searchBy.tag, 'button');
            TAB.ClickElement(pickerViewButton);
        }), this.WaitForViewLoad(selectedView));
        if (selectedView === FilePickerView.Search) {
            TAB.Log.AddTaskComment('Choose the first image category.');
            TAB.AddTask(TAB.MakeTask(function () {
                // Input keyword in search box
                var imageCategory = TAB.GetElements(_this._selectedTab, TAB.searchBy.customQuery, "[data-automation-id=\"folderCard\"]")[0];
                TAB.ClickElement(imageCategory);
            }), TAB.MakeWaiter(function () {
                try {
                    return !!_this._itemList;
                }
                catch (error) {
                    return false;
                }
            }));
        }
    };
    FilePicker.prototype.AddTaskSelectItem = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Select item');
            _this._selectedItem = _this._getItemsFromCurrentView(index);
            var el = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this._selectedItem, 'CheckCircle');
            TAB.ClickElement(el);
        }), this._waitForTileSelection(true));
    };
    FilePicker.prototype.AddTaskOpenFile = function (index) {
        var _this = this;
        this.AddTaskSelectItem(index);
        TAB.AddTask(
        /** @todo 284205 Add data-automation-id for related controls */
        TAB.MakeTask(function () {
            TAB.Log.Comment('Open File in Filepicker');
            TAB.ClickElement(_this._openButton);
        }), _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'sp-filepicker', 0));
    };
    FilePicker.prototype.AddTaskCancel = function () {
        var _this = this;
        // click cancel button
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(_this._cancelButton);
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].FilePicker = undefined;
        }), _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'sp-filepicker', 0));
    };
    FilePicker.prototype.AddTaskAddFromUrl = function (url) {
        var _this = this;
        this.AddTaskSelectView(FilePickerView.Link);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Edit Link textarea in FilePicker');
            var linkTextField = TAB.GetElement(_this._root, TAB.searchBy.tag, 'textarea');
            linkTextField.value = url;
            var ev = TAB.Win.document.createEvent('HTMLEvents');
            ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
            linkTextField.dispatchEvent(ev);
        }), TAB.MakeWaiter(function () {
            return !_this._openButton.disabled;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click Open Button');
            TAB.ClickElement(_this._openButton);
        }), TAB.MakeWaiter(function () {
            try {
                var filePicker = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(TAB.Win, 'sp-filepicker');
                if (filePicker.length === 0) {
                    _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].FilePicker = undefined;
                    return true;
                }
                else {
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        }));
    };
    FilePicker.prototype.AddTaskUploadItem = function (fileInput) {
        var _this = this;
        var inputElement;
        // Find INPUT element
        TAB.AddTask(TAB.MakeTask(function () {
            var fileInputElements = TAB.GetElements(_this._root, TAB.searchBy.customQuery, '[data-automation-id="localTabInput"]');
            if (fileInputElements !== undefined && fileInputElements.length > 0) {
                inputElement = fileInputElements[0];
                TAB.Log.Comment('Found INPUT element for Upload command');
            }
        }));
        // Upload items and verify they got added
        TAB.AddTask(TAB.MakeTask(function () {
            if (!inputElement) {
                throw 'Failed to find INPUT element for Upload command';
            }
            try {
                if (fileInput instanceof File) {
                    Object(_Upload__WEBPACK_IMPORTED_MODULE_2__["setFileInput"])(inputElement, [fileInput]);
                }
                else {
                    var fileInputs = [fileInput];
                    Object(_Upload__WEBPACK_IMPORTED_MODULE_2__["upload"])(inputElement, fileInputs);
                }
            }
            catch (e) {
                TAB.Log.Fail('Error when trying to upload items - ' + e.message);
            }
        }), undefined);
        this.AddTaskSelectView(FilePickerView.Local);
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return !_this._openButton.disabled;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click Open Button');
            TAB.ClickElement(_this._openButton);
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].FilePicker = undefined;
        }), _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'sp-filepicker', 0));
    };
    FilePicker.prototype.WaitForViewLoad = function (selectedView) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                if (selectedView === FilePickerView.Recent || selectedView === FilePickerView.Site) {
                    return !!_this._itemList;
                }
                else if (selectedView === FilePickerView.Link) {
                    return TAB.ElementExists(_this._root, TAB.searchBy.tag, 'textarea');
                }
                else {
                    // @todo 'Site' tab does not have a tabHeader.
                    return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this._selectedTab, "filePicker" + selectedView + "Container");
                }
            }
            catch (e) {
                return false;
            }
        });
    };
    Object.defineProperty(FilePicker.prototype, "_itemList", {
        get: function () {
            return (_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._selectedTab, 'DetailsList') ||
                _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._selectedTab, 'GridList') ||
                TAB.GetElements(this._selectedTab, TAB.searchBy.className, 'Placeholder-container')[0]);
        },
        enumerable: true,
        configurable: true
    });
    FilePicker.prototype._getItemsFromCurrentView = function (index) {
        var list = this._itemList;
        var tiles;
        if (_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(list, 'ItemTile').length > 0) {
            tiles = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(list, 'ItemTile');
        }
        else if (_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(list, 'ListCell').length > 0) {
            tiles = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(list, 'ListCell');
        }
        else {
            TAB.Log.DidNotRun('Selected item does not exist');
        }
        if (tiles.length > index) {
            return tiles[index];
        }
        else {
            TAB.Log.DidNotRun('Selected item does not exist');
        }
    };
    FilePicker.prototype._waitForTileSelection = function (selection) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var isBingTileSelected = !!_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this._selectedItem, 'bingTileSelected');
            var isSelected = TAB.HasCssClass(_this._selectedItem, 'is-selected') || isBingTileSelected;
            return (selection && isSelected) || (!selection && !isSelected);
        });
    };
    Object.defineProperty(FilePicker.prototype, "_openButton", {
        get: function () {
            // Each tab has a group of open/cancel button, using SelectedTab as searchObj to select the correct one.
            // @todo change this to automation id
            return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._selectedTab, 'OKButton');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilePicker.prototype, "_cancelButton", {
        get: function () {
            // Each tab has a group of open/cancel button, using SelectedTab as searchObj to select the correct one.
            // @todo change this to automation id
            return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._selectedTab, 'cancelButton');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilePicker.prototype, "_selectedTab", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._root, 'selectedTab');
        },
        enumerable: true,
        configurable: true
    });
    return FilePicker;
}());



/***/ }),

/***/ "8vep":
/*!***********************************************************!*\
  !*** ./lib/SPTaskLib/MemoryTest/CanvasContentTemplate.js ***!
  \***********************************************************/
/*! exports provided: ResourcePath, CanvasContentTemplate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourcePath", function() { return ResourcePath; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CanvasContentTemplate", function() { return CanvasContentTemplate; });
var ResourcePath;
(function (ResourcePath) {
    ResourcePath["Image_16x16"] = "/MemoryTestLib/16x16.png";
    ResourcePath["Image_550x335"] = "/MemoryTestLib/550x335.jpg";
    ResourcePath["Image_1280x800"] = "/MemoryTestLib/1280x800.jpg";
    ResourcePath["Image_1920x1200"] = "/MemoryTestLib/1920x1200.jpg";
})(ResourcePath || (ResourcePath = {}));
var LINK_DATA_AUTOMATION_ID = 'memoryTestLink';
var CanvasContentTemplate = /** @class */ (function () {
    function CanvasContentTemplate() {
    }
    CanvasContentTemplate.GetLinkCanvasContent = function (linkToPageTitle) {
        return [
            this._generateSingleLinkContent(1, linkToPageTitle),
            {
                controlType: 0,
                pageSettingsSlice: {
                    isDefaultDescription: true,
                    isDefaultThumbnail: true
                }
            }
        ];
    };
    CanvasContentTemplate.GetImagesCanvasContent = function (linkToPageTitle) {
        return [
            this._generateSingleImageContent(1, ResourcePath.Image_16x16, 'b66e5850-7e04-42f2-9cf5-18ad3541a373'),
            this._generateSingleImageContent(2, ResourcePath.Image_550x335, '88cbfbea-71a2-4fc7-afc2-84b52f6bbffd'),
            this._generateSingleImageContent(3, ResourcePath.Image_1280x800, 'a839f19b-d317-4c09-876d-d20b6fcc9176'),
            this._generateSingleImageContent(4, ResourcePath.Image_1920x1200, '0bb66dda-cac3-4814-b10c-9d44e5f2d6e1'),
            this._generateSingleLinkContent(5, linkToPageTitle),
            {
                controlType: 0,
                pageSettingsSlice: {
                    isDefaultDescription: true,
                    isDefaultThumbnail: true
                }
            }
        ];
    };
    CanvasContentTemplate.getLinkElement = function () {
        return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + LINK_DATA_AUTOMATION_ID + "\"]");
    };
    CanvasContentTemplate.isCanvasWithLinkLoaded = function () {
        var webparts = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + LINK_DATA_AUTOMATION_ID + "\"]");
        return webparts.length > 0;
    };
    CanvasContentTemplate.isCanvasWithImagesLoaded = function () {
        var webparts = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'imageFrame');
        return webparts.length === 4;
    };
    CanvasContentTemplate._generateSingleLinkContent = function (index, linkToPageTitle) {
        return {
            controlType: 4,
            id: 'd2ff80b5-471c-4477-8c3c-fd415dd6b695',
            position: {
                zoneIndex: 1,
                sectionIndex: 1,
                controlIndex: index,
                layoutIndex: 1
            },
            emphasis: {},
            addedFromPersistedData: true,
            innerHTML: "<p><a data-interception=\"on\" data-automation-id=\"" + LINK_DATA_AUTOMATION_ID + "\" href=\"/SitePages/" + linkToPageTitle + ".aspx\">" + linkToPageTitle + "</a></p>\n"
        };
    };
    CanvasContentTemplate._generateSingleImageContent = function (index, imgSrc, instanceId) {
        return {
            controlType: 3,
            id: instanceId,
            position: {
                zoneIndex: 1,
                sectionIndex: 1,
                controlIndex: index,
                layoutIndex: 1
            },
            webPartId: 'd1d91016-032f-456d-98a4-721247c305e8',
            webPartData: {
                id: 'd1d91016-032f-456d-98a4-721247c305e8',
                instanceId: instanceId,
                title: 'Image',
                description: 'Show an image on your page',
                serverProcessedContent: {
                    htmlStrings: {},
                    searchablePlainTexts: {
                        captionText: ''
                    },
                    imageSources: {
                        imageSource: imgSrc
                    },
                    links: {
                        linkUrl: ''
                    },
                    customMetadata: {
                        imageSource: {}
                    }
                },
                dataVersion: 1.8,
                properties: {}
            },
            emphasis: {},
            reservedHeight: 671,
            reservedWidth: 1180
        };
    };
    return CanvasContentTemplate;
}());



/***/ }),

/***/ "9JB+":
/*!***************************************************!*\
  !*** ./lib/SPTaskLib/Pages/PageTemplatesPanel.js ***!
  \***************************************************/
/*! exports provided: PageTemplatePickerOpenType, PageTemplatesPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageTemplatePickerOpenType", function() { return PageTemplatePickerOpenType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageTemplatesPanel", function() { return PageTemplatesPanel; });
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../PageUtil */ "jK1H");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ListLibrary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ListLibrary */ "7on5");





/**
 * @public
 */
var PageTemplatePickerOpenType;
(function (PageTemplatePickerOpenType) {
    PageTemplatePickerOpenType["pageFromHome"] = "NewPageInHome";
    PageTemplatePickerOpenType["pageFromPage"] = "ChooseFromTemplate";
    PageTemplatePickerOpenType["newsFromHome"] = "NewNewsPostInHome";
    PageTemplatePickerOpenType["newsFromPage"] = "CreateNewsPost";
})(PageTemplatePickerOpenType || (PageTemplatePickerOpenType = {}));
/**
 * @public
 */
var PageTemplatesPanel = /** @class */ (function () {
    function PageTemplatesPanel() {
    }
    Object.defineProperty(PageTemplatesPanel, "SiteName", {
        get: function () {
            return 'PageTemplatesPanelSite';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageTemplatesPanel, "LastTemplateDataAutomationID", {
        set: function (value) {
            PageTemplatesPanel._lastTemplateDataAutomationId = value;
        },
        enumerable: true,
        configurable: true
    });
    PageTemplatesPanel.AddTaskGoToSiteHomePage = function () {
        var siteUrl = TAB.Settings.Get('ProductServer') + ("/teams/" + PageTemplatesPanel.SiteName);
        TAB.AddTask(TAB.LoadPage(siteUrl), TAB.PageReady());
    };
    PageTemplatesPanel.AddTaskAddTemplateToSite = function (siteName, rteWebPart, pageNameAndDesc, urlArray, templateName) {
        TAB.Log.AddTaskComment('Attempting to create a page and save it as a template...');
        _PageUtil__WEBPACK_IMPORTED_MODULE_2__["PageUtil"].AddTaskCreatePageOnSite(siteName, 'teams');
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskEditPage();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskAddPageTitle(pageNameAndDesc);
        _Pages_Canvas__WEBPACK_IMPORTED_MODULE_1__["Canvas"].AddTaskCreateWebPart(rteWebPart);
        _Pages_Canvas__WEBPACK_IMPORTED_MODULE_1__["Canvas"].AddTaskWaitForAnyCanvasControl();
        // called here instead of in Canvas.AddTaskCreateWebPart so that it can be run in deterministic order
        _Pages_Canvas__WEBPACK_IMPORTED_MODULE_1__["Canvas"].AddTaskBindWebPart(rteWebPart, false);
        rteWebPart.AddTaskToAddTextInRTE(pageNameAndDesc + 'Body');
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskPublishPage();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskOpenPostPublishPanel();
        PageTemplatesPanel.AddTaskCollectPageUrl(urlArray);
        PageTemplatesPanel.AddTaskSavePageAsTemplateFromPostPublish();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskAddPageTitle(templateName);
        PageTemplatesPanel.AddTaskSaveTemplate();
        PageTemplatesPanel.AddTaskCollectPageUrl(urlArray);
    };
    PageTemplatesPanel.AddTaskSavePageAsTemplateFromPostPublish = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Attempting to save published page as template');
            var savePageAsTemplateLink = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(PageTemplatesPanel.GetPromotePanel(), 'savePageAsTemplate');
            TAB.ClickElement(savePageAsTemplateLink);
            TAB.Log.Comment('Waiting for template save button');
        }), PageTemplatesPanel.WaitForTemplateSaveButton());
    };
    PageTemplatesPanel.AddTaskSaveTemplate = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Attempting to save created template');
            var saveTemplateButton = PageTemplatesPanel.GetTemplateSaveButton();
            TAB.ClickElement(saveTemplateButton);
            TAB.Log.Comment('Waiting for template edit button');
        }), PageTemplatesPanel.WaitForTemplateEditButton());
    };
    PageTemplatesPanel.AddTaskOpenPageTemplatesPanel = function (pageTemplatePickerType) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for Command Bar');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-CommandBar'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for CommandBar +New');
        }), TAB.MakeWaiter(function () {
            return Boolean(PageTemplatesPanel.GetCommandBarNewButton());
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Attempting to click +New');
            var newButton = PageTemplatesPanel.GetCommandBarNewButton();
            TAB.ClickElement(newButton);
            var calloutField = (TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-ContextualMenu-list'));
            var startFromBlankPageButton = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(calloutField, pageTemplatePickerType);
            TAB.ClickElement(startFromBlankPageButton);
            TAB.Log.Comment('Waiting for submenu');
        }), TAB.MakeWaiter(function () {
            return PageTemplatesPanel.WaitForPageTemplatesPanel();
        }));
    };
    PageTemplatesPanel.AddTaskSelectTemplate = function (selectedPageTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting newly created template');
            var tilesList = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(TAB.Win, 'template-picker-tiles-list')[0];
            var items = TAB.GetElements(tilesList, TAB.searchBy.hasClassName, 'ms-TilesList-grid');
            var item = items[items.length - 1];
            var clickableElement = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(item, "template-picker-item_" + selectedPageTitle);
            TAB.ClickElement(clickableElement);
            TAB.Log.Comment('Waiting for Create Page from template button');
        }), TAB.MakeWaiter(function () {
            var createButton = PageTemplatesPanel.GetCreatePageButton();
            if (createButton) {
                /* tslint:disable:no-null-keyword */
                return createButton.getAttribute('disabled') === null;
                /* tslint:enable:no-null-keyword */
            }
            return false;
        }));
    };
    PageTemplatesPanel.AddTaskCreatePageFromSelectedTemplate = function (pageTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Creating page from Selected Template');
            TAB.ClickElement(PageTemplatesPanel.GetCreatePageButton());
            TAB.Log.Comment('Waiting for new page from selected template');
        }), PageTemplatesPanel.WaitForNewPage());
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskAddPageTitle(pageTitle);
    };
    PageTemplatesPanel.AddTaskPublishPageAndCollectUrl = function (urlArray) {
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].AddTaskPublishPage();
        PageTemplatesPanel.AddTaskCollectPageUrl(urlArray);
    };
    PageTemplatesPanel.AddTaskCleanupTemplates = function (pageUrls) {
        var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        pageUrls.forEach(function (url) {
            var pageUrl = url;
            pageUrl = pageUrl.substr(rootSiteUrl.length);
            _ListLibrary__WEBPACK_IMPORTED_MODULE_4__["List"].addRestTaskDeleteItem2(rootSiteUrl, pageUrl);
        });
    };
    PageTemplatesPanel.AddTaskCancelTemplatePanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Cancelling template picker');
            TAB.ClickElement(PageTemplatesPanel.GetCancelButton());
            TAB.Log.Comment('Waiting for dialog to dismiss');
        }), TAB.MakeWaiter(function () {
            return PageTemplatesPanel.WaitForPageTemplatesPanelToDismiss();
        }));
    };
    PageTemplatesPanel.AddTaskCollectPageUrl = function (array) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Collecting page url for deletion');
            array.push(TAB.Win.location.href);
        }));
    };
    PageTemplatesPanel.GetPromotePanel = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-Panel-main')[0];
    };
    PageTemplatesPanel.GetTemplateSaveButton = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(PageTemplatesPanel.GetCommandBar(), 'pageCommandBarSaveTemplateButton');
    };
    PageTemplatesPanel.GetCommandBarNewButton = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(PageTemplatesPanel.GetCommandBar(), 'pageCommandBarNewButton');
    };
    PageTemplatesPanel.GetCreatePageButton = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(TAB.Win, 'template-panel-create-button')[0];
    };
    PageTemplatesPanel.GetCommandBar = function () {
        // using check mark to decide if the page has been saved
        try {
            var commandBar = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'commandBarWrapper');
            return commandBar;
        }
        catch (e) {
            return undefined;
        }
    };
    PageTemplatesPanel.GetCancelButton = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(TAB.Win, 'template-panel-cancel-button')[0];
    };
    PageTemplatesPanel.WaitForTemplateSaveButton = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarSaveTemplateButton']");
    };
    PageTemplatesPanel.WaitForTemplateEditButton = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarEditButton']");
    };
    PageTemplatesPanel.WaitForPageTemplatesPanel = function () {
        TAB.Log.AddTaskComment('Waiting for page template panel');
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='template-picker-item_" + PageTemplatesPanel._lastTemplateDataAutomationId + "']");
    };
    PageTemplatesPanel.WaitForPageTemplatesPanelToDismiss = function () {
        TAB.Log.AddTaskComment('Waiting for page template panel to dismiss');
        return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='template-picker-item_" + PageTemplatesPanel._lastTemplateDataAutomationId + "']");
    };
    PageTemplatesPanel.WaitForNewPage = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarPublishButton']");
    };
    PageTemplatesPanel._lastTemplateDataAutomationId = undefined;
    return PageTemplatesPanel;
}());



/***/ }),

/***/ "9yWr":
/*!*******************************************!*\
  !*** ./lib/SPTaskLib/Pages/Navigation.js ***!
  \*******************************************/
/*! exports provided: Navigation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Navigation", function() { return Navigation; });
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../PageUtil */ "jK1H");
/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");



/**
 * @internal
 */
var Navigation = /** @class */ (function () {
    function Navigation() {
    }
    /**
     * Clicks the specified navigation link in the currently showing Cascading menu
     * @param linkText - The display label of the link to click
     * @param linkHref - The link that the menu item is pointing to. Needed because some menu items use javascript
     *   to perform the navigation rather than having an href attribute where we can read the href.
     */
    Navigation.AddTaskClickCascadingMenuItem = function (linkText, linkHref) {
        var menuItems;
        TAB.Log.AddTaskComment('Getting all links in the CascadingMenu and clicking on the specified item');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            menuItems = Array.from(TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-itemText'));
            var matchingMenuItems = menuItems.filter(function (item) { return item.innerText === linkText; });
            // Clicking must unfortunately be done in the waiter to work around a TAB framework quirk with mouse events
            if (matchingMenuItems.length > 0) {
                TAB.Log.AddTaskComment('Found the matching menu item. Clicking on it...');
                var button = matchingMenuItems[0].parentElement.parentElement;
                TAB.ClickElement(button);
                return true;
            }
            return false;
        }));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.Win.location.href.indexOf(linkHref) >= 0;
        }));
    };
    /**
     * Clicks the specified navigation link in the currently showing Mega menu
     * @param linkText - The display label of the link to click
     * @param linkHref - The link that the menu item is pointing to. Needed because some menu items use javascript
     *   to perform the navigation rather than having an href attribute where we can read the href.
     */
    Navigation.AddTaskClickMegaMenuItem = function (linkText, linkHref) {
        var menuContainer;
        var menuLinks;
        TAB.Log.AddTaskComment('Ensuring that MegaMenu callout is rendered.');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var containers = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Callout-main');
            if (containers.length > 0) {
                menuContainer = containers[0];
            }
            return menuContainer !== undefined;
        }));
        TAB.Log.AddTaskComment('Getting all links in the MegaMenu and clicking on the specified link');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            menuLinks = Array.from(TAB.GetElements(menuContainer, TAB.searchBy.tag, 'a'));
            var filteredLinks = menuLinks.filter(function (item) { return item.innerText === linkText; });
            // Clicking must unfortunately be done in the waiter to work around a TAB framework quirk with mouse events
            if (filteredLinks.length > 0) {
                TAB.Log.AddTaskComment('Found the matching link. Clicking on it...');
                TAB.ClickElement(filteredLinks[0]);
                return true;
            }
            return false;
        }));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.Win.location.href.indexOf(linkHref) >= 0;
        }));
    };
    /**
     * Assuming a Cascading menu is open, expands the submenu for an item with children
     * @param linkText - The display label of the link to click
     */
    Navigation.AddTaskExpandSubMenu = function (linkText) {
        var menuItems;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            menuItems = Array.from(TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-itemText'));
            return menuItems.length > 0;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var matchingMenuItems = menuItems.filter(function (item) { return item.innerText === linkText; });
            var buttonContainer = matchingMenuItems[0].parentElement.parentElement.parentElement;
            var splitButton = TAB.GetElement(buttonContainer, TAB.searchBy.hasClassName, 'ms-ContextualMenu-splitMenu');
            TAB.ClickElement(splitButton);
        }));
    };
    /**
     * Ensures that a Comm site exists with the specified name. Also ensures that a series of hardcoded test
     * navigation links exist in the site header for that site.
     * @param siteName - the name of the comm site to create
     * @param result - The output of site creation
     * @param serverUrl - The URL of the root site. This becomes the href for all test nav links.
     * @param homePageUrl - URL of the test site's home page. This is used to test behavior during in-place nav.
     */
    Navigation.EnsureCommSiteWithTestNavNodes = function (siteName, result, serverUrl, homePageUrl) {
        _TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].EnsureCommSiteExists(siteName, result);
        _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].AddTaskWaitForHeaderRender();
        // check if site now exists and whether our test nav links exist by checking if the L1 link exists in HorizontalNav
        var taskOptions = {
            shouldPerformAction: false
        };
        TAB.AddTask(TAB.MakeTask(function () {
            var navLinks = Array.from(Navigation.GetHeaderNavNodes());
            taskOptions.shouldPerformAction =
                TAB.Win.location.href.indexOf(siteName) >= 0 &&
                    !navLinks.some(function (link) { return link.innerText === Navigation.link1Label; });
            if (taskOptions.shouldPerformAction) {
                TAB.Log.AddTaskComment('Test navigation nodes not found. Adding them through EditNav pane...');
            }
        }));
        // If no test link, open EditNav pane
        Navigation.AddTaskOpenEditNavInHorizonalNav(taskOptions);
        // Open EditNav callout to add L1 link
        Navigation.AddTaskGetLastAddButton(taskOptions);
        Navigation.AddTaskAddNavNodeInEditPanel(Navigation.link1Label, serverUrl, taskOptions);
        // Add an L2 link that will be used to test behavior around in-place nav
        Navigation.AddTaskGetLastAddButton(taskOptions);
        Navigation.AddTaskAddNavNodeInEditPanel(Navigation.homeLinkLabel, homePageUrl, taskOptions);
        Navigation.AddTaskMakeSublink(Navigation.homeLinkLabel, taskOptions);
        // Add another L2 link and make it a sublink of 'link1Label' to test regular navigation
        Navigation.AddTaskGetLastAddButton(taskOptions);
        Navigation.AddTaskAddNavNodeInEditPanel(Navigation.link2Label, serverUrl, taskOptions);
        // Add another L2 link that will have children.
        Navigation.AddTaskGetLastAddButton(taskOptions);
        Navigation.AddTaskAddNavNodeInEditPanel(Navigation.link3Label, serverUrl, taskOptions);
        // Add our first L3 link and make it a sublink of 'link3Label'
        Navigation.AddTaskGetLastAddButton(taskOptions);
        Navigation.AddTaskAddNavNodeInEditPanel(Navigation.link4Label, serverUrl, taskOptions);
        Navigation.AddTaskMakeSublink(Navigation.link4Label, taskOptions);
        // Clicking on the save button to save our changes.
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                var saveButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='EditNav-SaveButton']");
                TAB.ClickElement(saveButton);
            }
        }), TAB.MakeWaiter(function () {
            if (!Navigation.shouldPerformTask(taskOptions)) {
                return true;
            }
            var headerNavNodes = Array.from(Navigation.GetHeaderNavNodes());
            return headerNavNodes.some(function (navlink) { return navlink.innerText === Navigation.link1Label; });
        }));
    };
    /**
     * Makes the link with the specified display label a sublink.
     * @param linkLabel - the label of the link that you are making a sublink
     * @param taskOptions - whether or not to run the operation. needed if this is not known until runtime.
     */
    Navigation.AddTaskMakeSublink = function (linkLabel, taskOptions) {
        var sublinkContextualMenuIndex = 3;
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                var linkList = Array.from(TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-EditNav-linkText'));
                var filteredLinkList = linkList.filter(function (link) { return link.innerText === linkLabel; });
                if (filteredLinkList.length) {
                    if (linkList[linkList.length - 1].innerText === linkLabel) {
                        // if the specified label is for the link at the end of the list, then the 'Make sub link"
                        // context menu option is in a different position
                        sublinkContextualMenuIndex = 2;
                    }
                    var linkContainerEl = filteredLinkList[0].parentElement.parentElement;
                    var contextMenuButton = TAB.GetElement(linkContainerEl, TAB.searchBy.tag, 'i');
                    TAB.ClickElement(contextMenuButton);
                }
            }
        }), TAB.MakeWaiter(function () {
            if (!Navigation.shouldPerformTask(taskOptions)) {
                return true;
            }
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-link');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                var contextualMenuButtons = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-link');
                TAB.ClickElement(contextualMenuButtons[sublinkContextualMenuIndex]);
            }
        }));
    };
    /**
     * Gets the last 'add' button in the EditNav pane and points to it from Navigation.addButtonRef
     * @param taskOptions - whether or not to run the operation. needed if this is not known until runtime.
     */
    Navigation.AddTaskGetLastAddButton = function (taskOptions) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                var addButtons = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='EditNav-insertLine']");
                Navigation.addButtonRef = addButtons[addButtons.length - 1];
            }
        }));
    };
    /**
     * Opens the EditNav pane for the Horizontal Nav links in site header
     * @param taskOptions - whether or not to run the operation. needed if this is not known until runtime.
     */
    Navigation.AddTaskOpenEditNavInHorizonalNav = function (taskOptions) {
        var editButtonId = "[data-automationid='HorizontalNav-edit']";
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return (!Navigation.shouldPerformTask(taskOptions) ||
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, editButtonId));
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                TAB.Log.Comment('Clicking edit link in the horizontal nav');
                var editLinkDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, editButtonId);
                var editLinkButton = TAB.GetElement(editLinkDiv, TAB.searchBy.tag, 'button');
                TAB.ClickElement(editLinkButton);
            }
        }), TAB.MakeWaiter(function () {
            return (!Navigation.shouldPerformTask(taskOptions) ||
                TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'ms-EditNav'));
        }));
    };
    Navigation.GetHeaderNavNodes = function () {
        try {
            var horizontalNavEl = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-HorizontalNavItems');
            return TAB.GetElements(horizontalNavEl, TAB.searchBy.hasClassName, 'ms-HorizontalNavItem-link');
        }
        catch (error) {
            return [];
        }
    };
    /**
     * Assuming that the EditNav pane is open, adds a nav link with the specified link.
     * Specify position by passing the HTMLElement for the correct add button in the EditNav pane.
     * @param label - The link display label
     * @param href - The link href
     * @param taskOptions - whether or not to run the operation. needed if this is not known until runtime.
     */
    Navigation.AddTaskAddNavNodeInEditPanel = function (label, href, taskOptions) {
        var editNavForm;
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                TAB.Log.AddTaskComment('Clicking on an "add" button to add nav node.');
                TAB.ClickElement(Navigation.addButtonRef);
            }
        }), TAB.MakeWaiter(function () {
            if (!Navigation.shouldPerformTask(taskOptions)) {
                return true;
            }
            var elementList = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='EditNavCallout-inner']");
            editNavForm = elementList && elementList.length ? elementList[0] : undefined;
            return editNavForm !== undefined;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (Navigation.shouldPerformTask(taskOptions)) {
                var urlTextArea = TAB.GetElement(editNavForm, [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['textarea', 'ms-TextField-field']);
                var labelTextInput = TAB.GetElement(editNavForm, [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['input', 'ms-TextField-field']);
                urlTextArea.value = href;
                labelTextInput.value = label;
                _ReactUtil__WEBPACK_IMPORTED_MODULE_2__["ReactUtil"].TriggerOnChange(urlTextArea, href);
                _ReactUtil__WEBPACK_IMPORTED_MODULE_2__["ReactUtil"].TriggerOnChange(labelTextInput, label);
                var saveButton = TAB.GetElement(editNavForm, TAB.searchBy.hasClassName, 'ms-EditNav-SaveButton');
                TAB.ClickElement(saveButton);
            }
        }), TAB.MakeWaiter(function () {
            if (!Navigation.shouldPerformTask(taskOptions)) {
                return true;
            }
            var editLinks = Array.from(TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-EditNav-linkText'));
            return editLinks.some(function (link) { return link.innerText === label; });
        }));
    };
    Navigation.shouldPerformTask = function (taskOptions) {
        return taskOptions === undefined ? true : taskOptions.shouldPerformAction;
    };
    Navigation.link1Label = 'Header link';
    Navigation.link2Label = 'L2 sublink';
    Navigation.link3Label = 'L2 sublink with children';
    Navigation.link4Label = 'L3 sublink';
    Navigation.homeLinkLabel = 'Home page';
    return Navigation;
}());



/***/ }),

/***/ "ARZc":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Pages/AudienceTargeting.js ***!
  \**************************************************/
/*! exports provided: AudienceTargeting */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AudienceTargeting", function() { return AudienceTargeting; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

/**
 * @public
 */
var AudienceTargeting = /** @class */ (function () {
    function AudienceTargeting() {
    }
    AudienceTargeting.AddTaskClickEditLinkOnFooter = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking edit link in the footer');
            var editLinkDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='SimpleFooter-edit']");
            var editLinkButton = TAB.GetElement(editLinkDiv, TAB.searchBy.tag, 'button');
            TAB.ClickElement(editLinkButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.className, 'ms-EditNav'));
    };
    AudienceTargeting.AddTaskOpenEditNavInHorizontalNav = function () {
        var editButtonId = "[data-automationid='HorizontalNav-edit']";
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, editButtonId));
        TAB.AddTask(
        // Click edit link
        TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking edit link in the horizontal nav');
            var editLinkDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, editButtonId);
            var editLinkButton = TAB.GetElement(editLinkDiv, TAB.searchBy.tag, 'button');
            TAB.ClickElement(editLinkButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.className, 'ms-EditNav'));
    };
    AudienceTargeting.AddTaskDisplayContextualMenu = function () {
        TAB.AddTask(
        // Click ... next to first item
        TAB.MakeTask(function () {
            TAB.Log.Comment('Verify Contextual Menu');
            var editNavButtons = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav-linkButton');
            TAB.ClickElement(editNavButtons[0]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav_contextMenu');
        }));
    };
    AudienceTargeting.AddTaskClickEditInContextualMenu = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking edit menu for the item');
            var contextualMenuButtons = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-ContextualMenu-link');
            TAB.ClickElement(contextualMenuButtons[0]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNavCallout');
        }));
    };
    AudienceTargeting.AddTaskClickCancelInCallOut = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking cancel in nav callout');
            var callOutButtonArea = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNavCallout-buttonArea');
            var cancelButton = TAB.GetElement(callOutButtonArea, TAB.searchBy.partialClassName, 'ms-EditNav-CancelButton');
            TAB.ClickElement(cancelButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNavCallout');
        }));
    };
    AudienceTargeting.AddTaskSwitchToggle = function (status) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Switch the audience targeting toggle to " + (status ? 'true' : 'false'));
            var audienceTargetingDiv = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav-AudienceTargetInner');
            var toggle = TAB.GetElement(audienceTargetingDiv, TAB.searchBy.tag, 'button');
            if (status !== (toggle.attributes['aria-checked'].value.localeCompare('true') === 0)) {
                TAB.ClickElement(toggle);
            }
            else {
                // click twice to enable save button
                TAB.ClickElement(toggle);
                TAB.ClickElement(toggle);
            }
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment("Confirm the toggle is switched to " + (status ? 'true' : 'false'));
            var audienceTargetingDiv = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav-AudienceTargetInner');
            var toggle = TAB.GetElement(audienceTargetingDiv, TAB.searchBy.tag, 'button');
            return status === (toggle.attributes['aria-checked'].value.localeCompare('true') === 0);
        }));
    };
    AudienceTargeting.AddTaskSaveEditNav = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking save button on edit nav panel');
            var saveButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='EditNav-SaveButton']");
            TAB.ClickElement(saveButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'ms-EditNav');
        }));
    };
    AudienceTargeting.AddTaskGetCurrentUserMembership = function (callback) {
        var siteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        var apiUrl = siteUrl + "/_api/SP.Publishing.SitePageService.GetCurrentUserMemberships";
        var results = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendGetRequest(siteUrl, apiUrl, results);
        TAB.AddTask(TAB.MakeTask(function () {
            if (results.success) {
                var memberships = results.retVal.value;
                TAB.Log.Comment("Successfully get " + memberships.length + " groups for the current user");
                callback(memberships);
            }
            else {
                TAB.Log.Fail('Fail to get the memberships for the current user');
            }
        }));
    };
    return AudienceTargeting;
}());



/***/ }),

/***/ "ASfe":
/*!*********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/TeamsTabUrlConfigTest.js ***!
  \*********************************************************/
/*! exports provided: TeamsTabUrlConfigTest */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TeamsTabUrlConfigTest", function() { return TeamsTabUrlConfigTest; });
/**
 * Provides tasks to use when testing the Teams TabUrl Configuration page.
 * The Teams TabUrl Configuration page shows the Paste Url link. Clicking on this link loads TabUrl component.
 * You can view this page by appending /_layouts/15/teamstabconfiguration.aspx to the site URL.
 *
 * @public
 */
var TeamsTabUrlConfigTest = /** @class */ (function () {
    function TeamsTabUrlConfigTest() {
    }
    /** Navigate to the Teams TabUrl Configuration page */
    TeamsTabUrlConfigTest.AddTaskGoToTeamsTabUrlConfigPage = function (serverUrl, groupAlias) {
        var pageUrl = serverUrl + "/sites/" + groupAlias + "/_layouts/15/teamstabconfiguration.aspx";
        TAB.Log.AddTaskComment('Navigating to Teams TabUrl Configuration page for site ' + pageUrl);
        TAB.AddTask(TAB.LoadPage(pageUrl), TAB.AndWaiters(TAB.PageReady(), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PagesAndListsPivots']")));
    };
    /** Verify that the Paste link appears */
    TeamsTabUrlConfigTest.AddTaskVerifyPasteLink = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring Paste Link appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PasteLinkButton']"));
    };
    /** Verify that the Any SP Site RadioBtn appears. For the expt treatment experience. */
    TeamsTabUrlConfigTest.AddTaskVerifyPasteLinkV3 = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring any SP Site radio Btn appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'RadioHead-B'));
    };
    /** Click the paste link button and verify that the TabUrl component loads */
    TeamsTabUrlConfigTest.AddTaskVerifyTabUrlConfig = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring TabUrl component appears');
            TeamsTabUrlConfigTest._addTaskClickPasteLinkButton();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='TabUrlConfig']"));
    };
    /** Click the Any SP Site radio btn and verify that the TabUrl component loads (expt treatment experience) */
    TeamsTabUrlConfigTest.AddTaskVerifyTabUrlConfigV3 = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring TabUrl component appears (V3)');
            TeamsTabUrlConfigTest._addTaskClickPasteLinkButtonV3();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='TabUrlConfig']"));
    };
    /** Verify that the Link input component appears */
    TeamsTabUrlConfigTest.AddTaskVerifyLinkInputItem = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring Link input component appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='LinkInput']"));
    };
    /** Verify that the Browse back link appears */
    TeamsTabUrlConfigTest.AddTaskVerifyBackBrowseLink = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring Browse back link appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='BrowseBackLinkButton']"));
    };
    /** Verify that the Site Title radio btn appears (analog to backbrowse) */
    TeamsTabUrlConfigTest.AddTaskVerifyBackBrowseLinkV3 = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring site name radio Btn appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'RadioHead-A'));
    };
    /** Click the Browse back button and verify that the paste link appears */
    TeamsTabUrlConfigTest.AddTaskVerifyBackBrowseLinkClick = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring Paste link appears on Back browse link click');
            TeamsTabUrlConfigTest._addTaskClickBrowseBackButton();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PasteLinkButton']"));
    };
    /** Click the site name radio btn and verify that pivots appear */
    TeamsTabUrlConfigTest.AddTaskVerifyBackBrowseLinkClickV3 = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring pivots appear on clicking site name radio btn');
            TeamsTabUrlConfigTest._addTaskClickBrowseBackButtonV3();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PagesAndListsPivots']"));
    };
    TeamsTabUrlConfigTest._addTaskClickPasteLinkButton = function () {
        TAB.Log.AddTaskComment('Obtaining the Paste link element');
        var pasteLinkButton = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                pasteLinkButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PasteLinkButton']");
                return Boolean(pasteLinkButton);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the Paste Link Button');
            TAB.ClickElement(pasteLinkButton);
        }), undefined);
    };
    TeamsTabUrlConfigTest._addTaskClickPasteLinkButtonV3 = function () {
        TAB.Log.AddTaskComment('Obtaining the any SP site radio btn input element');
        var pasteLinkButton = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                pasteLinkButton = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'RadioHead-B');
                return Boolean(pasteLinkButton);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the any SP site radio btn input element');
            TAB.ClickElement(pasteLinkButton);
        }), undefined);
    };
    TeamsTabUrlConfigTest._addTaskClickBrowseBackButton = function () {
        TAB.Log.AddTaskComment('Obtaining the Browse back element');
        var browseBackLinkButton = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                browseBackLinkButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='BrowseBackLinkButton']");
                return Boolean(browseBackLinkButton);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the Browse back Link Button');
            TAB.ClickElement(browseBackLinkButton);
        }), undefined);
    };
    TeamsTabUrlConfigTest._addTaskClickBrowseBackButtonV3 = function () {
        TAB.Log.AddTaskComment('Obtaining the site title radio btn input element');
        var browseBackLinkButton = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                browseBackLinkButton = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'RadioHead-A');
                return Boolean(browseBackLinkButton);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the site title radio btn input element');
            TAB.ClickElement(browseBackLinkButton);
        }), undefined);
    };
    return TeamsTabUrlConfigTest;
}());



/***/ }),

/***/ "Aitv":
/*!***************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ListViewWebpart.js ***!
  \***************************************************/
/*! exports provided: ListViewWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListViewWebpart", function() { return ListViewWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _ContextMenu__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ContextMenu */ "yis5");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");





/**
 * @public
 */
var ListViewWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(ListViewWebpart, _super);
    function ListViewWebpart(isDocLibrary) {
        var _this = this;
        if (isDocLibrary) {
            _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].ListViewDocLib, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].ListViewDocLib.toString()) || this;
        }
        else {
            _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].ListView, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].ListView.toString()) || this;
        }
        return _this;
    }
    ListViewWebpart.prototype.GetRoot = function () {
        return this.root;
    };
    ListViewWebpart.prototype.AddTaskAddNewFolder = function (folderName) {
        var _this = this;
        var newButton;
        TAB.Log.AddTaskComment('Waiting for "New" commandbar button to appear');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var buttons = TAB.GetElements(_this.root, TAB.searchBy.hasClassName, 'ms-CommandBarItem-link');
            if (buttons && buttons.length > 0) {
                newButton = buttons[0]; // "New" button is first in CommandBar
                return true;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking "New" button');
            TAB.ClickElement(newButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu'));
        this._addTaskClickContextMenuItemByIndex('Folder', 0); // Folder is first item in "New" context menu
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Adding new folder');
            var dialog = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-main');
            var input = TAB.GetElement(dialog, TAB.searchBy.tag, 'input');
            input.focus();
            input.value = folderName;
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(input, folderName);
            var createButton = TAB.GetElement(dialog, TAB.searchBy.hasClassName, 'ms-Button--primary');
            TAB.ClickElement(createButton);
        }));
    };
    ListViewWebpart.prototype.AddTaskDeleteFirstItem = function () {
        var _this = this;
        var titleToDelete;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting first item');
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            var firstItem = items[0];
            titleToDelete = TAB.GetTextContent(TAB.GetElement(firstItem, TAB.searchBy.customQuery, "[data-automation-key=\"Title\"]"));
            var checkbox = TAB.GetElement(firstItem, TAB.searchBy.hasClassName, 'ms-DetailsRow-check');
            TAB.ClickElement(checkbox);
            TAB.Log.Comment('Clicking delete');
            var commandBar = TAB.GetElement(_this.root, TAB.searchBy.hasClassName, 'ms-CommandBar');
            // "Delete" button is second in CommandBar for custom lists
            var deleteButton = TAB.GetElements(commandBar, TAB.searchBy.hasClassName, 'ms-CommandBarItem-link')[1];
            TAB.ClickElement(deleteButton);
            TAB.Log.Comment('Confirming delete');
            var dialogActions = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-actions');
            var confirmDeleteBtn = TAB.GetElements(dialogActions, TAB.searchBy.tag, 'button')[0];
            TAB.ClickElement(confirmDeleteBtn);
        }));
        TAB.Log.AddTaskComment('Waiting for item to be removed from list');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            var itemStillExists = false;
            for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {
                var item = items_1[_i];
                var currentTitle = TAB.GetTextContent(TAB.GetElement(item, TAB.searchBy.customQuery, "[data-automation-key=\"Title\"]"));
                if (currentTitle === titleToDelete) {
                    itemStillExists = true;
                    break;
                }
            }
            if (!itemStillExists) {
                TAB.Log.Pass('Item successfully deleted');
                return true;
            }
        }));
    };
    ListViewWebpart.prototype.AddTaskDeleteFolder = function (folderName) {
        var _this = this;
        var checkbox;
        TAB.Log.AddTaskComment('Waiting for target folder to render');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            for (var _i = 0, items_2 = items; _i < items_2.length; _i++) {
                var item = items_2[_i];
                var name_1 = TAB.GetElement(item, TAB.searchBy.customQuery, '[data-automation-key="name"]');
                if (TAB.GetTextContent(name_1).indexOf(folderName) > -1) {
                    checkbox = TAB.GetElements(item, TAB.searchBy.customQuery, '[role="checkbox"]')[0];
                    return true;
                }
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting folder');
            TAB.ClickElement(checkbox);
            TAB.Log.Comment('Clicking delete');
            var deleteButton = TAB.GetElement(_this.root, TAB.searchBy.customQuery, '[data-command-key="delete"]');
            TAB.ClickElement(deleteButton);
            TAB.Log.Comment('Confirming delete');
            var dialog = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-main');
            var confirmDelete = TAB.GetElement(dialog, TAB.searchBy.hasClassName, 'ms-Button--default');
            TAB.ClickElement(confirmDelete);
        }));
    };
    ListViewWebpart.prototype.AddTaskEditWebPartTitle = function (newTitle) {
        var _this = this;
        TAB.Log.AddTaskComment('Waiting for webpart title textarea to render');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.GetElements(_this.root, TAB.searchBy.tag, 'textarea').length > 0;
        }));
        TAB.Log.AddTaskComment('Editing webpart title');
        TAB.AddTask(TAB.MakeTask(function () {
            var titleInput = (TAB.GetElements(_this.root, TAB.searchBy.tag, 'textarea')[0]);
            titleInput.value = newTitle;
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(titleInput, newTitle);
        }));
    };
    ListViewWebpart.prototype.AddTaskFilter = function (columnName, filterValue) {
        this._addTaskClickColumnHeader(columnName);
        this._addTaskClickContextMenuItemByIndex('Filter by', 2); // "Filter by" is third item in column context menu
        TAB.Log.AddTaskComment('Waiting for filter pane to render');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.className, 'FiltersPane-sectionContent'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Selecting filter by " + filterValue);
            var filterPane = TAB.GetElement(TAB.Win, TAB.searchBy.className, 'FiltersPane-sectionContent');
            var targetField = TAB.GetElement(filterPane, TAB.searchBy.customQuery, "[data-checked-value=\"" + filterValue + "\"]");
            var checkbox = TAB.GetElement(targetField, TAB.searchBy.tag, 'button');
            TAB.ClickElement(checkbox);
            TAB.Log.Comment('Clicking "Apply" filter');
            var filterButtons = TAB.GetElement(TAB.Win, TAB.searchBy.className, 'od-FilterSelect-buttons');
            var applyButton = TAB.GetElement(filterButtons, TAB.searchBy.customQuery, '[data-automationid="FilterSelect-Apply"]');
            TAB.ClickElement(applyButton);
        }));
    };
    ListViewWebpart.prototype.AddTaskGroupBy = function (columnName, expectedCount) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._addTaskClickColumnHeader(columnName);
            _this._addTaskClickContextMenuItemByIndex("Group by " + columnName, 3); // "Group by" is fourth item in column context menu
            TAB.Log.AddTaskComment('Waiting for list to be grouped');
            TAB.AddTask(undefined, TAB.WaitForElementToExist(_this.root, TAB.searchBy.customQuery, '[data-icon-name="GroupedDescending"]'));
            var groupCount = 0;
            TAB.Log.AddTaskComment('Verifying list groups');
            TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                var items = TAB.GetElements(_this.root, TAB.searchBy.hasClassName, 'ms-GroupHeader-title');
                groupCount = items && items.length;
                return groupCount > 0;
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.VerifyEquals(expectedCount, groupCount, '`Correct number of groups displayed');
            }));
            TAB.Log.AddTaskComment('Ungrouping list');
            _this._addTaskClickColumnHeader(columnName);
            _this._addTaskClickContextMenuItemByIndex("Group by " + columnName, 3); // "Group by" is fourth item in column context menu
        }));
    };
    ListViewWebpart.prototype.AddTaskSelectItemByPosition = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting item ' + index.toString());
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            var item = items[index];
            var checkbox = TAB.GetElement(item, TAB.searchBy.hasClassName, 'ms-DetailsRow-check');
            TAB.ClickElement(checkbox);
        }));
    };
    /**
     * @param listName - Provide if a specific list should be selected
     * @param selectedDocLib - If specific list is not provided, this object is passed in to keep track of the selected list
     */
    ListViewWebpart.prototype.AddTaskSelectList = function (list, selectedDocLib) {
        var _this = this;
        TAB.Log.AddTaskComment('Selecting list for web part');
        TAB.AddTask(TAB.MakeTask(function () {
            var listElement;
            var listName = _this._getListName(list);
            if (listName) {
                listElement = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[title=\"" + listName + "\"]");
            }
            else {
                // if listName not provided, get all list items and select first one
                listElement = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='setupPanelItem']");
                var title = TAB.GetElement(listElement[0], TAB.searchBy.tag, 'div');
                selectedDocLib.name = TAB.GetTextContent(title); // Only need to keep track of selected doclib
            }
            if (listElement && listElement[0]) {
                TAB.ClickElement(listElement[0]);
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-DetailsList'));
    };
    ListViewWebpart.prototype.AddTaskSortByColumn = function (columnName, sortBy, index, sortString) {
        var _this = this;
        this._addTaskClickColumnHeader(columnName);
        this._addTaskClickContextMenuItemByIndex(sortBy, index);
        TAB.Log.AddTaskComment('Waiting for items to be sorted');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var sorted = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-icon-name=\"" + sortString + "\"]");
            if (sorted && sorted[0]) {
                return true;
            }
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyBreadcrumb = function (root, folderName) {
        var _this = this;
        var breadcrumbItems;
        TAB.Log.AddTaskComment('Waiting for breadcrumb to appear');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-DetailsList'));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            breadcrumbItems = TAB.GetElements(_this.root, TAB.searchBy.hasClassName, 'ms-Breadcrumb-listItem');
            return breadcrumbItems && breadcrumbItems.length > 1;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var expectedBreadcrumb = [root.name, folderName];
            var breadcrumbSuccess = true;
            for (var i = 0; i < expectedBreadcrumb.length; i++) {
                var actualText = TAB.GetTextContent(breadcrumbItems[i]);
                if (actualText.indexOf(expectedBreadcrumb[i]) === -1) {
                    breadcrumbSuccess = false;
                    break;
                }
            }
            TAB.Log.Verify(breadcrumbSuccess, 'Breadcrumb contains correct text: ' + expectedBreadcrumb.join(' > '));
            TAB.Log.Comment('Navigating back to library root');
            TAB.AddTask(TAB.MakeTask(function () {
                // Need to get breadcrumbItems again to ensure we are not use the staled elements.
                breadcrumbItems = TAB.GetElements(_this.root, TAB.searchBy.hasClassName, 'ms-Breadcrumb-listItem');
                var libraryRoot = TAB.GetElement(breadcrumbItems[0], TAB.searchBy.tag, 'button');
                TAB.ClickElement(libraryRoot);
            }), TAB.MakeWaiter(function () {
                // Wait until root title element is found.
                var rootTitle = TAB.GetElements(_this.root, TAB.searchBy.tag, 'textarea');
                return rootTitle && rootTitle.length > 0;
            }));
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyFilters = function (columnName, filters) {
        var _this = this;
        TAB.Log.AddTaskComment('Verify Dynamic filter to apply');
        TAB.AddTask(TAB.MakeTask(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            var filterSuccess = true;
            for (var _i = 0, items_3 = items; _i < items_3.length; _i++) {
                var item = items_3[_i];
                var value = TAB.GetTextContent(TAB.GetElement(item, TAB.searchBy.customQuery, "[data-automation-key=\"" + columnName + "\"]"));
                if (!_this._checkFilteredValue(filters, value)) {
                    filterSuccess = false;
                    break;
                }
            }
            TAB.Log.Verify(filterSuccess, 'Items successfully filtered');
        }));
    };
    ListViewWebpart.prototype.AddTaskWaitForFilteredView = function () {
        TAB.Log.AddTaskComment('Waiting for target filtered view shown instead of shimmer items ...');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(this.root, TAB.searchBy.customQuery, "[data-automationid='FieldRender-DotDotDot']"));
    };
    ListViewWebpart.prototype.AddTaskVerifyFilter = function (columnName, filterValue) {
        var _this = this;
        TAB.Log.AddTaskComment('Waiting for filter to apply');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-icon-name="Filter"]'));
        TAB.AddTask(TAB.MakeTask(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            var filterSuccess = true;
            for (var _i = 0, items_4 = items; _i < items_4.length; _i++) {
                var item = items_4[_i];
                var value = TAB.GetTextContent(TAB.GetElement(item, TAB.searchBy.customQuery, "[data-automation-key=\"" + columnName + "\"]"));
                if (value !== filterValue) {
                    filterSuccess = false;
                    break;
                }
            }
            TAB.Log.Verify(filterSuccess, 'Items successfully filtered');
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyFolder = function (folderName) {
        var _this = this;
        var folder;
        TAB.Log.AddTaskComment('Waiting for new folder to appear');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.customQuery, '[data-automationid="ListCell"]');
            for (var _i = 0, items_5 = items; _i < items_5.length; _i++) {
                var item = items_5[_i];
                var nameElements = TAB.GetElements(item, TAB.searchBy.customQuery, '[data-automationid="FieldRenderer-name"]');
                // skip the placeholder elements.
                if (!nameElements || nameElements.length < 1) {
                    continue;
                }
                var name_2 = nameElements[0];
                var success = name_2.innerText === folderName;
                if (success) {
                    folder = name_2;
                    TAB.Log.Pass("Successfully created new folder: " + folderName);
                }
                return success;
            }
        }));
        TAB.Log.AddTaskComment('Clicking folder');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(folder);
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyFolderDeleted = function (folderName, result) {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying deleted folder does not appear in list');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            for (var _i = 0, items_6 = items; _i < items_6.length; _i++) {
                var item = items_6[_i];
                var name_3 = TAB.GetElement(item, TAB.searchBy.customQuery, '[data-automation-key="name"]');
                if (TAB.GetTextContent(name_3) === folderName) {
                    result.success = false;
                    return false;
                }
            }
            TAB.Log.Pass('Deleted folder does not appear in list');
            result.success = true;
            return true;
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyItemOrder = function (columnName, expectedValues) {
        var _this = this;
        TAB.Log.AddTaskComment('Waiting for fields to render');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var fields = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-key=\"" + columnName + "\"]");
            return fields && fields.length > 0;
        }));
        TAB.Log.AddTaskComment('Verifying items are sorted correctly');
        TAB.AddTask(TAB.MakeTask(function () {
            var items = TAB.GetElements(_this.root, TAB.searchBy.className, 'ms-List-cell');
            if (items && items.length) {
                for (var i = 0; i < expectedValues.length; i++) {
                    var fields = TAB.GetElements(items[i], TAB.searchBy.customQuery, "[data-automation-key=\"" + columnName + "\"]");
                    if (fields && fields.length) {
                        var fieldValue = TAB.GetTextContent(fields[0]);
                        TAB.Log.VerifyEquals(fieldValue, expectedValues[i], 'Sorted item has correct value');
                    }
                }
            }
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifySeeAllLink = function (list) {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying "See all" link');
        TAB.AddTask(TAB.MakeTask(function () {
            var listName = _this._getListName(list);
            var expectedHref = '/Lists/' + listName;
            var link = (_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this.root, 'listViewWebPartSeeAll'));
            TAB.Log.Verify(link.href.indexOf(expectedHref) > -1, '"See all" link is correct');
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyTitle = function (list) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var expectedText = _this._getListName(list);
            var header = TAB.GetElement(_this.root, TAB.searchBy.tag, 'textarea');
            var headerText = TAB.GetTextContent(header);
            TAB.Log.VerifyEquals(expectedText, headerText, 'ListViewWebpart title is correct');
        }));
    };
    ListViewWebpart.prototype.AddTaskVerifyUpdatedTitle = function (expectedTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            var webpartHeaders = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="captionElement"]');
            var foundTitle = false;
            for (var _i = 0, webpartHeaders_1 = webpartHeaders; _i < webpartHeaders_1.length; _i++) {
                var header = webpartHeaders_1[_i];
                var text = TAB.GetTextContent(header);
                if (text === expectedTitle) {
                    foundTitle = true;
                }
                TAB.Log.Verify(foundTitle, 'Updated web part title found');
            }
        }));
    };
    ListViewWebpart.prototype.IsWebpartUpdated = function () {
        return TAB.ElementExists(this.root, TAB.searchBy.tag, 'div');
    };
    ListViewWebpart.prototype.WaitForChoiceBox = function () {
        TAB.Log.AddTaskComment('Waiting for the list choice box to be populated ...');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='setupPanelItem']"));
    };
    ListViewWebpart.prototype._addTaskClickColumnHeader = function (columnName) {
        var _this = this;
        TAB.Log.AddTaskComment('Clicking column header to open context menu');
        // Look for correct column and click until context menu opens
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var headers = TAB.GetElements(_this.root, TAB.searchBy.customQuery, '[data-automationid="ColumnsHeaderColumn"]');
            for (var _i = 0, headers_1 = headers; _i < headers_1.length; _i++) {
                var header = headers_1[_i];
                var headerText = TAB.GetTextContent(header);
                if (headerText.indexOf(columnName) > -1) {
                    var button = TAB.GetElement(header, TAB.searchBy.customQuery, '[role="button"]');
                    TAB.ClickElement(button);
                    break;
                }
            }
            return _ContextMenu__WEBPACK_IMPORTED_MODULE_3__["ContextMenu"].MenuAlreadyOpen();
        }));
    };
    ListViewWebpart.prototype._addTaskClickContextMenuItemByIndex = function (item, index) {
        TAB.Log.AddTaskComment("Clicking context menu item \"" + item + "\" at index " + index);
        TAB.AddTask(TAB.MakeTask(function () {
            var sortMenu = new _ContextMenu__WEBPACK_IMPORTED_MODULE_3__["ContextMenu"]();
            sortMenu.AddTaskClickItemByIndex(index);
        }));
    };
    ListViewWebpart.prototype._getListName = function (list) {
        return typeof list === 'string' ? list : list && list.listName;
    };
    ListViewWebpart.prototype._checkFilteredValue = function (filters, value) {
        var foundMatch = false;
        for (var item in filters) {
            if (filters[item] === value) {
                foundMatch = true;
                break;
            }
        }
        return foundMatch;
    };
    return ListViewWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["BaseWebpart"]));



/***/ }),

/***/ "BJbA":
/*!*******************************!*\
  !*** ./lib/SPTaskLib/Next.js ***!
  \*******************************/
/*! exports provided: Next */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Next", function() { return Next; });
/* harmony import */ var _CsomUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CsomUtil */ "UXDa");

/**
 * @public
 */
var Next = /** @class */ (function () {
    function Next() {
    }
    Next.GetElementByDataAutomationId = function (root, id) {
        var elementCollection = this.GetElementsByDataAutomationId(root, id);
        if (!elementCollection) {
            TAB.Log.Verbose("Element not found with data automation id '" + id + "'");
            return null;
        }
        var element = elementCollection[id] || elementCollection[0];
        if (!element) {
            TAB.Log.Verbose("Element not found with data automation id '" + id + "'");
            return null;
        }
        return element;
    };
    Next.GetElementsByDataAutomationId = function (root, id) {
        var automationId = "[data-automation-id='" + id + "']";
        var elementCollection = TAB.GetElements(root, TAB.searchBy.customQuery, automationId);
        if (elementCollection.length === 0) {
            automationId = "[data-automationid='" + id + "']";
            elementCollection = TAB.GetElements(root, TAB.searchBy.customQuery, automationId);
        }
        return elementCollection;
    };
    Next.WaitForElementsByDataAutomationId = function (root, id, numberOfInstances) {
        return TAB.MakeWaiter(function () {
            if (typeof root === 'function') {
                root = root();
            }
            if (!root) {
                root = TAB.Win;
            }
            try {
                var automationId = "[data-automation-id='" + id.toString() + "']";
                var elementCollection = TAB.GetElements(root, TAB.searchBy.customQuery, automationId);
                if (isNaN(numberOfInstances)) {
                    return elementCollection.length > 0;
                }
                else {
                    return elementCollection.length === numberOfInstances;
                }
            }
            catch (e) {
                return false;
            }
        });
    };
    /**
     * Fetches the request digest (canary) if needed, and makes a POST request to the
     * specified URL using that canary.
     *
     * @param serverUrl - The server URL
     * @param targetUrl - The target URL to send the POST request
     * @param postBody - Body to send in POST request
     * @param responseResult - Wrapper object for response from POST request
     * @param onComplete - Callback to validate the XHR status and response
     */
    Next.AddTaskSendRestRequest = function (serverUrl, targetUrl, postBody, responseResult, fetchCanary, xHTTPMethod, onComplete) {
        Next._addTaskSetUpCanaryData(serverUrl, fetchCanary);
        TAB.AddTask(TAB.MakeTask(function () {
            if (!Next.digestResult.success || typeof Next.digestResult.retVal !== 'string') {
                throw 'AddTaskSendPost: The canary is invalid.';
            }
            else {
                var canary = Next.digestResult.retVal;
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.Log.Comment("SendPost: Creating XML http request to '" + targetUrl + "'.");
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', targetUrl, true);
                    xhr.setRequestHeader('x-requestdigest', canary);
                    xhr.setRequestHeader('Content-Type', 'application/json;odata=verbose');
                    xhr.setRequestHeader('Accept', 'application/json;odata=verbose');
                    if (xHTTPMethod) {
                        xhr.setRequestHeader('X-HTTP-Method', xHTTPMethod);
                        xhr.setRequestHeader('IF-MATCH', '*');
                    }
                    var OnSuccess = function () {
                        TAB.Log.Comment('SendPost: XHR returned successfully.');
                        responseResult.retVal = JSON.parse(xhr.responseText);
                        responseResult.success = true;
                        var correlationId = xhr.getResponseHeader('sprequestguid');
                        TAB.Log.Comment("Request correlation ID: " + correlationId);
                    };
                    TAB.AddAjaxTask(xhr, OnSuccess, postBody);
                    // After the XHR task completes, create a task to evaluate the result of the xhr.
                    TAB.AddTask(TAB.MakeTask(function () {
                        if (onComplete) {
                            onComplete(xhr);
                        }
                    }));
                }));
            }
        }));
    };
    Next.AddTaskSendGetRequest = function (serverUrl, targetUrl, responseResult, onComplete) {
        Next._addTaskSetUpCanaryData(serverUrl);
        TAB.AddTask(TAB.MakeTask(function () {
            if (!Next.digestResult.success || typeof Next.digestResult.retVal !== 'string') {
                throw 'AddTaskSendPost: The canary is invalid.';
            }
            else {
                var canary = Next.digestResult.retVal;
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.Log.Comment("Sending get request to '" + targetUrl + "'.");
                    var xhr = new XMLHttpRequest();
                    xhr.open('GET', targetUrl, true);
                    xhr.setRequestHeader('x-requestdigest', canary);
                    xhr.setRequestHeader('Content-Type', 'application/json; odata.metadata=minimal');
                    xhr.setRequestHeader('Accept', '*/*, application/json; odata.metadata=minimal');
                    xhr.setRequestHeader('odata-version', '4.0');
                    var OnSuccess = function () {
                        TAB.Log.Comment('GET request returned successfully.');
                        responseResult.retVal = JSON.parse(xhr.responseText);
                        responseResult.success = true;
                        var correlationId = xhr.getResponseHeader('sprequestguid');
                        TAB.Log.Comment("Request correlation ID: " + correlationId);
                    };
                    Next._addTaskSendAjax(xhr, OnSuccess);
                    // After the XHR task completes, create a task to evaluate the result of the xhr.
                    TAB.AddTask(TAB.MakeTask(function () {
                        var _a;
                        (_a = onComplete) === null || _a === void 0 ? void 0 : _a(xhr);
                    }));
                }));
            }
        }));
    };
    Next.AddTaskSendPostRequest = function (serverUrl, targetUrl, postBody, responseResult, fetchCanary) {
        Next._addTaskSetUpCanaryData(serverUrl, fetchCanary);
        TAB.AddTask(TAB.MakeTask(function (serverUrl) {
            if (!Next.digestResult.success || typeof Next.digestResult.retVal !== 'string') {
                throw 'AddTaskSendPost: The canary is invalid.';
            }
            else {
                var canary = Next.digestResult.retVal;
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.Log.Comment("SendPost: Creating XML http request to '" + targetUrl + "'.");
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', targetUrl, true);
                    xhr.setRequestHeader('x-requestdigest', canary);
                    xhr.setRequestHeader('Content-Type', 'application/json; odata.metadata=minimal');
                    xhr.setRequestHeader('Accept', '*/*, application/json; odata.metadata=minimal');
                    xhr.setRequestHeader('odata-version', '4.0');
                    var OnSuccess = function () {
                        TAB.Log.Comment('SendPost: XHR returned successfully.');
                        if (xhr.responseText) {
                            responseResult.retVal = JSON.parse(xhr.responseText);
                        }
                        responseResult.success = true;
                        var correlationId = xhr.getResponseHeader('sprequestguid');
                        TAB.Log.Comment("Request correlation ID: " + correlationId);
                    };
                    Next._addTaskSendAjax(xhr, OnSuccess, postBody);
                }));
            }
        }));
    };
    Next.AddTaskSendGetRequestClassicPage = function (serverUrl, targetUrl, responseResult) {
        Next._addTaskSetUpCanaryData(serverUrl);
        TAB.AddTask(TAB.MakeTask(function () {
            if (!Next.digestResult.success || typeof Next.digestResult.retVal !== 'string') {
                throw new Error('AddTaskSendGePublishingPage: The canary is invalid.');
            }
            else {
                var canary = Next.digestResult.retVal;
                TAB.AddTask(TAB.MakeTask(function () {
                    var start;
                    var end;
                    if (performance)
                        start = performance.now();
                    TAB.Log.Comment("Sending get request to '" + targetUrl + "'.");
                    var xhr = new XMLHttpRequest();
                    xhr.open('GET', targetUrl, true);
                    xhr.setRequestHeader('x-requestdigest', canary);
                    xhr.setRequestHeader('Content-Type', 'text/html; odata.metadata=minimal');
                    xhr.setRequestHeader('Accept', '*/*, text/html; odata.metadata=minimal');
                    xhr.setRequestHeader('odata-version', '4.0');
                    xhr.responseType = 'document';
                    var OnSuccess = function () {
                        if (performance)
                            end = performance.now();
                        if (start && end) {
                            var totalTime = end - start;
                            if (totalTime < 6000) {
                                TAB.Log.Comment("Get request took " + totalTime + " ms which was under our 6000 ms goal");
                            }
                            else {
                                TAB.Log.Comment("Get request took " + totalTime + " ms which was over our 6000 ms goal");
                            }
                        }
                        TAB.Log.Comment('GET request returned successfully.');
                        responseResult.retVal = xhr.responseXML;
                        responseResult.success = true;
                        responseResult.correlationId = xhr.getResponseHeader('sprequestguid');
                    };
                    Next._addTaskSendAjax(xhr, OnSuccess);
                }));
            }
        }));
    };
    Next._addTaskSetUpCanaryData = function (serverUrl, fetchCanary) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (!Next.digestResult || Next.digestResult.retVal === undefined || fetchCanary) {
                Next.digestResult = {};
                TAB.AddTask(TAB.MakeTask(function () {
                    var canaryXhr = new XMLHttpRequest();
                    var contexturl = serverUrl + '/_api/contextinfo';
                    TAB.Log.Comment("GetRequestDigest: Getting Form Digest Value from URL '" + contexturl + "'.");
                    canaryXhr.open('POST', contexturl, true);
                    canaryXhr.setRequestHeader('Content-Type', 'application/json;odata=verbose');
                    canaryXhr.setRequestHeader('Accept', 'application/json; odata = verbose');
                    TAB.AddAjaxTask(canaryXhr, function () {
                        TAB.Log.Comment('GetRequestDigest: Get Form Digest Value succeeded.');
                        var canaryData = JSON.parse(canaryXhr.responseText);
                        Next.digestResult.retVal = canaryData.d.GetContextWebInformation.FormDigestValue;
                        Next.digestResult.success = true;
                        var correlationId = canaryXhr.getResponseHeader('sprequestguid');
                        TAB.Log.Comment("Canary request correlation ID: " + correlationId);
                    });
                }));
            }
        }));
    };
    /**
     * Sending ajax call to server
     * TODO: replace with TAB.AddAjaxTask once Alexsp update the onedrive-buildtools-binaries with latest tab core
     */
    Next._addTaskSendAjax = function (xmlhttp, successCallback, postBody) {
        var _isDone = false;
        TAB.AddTask(TAB.MakeTask(function () {
            xmlhttp.onreadystatechange = function () {
                var args = arguments;
                if (xmlhttp.readyState == 4) {
                    _isDone = true;
                    if (Math.floor(xmlhttp.status / 100) == 2 && successCallback != null)
                        // treat all 200s as success
                        successCallback.apply(xmlhttp, args);
                    else
                        TAB.Log.Warning('AjaxCallbackWrapper: AJAX call returned, but status not okay.');
                }
            };
            xmlhttp.onerror = function () {
                _isDone = true;
                TAB.Log.AddTaskWarning('_addTaskSendAjax failed');
            };
            xmlhttp.onabort = function () {
                _isDone = true;
                TAB.Log.AddTaskWarning('_addTaskSendAjax aborted');
            };
            xmlhttp.send(postBody);
        }), TAB.MakeWaiter(function () {
            return _isDone;
        }));
    };
    Next.addCsomTaskDoesWebExist = function (webUrl, result) {
        TAB.AddTask(TAB.MakeTask(function () {
            var cctx = null;
            var currentWeb = null;
            _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(loadWeb, onLoadSuccess, onLoadFail);
            // CSOM to load the web object
            function loadWeb() {
                cctx = new SP.ClientContext(webUrl);
                currentWeb = cctx.get_web();
                cctx.load(currentWeb);
                return cctx;
            }
            function onLoadSuccess() {
                TAB.Log.Verbose('Found existing web at: ' + webUrl);
                result.success = true;
                // It's the root site collection.
                if (currentWeb.get_serverRelativeUrl() === '/') {
                    result.success = false;
                }
            }
            function onLoadFail() {
                TAB.Log.Verbose('Count not find any existing web at: ' + webUrl);
                result.success = false;
            }
        }));
    };
    Next.digestResult = {};
    return Next;
}());



/***/ }),

/***/ "BW9v":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/Controls/NewsFilter.js ***!
  \**********************************************/
/*! exports provided: NewsFilter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewsFilter", function() { return NewsFilter; });
/* harmony import */ var _Utilities_ReactTriggerChange__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Utilities/ReactTriggerChange */ "dp3n");

var FilterDataAutomationId;
(function (FilterDataAutomationId) {
    FilterDataAutomationId["FilterDropDownBox"] = "queryFilterTypeDropDown";
    FilterDataAutomationId["FilterTextBox"] = "textQueryFilter";
    FilterDataAutomationId["FilterAddButton"] = "queryFilterAddButton";
    FilterDataAutomationId["FilterContainer"] = "queryFilterContainer";
    FilterDataAutomationId["FilterRemoveButton"] = "queryFilterRemoveButton";
    FilterDataAutomationId["FilterPropertyPaneApplyButton"] = "propertyPaneApplyButton";
    FilterDataAutomationId["DateTimeQueryFilter"] = "dateTimeQueryFilter";
    FilterDataAutomationId["PersonQueryFilter"] = "personQueryFilter";
    FilterDataAutomationId["PersonQueryFilterTypeTextField"] = "queryFilterTypeTextField";
    FilterDataAutomationId["FieldQueryFilterDropDown"] = "fieldQueryFilterDropDown";
    FilterDataAutomationId["FieldQueryFilterTextField"] = "fieldQueryFilterValueTextField";
    FilterDataAutomationId["FieldQueryFilterOperationDropDown"] = "fieldQueryFilterOperationDropdown";
})(FilterDataAutomationId || (FilterDataAutomationId = {}));
/**
 * @public
 */
var NewsFilter = /** @class */ (function () {
    function NewsFilter() {
    }
    NewsFilter.prototype.AddTaskCheckFilterOptionExists = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for filter container");
        }), this._waitForFilterElementToExist(FilterDataAutomationId.FilterContainer));
    };
    NewsFilter.prototype.AddTaskWaitForDropDownToExistById = function (dataAutomationId) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for Filter property pane " + dataAutomationId);
        }), this._waitForFilterElementToExist(dataAutomationId));
    };
    NewsFilter.prototype.AddTaskToOpenPropertyPaneDropDown = function (dataAutomationId, selectedValueIndex) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for Filter property pane " + dataAutomationId);
        }), this._waitForFilterElementToExist(dataAutomationId));
        TAB.AddTask(TAB.MakeTask(function () {
            var dropDown = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + dataAutomationId + "']");
            dropDown.focus();
            TAB.ClickElement(dropDown);
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment("Waiting for dropDown");
                var dropDown = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, NewsFilter.Dropdown_CallOutClassName);
                var buttons = TAB.GetElements(dropDown, TAB.searchBy.tag, NewsFilter.Dropdown_TagButton);
                return buttons.length > 0;
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Clicking on dropDownCallout");
            var dropDownCallout = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, NewsFilter.Dropdown_CallOutClassName)[0];
            var button = TAB.GetElements(dropDownCallout, TAB.searchBy.tag, NewsFilter.Dropdown_TagButton)[selectedValueIndex];
            TAB.ClickElement(button);
        }), undefined);
    };
    NewsFilter.prototype.AddTaskFilterTitle = function (dataAutomationId, title) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var inputBox = _this._getPropertyPaneElementByDataAutomationId(dataAutomationId);
            inputBox.focus();
            inputBox.value = title;
            Object(_Utilities_ReactTriggerChange__WEBPACK_IMPORTED_MODULE_0__["ReactTriggerChange"])(inputBox);
        }), undefined);
    };
    NewsFilter.prototype.AddTaskClickAddFilterButton = function (filterIndex) {
        var _this = this;
        var addFilterDataAutomationId = FilterDataAutomationId.FilterAddButton + filterIndex;
        var removeButtonFilterDataAutomationId = FilterDataAutomationId.FilterRemoveButton + ++filterIndex;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for Filter Add button");
        }), this._waitForFilterElementToExist(addFilterDataAutomationId));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking Filter Add button');
            TAB.ClickElement(_this._getPropertyPaneElementByDataAutomationId(addFilterDataAutomationId));
        }), this._waitForFilterElementToExist(removeButtonFilterDataAutomationId));
    };
    NewsFilter.prototype.AddTaskClickRemoveFilterButton = function (filterIndex) {
        var _this = this;
        var removeFilterDataAutomationId = FilterDataAutomationId.FilterRemoveButton + filterIndex;
        var addFilterIndex = filterIndex === 0 ? filterIndex : filterIndex - 1;
        var addFilterDataAutomationId = FilterDataAutomationId.FilterAddButton + addFilterIndex;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for Filter Remove button");
        }), this._waitForFilterElementToExist(removeFilterDataAutomationId));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking Filter Remove button');
            TAB.ClickElement(_this._getPropertyPaneElementByDataAutomationId(removeFilterDataAutomationId));
        }), this._waitForFilterElementToExist(addFilterDataAutomationId));
    };
    NewsFilter.prototype._waitForFilterElementToExist = function (dataAutomationId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            return Boolean(_this._getPropertyPaneElementByDataAutomationId(dataAutomationId));
        });
    };
    NewsFilter.prototype._getPropertyPaneElementByDataAutomationId = function (dataAutomationId) {
        try {
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
            return TAB.GetElement(propertyPane, TAB.searchBy.customQuery, "[data-automation-id='" + dataAutomationId + "']");
        }
        catch (e) {
            return undefined;
        }
    };
    NewsFilter.Dropdown_CallOutClassName = 'ms-Dropdown-callout';
    NewsFilter.Dropdown_TagButton = 'BUTTON';
    return NewsFilter;
}());



/***/ }),

/***/ "CPNt":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/Controls/CommandBar.js ***!
  \**********************************************/
/*! exports provided: CommandBar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CommandBar", function() { return CommandBar; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _CommandBarItem__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CommandBarItem */ "SMhQ");
/* harmony import */ var _ContextMenu__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ContextMenu */ "yis5");



/**
 * @public
 */
var CommandBar = /** @class */ (function () {
    function CommandBar(params) {
        this.root = getRootElement({
            area: params.area,
            rootElement: params.rootElement || TAB.Win,
            isReact: CommandBar.isReact
        });
        this._getCommandItems();
    }
    Object.defineProperty(CommandBar, "isReact", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    CommandBar.WaitForCommandBar = function (params, container) {
        return TAB.MakeWaiter(function () {
            try {
                var root = container || TAB.Win;
                // This is just looking to make sure there is at least one commandbar in the DOM.
                // Ideally each usage of this method would specify exactly which commandbar it is waiting for instead.
                var className = CommandBar.isReact ? '.ms-CommandBar' : '.CommandBar';
                var results = TAB.GetElements(root, TAB.searchBy.customQuery, className);
                var element = results && results.length && results[0];
                if (element && params.waitForSelection) {
                    TAB.Log.Comment('CommandBar found. Waiting for selected item.');
                    var commandBar = new CommandBar({ area: 'root' });
                    var selected = commandBar.GetItem({ title: /[0-9]+ selected/ });
                    var newCommand = commandBar.GetItem({ title: 'New' });
                    return !!selected && !newCommand;
                }
                else if (element && params.waitForItems) {
                    var commandBar = new CommandBar({ area: params.area });
                    var commandsToWaitFor = typeof params.waitForItems === 'number' ? params.waitForItems : 1;
                    TAB.Log.Comment("CommandBar found. Waiting for " + commandsToWaitFor + " items to be present.");
                    return commandBar.GetItemCount(true) >= commandsToWaitFor;
                }
                return !!element;
            }
            catch (ex) {
                return false;
            }
        });
    };
    CommandBar.WaitForCommandBarItem = function (title) {
        return TAB.MakeWaiter(function () {
            try {
                var commandBar = new CommandBar({ area: 'root' });
                var commandInfo = typeof title === 'string' ? { title: title } : title;
                return !!commandBar.GetItem(commandInfo);
            }
            catch (ex) {
                return false;
            }
        });
    };
    CommandBar.AddItemVerificationTask = function (options) {
        TAB.Log.AddTaskComment('Verifying that items are present in the CommandBar.');
        TAB.AddTask(TAB.MakeTask(function () {
            var commandBar = new CommandBar({
                area: options.area,
                rootElement: options.rootElement
            });
            return commandBar._addItemVerificationTask(options);
        }));
    };
    CommandBar.prototype.GetItemByTitle = function (title, throwIfNotFound) {
        return getItem({
            items: this.commandBarItems,
            expected: { title: title },
            throwIfNotFound: throwIfNotFound
        });
    };
    CommandBar.prototype.GetItem = function (commandInfo, throwIfNotFound) {
        return getItem({
            items: this.commandBarItems,
            expected: commandInfo,
            throwIfNotFound: throwIfNotFound
        });
    };
    CommandBar.prototype.GetItemBySequence = function (sequence) {
        return this.commandBarItems[sequence];
    };
    CommandBar.prototype.GetItemCount = function (excludeOverFlow) {
        if (excludeOverFlow) {
            var command = this.GetOverflowMenu();
            if (command) {
                return this.commandBarItems.length - 1;
            }
        }
        return this.commandBarItems.length;
    };
    CommandBar.prototype.GetOverflowMenu = function () {
        for (var _i = 0, _a = this.commandBarItems; _i < _a.length; _i++) {
            var command = _a[_i];
            if (command.IsOverflow) {
                return command;
            }
        }
    };
    CommandBar.prototype.VerifyItems = function (expectedItems, requireExactMatch) {
        return verifyItems({
            actual: this.commandBarItems,
            expected: expectedItems,
            requireExactMatch: requireExactMatch
        });
    };
    CommandBar.prototype.VerifyItem = function (index, expectedItem) {
        return verifyItem(this.commandBarItems, index, expectedItem);
    };
    CommandBar.prototype.AddTaskEnsureCommandBarItem = function (title, resetRoot, rootParams) {
        var _this = this;
        var commandInfo = typeof title === 'string' ? { title: title } : title;
        TAB.Log.AddTaskComment("Ensuring item with title \"" + (commandInfo.title || commandInfo.iconClassName) + "\" is in the CommandBar.");
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            if (resetRoot && rootParams) {
                _this.root = getRootElement(rootParams);
            }
            _this._getCommandItems();
            return !!_this.GetItem(commandInfo);
        }));
    };
    /**
     * Click on an item, even if it's in the overflow menu,
     * then return a boolean indicating if the item was in an overflow menu.
     * WARNING: Command or overflow MUST be rendered before this method is called!
     *
     * @param title - Command title or info about the command
     */
    CommandBar.prototype.AddTaskEnsureClickCommandBarItem = function (title) {
        var commandInfo = typeof title === 'string' ? { title: title } : title;
        var itemToGet = this.GetItem(commandInfo);
        var itemToGetVisible = itemToGet && itemToGet.IsVisible;
        if (itemToGetVisible) {
            itemToGet.AddTaskClick();
            TAB.Log.AddTaskComment("Command \"" + (commandInfo.title || commandInfo.iconClassName) + "\" was clicked.");
        }
        else {
            // in overflow
            var overflow = this.GetOverflowMenu();
            TAB.Log.AddTaskComment("Command \"" + (commandInfo.title || commandInfo.iconClassName) + "\" is not visible in the CommandBar. Clicking overflow command.");
            if (overflow) {
                overflow.AddTaskOpenContextMenu();
                TAB.AddTask(TAB.MakeTask(function () {
                    new _ContextMenu__WEBPACK_IMPORTED_MODULE_2__["ContextMenu"](false /*isSubMenu*/).AddTaskClickItem(commandInfo);
                }));
                TAB.Log.AddTaskComment("Command \"" + (commandInfo.title || commandInfo.iconClassName) + "\" was clicked from the overflow menu.");
            }
            else {
                TAB.Log.AddTaskFail("Command \"" + (commandInfo.title || commandInfo.iconClassName) + "\" not found, and overflow command not found.");
                throw "Command \"" + (commandInfo.title || commandInfo.iconClassName) + "\" not found, and overflow command not found";
            }
        }
        return !itemToGetVisible;
    };
    CommandBar.prototype._getCommandItems = function () {
        var className = CommandBar.isReact ? 'ms-Button--commandBar' : 'CommandBarItem';
        var commandElements = TAB.GetElements(this.root, TAB.searchBy.hasClassName, className);
        this.commandBarItems = Array.prototype.map.call(commandElements, function (elem) { return new _CommandBarItem__WEBPACK_IMPORTED_MODULE_1__["CommandBarItem"](elem); });
    };
    CommandBar.prototype._addItemVerificationTask = function (options) {
        var _this = this;
        // tslint:disable-next-line:no-any
        var overflowItems = [];
        var hasOverFlow = false;
        if (options.checkOverflow) {
            TAB.Log.Comment('CommandBar item verification requests checking overflow menu.');
            TAB.AddTask(TAB.MakeTask(function () {
                var overflow = _this.GetOverflowMenu();
                if (overflow) {
                    TAB.Log.Comment('CommandBar has an overflow menu. Opening the context menu.');
                    hasOverFlow = true;
                    overflow.AddTaskOpenContextMenu();
                }
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                if (hasOverFlow) {
                    var overflowMenu = new _ContextMenu__WEBPACK_IMPORTED_MODULE_2__["ContextMenu"](false /*isSubMenu*/);
                    overflowItems = overflowMenu.GetItems();
                }
            }));
        }
        else {
            TAB.Log.Comment('CommandBar item verification requests ignoring overflow menu.');
        }
        TAB.AddTask(TAB.MakeTask(function () {
            var items = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__spreadArrays"])(_this.commandBarItems.filter(function (item) { return !item.IsOverflow; }), overflowItems);
            return verifyItems({
                actual: items,
                expected: options.expectedItems,
                requireExactMatch: options.requireExactMatch
            });
        }));
    };
    return CommandBar;
}());

function getRootElement(params) {
    // There will sometimes be more than one .ms-CommandBar in the DOM because of one used for measurement
    switch (params.area) {
        case 'root':
            var className = params.isReact ? '.ms-ResizeGroup>.ms-CommandBar' : '.CommandBar';
            return TAB.GetElement(params.rootElement, TAB.searchBy.customQuery, className);
        case 'primary':
            if (params.isReact) {
                var primary = TAB.GetElements(params.rootElement, TAB.searchBy.hasClassName, 'ms-CommandBar-primaryCommand');
                return primary && primary.length ? primary[0] : undefined;
            }
            return TAB.GetElement(params.rootElement, TAB.searchBy.hasClassName, 'CommandBar-mainArea');
        case 'secondary':
            if (params.isReact) {
                var secondary = TAB.GetElements(params.rootElement, TAB.searchBy.customQuery, '.ms-ResizeGroup>.ms-CommandBar .ms-OverflowSet');
                return secondary && secondary.length > 1 ? secondary[1] : undefined;
            }
            return TAB.GetElement(params.rootElement, TAB.searchBy.hasClassName, 'CommandBar-sideArea');
    }
}
function verifyItems(params) {
    for (var i = 0; i < params.expected.length; i++) {
        // tslint:disable-next-line:no-any
        var expectedItem = params.expected[i];
        if (params.requireExactMatch) {
            verifyItem(params.actual, i, expectedItem);
        }
        else {
            // tslint:disable-next-line:no-any
            var item = getItem({ items: params.actual, expected: expectedItem });
            if (item) {
                TAB.Log.Pass("Verified expected command bar item \"" + expectedItem.title + "\"");
            }
            else if (expectedItem.isOptional && expectedItem.isOptional()) {
                TAB.Log.Warning("Did not find optional command bar item \"" + expectedItem.title + "\"");
            }
            else {
                throw "Did not find command bar item \"" + expectedItem.title + "\"";
            }
        }
    }
}
function getItem(params) {
    var _a = params.expected, title = _a.title, iconClassName = _a.iconClassName, automationId = _a.automationId;
    for (var _i = 0, _b = params.items; _i < _b.length; _i++) {
        var item = _b[_i];
        if (automationId && item.AutomationId && automationId === item.AutomationId) {
            // item match automation Id
            return item;
        }
        else if (title && isNameMatch(item.Title, title)) {
            if (iconClassName && item.IconClassName) {
                if (item.IconClassName.indexOf(iconClassName) >= 0) {
                    return item; // item matched expected title and icon
                }
                continue; // item matched expected title but not icon
            }
            return item; // item matched expected title and there was no icon to match
        }
        else if (!title) {
            if (!iconClassName || !item.IconClassName) {
                continue; // There wasn't a title to test, so we at least need an icon to test
            }
            if (item.IconClassName.indexOf(iconClassName) >= 0) {
                return item; // There wasn't a title to test, but the item did match the given icon
            }
        }
    }
    if (params.throwIfNotFound) {
        throw 'Command bar item not found: ' + (title || iconClassName);
    }
    return undefined;
}
function isNameMatch(actual, expected) {
    if (typeof expected === 'string') {
        if (expected.toUpperCase() === actual.toUpperCase()) {
            return true;
        }
    }
    else if (expected && !expected.test(actual)) {
        return true;
    }
    return false;
}
function verifyItem(items, index, expected) {
    var actual = items[index];
    if (!actual) {
        TAB.Log.Fail("Menu item \"" + expected.title + "\" not found at index " + index);
        return;
    }
    var itemTitle = actual.Title;
    if (typeof expected.title === 'string') {
        TAB.Log.VerifyEquals(itemTitle.toUpperCase(), expected.title.toUpperCase(), "Verified expected command bar item " + expected.title);
    }
    else {
        TAB.Log.Verify(expected.title.test(itemTitle), "Verified expected command bar item matching regex " + expected.title);
    }
}


/***/ }),

/***/ "Ckxo":
/*!*************************************!*\
  !*** ./lib/SPTaskLib/WebLibrary.js ***!
  \*************************************/
/*! exports provided: Web */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Web", function() { return Web; });
/* harmony import */ var _CsomUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CsomUtil */ "UXDa");

/**
 * @public
 */
var Web = /** @class */ (function () {
    function Web() {
    }
    Web.addCsomTaskGetCurrentUserFromWeb = function (userResult) {
        var currentUser;
        var retrieveWebUser = function () {
            var context = SP.ClientContext.get_current();
            var web = context.get_web();
            currentUser = web.get_currentUser();
            context.load(currentUser);
            return context;
        };
        var onRetriveUserSuccess = function () {
            userResult.loginName = currentUser.get_loginName();
            userResult.title = currentUser.get_title();
            userResult.email = currentUser.get_email();
            userResult.isSiteAdmin = currentUser.get_isSiteAdmin();
            userResult.id = currentUser.get_id();
        };
        var onRetrieveUserFailed = function () {
            TAB.Log.AddTaskFail('Failed to get current web user');
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(retrieveWebUser, onRetriveUserSuccess, onRetrieveUserFailed);
    };
    Web.addCsomTaskGetUserFromWeb = function (loginName, userResult) {
        var user;
        var retrieveWebUser = function () {
            var context = SP.ClientContext.get_current();
            var web = context.get_web();
            user = web.ensureUser(loginName);
            context.load(user);
            return context;
        };
        var onRetriveUserSuccess = function () {
            userResult.loginName = user.get_loginName();
            userResult.title = user.get_title();
            userResult.email = user.get_email();
            userResult.isSiteAdmin = user.get_isSiteAdmin();
            userResult.id = user.get_id();
        };
        var onRetrieveUserFailed = function () {
            TAB.Log.AddTaskFail("Failed to get web user with login name: " + loginName);
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(retrieveWebUser, onRetriveUserSuccess, onRetrieveUserFailed);
    };
    Web.addCsomTaskCheckReadOnly = function (serverUrl, result) {
        var spSite;
        var GetSPSite = function () {
            var context = new SP.ClientContext(serverUrl);
            spSite = context.get_site();
            context.load(spSite);
            return context;
        };
        var OnFailedGetSPSite = function () {
            TAB.Log.Fail('Failed to get site.');
        };
        var OnSuccessGetSPSite = function () {
            TAB.Log.Comment('Got site.');
            result.readOnly = !!spSite.get_readOnly();
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(GetSPSite, OnSuccessGetSPSite, OnFailedGetSPSite);
    };
    /**
     * Runs CSOM in the context of the test stub to unfollow a web.
     */
    Web.AddCsomUnfollowWeb = function (url, logFailure) {
        if (logFailure === void 0) { logFailure = false; }
        Web.addCsomTaskSetFollowStatus(url, false /*toFollow*/);
    };
    Web.addCsomTaskSetFollowStatus = function (url, toFollow, logFailure) {
        if (logFailure === void 0) { logFailure = false; }
        var followResult;
        var SetFollowStatus = function () {
            var context = SP.ClientContext.get_current();
            var profile = SP.UserProfiles.ProfileLoader.getProfileLoader(context).getUserProfile();
            var fc = profile.get_followedContent();
            if (toFollow) {
                followResult = fc.follow(url, undefined /*FollowedItemData*/);
            }
            else {
                fc.stopFollowing(url);
            }
            return context;
        };
        var OnFailedSetFollowStatus = function (sender, args) {
            var msg = "Failed to " + (toFollow ? 'follow' : 'unfollow') + " web at url: " + url + ", errorCode: " + args.get_errorCode() + ", errorMsg: " + args.get_message();
            if (logFailure) {
                TAB.Log.Fail(msg);
            }
            else {
                TAB.Log.Comment(msg);
            }
        };
        var OnSuccessSetFollowStatus = function () {
            if (toFollow) {
                var msg = 'Successfully followed web at url: ' + url;
                if (Boolean(followResult)) {
                    var resultType = followResult.get_resultType();
                    switch (resultType) {
                        case SP.UserProfiles.FollowResultType.followed:
                        case SP.UserProfiles.FollowResultType.refollowed:
                            // default msg
                            break;
                        case SP.UserProfiles.FollowResultType.hitFollowLimit:
                            msg = "Failed to followed web at url: " + url + ", hit follow limit";
                            break;
                        default:
                            msg = "Failed to followed web at url: " + url + ", unknown error";
                    }
                }
                TAB.Log.Comment(msg);
            }
            else {
                TAB.Log.Comment('Successfully unfollowed web at url: ' + url);
            }
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(SetFollowStatus, OnSuccessSetFollowStatus, OnFailedSetFollowStatus);
    };
    return Web;
}());



/***/ }),

/***/ "DM7Z":
/*!*******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/SitePermissionPanel.js ***!
  \*******************************************************/
/*! exports provided: SitePermissionPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SitePermissionPanel", function() { return SitePermissionPanel; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

/**
 * @public
 */
var SitePermissionPanel = /** @class */ (function () {
    function SitePermissionPanel() {
    }
    Object.defineProperty(SitePermissionPanel.prototype, "RootElement", {
        get: function () {
            return this._rootElement;
        },
        enumerable: true,
        configurable: true
    });
    SitePermissionPanel.WaitForPanel = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-SitePermPanel');
    };
    SitePermissionPanel.prototype.AddTaskLaunchSitePermissionPanelFromSuiteNav = function () {
        TAB.Log.AddTaskComment('Launching site permission panel...');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'O365_NavHeader'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Settings', TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nav-contextMenu'));
            TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_SubLink_SUITENAV_SITE_PERMISSIONS', SitePermissionPanel.WaitForPanel());
        }));
        this.SetRootElementForPanel();
    };
    SitePermissionPanel.prototype.AddTaskVerifyPersona = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying persona...');
        TAB.AddTask(TAB.MakeTask(function () {
            var sitePermBodys = _this.GetSitePermissionBodys();
            if (sitePermBodys && sitePermBodys.length > 0) {
                var persona_1 = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(sitePermBodys[0], 'SitePermissionsPersona');
                // If the persona is not opened, click site permission body button to open persona,
                // if it's already open, click site permission body button to close it.
                if (!persona_1) {
                    TAB.AddTaskClickElement(sitePermBodys[0], TAB.searchBy.customQuery, '[data-automationid="SitePermissionsBodyButton"]', TAB.WaitForElementToExist(sitePermBodys[0], TAB.searchBy.customQuery, '[data-automationid="SitePermissionsPersona"]'));
                    persona_1 = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(sitePermBodys[0], 'SitePermissionsPersona');
                    TAB.Log.Verify(Boolean(persona_1), 'The persona was verified.');
                }
                else {
                    TAB.AddTaskClickElement(sitePermBodys[0], TAB.searchBy.customQuery, '[data-automationid="SitePermissionsBodyButton"]', TAB.MakeWaiter(function () {
                        persona_1 = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(sitePermBodys[0], 'SitePermissionsPersona');
                        return Boolean(!persona_1);
                    }));
                    TAB.Log.Pass('The persona was verified.');
                }
            }
            else {
                TAB.Log.AddTaskFail('Failed to get sitePermBody.');
            }
        }));
    };
    SitePermissionPanel.prototype.AddTaskLaunchSitePermissionPanelDirectly = function () {
        TAB.Log.AddTaskComment('Launching site permission panel...');
        var sitePermPanelLaunchFunction = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            sitePermPanelLaunchFunction = TAB.Win.window['_spLaunchSitePermissions']; // tslint:disable-line:no-string-literal
            return Boolean(sitePermPanelLaunchFunction);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            sitePermPanelLaunchFunction();
        }), SitePermissionPanel.WaitForPanel());
        this.SetRootElementForPanel();
    };
    SitePermissionPanel.prototype.WaitForSitePermissionBody = function () {
        return TAB.WaitForElementToExist(this._rootElement, TAB.searchBy.customQuery, '[data-automationid="SitePermissionsBody"]');
    };
    SitePermissionPanel.prototype.GetSitePermissionBodyItemButtons = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(this._rootElement, 'SitePermissionsBodyButton');
    };
    SitePermissionPanel.prototype.GetContextMenuItems = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-item');
    };
    SitePermissionPanel.prototype.ClickInviteButton = function () {
        TAB.AddTaskClickElement(this._rootElement, TAB.searchBy.customQuery, '[data-automationid="SitePermissionsPanelInviteButton"]', TAB.MakeWaiter(function () {
            var contextMenuItems = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu');
            return Boolean(contextMenuItems.length !== 0);
        }));
    };
    SitePermissionPanel.prototype.DismissContextMenu = function () {
        TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.tag, 'body', TAB.MakeWaiter(function () {
            var contextMenu = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu');
            return Boolean(contextMenu.length === 0);
        }));
    };
    SitePermissionPanel.prototype.GetSitePermissionBodys = function (rootElement) {
        if (rootElement === void 0) { rootElement = this._rootElement; }
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(rootElement, 'SitePermissionsBody');
    };
    SitePermissionPanel.prototype.AddTaskDismissSitePermissionPanel = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Dismiss site permission panel...');
        TAB.AddTask(TAB.MakeTask(function () {
            // We just click this close button, but removed the waiter, because Phamton JS has issue with the waiter.
            TAB.AddTaskClickElement(_this._rootElement, TAB.searchBy.hasClassName, 'ms-Panel-closeButton');
            TAB.Log.Pass('Site permission panel was dismissed.');
        }));
    };
    SitePermissionPanel.prototype.GetElementTextContent = function (targetDataAutomationId, targetClassName) {
        if (!targetDataAutomationId && !targetClassName) {
            return undefined;
        }
        var targetElement = targetDataAutomationId
            ? _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._rootElement, targetDataAutomationId)
            : TAB.GetElement(this._rootElement, TAB.searchBy.hasClassName, targetClassName);
        return TAB.GetTextContent(targetElement);
    };
    SitePermissionPanel.prototype.SetRootElementForPanel = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._rootElement = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-SitePermPanel');
            TAB.Log.Pass('Site permission panel was successfully launched.');
        }));
    };
    return SitePermissionPanel;
}());



/***/ }),

/***/ "DSf6":
/*!*************************************************************!*\
  !*** ./lib/SPTaskLib/Mocks/MockTopicSuggestionsResponse.js ***!
  \*************************************************************/
/*! exports provided: MOCK_TOPIC_SUGGESTION_RESPONSE, MOCK_MYTOPICS_RESPONSE */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MOCK_TOPIC_SUGGESTION_RESPONSE", function() { return MOCK_TOPIC_SUGGESTION_RESPONSE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MOCK_MYTOPICS_RESPONSE", function() { return MOCK_MYTOPICS_RESPONSE; });
/**
 * @Copyright (c) Microsoft Corporation.  All rights reserved.
 */
var MOCK_TOPIC_SUGGESTION_RESPONSE = {
    value: [
        {
            EntityId: 'AL_dXgk91A4pPkFpyhGuFNxDA',
            Name: 'Planet Blue',
            Type: 'Project',
            Definition: 'Project Planet Blue addresses the global challenges we face, primarily those related to climate and environmental degradation. This initiative aims to achieve a better and more sustainable future for all.',
            RelatedPeople: [
                {
                    Upn: 'user0@test.onmicrosoft.com',
                    Name: 'Test User 0',
                    Email: 'user0@test.onmicrosoft.com',
                    OId: '00000000-0000-0000-0000-000000000000',
                    Description: undefined,
                    State: 'Mined',
                    AIReason: {
                        Count: 3
                    }
                },
                {
                    Upn: 'user1@test.onmicrosoft.com',
                    Name: 'Test User 1',
                    Email: 'user1@test.onmicrosoft.com',
                    OId: '00000000-0000-0000-0000-000000000001',
                    Description: undefined,
                    State: 'Mined',
                    AIReason: {
                        Count: 0
                    }
                }
            ],
            AlternateNames: [{ Name: 'Project Planet Blue', State: 'Mined' }]
        }
    ],
    isCachedResponse: false
};
var MOCK_MYTOPICS_RESPONSE = {
    CanEdit: true,
    Suggested: [],
    Established: [],
    Confirmed: []
};


/***/ }),

/***/ "E3+K":
/*!**********************************************************!*\
  !*** ./lib/SPTaskLib/Pages/ViewPortLoaderRichContent.js ***!
  \**********************************************************/
/*! exports provided: viewPortLoaderRichPageContent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "viewPortLoaderRichPageContent", function() { return viewPortLoaderRichPageContent; });
/**
 * It contains one dummy text web part,
 * 5 quick links web part in filmstrip layout,
 * and 1 Hero web part at the bottom of a separate canvas zone.
 * @internal
 */
// tslint:disable-next-line:export-name
var viewPortLoaderRichPageContent = [
    {
        controlType: 4,
        id: '0d561247-320a-49fb-932b-96e54dd0f25d',
        innerHTML: '<p>Some dummy content</p>',
        position: { zoneIndex: 1, sectionIndex: 1, controlIndex: 1, layoutIndex: 1 },
        emphasis: {}
    },
    {
        controlType: 3,
        id: '91483d17-74a8-420a-85b8-e9a0377e315e',
        position: { zoneIndex: 1, sectionIndex: 1, controlIndex: 2, layoutIndex: 1 },
        webPartId: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
        webPartData: {
            id: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
            instanceId: '91483d17-74a8-420a-85b8-e9a0377e315e',
            title: 'Quick links',
            description: 'Add links to important documents and pages.',
            serverProcessedContent: {
                htmlStrings: {},
                searchablePlainTexts: { 'items[0].title': 'Happy Hobbit Day' },
                imageSources: {
                    'items[0].rawPreviewImageUrl': 'https://www.bing.com/th?id=OHR.Matamata_EN-US3735598473_tmb.jpg&rf='
                },
                links: { 'items[0].sourceItem.url': 'https://bing.com' },
                componentDependencies: { layoutComponentId: '706e33c8-af37-4e7b-9d22-6e5694d92a6f' },
                customMetadata: { 'items[0].rawPreviewImageUrl': { fixedWidth: 100, minCanvasWidth: 32767 } }
            },
            dataVersion: '2.2',
            properties: {
                items: [
                    {
                        sourceItem: { itemType: 2, fileExtension: '', progId: '' },
                        thumbnailType: 3,
                        id: 1,
                        description: '',
                        altText: '',
                        rawPreviewImageMinCanvasWidth: 32767
                    }
                ],
                isMigrated: true,
                layoutId: 'FilmStrip',
                shouldShowThumbnail: true,
                imageWidth: 100,
                buttonLayoutOptions: {
                    showDescription: false,
                    buttonTreatment: 2,
                    iconPositionType: 2,
                    textAlignmentVertical: 2,
                    textAlignmentHorizontal: 2,
                    linesOfText: 2
                },
                listLayoutOptions: { showDescription: false, showIcon: true },
                waffleLayoutOptions: { iconSize: 1, onlyShowThumbnail: false },
                hideWebPartWhenEmpty: true,
                dataProviderId: 'QuickLinks',
                webId: '460208e8-e7a3-4970-9482-79ecaf33e710',
                siteId: 'e41016eb-ce1d-47b1-91e8-892969277f17'
            }
        },
        emphasis: {},
        reservedHeight: 141,
        reservedWidth: 1018,
        addedFromPersistedData: true
    },
    {
        controlType: 3,
        id: 'a46a7417-3bd5-4678-b6ec-27a8ed30638e',
        position: { zoneIndex: 1, sectionIndex: 1, controlIndex: 2.0625, layoutIndex: 1 },
        webPartId: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
        webPartData: {
            id: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
            instanceId: 'a46a7417-3bd5-4678-b6ec-27a8ed30638e',
            title: 'Quick links',
            description: 'Add links to important documents and pages.',
            serverProcessedContent: {
                htmlStrings: {},
                searchablePlainTexts: { 'items[0].title': 'Happy Hobbit Day' },
                imageSources: {
                    'items[0].rawPreviewImageUrl': 'https://www.bing.com/th?id=OHR.Matamata_EN-US3735598473_tmb.jpg&rf='
                },
                links: { 'items[0].sourceItem.url': 'https://bing.com' },
                componentDependencies: { layoutComponentId: '706e33c8-af37-4e7b-9d22-6e5694d92a6f' },
                customMetadata: { 'items[0].rawPreviewImageUrl': { fixedWidth: 100, minCanvasWidth: 32767 } }
            },
            dataVersion: '2.2',
            properties: {
                items: [
                    {
                        sourceItem: { itemType: 2, fileExtension: '', progId: '' },
                        thumbnailType: 3,
                        id: 1,
                        description: '',
                        altText: '',
                        rawPreviewImageMinCanvasWidth: 32767
                    }
                ],
                isMigrated: true,
                layoutId: 'FilmStrip',
                shouldShowThumbnail: true,
                imageWidth: 100,
                buttonLayoutOptions: {
                    showDescription: false,
                    buttonTreatment: 2,
                    iconPositionType: 2,
                    textAlignmentVertical: 2,
                    textAlignmentHorizontal: 2,
                    linesOfText: 2
                },
                listLayoutOptions: { showDescription: false, showIcon: true },
                waffleLayoutOptions: { iconSize: 1, onlyShowThumbnail: false },
                hideWebPartWhenEmpty: true,
                dataProviderId: 'QuickLinks',
                webId: '460208e8-e7a3-4970-9482-79ecaf33e710',
                siteId: 'e41016eb-ce1d-47b1-91e8-892969277f17'
            }
        },
        emphasis: {},
        reservedHeight: 141,
        reservedWidth: 1018,
        addedFromPersistedData: true
    },
    {
        controlType: 3,
        id: '76d7c936-a3a9-4fb4-8a4d-aed6e57c172f',
        position: { zoneIndex: 1, sectionIndex: 1, controlIndex: 2.125, layoutIndex: 1 },
        webPartId: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
        webPartData: {
            id: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
            instanceId: '76d7c936-a3a9-4fb4-8a4d-aed6e57c172f',
            title: 'Quick links',
            description: 'Add links to important documents and pages.',
            serverProcessedContent: {
                htmlStrings: {},
                searchablePlainTexts: { 'items[0].title': 'Happy Hobbit Day' },
                imageSources: {
                    'items[0].rawPreviewImageUrl': 'https://www.bing.com/th?id=OHR.Matamata_EN-US3735598473_tmb.jpg&rf='
                },
                links: { 'items[0].sourceItem.url': 'https://bing.com' },
                componentDependencies: { layoutComponentId: '706e33c8-af37-4e7b-9d22-6e5694d92a6f' },
                customMetadata: { 'items[0].rawPreviewImageUrl': { fixedWidth: 100, minCanvasWidth: 32767 } }
            },
            dataVersion: '2.2',
            properties: {
                items: [
                    {
                        sourceItem: { itemType: 2, fileExtension: '', progId: '' },
                        thumbnailType: 3,
                        id: 1,
                        description: '',
                        altText: '',
                        rawPreviewImageMinCanvasWidth: 32767
                    }
                ],
                isMigrated: true,
                layoutId: 'FilmStrip',
                shouldShowThumbnail: true,
                imageWidth: 100,
                buttonLayoutOptions: {
                    showDescription: false,
                    buttonTreatment: 2,
                    iconPositionType: 2,
                    textAlignmentVertical: 2,
                    textAlignmentHorizontal: 2,
                    linesOfText: 2
                },
                listLayoutOptions: { showDescription: false, showIcon: true },
                waffleLayoutOptions: { iconSize: 1, onlyShowThumbnail: false },
                hideWebPartWhenEmpty: true,
                dataProviderId: 'QuickLinks',
                webId: '460208e8-e7a3-4970-9482-79ecaf33e710',
                siteId: 'e41016eb-ce1d-47b1-91e8-892969277f17'
            }
        },
        emphasis: {},
        reservedHeight: 141,
        reservedWidth: 1018,
        addedFromPersistedData: true
    },
    {
        controlType: 3,
        id: '73b126f4-9d76-4c93-b934-4fa6caf3414b',
        position: { zoneIndex: 1, sectionIndex: 1, controlIndex: 2.25, layoutIndex: 1 },
        webPartId: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
        webPartData: {
            id: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
            instanceId: '73b126f4-9d76-4c93-b934-4fa6caf3414b',
            title: 'Quick links',
            description: 'Add links to important documents and pages.',
            serverProcessedContent: {
                htmlStrings: {},
                searchablePlainTexts: { 'items[0].title': 'Happy Hobbit Day' },
                imageSources: {
                    'items[0].rawPreviewImageUrl': 'https://www.bing.com/th?id=OHR.Matamata_EN-US3735598473_tmb.jpg&rf='
                },
                links: { 'items[0].sourceItem.url': 'https://bing.com' },
                componentDependencies: { layoutComponentId: '706e33c8-af37-4e7b-9d22-6e5694d92a6f' },
                customMetadata: { 'items[0].rawPreviewImageUrl': { fixedWidth: 100, minCanvasWidth: 32767 } }
            },
            dataVersion: '2.2',
            properties: {
                items: [
                    {
                        sourceItem: { itemType: 2, fileExtension: '', progId: '' },
                        thumbnailType: 3,
                        id: 1,
                        description: '',
                        altText: '',
                        rawPreviewImageMinCanvasWidth: 32767
                    }
                ],
                isMigrated: true,
                layoutId: 'FilmStrip',
                shouldShowThumbnail: true,
                imageWidth: 100,
                buttonLayoutOptions: {
                    showDescription: false,
                    buttonTreatment: 2,
                    iconPositionType: 2,
                    textAlignmentVertical: 2,
                    textAlignmentHorizontal: 2,
                    linesOfText: 2
                },
                listLayoutOptions: { showDescription: false, showIcon: true },
                waffleLayoutOptions: { iconSize: 1, onlyShowThumbnail: false },
                hideWebPartWhenEmpty: true,
                dataProviderId: 'QuickLinks',
                webId: '460208e8-e7a3-4970-9482-79ecaf33e710',
                siteId: 'e41016eb-ce1d-47b1-91e8-892969277f17'
            }
        },
        emphasis: {},
        reservedHeight: 141,
        reservedWidth: 1018,
        addedFromPersistedData: true
    },
    {
        controlType: 3,
        id: 'ed52067c-2705-44b2-b0e5-af25efe99c81',
        position: { zoneIndex: 1, sectionIndex: 1, controlIndex: 2.5, layoutIndex: 1 },
        webPartId: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
        webPartData: {
            id: 'c70391ea-0b10-4ee9-b2b4-006d3fcad0cd',
            instanceId: 'ed52067c-2705-44b2-b0e5-af25efe99c81',
            title: 'Quick links',
            description: 'Add links to important documents and pages.',
            serverProcessedContent: {
                htmlStrings: {},
                searchablePlainTexts: { 'items[0].title': 'Happy Hobbit Day' },
                imageSources: {
                    'items[0].rawPreviewImageUrl': 'https://www.bing.com/th?id=OHR.Matamata_EN-US3735598473_tmb.jpg&rf='
                },
                links: { 'items[0].sourceItem.url': 'https://bing.com' },
                componentDependencies: { layoutComponentId: '706e33c8-af37-4e7b-9d22-6e5694d92a6f' },
                customMetadata: { 'items[0].rawPreviewImageUrl': { fixedWidth: 100, minCanvasWidth: 32767 } }
            },
            dataVersion: '2.2',
            properties: {
                items: [
                    {
                        sourceItem: { itemType: 2, fileExtension: '', progId: '' },
                        thumbnailType: 3,
                        id: 1,
                        description: '',
                        altText: '',
                        rawPreviewImageMinCanvasWidth: 32767
                    }
                ],
                isMigrated: true,
                layoutId: 'FilmStrip',
                shouldShowThumbnail: true,
                imageWidth: 100,
                buttonLayoutOptions: {
                    showDescription: false,
                    buttonTreatment: 2,
                    iconPositionType: 2,
                    textAlignmentVertical: 2,
                    textAlignmentHorizontal: 2,
                    linesOfText: 2
                },
                listLayoutOptions: { showDescription: false, showIcon: true },
                waffleLayoutOptions: { iconSize: 1, onlyShowThumbnail: false },
                hideWebPartWhenEmpty: true,
                dataProviderId: 'QuickLinks',
                webId: '460208e8-e7a3-4970-9482-79ecaf33e710',
                siteId: 'e41016eb-ce1d-47b1-91e8-892969277f17'
            }
        },
        emphasis: {},
        reservedHeight: 141,
        reservedWidth: 1018,
        addedFromPersistedData: true
    },
    {
        controlType: 3,
        id: 'a640d9d3-634a-462d-8f56-b0c7723a9613',
        position: { zoneIndex: 2, sectionIndex: 1, controlIndex: 1, layoutIndex: 1 },
        webPartId: 'c4bd7b2f-7b6e-4599-8485-16504575f590',
        webPartData: {
            id: 'c4bd7b2f-7b6e-4599-8485-16504575f590',
            instanceId: 'a640d9d3-634a-462d-8f56-b0c7723a9613',
            title: 'Hero',
            description: 'Prominently display up to 5 pieces of content in a highly visual layout',
            serverProcessedContent: {
                htmlStrings: {},
                searchablePlainTexts: { 'content[0].callToActionText': 'Learn more' },
                imageSources: { 'content[0].previewImage.url': 'https://bing.com' },
                links: { 'content[0].link': 'https://bing.com' },
                customMetadata: {
                    'content[0].previewImage.url': {
                        renderWidthRatio: 0.5,
                        renderWidthRatioThreshold: 640,
                        minCanvasWidth: 1
                    },
                    heroLayoutComponentId: { minCanvasWidth: 640 },
                    carouselLayoutComponentId: { maxCanvasWidth: 639 }
                },
                componentDependencies: {
                    heroLayoutComponentId: '9586b262-54de-4b27-9eb9-34c671400c33',
                    carouselLayoutComponentId: '8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027'
                }
            },
            dataVersion: '1.5',
            properties: {
                heroLayoutThreshold: 640,
                carouselLayoutMaxWidth: 639,
                layoutCategory: 1,
                layout: 5,
                content: [
                    {
                        id: '31fac16a-b291-4713-8d45-63a2831746ab',
                        type: 'UrlLink',
                        color: 4,
                        description: '',
                        title: '',
                        showDescription: false,
                        showTitle: true,
                        alternateText: '',
                        imageDisplayOption: 1,
                        isDefaultImage: false,
                        showCallToAction: true,
                        isDefaultImageLoaded: true,
                        isCustomImageLoaded: false,
                        showFeatureText: false,
                        previewImage: {
                            zoomRatio: 1,
                            imageUrl: 'https://www.bing.com/th?id=OHR.Matamata_EN-US3735598473_tmb.jpg&rf=',
                            widthFactor: 0.5,
                            minCanvasWidth: 1
                        }
                    },
                    {
                        id: 'efce5c6f-9c13-4f3d-94a7-284703f6a8a2',
                        type: 'Image',
                        color: 4,
                        description: '',
                        title: '',
                        showDescription: false,
                        showTitle: true,
                        alternateText: '',
                        imageDisplayOption: 0,
                        isDefaultImage: false,
                        showCallToAction: false,
                        isDefaultImageLoaded: false,
                        isCustomImageLoaded: false,
                        showFeatureText: false
                    },
                    {
                        id: 'ddfa871c-2a66-4396-be9b-409e179d8f93',
                        type: 'Image',
                        color: 4,
                        description: '',
                        title: '',
                        showDescription: false,
                        showTitle: true,
                        alternateText: '',
                        imageDisplayOption: 0,
                        isDefaultImage: false,
                        showCallToAction: false,
                        isDefaultImageLoaded: false,
                        isCustomImageLoaded: false,
                        showFeatureText: false
                    },
                    {
                        id: '4b02b238-c16b-498c-9e32-29e65f333242',
                        type: 'Image',
                        color: 4,
                        description: '',
                        title: '',
                        showDescription: false,
                        showTitle: true,
                        alternateText: '',
                        imageDisplayOption: 0,
                        isDefaultImage: false,
                        showCallToAction: false,
                        isDefaultImageLoaded: false,
                        isCustomImageLoaded: false,
                        showFeatureText: false
                    },
                    {
                        id: 'eac6da1e-49ef-40af-a66c-5b227672ce08',
                        type: 'Image',
                        color: 4,
                        description: '',
                        title: '',
                        showDescription: false,
                        showTitle: true,
                        alternateText: '',
                        imageDisplayOption: 0,
                        isDefaultImage: false,
                        showCallToAction: false,
                        isDefaultImageLoaded: false,
                        isCustomImageLoaded: false,
                        showFeatureText: false
                    }
                ]
            }
        },
        emphasis: {},
        reservedHeight: 400,
        reservedWidth: 678,
        addedFromPersistedData: true
    },
    { controlType: 0, pageSettingsSlice: { isDefaultDescription: true, isDefaultThumbnail: true } }
];


/***/ }),

/***/ "EfLR":
/*!**************************************************************!*\
  !*** ./lib/SPTaskLib/Controls/DynamicDataConsumerWebPart.js ***!
  \**************************************************************/
/*! exports provided: DynamicDataConsumerWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicDataConsumerWebPart", function() { return DynamicDataConsumerWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/PropertyPane */ "M/CL");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");





/**
 * @public
 */
var DynamicDataConsumerWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(DynamicDataConsumerWebPart, _super);
    function DynamicDataConsumerWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_4__["WebpartType"].DynamicDataStaticConsumer, _BaseWebpart__WEBPACK_IMPORTED_MODULE_4__["WebpartType"].DynamicDataStaticConsumer.toString()) || this;
    }
    DynamicDataConsumerWebPart.prototype.AddTaskSetDynamicDataSource = function (sourceValue) {
        TAB.Log.AddTaskComment('Adding dynamic data web part to the page.');
        this.addWebPartToPage();
        TAB.Log.AddTaskComment('Setting up dynamic data web part through the property pane.');
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_2__["PropertyPane"].AddTaskOpenPropertyPane();
        TAB.AddTask(undefined, this.WaitForDynamicDataPropertyPane());
        TAB.Log.AddTaskComment('Property pane for the dynamic data web part open.');
        TAB.AddTask(TAB.MakeTask(function () {
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var sourceInput = TAB.GetElement(propertyPane, TAB.searchBy.tag, 'input'); // tslint:disable-line:max-line-length
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(sourceInput, sourceValue);
        }), this.WaitForDynamicDataRendering());
        TAB.Log.AddTaskComment('Closing property pane for the dynamic data web part.');
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_2__["PropertyPane"].AddTaskClosePropertyPane();
    };
    DynamicDataConsumerWebPart.prototype.WaitForDynamicDataPropertyPane = function () {
        return TAB.MakeWaiter(function () {
            var propertyPane = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            if (!!propertyPane && !!propertyPane[0]) {
                var sourceInput = TAB.GetElements(propertyPane[0], TAB.searchBy.tag, 'input'); // tslint:disable-line:max-line-length
                return !!sourceInput && !!sourceInput[0];
            }
            return false;
        });
    };
    DynamicDataConsumerWebPart.prototype.WaitForDynamicDataRendering = function () {
        var _this = this;
        return TAB.AndWaiters(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'dynamicDataValue'), TAB.MakeWaiter(function () {
            return !!_this.GetDynamicDataValue();
        }));
    };
    DynamicDataConsumerWebPart.prototype.GetDynamicDataValue = function () {
        var element = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'dynamicDataValue'); // tslint:disable-line:max-line-length no-any
        return element ? element.textContent : undefined;
    };
    return DynamicDataConsumerWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_4__["BaseWebpart"]));



/***/ }),

/***/ "FN+G":
/*!*************************************!*\
  !*** ./lib/SPTaskLib/DocLibUtil.js ***!
  \*************************************/
/*! exports provided: DocLibUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocLibUtil", function() { return DocLibUtil; });
var NAVBAR_CLASS_NAME = 'ms-HorizontalNav ';
var NAVBAR_ITEM_CLASS_NAME = 'ms-HorizontalNavItem-link';
var LEFT_NAV_GROUPS = 'LeftNavGroups';
/**
 * @public
 */
var DocLibUtil = /** @class */ (function () {
    function DocLibUtil() {
    }
    DocLibUtil.AddTaskClickDocLibFromHeader = function (docLibIndex, docLibTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("DocLibUtil.AddTaskClickDocLibFromHeader(): link to '" + docLibTitle + "' Document Library to be clicked from navigation bar");
            var navBar = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.partialClassName, NAVBAR_CLASS_NAME);
            var navBarElements = TAB.GetElements(navBar, TAB.searchBy.partialClassName, NAVBAR_ITEM_CLASS_NAME);
            TAB.ClickElement(navBarElements[docLibIndex]);
        })
            .WaitFor(TAB.WaitForElementToExist(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='TitleSpan']"))
            .WaitFor(TAB.MakeWaiter(function () {
            try {
                var docLibTitleElem = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='TitleSpan']");
                if (docLibTitleElem.innerHTML === docLibTitle) {
                    return true;
                }
                else {
                    return false;
                }
            }
            catch (e) {
                TAB.Log.Fail("DocLibUtil: Exception encountered in AddTaskClickDocLibFromHeader().");
                return false;
            }
        })));
    };
    DocLibUtil.AddTaskClickDocLibFromLeftNav = function (docLibUrl, docLibTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("DocLibUtil.AddTaskClickDocLibFromLeftNav(): link to '" + docLibTitle + "' Document Library to be clicked from navigation bar");
            var leftNavGroups = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='" + LEFT_NAV_GROUPS + "']");
            /**
             * Ideally there will be only one doclib node of each type present on the left-nav, but sometimes we may find multiple
             * entries of the same node get added accidentally to the left-nav of a tenant's site. For such cases, we are using
             * GetElements, otherwise the TAB test will always fail on that tenant, unless the additional node is manually removed.
             */
            var doclibElement = TAB.GetElements(leftNavGroups, TAB.searchBy.partialHref, docLibUrl);
            TAB.ClickElement(doclibElement[0]);
        })
            .WaitFor(TAB.WaitForElementToExist(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='TitleSpan']"))
            .WaitFor(TAB.MakeWaiter(function () {
            try {
                var docLibTitleElem = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='TitleSpan']");
                if (docLibTitleElem.innerHTML === docLibTitle) {
                    return true;
                }
                else {
                    return false;
                }
            }
            catch (e) {
                TAB.Log.Fail("DocLibUtil: Exception encountered in AddTaskClickDocLibFromLeftNav().");
                return false;
            }
        })));
    };
    return DocLibUtil;
}());



/***/ }),

/***/ "FRLz":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Utilities/PageAnchor.js ***!
  \***********************************************/
/*! exports provided: PageAnchor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageAnchor", function() { return PageAnchor; });
/* harmony import */ var _ListLibrary__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ListLibrary */ "7on5");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Controls_RTEWebPart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Controls/RTEWebPart */ "mXly");



/**
 * @public
 */
var PageAnchor = /** @class */ (function () {
    function PageAnchor() {
    }
    PageAnchor.addTaskAddHeadingTextToPage = function (text, ariaLevel) {
        TAB.MakeTask(function () {
            TAB.Log.Comment("Create text web part and insert h" + ariaLevel + " text inside.");
            var rteWebPart = new _Controls_RTEWebPart__WEBPACK_IMPORTED_MODULE_2__["RTEWebPart"]();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_1__["Canvas"].AddTaskCreateWebPart(rteWebPart);
            rteWebPart.AddTaskToAddTextInRTE(text);
            rteWebPart.AddTaskToSelectTextInRTE(0, text.length);
            rteWebPart.AddTaskToClickOnFormattingBarButton("h" + ariaLevel + "-button", "h" + ariaLevel);
        }).WaitFor(undefined);
    };
    PageAnchor.addTaskTestClickAnchorsOfAllHeadings = function () {
        TAB.MakeTask(function () {
            TAB.Log.Comment("Wait for headings anchor to be rendered");
        }).WaitFor(TAB.MakeWaiter(function () {
            var anchoredHeadings = PageAnchor.getHeadingElements();
            var result = true;
            anchoredHeadings.forEach(function (heading) {
                try {
                    if (result && !Boolean(TAB.GetElement(heading, TAB.searchBy.tag, 'a[data-sp-anchor-id]'))) {
                        result = false;
                    }
                }
                catch (e) {
                    TAB.Log.Comment('Contains Error');
                }
            });
            return result;
        }));
        TAB.MakeTask(function () {
            TAB.Log.Comment("Click anchors of all headings on page and check if they are scrolled into view.");
            var anchoredHeadings = PageAnchor.getHeadingElements();
            anchoredHeadings.forEach(function (heading) {
                PageAnchor.addTaskClickAnchorIconOfHeading(heading);
            });
        }).WaitFor(undefined);
    };
    PageAnchor.addTaskClickAnchorIconOfHeading = function (headingElement) {
        TAB.MakeTask(function () {
            TAB.Log.Comment('Test clicking anchored element.');
            var anchorElement = TAB.GetElement(headingElement, TAB.searchBy.tag, 'a[data-sp-anchor-id]');
            if (!anchorElement) {
                throw 'No anchor icon is generated inside the heading element.';
            }
            TAB.ClickElement(anchorElement);
        }).WaitFor(PageAnchor._inViewPort());
    };
    PageAnchor.addTaskScrollPageDownBy = function (amountInPixel) {
        TAB.MakeTask(function () {
            TAB.Log.Comment("Scroll page body down by " + amountInPixel + " pixels.");
            var scrollableBody = PageAnchor._getPageScrollableBody();
            if (!scrollableBody) {
                throw 'Fail to get scrollable page body.';
            }
            scrollableBody.scrollBy(0, amountInPixel);
        }).WaitFor(undefined);
    };
    PageAnchor.addTaskDeletePageByUrl = function (getUrl) {
        TAB.MakeTask(function () {
            var pageUrl = getUrl().split('#', 1)[0].split('?', 1)[0];
            var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
            pageUrl = pageUrl.substr(rootSiteUrl.length);
            _ListLibrary__WEBPACK_IMPORTED_MODULE_0__["List"].addRestTaskDeleteItem(rootSiteUrl, rootSiteUrl, pageUrl);
        }).WaitFor(undefined);
    };
    PageAnchor.anchorFromPageUrlInViewPort = function () {
        return TAB.MakeWaiter(function () {
            var pageUrl = TAB.Win.location.href;
            var fragmentIndex = pageUrl.indexOf('#');
            if (!fragmentIndex) {
                return false;
            }
            var fragment = decodeURIComponent(pageUrl.substring(fragmentIndex + 1));
            try {
                var anchoredHeading = PageAnchor._getAnchorByAnchorId(fragment).parentElement;
                return PageAnchor._isElementInViewPort(anchoredHeading);
            }
            catch (error) {
                return false;
            }
        });
    };
    PageAnchor.anchorsReady = function (count) {
        return TAB.MakeWaiter(function () {
            var anchorElements = TAB.GetElements(TAB.Win, TAB.searchBy.tag, 'a[data-sp-anchor-id]');
            return anchorElements.length === count;
        });
    };
    PageAnchor.getHeadingElements = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="textBox"] h2, [data-automation-id="textBox"] h3, [data-automation-id="textBox"] h4');
    };
    PageAnchor._inViewPort = function () {
        return TAB.MakeWaiter(function () {
            var anchorId = TAB.Win.window.location.href.split('#')[1];
            var elements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-sp-anchor-id=\"" + anchorId + "\"]");
            if (elements.length === 0) {
                return false;
            }
            return PageAnchor._isElementInViewPort(elements[0].parentElement);
        });
    };
    PageAnchor._getAnchorByAnchorId = function (anchorId) {
        try {
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-sp-anchor-id = \"" + anchorId + "\"]");
        }
        catch (error) {
            return undefined;
        }
    };
    PageAnchor._isElementInViewPort = function (element) {
        var scrollableParent = PageAnchor._getPageScrollableBody();
        if (!scrollableParent) {
            return false;
        }
        var elementRect = element.getBoundingClientRect();
        var parentRect = scrollableParent.getBoundingClientRect();
        // +1 or -1 used for avoiding float result.
        var belowTopOfScroll = elementRect.top >= parentRect.top - 1;
        var aboveBottomOfScroll = elementRect.top < parentRect.top + parentRect.height + 1;
        return belowTopOfScroll && aboveBottomOfScroll;
    };
    PageAnchor._getPageScrollableBody = function () {
        try {
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-is-scrollable = "true"]');
        }
        catch (error) {
            return undefined;
        }
    };
    return PageAnchor;
}());



/***/ }),

/***/ "FSRG":
/*!***************************************!*\
  !*** ./lib/SPTaskLib/GroupLibrary.js ***!
  \***************************************/
/*! exports provided: Group */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Group", function() { return Group; });
/* harmony import */ var _CsomUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CsomUtil */ "UXDa");
/* harmony import */ var _WebLibrary__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./WebLibrary */ "Ckxo");
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PageUtil */ "jK1H");



/**
 * @public
 */
var Group = /** @class */ (function () {
    function Group() {
    }
    /**
     * Creates a Group site
     * Ported from SPORel //depot/devmainoverride/sporel/sptasklib/Browser/Libraries/groupslibrary.jss
     */
    Group.AddCsomTaskCreateGroup = function (serverUrl, groupAlias, groupDisplayName, handler, groupDescription, groupPictureUrl, groupMemberIds, groupOwnersIds, isPublic, ignoreCommitFailure) {
        var group;
        var createGroup = function () {
            var clientContext = new SP.ClientContext(serverUrl);
            var session = new SP.Directory.DirectorySession(clientContext);
            group = session.createGroup();
            group.set_alias(groupAlias);
            group.set_principalName(groupAlias);
            group.set_displayName(groupDisplayName);
            // Because isPublic is a boolean, check for undefined and undefined explicitly
            if (typeof isPublic !== 'undefined' && isPublic !== undefined) {
                group.set_isPublic(isPublic);
            }
            if (groupDescription) {
                group.set_description(groupDescription);
            }
            if (groupMemberIds) {
                for (var i = 0; i < groupMemberIds.length; i++) {
                    group.get_members().add(groupMemberIds[i].get_value());
                }
            }
            if (groupOwnersIds) {
                for (var i = 0; i < groupOwnersIds.length; i++) {
                    group.get_owners().add(groupOwnersIds[i].get_value());
                }
            }
            group.commit(true);
            clientContext.load(group);
            clientContext.load(group.get_members());
            clientContext.load(group.get_owners());
            return clientContext;
        };
        var onSucceededCreateGroup = function () {
            if (group && group.get_alias() === groupAlias) {
                TAB.Log.Comment("Group with the alias: " + groupAlias + " is created.");
                handler(group);
            }
            else {
                TAB.Log.Fail('Group creation via CSOM failed.');
            }
        };
        var onFailedCreateGroup = function (sender, args) {
            TAB.Log.Fail("Group creation via CSOM failed: " + args.get_message());
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(createGroup, onSucceededCreateGroup, onFailedCreateGroup);
    };
    /**
     * Checks for the existence of a group with the given alias and sets result.groupExists to true or false accordingly.
     * Ported with modifications from SPORel //depot/devmainoverride/sporel/sptasklib/Browser/Libraries/groupslibrary.jss
     */
    Group.AddCsomTaskVerifyGroupCreated = function (serverUrl, groupAlias, result) {
        var exists;
        var verifyGroupExists = function () {
            var clientContext = new SP.ClientContext(serverUrl);
            var session = new SP.Directory.DirectorySession(clientContext);
            exists = session.groupExists('Alias', groupAlias);
            return clientContext;
        };
        var onSuccessVerifyGroupExists = function () {
            if (exists.get_value()) {
                TAB.Log.Comment("Group with the name: " + groupAlias + " exists");
                result.groupExists = true;
            }
            else {
                TAB.Log.Comment("Group with the name: " + groupAlias + " does not exist");
                result.groupExists = false;
            }
        };
        var onFailureVerifyGroupExists = function (sender, args) {
            TAB.Log.Comment("VerifyGroupExists: Cannot verify group exists using CSOM: " + args.get_message());
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(verifyGroupExists, onSuccessVerifyGroupExists, onFailureVerifyGroupExists);
    };
    Group.AddCsomTaskRemoveGroup = function (serverUrl, groupId) {
        var removeGroup = function () {
            var clientContext = new SP.ClientContext(serverUrl);
            var session = new SP.Directory.DirectorySession(clientContext);
            session.removeGroup(groupId);
            return clientContext;
        };
        var onSucceededRemoveGroup = function () {
            TAB.Log.Comment("Successfully removed group with Id: " + groupId);
        };
        var onFailedRemoveGroup = function (sender, args) {
            TAB.Log.Fail("Failed to remove group with Id: " + groupId + ": " + args.get_message() + ", stack: " + args.get_stackTrace());
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(removeGroup, onSucceededRemoveGroup, onFailedRemoveGroup);
    };
    Group.AddCsomTaskGetUserIds = function (userLoginNames, callback, failedCallback) {
        var userIds = new Array(userLoginNames.length);
        var getUserIds = function () {
            var clientContext = new SP.ClientContext(TAB.Settings.Get('ProductServer'));
            var session = new SP.Directory.DirectorySession(clientContext);
            for (var i = 0; i < userLoginNames.length; i++) {
                userIds[i] = session.getUserId('PrincipalName', userLoginNames[i]);
            }
            return clientContext;
        };
        var onSuccessGetUserIds = function () {
            for (var i = 0; i < userIds.length; i++) {
                TAB.Log.Verify(userIds[i] !== undefined &&
                    userIds[i].get_value() !== undefined &&
                    SP.Guid.get_empty().toString('B') !== userIds[i].get_value().toString('B'), 'Verifying valid user id is found for user: ' + userLoginNames[i]);
            }
            callback(userIds);
        };
        var onFailureGetUserIds = function (sender, args) {
            if (!failedCallback) {
                TAB.Log.Fail('GetUserIds: Cannot get user ids using CSOM: ' + args.get_message());
            }
            else {
                failedCallback();
            }
        };
        _CsomUtil__WEBPACK_IMPORTED_MODULE_0__["Csom"].AddTask(getUserIds, onSuccessGetUserIds, onFailureGetUserIds);
    };
    Group.TestGroupSetup = function (groupCreationParams) {
        var _this = this;
        // Check if the test group site exists. If not, create it. Otherwise, use the existing site.
        TAB.Log.AddTaskComment("Checking if the test group with alias '" + groupCreationParams.groupAlias + "' exists.");
        var groupExistsResult = {
            // tslint:disable-line:no-any
            groupExists: undefined
        };
        Group.AddCsomTaskVerifyGroupCreated(groupCreationParams.serverUrl, groupCreationParams.groupAlias, groupExistsResult);
        TAB.AddTask(TAB.MakeTask(function () {
            if (groupExistsResult.groupExists || groupExistsResult.groupExists === undefined) {
                // If the group was confirmed to exist or the verification failed to determine existence, assume the group exists.
                // Unfortunately, AddCsomTaskVerifyGroupCreated can be flaky, but the most likely case is that the group exists.
                // groupExistsResult.groupExists will be true if group exists, false if group does not exist, undefined if failed to determine.
                TAB.Log.AddTaskComment("Using existing test group with alias '" + groupCreationParams.groupAlias + "'.");
                _this._addTaskUseExistingTestGroup(groupCreationParams);
            }
            else {
                // Provisioning a new group site can take awhile, so increase the timeout if we need to do that, and the group is only created
                // in the first test run while in a new environment.
                TAB.SetWaitTime(2 * 60 * 1000); // 2 minute timeout
                TAB.Log.AddTaskComment("Creating test group with alias '" + groupCreationParams.groupAlias + "'.");
                _this._addTaskCreateNewTestGroup(groupCreationParams);
            }
        }));
    };
    /**
     * This method checks AAD service availability thougth a simple csom call AddCsomTaskGetUserIds, if the user ids is obtained,
     * then AAD service available, otherwise, it's not available.
     * @param result - AAD service validation result, which contains isAADServiceAvailable and userIds.
     */
    Group.AddCsomTaskCheckAADServiceAvailability = function (result) {
        var userResult = {};
        var getUserIdsCallBack = function (foundMemberIds) {
            result.isAADServiceAvailable = true;
            result.userIds = foundMemberIds;
            TAB.Log.Pass('AAD Service is available.');
        };
        var getUserIdsFailedCallback = function () {
            result.isAADServiceAvailable = false;
            TAB.Log.AddTaskComment('AAD Service is not available.');
        };
        TAB.AddTask(TAB.MakeTask(function () {
            _WebLibrary__WEBPACK_IMPORTED_MODULE_1__["Web"].addCsomTaskGetCurrentUserFromWeb(userResult);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            Group.AddCsomTaskGetUserIds([userResult.loginName], getUserIdsCallBack, getUserIdsFailedCallback);
        }));
    };
    Group._addTaskCreateNewTestGroup = function (groupCreationParams) {
        _PageUtil__WEBPACK_IMPORTED_MODULE_2__["PageUtil"].AddTaskSetDebugManifests();
        var group = undefined;
        var groupSiteURL = undefined;
        var createGroupHandler = function (createdGroup) {
            group = createdGroup;
        };
        TAB.AddTask(TAB.MakeTask(function () {
            Group.AddCsomTaskCreateGroup(groupCreationParams.serverUrl, groupCreationParams.groupAlias, groupCreationParams.groupDisplayName, createGroupHandler, undefined, undefined, groupCreationParams.userIds);
        }));
        // Wait for group site to finish provisioning
        // Group id will return immediately, but site URL should not be made available until group site is ready
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                groupSiteURL = group.get_siteUrl();
                return Boolean(groupSiteURL);
            }
            catch (e) {
                return false;
            }
        }));
        // Navigate to the new group
        // Put this inside a task so groupSiteURL is not evaluated too soon
        TAB.AddTask(TAB.LoadPage(groupSiteURL), TAB.PageReady());
    };
    Group._addTaskUseExistingTestGroup = function (groupCreationParams) {
        _PageUtil__WEBPACK_IMPORTED_MODULE_2__["PageUtil"].AddTaskSetDebugManifests();
        var groupUrl = groupCreationParams.serverUrl + "/sites/" + groupCreationParams.groupAlias;
        TAB.AddTask(TAB.LoadPage(groupUrl), TAB.PageReady());
    };
    return Group;
}());



/***/ }),

/***/ "Fp7G":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Mocks/CortexMockData.js ***!
  \***********************************************/
/*! exports provided: SessionStorageKey, CortexMockData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SessionStorageKey", function() { return SessionStorageKey; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CortexMockData", function() { return CortexMockData; });
/* harmony import */ var _MockTopicSuggestionsResponse__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MockTopicSuggestionsResponse */ "DSf6");
/**
 * @Copyright (c) Microsoft Corporation.  All rights reserved.
 */
var _a;

/**
 * @public
 * Append new sesstion storage key for new mock data here.
 */
var SessionStorageKey = /** @class */ (function () {
    function SessionStorageKey() {
    }
    SessionStorageKey.TOPIC_SUGGESTION = 'MOCK_TOPIC_SUGGESTION_RESPONSE';
    SessionStorageKey.MYTOPICS = 'MOCK_MYTOPICS_RESPONSE';
    return SessionStorageKey;
}());

/**
 * @public
 * Append new mock data for new API here.
 */
var CortexMockData = (_a = {},
    _a[SessionStorageKey.TOPIC_SUGGESTION] = _MockTopicSuggestionsResponse__WEBPACK_IMPORTED_MODULE_0__["MOCK_TOPIC_SUGGESTION_RESPONSE"],
    _a[SessionStorageKey.MYTOPICS] = _MockTopicSuggestionsResponse__WEBPACK_IMPORTED_MODULE_0__["MOCK_MYTOPICS_RESPONSE"],
    _a);


/***/ }),

/***/ "FtYJ":
/*!******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/SendByYammerDialog.js ***!
  \******************************************************/
/*! exports provided: SendByYammerDialog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SendByYammerDialog", function() { return SendByYammerDialog; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");


/**
 * @public
 */
var SendByYammerDialog = /** @class */ (function () {
    function SendByYammerDialog() {
        this._yammerIdTitle = 'yammer-ShareTo-Modal-Title';
    }
    SendByYammerDialog.prototype.AddTaskOpenDialog = function () {
        var sendToDataId = 'sendTo';
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].MakeTaskFindButtonInCommandBar(sendToDataId);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the Send by button');
            var sendButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, sendToDataId);
            TAB.Log.Comment('Click the Send by button');
            TAB.ClickElement(sendButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + sendToDataId + "']"));
    };
    SendByYammerDialog.prototype.AddTaskOpenSendToYammer = function () {
        var yammerButtonDataId = 'shareToYammerButton';
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the Send by Yammer button');
            var shareButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, yammerButtonDataId);
            TAB.Log.Comment('Click the Send to Yammer button');
            TAB.ClickElement(shareButton);
        }), TAB.OrWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + yammerButtonDataId + "']"), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, this._yammerIdTitle)));
    };
    SendByYammerDialog.prototype.AddTaskCheckForModalHeader = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Checking for Yammer modal header');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, this._yammerIdTitle));
    };
    return SendByYammerDialog;
}());



/***/ }),

/***/ "H50h":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/Utilities/index.js ***!
  \******************************************/
/*! exports provided: ClientFeatures, PageAnchor, ReactTriggerChange, ReactSetValueChange */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _ClientFeatures__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ClientFeatures */ "zTnS");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientFeatures", function() { return _ClientFeatures__WEBPACK_IMPORTED_MODULE_0__["ClientFeatures"]; });

/* harmony import */ var _PageAnchor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PageAnchor */ "FRLz");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageAnchor", function() { return _PageAnchor__WEBPACK_IMPORTED_MODULE_1__["PageAnchor"]; });

/* harmony import */ var _ReactTriggerChange__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ReactTriggerChange */ "dp3n");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ReactTriggerChange", function() { return _ReactTriggerChange__WEBPACK_IMPORTED_MODULE_2__["ReactTriggerChange"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ReactSetValueChange", function() { return _ReactTriggerChange__WEBPACK_IMPORTED_MODULE_2__["ReactSetValueChange"]; });






/***/ }),

/***/ "H5jt":
/*!*************************************************!*\
  !*** ./lib/SPTaskLib/Pages/PageVersionsPane.js ***!
  \*************************************************/
/*! exports provided: PageVersionsPane */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageVersionsPane", function() { return PageVersionsPane; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Canvas__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Canvas */ "mmJW");
/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");



/**
 * @public
 */
var PageVersionsPane = /** @class */ (function () {
    function PageVersionsPane() {
    }
    PageVersionsPane.AddTaskOpenPageVersionsPane = function () {
        _TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].AddTaskOpenPageSettingsPanel();
        TAB.MakeWaiter(function () {
            return PageVersionsPane._pageVersionsLink;
        })
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click page versions link to launch page version pane');
            TAB.ClickElement(PageVersionsPane._pageVersionsLink);
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            return !!PageVersionsPane._pageVersionsRootElement;
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            return PageVersionsPane.getVersions().length;
        }));
    };
    PageVersionsPane.AddTaskUnpublish = function () {
        TAB.Log.AddTaskComment('Unpublish the latest version');
        TAB.MakeTask(function () {
            if (!PageVersionsPane._isMajorVersion(PageVersionsPane.getVersions()[0].versionLabel)) {
                TAB.Log.Fail('First version is not major version, unpublish is not expected');
            }
            PageVersionsPane._addTaskClickMoreButtonOnVersion();
        })
            .WaitFor(TAB.MakeWaiter(function () {
            return !!PageVersionsPane._unpublishButton;
        }))
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on unpublish button');
            TAB.ClickElement(PageVersionsPane._unpublishButton);
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            try {
                // Wait until first version becomes a draft version.
                return !PageVersionsPane._isMajorVersion(PageVersionsPane.getVersions()[0].versionLabel);
            }
            catch (error) {
                return false;
            }
        }));
    };
    PageVersionsPane.AddTaskDeleteVersion = function (versionLabel) {
        var _this = this;
        TAB.Log.AddTaskComment("Delete version " + versionLabel);
        PageVersionsPane._addTaskClickMoreButtonOnVersion(versionLabel);
        TAB.MakeWaiter(function () {
            return !!PageVersionsPane._deleteButton;
        })
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on delete button');
            TAB.ClickElement(PageVersionsPane._deleteButton);
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            return !!_this._confirmationYesButton;
        }))
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on yes button');
            TAB.ClickElement(_this._confirmationYesButton);
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            try {
                // Wait until the deleted version is gone.
                return !PageVersionsPane.getVersions().some(function (version) { return version.versionLabel === versionLabel; });
            }
            catch (error) {
                return false;
            }
        }));
    };
    PageVersionsPane.AddTaskRestoreVersion = function (versionLabel) {
        TAB.Log.AddTaskComment("Restore version " + versionLabel);
        PageVersionsPane._addTaskClickMoreButtonOnVersion(versionLabel);
        var initialVersionsCount;
        TAB.MakeWaiter(function () {
            initialVersionsCount = PageVersionsPane.getVersions().length;
            return !!PageVersionsPane._restoreButton;
        })
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on restore button');
            TAB.ClickElement(PageVersionsPane._restoreButton);
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            try {
                // Wait until restored version becomes a draft.
                return PageVersionsPane.getVersions().length === initialVersionsCount + 1;
            }
            catch (error) {
                return false;
            }
        }));
    };
    PageVersionsPane.AddTaskCompareVersions = function (versionLabelCompareFrom, versionLabelCompareTo) {
        TAB.Log.AddTaskComment("Compare version " + versionLabelCompareFrom + " with version " + versionLabelCompareTo);
        TAB.MakeTask(function () {
            // Check two versions both exist
            var versions = PageVersionsPane.getVersions();
            if (versions.every(function (version) { return version.versionLabel !== versionLabelCompareFrom; })) {
                TAB.Log.Fail("Version " + versionLabelCompareFrom + " not available");
            }
            if (versions.every(function (version) { return version.versionLabel !== versionLabelCompareTo; })) {
                TAB.Log.Fail("Version " + versionLabelCompareTo + " not available");
            }
        })
            .Then(TAB.MakeTask(function () {
            // Select the first, and click "more actions" button on the section version.
            PageVersionsPane.AddTaskSelectVersionItem(versionLabelCompareFrom);
            PageVersionsPane._addTaskClickMoreButtonOnVersion(versionLabelCompareTo);
        }))
            .WaitFor(TAB.MakeWaiter(function () {
            return !!PageVersionsPane._compareButton;
        }))
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on compare button');
            TAB.ClickElement(PageVersionsPane._compareButton);
        }))
            .WaitFor(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(PageVersionsPane._pageVersionsRootElement, 'version-comparison'))
            .WaitFor(TAB.MakeWaiter(function () {
            // Wait until it renders any version detail items.
            // It always expected to render at least one detailed item because a "no change" item will be rendered if
            // two versions are identical.
            return PageVersionsPane.getVersionDetails().length;
        }));
    };
    PageVersionsPane.AddTaskSelectVersionItem = function (versionLabel) {
        TAB.Log.AddTaskComment("Try select version " + versionLabel);
        TAB.AddTask(TAB.MakeTask(function () {
            var targetVersion = PageVersionsPane._versionListItems.filter(function (versionElement) { return versionElement.getAttribute('data-version-label') === versionLabel; })[0];
            if (!targetVersion) {
                TAB.Log.Fail("The specified version doesn't exist");
            }
            else {
                TAB.Log.Comment("Click on target version " + versionLabel);
                TAB.ClickElement(targetVersion);
            }
        }));
    };
    PageVersionsPane.AddTaskToggleHighlightChanges = function () {
        TAB.MakeTask(function () {
            TAB.ClickElement(PageVersionsPane._highlightToggle);
        }).WaitFor(TAB.MakeWaiter(function () {
            try {
                // Wait until diff indicators are rendered.
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(_Canvas__WEBPACK_IMPORTED_MODULE_1__["Canvas"].rootCanvasElement, 'diff-indicator').length > 0;
            }
            catch (error) {
                return false;
            }
        }));
    };
    /**
     * Go back from comparison view to versions list view.
     */
    PageVersionsPane.AddTaskClickVersionComparisonBackButton = function () {
        TAB.MakeTask(function () {
            var backButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(PageVersionsPane._pageVersionsRootElement, 'version-comparison-back-button');
            TAB.ClickElement(backButton);
        }).WaitFor(TAB.MakeWaiter(function () {
            // Wait until the versions are showing.
            return PageVersionsPane.getVersions().length;
        }));
    };
    PageVersionsPane.getVersions = function () {
        return PageVersionsPane._versionListItems.map(function (versionItem) { return ({
            versionLabel: versionItem.getAttribute('data-version-label')
        }); });
    };
    PageVersionsPane.getVersionDetails = function () {
        return Array.prototype.slice
            .call(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(PageVersionsPane._pageVersionsRootElement, 'page-version-detail-item'))
            .map(function (versionItem) { return ({
            diffType: versionItem.getAttribute('data-diff-type')
        }); });
    };
    /**
     * Click on the more actions button of given version. It performs on the first version if versionLabel not specified.
     */
    PageVersionsPane._addTaskClickMoreButtonOnVersion = function (versionLabel) {
        if (versionLabel === void 0) { versionLabel = undefined; }
        TAB.AddTask(TAB.MakeTask(function () {
            var targetVersion = PageVersionsPane._versionListItems.filter(function (version) { return !versionLabel || version.getAttribute('data-version-label') === versionLabel; })[0];
            if (!targetVersion) {
                TAB.Log.Fail('The specified version not found');
            }
            var moreButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(targetVersion, 'version-more-actions');
            TAB.ClickElement(moreButton);
        }));
    };
    Object.defineProperty(PageVersionsPane, "_versionListItems", {
        get: function () {
            return Array.prototype.slice.call(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(PageVersionsPane._pageVersionsRootElement, 'page-version-item'));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_pageVersionsLink", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'page-versions-entry');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_pageVersionsRootElement", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'page-versions-pane-content');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_unpublishButton", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'version-unpublish');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_deleteButton", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'version-delete');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_restoreButton", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'version-restore');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_compareButton", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'version-compare');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_highlightToggle", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'page-version-highlight');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageVersionsPane, "_confirmationYesButton", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'yesButton');
            }
            catch (error) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    PageVersionsPane._isMajorVersion = function (versionLabel) {
        return Number(versionLabel) === Math.floor(Number(versionLabel));
    };
    return PageVersionsPane;
}());



/***/ }),

/***/ "HRpY":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/TwitterWebPart.js ***!
  \**************************************************/
/*! exports provided: TwitterWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TwitterWebPart", function() { return TwitterWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var TwitterWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(TwitterWebPart, _super);
    function TwitterWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Twitter, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Twitter.toString()) || this;
    }
    TwitterWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="twitterWidget"]') &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="twitter-term-field"]');
        }));
    };
    TwitterWebPart.prototype.AddTaskChangeTermToInvalidValue = function () {
        var _this = this;
        TAB.MakeTask(function () {
            // todo: remove setTimeout when this bug:https://onedrive.visualstudio.com/SPPPlat/_workitems/edit/669027 is resolved
            // use setTimeout to wait for property pane reRender complete
            // as propertypane will reRender unnecessarily for several times
            setTimeout(function () {
                var termTextArea = _this._getTwitterPropertyPaneTextAreaByIndex(0);
                _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(termTextArea, 'abcd');
            }, 3000);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="invalidTweetSource"]'));
    };
    TwitterWebPart.prototype.AddTaskChangeTermToProfileValue = function (profileName) {
        var _this = this;
        TAB.MakeTask(function () {
            var termTextArea = _this._getTwitterPropertyPaneTextAreaByIndex(0);
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(termTextArea, '@' + profileName);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-widget-id="profile:' + profileName + '"]'));
    };
    TwitterWebPart.prototype.AddTaskChangeMaxTweetsNumberToInvalidValue = function () {
        var _this = this;
        TAB.MakeTask(function () {
            // todo: remove setTimeout when this bug:https://onedrive.visualstudio.com/SPPPlat/_workitems/edit/669027 is resolved
            // use setTimeout to wait for property pane reRender complete
            // as propertypane will reRender unnecessarily for several times
            setTimeout(function () {
                var numbetTextArea = _this._getTwitterPropertyPaneTextAreaByIndex(5);
                _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(numbetTextArea, '-1');
            }, 3000);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="error-message"]'));
    };
    TwitterWebPart.prototype._getTwitterPropertyPaneTextAreaByIndex = function (index) {
        var twitterPropertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[class^="spPropertyPaneContainer"]');
        var twitterPropertyPaneGroupField = TAB.GetElements(twitterPropertyPane, TAB.searchBy.customQuery, '[data-automation-id="propertyPaneGroupField"]')[index];
        var twitterPropertyPaneTextArea = TAB.GetElements(twitterPropertyPaneGroupField, TAB.searchBy.partialClassName, 'ms-TextField-field')[1];
        return twitterPropertyPaneTextArea;
    };
    return TwitterWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "HZDx":
/*!*******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/SiteActivityWebPart.js ***!
  \*******************************************************/
/*! exports provided: SiteActivityWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SiteActivityWebPart", function() { return SiteActivityWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages */ "JWtQ");




/**
 * @public
 */
var SiteActivityWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(SiteActivityWebPart, _super);
    function SiteActivityWebPart() {
        var _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].SiteActivity, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].SiteActivity.toString()) || this;
        _this.SEE_ALL = 'See all';
        return _this;
    }
    SiteActivityWebPart.prototype.AddTaskBindActivityWebPart = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Waiting for siteActivity class to exist');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='siteActivity']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Looking for Activity web part');
            var webParts = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, _Pages__WEBPACK_IMPORTED_MODULE_3__["Canvas"].CanvasControlId);
            for (var _i = 0, webParts_1 = webParts; _i < webParts_1.length; _i++) {
                var webPart = webParts_1[_i];
                var header = TAB.GetElement(webPart, TAB.searchBy.customQuery, "[data-automation-id='webPartHeader']");
                var headerText = TAB.GetTextContent(header);
                if (headerText.indexOf('Activity') > -1) {
                    _this._activityWebPart = webPart;
                    TAB.Log.Comment('Activity web part found');
                    break;
                }
                if (!_this._activityWebPart) {
                    TAB.Log.Fail('Could not find Activity web part');
                }
            }
        }));
    };
    SiteActivityWebPart.prototype.AddTaskBindSeeAllActivity = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Finding webPartCointainer in "See all" page');
            var webParts = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='webPartContainer']");
            if (webParts.length === 1) {
                TAB.Log.Pass('Only Activity web part is displayed on "See all" page');
                _this._seeAllActivityWebPart = webParts[0];
            }
            else {
                TAB.Log.Fail('More than one web part found on "See all" page');
            }
        }));
    };
    SiteActivityWebPart.prototype.AddTaskFindSeeAllLink = function (result) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Looking for "See all" link');
            var links = TAB.GetElements(_this._activityWebPart, TAB.searchBy.tag, 'a');
            if (links && links.length > 0) {
                var linkText = TAB.GetTextContent(links[0]);
                if (linkText === _this.SEE_ALL) {
                    result.success = true;
                    _this._seeAllLink = links[0];
                    TAB.Log.Pass("\"" + _this.SEE_ALL + "\" link found");
                }
            }
        }));
    };
    SiteActivityWebPart.prototype.AddTaskLoadSeeAllPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Navigating to "See all" page');
            TAB.AddTask(TAB.LoadPage(_this._seeAllLink.href), TAB.PageReady());
        }));
        TAB.Log.AddTaskComment("Waiting for 'ms-List-cell' and 'webPartContainer' classes to exist");
        TAB.AddTask(undefined, TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.className, 'ms-List-cell'), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='webPartContainer']")));
    };
    SiteActivityWebPart.prototype.AddTaskVerifyNoSeeAllLink = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var text = TAB.GetTextContent(_this._seeAllActivityWebPart);
            TAB.Log.Verify(text.indexOf(_this.SEE_ALL) === -1, '"See all" page does not contain "See all" link');
        }));
    };
    SiteActivityWebPart.prototype.AddTaskVerifyRecentActivity = function (filename, siteUrl) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Verifying recent activity');
            var cards = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-DocumentCardTile-titleArea');
            var doc;
            for (var _i = 0, cards_1 = cards; _i < cards_1.length; _i++) {
                var card = cards_1[_i];
                if (TAB.GetTextContent(card).indexOf(filename) > -1) {
                    doc = card;
                    break;
                }
            }
            if (doc) {
                _this._verifyRecentActivityText(doc, filename, siteUrl);
            }
            else {
                TAB.Log.Fail('Recently uploaded document not found');
            }
        }));
    };
    SiteActivityWebPart.prototype.AddTaskWaitForSeeAll = function () {
        TAB.Log.AddTaskComment('Waiting for "See all" link to appear');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var webParts = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, _Pages__WEBPACK_IMPORTED_MODULE_3__["Canvas"].CanvasControlId);
            for (var _i = 0, webParts_2 = webParts; _i < webParts_2.length; _i++) {
                var webPart = webParts_2[_i];
                var header = TAB.GetElements(webPart, TAB.searchBy.customQuery, "[data-automation-id='webPartHeader']");
                if (header.length > 0) {
                    var headerText = TAB.GetTextContent(header[0]);
                    if (headerText.indexOf('See all') > -1) {
                        return true;
                    }
                }
            }
        }));
    };
    SiteActivityWebPart.prototype._verifyRecentActivityText = function (doc, docName, siteUrl) {
        TAB.Log.Pass('Recently edited document found');
        var link = TAB.GetElement(doc, TAB.searchBy.tag, 'a');
        var href = decodeURI(link.getAttribute('href'));
        var expectedHref = siteUrl + '/Shared Documents';
        TAB.Log.VerifyEquals(href, expectedHref, 'Activity card contains link to Shared Documents');
        var titleElement = TAB.GetElement(doc, TAB.searchBy.hasClassName, 'ms-DocumentCardTitle');
        var title = titleElement.getAttribute('title');
        TAB.Log.VerifyEquals(title, docName, 'Activity card has correct title for recently edited doc');
    };
    return SiteActivityWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "IfeM":
/*!************************************!*\
  !*** ./lib/SPTaskLib/SpaceUtil.js ***!
  \************************************/
/*! exports provided: areVectorsEqual, SpaceUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "areVectorsEqual", function() { return areVectorsEqual; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpaceUtil", function() { return SpaceUtil; });
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PageUtil */ "jK1H");
/* harmony import */ var _Controls_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Controls/index */ "iDSo");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Next */ "BJbA");
/**
 * @copyright Microsoft Corporation. All rights reserved.
 *
 */



/**
 * @public
 */
function areVectorsEqual(a, b, precision) {
    if (precision === void 0) { precision = 0.001; }
    return (Math.abs(a.x - b.x) < precision && Math.abs(a.y - b.y) < precision && Math.abs(a.z - b.z) < precision);
}
/**
 * @public
 */
var SpaceUtil = /** @class */ (function () {
    function SpaceUtil() {
    }
    /**
     * Executes a series of tasks to create a test site with the given name and navigates to it.
     *
     * This method also validates if the site already exists, and if so method will only navigate to the
     * existing site.
     * @param siteName - Website name to use
     * @param serverUrl - Server URL where the test is executing
     */
    SpaceUtil.CreateTestSite = function (siteName, serverUrl) {
        var _this = this;
        SpaceUtil.TryLoadHomePage(serverUrl, siteName);
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this._elementExists(_this.newButton)) {
                TAB.Log.AddTaskComment('Site loaded. Checking if Spaces enabled.');
                _this._addTaskClickNewButton(); // open the new item dropdown to see if new space button is there
                TAB.AddTask(TAB.MakeTask(function () {
                    if (!_this._elementExists(_this.newSpaceButton)) {
                        TAB.Log.AddTaskComment('Spaces feature is not enabled.');
                        _this._enableSpacesFeatureAndReload();
                    }
                    else {
                        TAB.Log.AddTaskComment('Spaces feature is enabled.');
                        _this._addTaskClickElement(_this.newButton); // close the dropdown
                    }
                }));
            }
            else if (!_PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].IsSPPageReady()) {
                TAB.Log.AddTaskComment('Site does not exist. Attempting to create.');
                _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].AddTaskCreateSetupCommunicationSite(serverUrl, siteName);
                _this._enableSpacesFeatureAndReload();
            }
            else {
                TAB.Log.AddTaskDidNotRun('New item dropdown does not exist.');
            }
        }));
    };
    /**
     * Attempts to load the Home.aspx page of a site. Times out if site does not exist.
     * @param serverUrl - the server URL
     * @param siteName - the site name
     */
    SpaceUtil.TryLoadHomePage = function (serverUrl, siteName) {
        var pageUrl = serverUrl + '/sites/' + siteName + '/SitePages/Home.aspx';
        TAB.Log.AddTaskComment("Attempting to load site " + pageUrl);
        SpaceUtil._addTaskLoadPage(pageUrl, this._waitForElement(this.newButton), 20000);
    };
    /**
     * Executes a series of steps to create a space with the given name.
     *
     * If this method terminates successfully, the Scene and AutomationRegistry fields of this
     * class will be populated.
     * @param spaceName - Name to use for space creation
     */
    SpaceUtil.CreateSpace = function (spaceName) {
        var _this = this;
        this._addTaskClickNewButton();
        TAB.AddTask(TAB.MakeTask(function () {
            if (!_this._elementExists(_this.newSpaceButton)) {
                TAB.Log.AddTaskFail('New space button not found - Test Failed.');
            }
        }));
        this._addTaskClickElement(this.newSpaceButton, this._waitForElement(this.createSpaceFinishButton));
        this._addTaskEnterText(this.spaceNameTextField, spaceName, 100, this._waitForSpaceLoad(true));
    };
    /**
     * Attempts to load a space. Times out if space does not exist.
     * @param serverUrl - the server URL
     * @param siteName - the site name
     * @param spaceName - the space name
     */
    SpaceUtil.TryLoadSpace = function (serverUrl, siteName, spaceName) {
        var url = serverUrl + "/sites/" + siteName + "/SitePages/" + spaceName + ".aspx";
        TAB.Log.AddTaskComment("Attempting to load space " + url);
        SpaceUtil._addTaskLoadPage(url, this._waitForSpaceLoad(), 20000);
    };
    /**
     * Executes a series of steps to add a web part to an existing scene, then selects it.
     *
     * This method assumes that the test is currently on a Space and the
     * page is in Edit mode.
     * @param type - the type of web part to add
     * @param verifyPredicate - an optional predicate to verify that the web part was added
     */
    SpaceUtil.AddWebPart = function (type, verifyPredicate) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (!_this.AutomationRegistry) {
                TAB.Log.AddTaskFail('Cannot add web part - automation registry does not exist.');
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (type === _Controls_index__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].SPMRTestWebPart) {
                _this.AutomationRegistry.execute('enableTestWebPart');
            }
        }));
        this._addTaskClickAddWebPartButton();
        this._addTaskClickWebPartInToolbox(type);
        this._addTaskAddWebPartOnCanvas(verifyPredicate);
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AutomationRegistry.execute('select');
        }));
    };
    /**
     * Deletes the currently selected webpart.
     * @param verifyPredicate - an optional predicate to verify that the web part was deleted
     */
    SpaceUtil.DeleteSelectedWebPart = function (verifyPredicate) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Pressing Delete key');
            var canvas = _this._getElement('MRCanvas');
            TAB.FireKeyboardEvent(canvas, 'keydown', 46);
        }), this._waitForElement('yesButton'));
        this._addTaskClickElement('yesButton', TAB.MakeWaiter(function () {
            return !verifyPredicate || verifyPredicate();
        }));
    };
    /**
     * Uses the transform bar to update the transforms of the currently selected webpart.
     * @param transform - the fields of the webpart transform
     */
    SpaceUtil.SetWebPartTransform = function (transform) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var expectedInputs = 7;
            var transformBar = TAB.GetElement(TAB.Win.document, TAB.searchBy.id, 'TransformBar');
            var transformInputs = TAB.GetElements(transformBar, TAB.searchBy.partialClassName, _this.transformInputClassName);
            if (transformInputs.length === expectedInputs) {
                if (transform.angle !== undefined) {
                    TAB.Log.AddTaskComment("Setting angle transform to " + transform.angle);
                    _this._addTaskEnterText(transformInputs[0], transform.angle.toString());
                }
                if (transform.distance !== undefined) {
                    TAB.Log.AddTaskComment("Setting distance transform to " + transform.distance);
                    _this._addTaskEnterText(transformInputs[1], transform.distance.toString());
                }
                if (transform.scale !== undefined) {
                    TAB.Log.AddTaskComment("Setting scale transform to " + transform.scale);
                    _this._addTaskEnterText(transformInputs[transformInputs.length - 1], transform.scale.toString());
                }
                if (transform.rotationY !== undefined) {
                    TAB.Log.AddTaskComment("Setting Y rotation transform to " + transform.rotationY);
                    var inputFieldIndex = 4;
                    _this._addTaskEnterText(transformInputs[inputFieldIndex], transform.rotationY.toString());
                }
                if (transform.rotationX !== undefined) {
                    TAB.Log.AddTaskComment("Setting X rotation transform to " + transform.rotationX);
                    _this._addTaskEnterText(transformInputs[3], transform.rotationX.toString());
                }
                if (transform.rotationZ !== undefined) {
                    TAB.Log.AddTaskComment("Setting Z rotation transform to " + transform.rotationZ);
                    _this._addTaskEnterText(transformInputs[5], transform.rotationZ.toString());
                }
                // Set height last because other transforms can change it.
                if (transform.height !== undefined) {
                    TAB.Log.AddTaskComment("Setting height transform to " + transform.height);
                    _this._addTaskEnterText(transformInputs[2], transform.height.toString());
                }
            }
            else {
                TAB.Log.AddTaskFail("Found " + transformInputs.length + " spin buttons. Expected " + expectedInputs + " in transform bar");
            }
        }));
    };
    SpaceUtil.ClickPublish = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._addTaskClickElement(_this.pagePublishButton, _this._waitForElement(_this.pageEditButton));
        }));
    };
    SpaceUtil.ClickEdit = function () {
        this._addTaskClickElement(this.pageEditButton, this._waitForElement(this.pagePublishButton));
    };
    SpaceUtil.ReloadSpace = function () {
        TAB.Log.AddTaskComment('Reloading space...');
        TAB.AddTask(TAB.ReloadPage(), this._waitForSpaceLoad());
    };
    /**
     * Creates a Waiter that completes after a fixed timeout.
     * @param timeout - the time in milliseconds to wait
     */
    SpaceUtil.TimedWait = function (timeout) {
        var startTime;
        return TAB.MakeWaiter(function () {
            if (!startTime) {
                startTime = Date.now();
            }
            return Date.now() - startTime > timeout;
        });
    };
    /**
     * Gets an inventory of the current scene with a snapshot of Babylon objects
     */
    SpaceUtil.GetSceneInventory = function () {
        var inventory = this.Scene.__inventory__;
        inventory.snapshot();
        return inventory;
    };
    /**
     * Evaluates a scene inventory against the current state of the scene
     * @param inventory - snapshotted inventory to audit
     */
    SpaceUtil.AuditScene = function (inventory) {
        var audit = inventory.audit();
        audit.meshes.forEach(function (mesh) {
            TAB.Log.AddTaskWarning("Unexpected mesh found in scene, name: " + mesh + ";");
        });
        audit.materials.forEach(function (mat) {
            TAB.Log.AddTaskWarning("Unexpected material found in scene, name: " + mat + ";");
        });
        audit.textures.forEach(function (t) {
            TAB.Log.AddTaskWarning("Unexpected texture found in scene, name: " + t + ";");
        });
        audit.lights.forEach(function (l) {
            TAB.Log.AddTaskWarning("Unexpected light found in scene, name: " + l);
        });
        if (audit.meshes.length > 0 ||
            audit.materials.length > 0 ||
            audit.textures.length > 0 ||
            audit.lights.length > 0) {
            TAB.Log.Fail("Found unexpected objects in scene - Meshes: " + audit.meshes.length + "," +
                (" Materials: " + audit.materials.length + ", Textures: " + audit.textures.length + ",") +
                (" Lights: " + audit.lights.length));
        }
    };
    SpaceUtil._enableSpacesFeatureAndReload = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Invoking API to enable Spaces feature.');
        TAB.AddTask(TAB.MakeTask(function () {
            var siteUrl = TAB.Win.location.href;
            if (siteUrl.endsWith('.aspx')) {
                siteUrl = siteUrl.slice(0, siteUrl.lastIndexOf('/SitePages/'));
            }
            var contextInfoRequest = new XMLHttpRequest();
            contextInfoRequest.open('POST', siteUrl + '/_api/contextinfo', false);
            contextInfoRequest.setRequestHeader('Content-Type', 'application/json;odata=verbose');
            contextInfoRequest.setRequestHeader('Accept', 'application/json; odata = verbose');
            contextInfoRequest.send();
            // tslint:disable-next-line:no-any
            var responseData = JSON.parse(contextInfoRequest.responseText);
            var formDigestValue = responseData.d.GetContextWebInformation.FormDigestValue;
            var xhr = new XMLHttpRequest();
            xhr.open('POST', siteUrl + "/_api/web/features/add(guid'2AC9C540-6DB4-4155-892C-3273957F1926')", false);
            xhr.setRequestHeader('x-requestdigest', formDigestValue);
            xhr.setRequestHeader('Content-Type', 'application/json; odata.metadata=minimal');
            xhr.setRequestHeader('Accept', '*/*, application/json; odata.metadata=minimal');
            xhr.setRequestHeader('odata-version', '4.0');
            xhr.send();
            // tslint:disable-next-line:no-any
            var response = JSON.parse(xhr.responseText);
            if (response.error) {
                if (response.error.code.endsWith('DuplicateNameException')) {
                    TAB.Log.AddTaskComment('Spaces feature already activated - commencing test.');
                }
                else {
                    // Service failed to activate feature
                    TAB.Log.AddTaskDidNotRun('Unable to activate SharePoint Spaces feature - could not run Spaces tab test');
                }
            }
            else {
                TAB.Log.AddTaskComment('Activated SharePoint Spaces feature. Reloading.');
                TAB.AddTask(TAB.ReloadPage(), _this._waitForElement(_this.newButton));
            }
        }));
    };
    SpaceUtil._addTaskClickNewButton = function () {
        var newSpaceButtonWaitMax = 10000; // 10 seconds
        this._addTaskClickElement(this.newButton, this._elementExistsOrTimeoutWaiter(this.newSpaceButton, newSpaceButtonWaitMax));
    };
    SpaceUtil._elementExistsOrTimeoutWaiter = function (dataAutomationId, timeout) {
        if (timeout === void 0) { timeout = 20000; }
        return TAB.OrWaiters(this._waitForElement(dataAutomationId), this.TimedWait(timeout));
    };
    SpaceUtil._addTaskEnterText = function (inputOrQuery, text, delay, waiter) {
        var _this = this;
        if (delay === void 0) { delay = 500; }
        TAB.AddTask(TAB.MakeTask(function () {
            var input = (typeof inputOrQuery === 'string'
                ? _this._getElement(inputOrQuery)
                : inputOrQuery);
            TAB.AddTask(TAB.MakeTask(function () {
                var focusEv = TAB.Win.document.createEvent('HTMLEvents');
                focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
                input.dispatchEvent(focusEv);
            }), _this.TimedWait(delay));
            TAB.AddTask(TAB.MakeTask(function () {
                input.value = text;
            }), _this.TimedWait(delay));
            TAB.AddTask(TAB.MakeTask(function () {
                var ev = TAB.Win.document.createEvent('HTMLEvents');
                ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
                input.dispatchEvent(ev);
            }), _this.TimedWait(delay));
            TAB.AddTask(TAB.MakeTask(function () {
                // press Enter
                TAB.FireKeyboardEvent(input, 'keydown', 13);
            }), _this.TimedWait(delay));
            TAB.AddTask(TAB.MakeTask(function () {
                var blurEv = TAB.Win.document.createEvent('HTMLEvents');
                blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
                input.dispatchEvent(blurEv);
            }), _this.TimedWait(delay));
        }), waiter);
    };
    SpaceUtil._waitForSpaceLoad = function (editMode) {
        if (editMode === void 0) { editMode = false; }
        return TAB.AndWaiters(this._waitForSceneLoad(), this._waitForElement(editMode ? this.pagePublishButton : this.pageEditButton));
    };
    SpaceUtil._waitForSceneLoad = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            // tslint:disable-next-line:no-any
            var window = TAB.Win.window;
            if (window && window.__babylonScene__) {
                var scene = window.__babylonScene__;
                if (scene &&
                    scene.meshes &&
                    scene.meshes.length > 0 &&
                    scene.__automationRegistry__ &&
                    scene.__automationRegistry__.exists('plusClick')) {
                    TAB.Log.Comment('Context found - Total Meshes: ' + scene.meshes.length);
                    _this.Scene = scene;
                    _this.AutomationRegistry = scene.__automationRegistry__;
                    return true;
                }
            }
            return false;
        });
    };
    SpaceUtil._addTaskClickAddWebPartButton = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Clicking add button');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AutomationRegistry.execute('plusClick');
        }), this._waitForElement(this.webPartToolbox));
    };
    SpaceUtil._addTaskClickWebPartInToolbox = function (type) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var textWebPartButtons = [];
            TAB.Log.AddTaskComment('Waiting for web part button.');
            TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                textWebPartButtons = _this._getElements(type);
                if (textWebPartButtons.length > 0) {
                    if (textWebPartButtons.length > 1) {
                        TAB.Log.Warning('Found duplicate web part buttons');
                    }
                    return true;
                }
                else {
                    return false;
                }
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Clicking web part button.');
                TAB.ClickElement(textWebPartButtons[0]);
                TAB.Log.Comment('Button clicked!');
            }));
        }));
    };
    SpaceUtil._addTaskAddWebPartOnCanvas = function (waitPredicate) {
        var _this = this;
        var waiter = waitPredicate ? waitPredicate : function () { return true; };
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Starting drag action');
            _this.AutomationRegistry.execute('dragStart');
            TAB.Log.Comment('Continuing drag');
            _this.AutomationRegistry.execute('drag');
            TAB.Log.Comment('Ending drag');
            _this.AutomationRegistry.execute('dragEnd');
            TAB.Log.Comment('Placement complete');
        }), TAB.MakeWaiter(waiter));
    };
    /**
     * Loads a SharePoint page. Ensures that the page becomes ready and executes an optional
     * waiter, both subject to an optional timeout.
     * @param url - the URL to load
     * @param waiter - an optional waiter
     * @param timeout - an optional timeout
     */
    SpaceUtil._addTaskLoadPage = function (url, waiter, timeout) {
        TAB.AddTask(TAB.LoadPage(url), SpaceUtil.TimedWait(5000) // give time for the page navigate to start
        );
        var pageLoadWaiter = waiter
            ? TAB.AndWaiters(_PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].SPPageReady(), waiter)
            : _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].SPPageReady();
        TAB.AddTask(undefined, timeout ? TAB.OrWaiters(pageLoadWaiter, SpaceUtil.TimedWait(timeout)) : pageLoadWaiter);
    };
    SpaceUtil._elementExists = function (dataAutomationId) {
        return this._getElement(dataAutomationId) !== undefined;
    };
    SpaceUtil._getElement = function (dataAutomationId) {
        return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, dataAutomationId) || undefined;
    };
    SpaceUtil._getElements = function (dataAutomationId) {
        return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementsByDataAutomationId(TAB.Win.document.body, dataAutomationId);
    };
    SpaceUtil._addTaskClickElement = function (dataAutomationId, waiter) {
        var _this = this;
        return TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Looking for '" + dataAutomationId + "' element to click.");
            var element = _this._getElement(dataAutomationId);
            if (element) {
                TAB.ClickElement(element);
                TAB.Log.Comment("Clicked '" + dataAutomationId + "'.");
            }
            else {
                TAB.Log.AddTaskFail("Did not find '" + dataAutomationId + "' to click.");
            }
        }), waiter);
    };
    SpaceUtil._waitForElement = function (dataAutomationId) {
        return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win.window, dataAutomationId);
    };
    SpaceUtil.newButton = 'pageCommandBarNewButton';
    SpaceUtil.newSpaceButton = 'NewSpaceInHome';
    SpaceUtil.createSpaceFinishButton = 'createSpaceFinishButton';
    SpaceUtil.spaceNameTextField = 'spaceNameField';
    SpaceUtil.pagePublishButton = 'pageCommandBarPublishButton';
    SpaceUtil.pageEditButton = 'pageCommandBarEditButton';
    SpaceUtil.webPartToolbox = 'toolbox-callout';
    SpaceUtil.transformInputClassName = 'ms-spinButton-input';
    return SpaceUtil;
}());



/***/ }),

/***/ "Is2z":
/*!*******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/RSSConnectorWebPart.js ***!
  \*******************************************************/
/*! exports provided: RSSConnectorWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RSSConnectorWebPart", function() { return RSSConnectorWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _ConnectorWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectorWebPart */ "sQpn");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");



/**
 * @public
 */
var RSSConnectorWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(RSSConnectorWebPart, _super);
    function RSSConnectorWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].RSSConnector, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].RSSConnector.toString()) || this;
    }
    return RSSConnectorWebPart;
}(_ConnectorWebPart__WEBPACK_IMPORTED_MODULE_1__["ConnectorWebPart"]));



/***/ }),

/***/ "JWtQ":
/*!**************************************!*\
  !*** ./lib/SPTaskLib/Pages/index.js ***!
  \**************************************/
/*! exports provided: HintType, Canvas, CanvasToolbox, ClassicPage, Comments, CommentsMention, Footer, SPHome, MegaMenu, PageSettingsPanel, PageTemplatePickerOpenType, PageTemplatesPanel, PageVersionsPane, PrePublishPanel, PromotePage, PropertyPane, Router, SocialBar, SiteDesignId, TeamSitePage, TopicPage, TranslationUtil, UndoRedo, Workbench, PublishingPageMonitoring, AudienceTargeting, PartialId, ViewPortLoader, viewPortLoaderRichPageContent, TopicAnnotations, Navigation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Canvas */ "mmJW");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HintType", function() { return _Canvas__WEBPACK_IMPORTED_MODULE_0__["HintType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Canvas", function() { return _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"]; });

/* harmony import */ var _CanvasToolbox__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasToolbox */ "bl+Y");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CanvasToolbox", function() { return _CanvasToolbox__WEBPACK_IMPORTED_MODULE_1__["CanvasToolbox"]; });

/* harmony import */ var _ClassicPage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ClassicPage */ "x05h");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClassicPage", function() { return _ClassicPage__WEBPACK_IMPORTED_MODULE_2__["ClassicPage"]; });

/* harmony import */ var _Comments__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Comments */ "tJmU");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Comments", function() { return _Comments__WEBPACK_IMPORTED_MODULE_3__["Comments"]; });

/* harmony import */ var _CommentsMention__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CommentsMention */ "iWcL");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommentsMention", function() { return _CommentsMention__WEBPACK_IMPORTED_MODULE_4__["CommentsMention"]; });

/* harmony import */ var _Footer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Footer */ "Ogso");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Footer", function() { return _Footer__WEBPACK_IMPORTED_MODULE_5__["Footer"]; });

/* harmony import */ var _SPHome__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SPHome */ "xxVG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHome", function() { return _SPHome__WEBPACK_IMPORTED_MODULE_6__["SPHome"]; });

/* harmony import */ var _MegaMenu__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./MegaMenu */ "mcqG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MegaMenu", function() { return _MegaMenu__WEBPACK_IMPORTED_MODULE_7__["MegaMenu"]; });

/* harmony import */ var _PageSettingsPanel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./PageSettingsPanel */ "YfnZ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageSettingsPanel", function() { return _PageSettingsPanel__WEBPACK_IMPORTED_MODULE_8__["PageSettingsPanel"]; });

/* harmony import */ var _PageTemplatesPanel__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./PageTemplatesPanel */ "9JB+");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageTemplatePickerOpenType", function() { return _PageTemplatesPanel__WEBPACK_IMPORTED_MODULE_9__["PageTemplatePickerOpenType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageTemplatesPanel", function() { return _PageTemplatesPanel__WEBPACK_IMPORTED_MODULE_9__["PageTemplatesPanel"]; });

/* harmony import */ var _PageVersionsPane__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./PageVersionsPane */ "H5jt");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageVersionsPane", function() { return _PageVersionsPane__WEBPACK_IMPORTED_MODULE_10__["PageVersionsPane"]; });

/* harmony import */ var _PrePublishPanel__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./PrePublishPanel */ "wwnI");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PrePublishPanel", function() { return _PrePublishPanel__WEBPACK_IMPORTED_MODULE_11__["PrePublishPanel"]; });

/* harmony import */ var _PromotePage__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./PromotePage */ "ldKH");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PromotePage", function() { return _PromotePage__WEBPACK_IMPORTED_MODULE_12__["PromotePage"]; });

/* harmony import */ var _PropertyPane__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./PropertyPane */ "M/CL");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PropertyPane", function() { return _PropertyPane__WEBPACK_IMPORTED_MODULE_13__["PropertyPane"]; });

/* harmony import */ var _Router__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Router */ "QcF0");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Router", function() { return _Router__WEBPACK_IMPORTED_MODULE_14__["Router"]; });

/* harmony import */ var _SocialBar__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./SocialBar */ "yZcd");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SocialBar", function() { return _SocialBar__WEBPACK_IMPORTED_MODULE_15__["SocialBar"]; });

/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SiteDesignId", function() { return _TeamSitePage__WEBPACK_IMPORTED_MODULE_16__["SiteDesignId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamSitePage", function() { return _TeamSitePage__WEBPACK_IMPORTED_MODULE_16__["TeamSitePage"]; });

/* harmony import */ var _TopicPage__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./TopicPage */ "Lu9u");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TopicPage", function() { return _TopicPage__WEBPACK_IMPORTED_MODULE_17__["TopicPage"]; });

/* harmony import */ var _TranslationUtil__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./TranslationUtil */ "LH7+");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TranslationUtil", function() { return _TranslationUtil__WEBPACK_IMPORTED_MODULE_18__["TranslationUtil"]; });

/* harmony import */ var _UndoRedo__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./UndoRedo */ "Nthi");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UndoRedo", function() { return _UndoRedo__WEBPACK_IMPORTED_MODULE_19__["UndoRedo"]; });

/* harmony import */ var _Workbench__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./Workbench */ "jj/V");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Workbench", function() { return _Workbench__WEBPACK_IMPORTED_MODULE_20__["Workbench"]; });

/* harmony import */ var _PublishingPageMonitoring__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./PublishingPageMonitoring */ "cVxD");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PublishingPageMonitoring", function() { return _PublishingPageMonitoring__WEBPACK_IMPORTED_MODULE_21__["PublishingPageMonitoring"]; });

/* harmony import */ var _AudienceTargeting__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./AudienceTargeting */ "ARZc");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AudienceTargeting", function() { return _AudienceTargeting__WEBPACK_IMPORTED_MODULE_22__["AudienceTargeting"]; });

/* harmony import */ var _ViewPortLoader__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./ViewPortLoader */ "v4Fw");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PartialId", function() { return _ViewPortLoader__WEBPACK_IMPORTED_MODULE_23__["PartialId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ViewPortLoader", function() { return _ViewPortLoader__WEBPACK_IMPORTED_MODULE_23__["ViewPortLoader"]; });

/* harmony import */ var _ViewPortLoaderRichContent__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./ViewPortLoaderRichContent */ "E3+K");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "viewPortLoaderRichPageContent", function() { return _ViewPortLoaderRichContent__WEBPACK_IMPORTED_MODULE_24__["viewPortLoaderRichPageContent"]; });

/* harmony import */ var _TopicAnnotations__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./TopicAnnotations */ "bqQT");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TopicAnnotations", function() { return _TopicAnnotations__WEBPACK_IMPORTED_MODULE_25__["TopicAnnotations"]; });

/* harmony import */ var _Navigation__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./Navigation */ "9yWr");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Navigation", function() { return _Navigation__WEBPACK_IMPORTED_MODULE_26__["Navigation"]; });






























/***/ }),

/***/ "JmdK":
/*!***************************************************!*\
  !*** ./lib/SPTaskLib/Controls/CreateSitePanel.js ***!
  \***************************************************/
/*! exports provided: CreateSitePanelForm, CreateSiteTemplateOption, GroupPrivacyOption, DesignPackageOption, CreateSitePanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateSitePanelForm", function() { return CreateSitePanelForm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateSiteTemplateOption", function() { return CreateSiteTemplateOption; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupPrivacyOption", function() { return GroupPrivacyOption; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DesignPackageOption", function() { return DesignPackageOption; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateSitePanel", function() { return CreateSitePanel; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../SPKillSwitchUtil */ "y5Zv");


/**
 * @public
 */
var CreateSitePanelForm;
(function (CreateSitePanelForm) {
    CreateSitePanelForm[CreateSitePanelForm["ChooseTemplate"] = 0] = "ChooseTemplate";
    CreateSitePanelForm[CreateSitePanelForm["CreateSite"] = 1] = "CreateSite";
    CreateSitePanelForm[CreateSitePanelForm["AddMember"] = 2] = "AddMember";
})(CreateSitePanelForm || (CreateSitePanelForm = {}));
/**
 * @public
 */
var CreateSiteTemplateOption;
(function (CreateSiteTemplateOption) {
    CreateSiteTemplateOption[CreateSiteTemplateOption["TeamSite"] = 0] = "TeamSite";
    CreateSiteTemplateOption[CreateSiteTemplateOption["Publishing"] = 1] = "Publishing";
})(CreateSiteTemplateOption || (CreateSiteTemplateOption = {}));
/**
 * @public
 */
var GroupPrivacyOption;
(function (GroupPrivacyOption) {
    GroupPrivacyOption[GroupPrivacyOption["Public"] = 0] = "Public";
    GroupPrivacyOption[GroupPrivacyOption["Private"] = 1] = "Private";
})(GroupPrivacyOption || (GroupPrivacyOption = {}));
/**
 * @public
 */
var DesignPackageOption;
(function (DesignPackageOption) {
    DesignPackageOption[DesignPackageOption["Topic"] = 0] = "Topic";
    DesignPackageOption[DesignPackageOption["Showcase"] = 1] = "Showcase";
    DesignPackageOption[DesignPackageOption["Blank"] = 2] = "Blank";
})(DesignPackageOption || (DesignPackageOption = {}));
var ChooseTemplateForm = /** @class */ (function () {
    function ChooseTemplateForm(panelRoot) {
        this.rootElement = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(panelRoot, 'chooseTemplateForm');
        if (this.rootElement) {
            this.templateOptions = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(this.rootElement, 'siteTemplateOption');
        }
    }
    ChooseTemplateForm.prototype.AddTaskVerifyForm = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Verify(Boolean(_this.rootElement), 'Site template option form is displayed');
            TAB.Log.Verify(_this.templateOptions.length === 2, 'Found two create site templates');
            TAB.Log.Verify(Boolean(_this.templateOptions[CreateSiteTemplateOption.TeamSite]), 'Found Team Site template option');
            TAB.Log.Verify(Boolean(_this.templateOptions[CreateSiteTemplateOption.Publishing]), 'Found Publishing template option');
        }));
    };
    ChooseTemplateForm.prototype.AddTaskChooseTemplate = function (templateOption) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this.templateOptions[templateOption].click();
        }));
    };
    return ChooseTemplateForm;
}());
var CreateSiteForm = /** @class */ (function () {
    function CreateSiteForm(panelRoot, siteTemplate) {
        var _this = this;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                _this.panelRoot = panelRoot;
                _this.rootElement = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(panelRoot, 'createForm');
                _this.siteTemplate = siteTemplate;
                if (_this.rootElement) {
                    _this.getFormContent();
                }
                return true;
            }
            catch (e) {
                return false;
            }
        }));
    }
    CreateSiteForm.prototype.AddTaskVerifyForm = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Verify(Boolean(_this.rootElement), 'Create Site form is displayed');
            TAB.Log.Verify(Boolean(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this.rootElement, 'createForm-title')), 'Create Site form title found');
            TAB.Log.Verify(Boolean(_this.groupNameField), 'Group Name field found');
            TAB.Log.Verify(Boolean(_this.groupDescriptionField), 'Group Description field found');
            TAB.Log.Verify(Boolean(_this.createButton), 'Create button found');
            TAB.Log.Verify(_this.createButton.getAttribute('disabled') === '', 'Create button is disabled');
            if (_this.siteTemplate === CreateSiteTemplateOption.Publishing) {
                TAB.Log.Verify(Boolean(_this.designPackageField), 'Design Package field found');
            }
        }));
    };
    CreateSiteForm.prototype.AddTaskCreateSite = function (param, template) {
        var _this = this;
        TAB.Log.AddTaskComment('Choose design package');
        this.AddTaskSelectDesign(param);
        TAB.Log.AddTaskComment('Enter value for group name and description');
        TAB.AddTask(TAB.MakeTask(function () {
            if (param.name) {
                _this.setTextFieldValue(_this.groupNameField, param.name);
            }
            if (param.description) {
                _this.setTextAreaFieldValue(_this.groupDescriptionField, param.description);
            }
        }));
        TAB.Log.AddTaskComment('Wait for additional fields');
        TAB.AddTask(undefined, this.waitForDetailFields());
        if (this.siteTemplate === CreateSiteTemplateOption.TeamSite) {
            TAB.AddTask(TAB.MakeTask(function () {
                _this.selectPrivatePolicy();
            }));
        }
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var siteUrl = TAB.GetElements(_this.siteUrlField, TAB.searchBy.className, 'od-GroupCreate-siteUrlDiv');
            if (siteUrl && siteUrl.length) {
                param.siteUrl = TAB.GetTextContent(siteUrl[0]);
            }
            else {
                param.siteUrl = TAB.GetTextContent(_this.siteUrlField);
            }
            return Boolean(param.siteUrl);
        }));
        TAB.Log.AddTaskComment('Wait for create button to enable');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            _this.createButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this.rootElement, 'createForm-createButton');
            if (_this.createButton) {
                /* tslint:disable:no-null-keyword */
                return _this.createButton.getAttribute('disabled') === null;
                /* tslint:enable:no-null-keyword */
            }
            return false;
        }));
        TAB.Log.AddTaskComment('Click on Create button to create group');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.createButton.click();
        }), template === CreateSiteTemplateOption.Publishing ? this._waitForPageLoaded() : undefined);
    };
    CreateSiteForm.prototype.AddTaskSelectDesign = function (param) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this.selectDesign(param);
        }));
    };
    CreateSiteForm.prototype._waitForPageLoaded = function () {
        var waiter = TAB.MakeWaiter(function () {
            var elements = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'SPPageChrome');
            return Boolean(elements.length > 0);
        });
        return waiter;
    };
    CreateSiteForm.prototype.getFormContent = function () {
        this.groupNameField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'createForm-groupName');
        this.groupDescriptionField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'createForm-description');
        this.createButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'createForm-createButton');
        if (this.siteTemplate === CreateSiteTemplateOption.Publishing) {
            this.designPackageField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.panelRoot, 'ms-designPackageSelector-choiceDropdown');
        }
    };
    CreateSiteForm.prototype.getGroupDetailFields = function () {
        this.groupAliasField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'createForm-groupAlias');
        this.siteUrlField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'createForm-siteUrl');
        if (this.siteTemplate === CreateSiteTemplateOption.TeamSite) {
            this.privacyField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'createForm-privacy');
        }
    };
    CreateSiteForm.prototype.waitForDetailFields = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            _this.getGroupDetailFields();
            return (Boolean(_this.groupAliasField) &&
                Boolean(_this.siteUrlField) &&
                (_this.siteTemplate === CreateSiteTemplateOption.Publishing || Boolean(_this.privacyField)));
        });
    };
    CreateSiteForm.prototype.setTextFieldValue = function (formField, value) {
        var inputElement = (TAB.GetElement(formField, TAB.searchBy.tag, 'input'));
        inputElement.value = value;
        TAB.FireChangeEvent(inputElement);
    };
    CreateSiteForm.prototype.setTextAreaFieldValue = function (formField, value) {
        var textAreaElement = (TAB.GetElement(formField, TAB.searchBy.tag, 'textarea'));
        textAreaElement.value = value;
        TAB.FireChangeEvent(textAreaElement);
    };
    CreateSiteForm.prototype.selectPrivatePolicy = function () {
        if (!_SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_1__["SPKillSwitchUtil"].isActivated('9bbc6ebe-ed86-4521-a784-cac83ac4d265')) {
            var newPrivacyField = (TAB.GetElement(TAB.Win, TAB.searchBy.id, 'od-Group-privacyDropdown'));
            newPrivacyField.value = 'Private - only members can access this site';
            TAB.FireChangeEvent(newPrivacyField);
        }
        else {
            var privacyField = (TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'od-DropdownFormField-select'));
            privacyField[0].value = 'Private - only members can access this site';
            TAB.FireChangeEvent(privacyField);
        }
    };
    CreateSiteForm.prototype.selectDesign = function (param) {
        if (param.designPackage === undefined) {
            return;
        }
        var designField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(TAB.Win, 'ms-designPackageSelector-choiceDropdown')[0];
        TAB.ClickElement(designField);
        var calloutField = (TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Callout-main'));
        var buttons = TAB.GetElements(calloutField, TAB.searchBy.hasClassName, 'ms-Button--command');
        // buttons[option].click();
        if (param.designPackage === DesignPackageOption.Topic) {
            TAB.ClickElement(buttons[0]);
        }
        else if (param.designPackage === DesignPackageOption.Showcase) {
            TAB.ClickElement(buttons[1]);
        }
        else if (param.designPackage === DesignPackageOption.Blank) {
            TAB.ClickElement(buttons[2]);
        }
    };
    return CreateSiteForm;
}());
var AddMemberForm = /** @class */ (function () {
    function AddMemberForm(panelRoot) {
        this.rootElement = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(panelRoot, 'addMemberForm');
        this.getFormContent();
    }
    AddMemberForm.prototype.AddTaskVerifyForm = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Verify(Boolean(_this.rootElement), 'Add member form is displayed');
            TAB.Log.Verify(Boolean(_this.addOwnerField), 'Add Owner dropdown found');
            TAB.Log.Verify(Boolean(_this.addMemberField), 'Add Member dropdown found');
        }));
    };
    AddMemberForm.prototype.WaitForDoneButton = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            _this.doneButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_this.rootElement, 'addMemberForm-doneButton');
            if (_this.doneButton) {
                /* tslint:disable:no-null-keyword */
                if (_this.doneButton.getAttribute('disabled') === null) {
                    /* tslint:enable:no-null-keyword */
                    TAB.Log.Comment('Done button enabled, group created successfully');
                    return true;
                }
                else {
                    return false;
                }
            }
            return false;
        });
    };
    AddMemberForm.prototype.AddTaskClickDone = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this.doneButton.click();
        }));
    };
    AddMemberForm.prototype.getFormContent = function () {
        this.addOwnerField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'addMemberForm-addOwner');
        this.addMemberField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this.rootElement, 'addMemberForm-addMember');
    };
    return AddMemberForm;
}());
/**
 * @public
 */
var CreateSitePanel = /** @class */ (function () {
    function CreateSitePanel(inPage, SPHomePanel) {
        if (inPage) {
            this.rootElement = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'od-GroupCreate');
        }
        else {
            this.rootElement = CreateSitePanel.getPanelRootElement(SPHomePanel);
        }
    }
    CreateSitePanel.WaitForPanel = function (SPHomePanel) {
        return TAB.MakeWaiter(function () {
            return Boolean(CreateSitePanel.getPanelRootElement(SPHomePanel));
        });
    };
    CreateSitePanel.getPanelRootElement = function (SPHomePanel) {
        var iFrameDialog = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'Create-site-panel-iframe-container');
        if (iFrameDialog) {
            var iFrameContainer = (TAB.GetElement(iFrameDialog, TAB.searchBy.tag, 'iframe'));
            if (iFrameContainer) {
                return TAB.GetElements(iFrameContainer.contentDocument, TAB.searchBy.hasClassName, 'od-GroupCreate')[0];
            }
        }
        return undefined;
    };
    CreateSitePanel.prototype.AddTaskVerifyForm = function (formType, siteTemplate) {
        switch (formType) {
            case CreateSitePanelForm.ChooseTemplate:
                this.addTaskVerifyChooseTemplateForm();
                break;
            case CreateSitePanelForm.CreateSite:
                this.addTaskVerifyCreateSiteForm(siteTemplate);
                break;
            case CreateSitePanelForm.AddMember:
                this.addTaskVerifyAddMemberForm();
                break;
        }
    };
    CreateSitePanel.prototype.AddTaskChooseTemplate = function (templateOption) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this.chooseTemplateForm) {
                _this.chooseTemplateForm.AddTaskChooseTemplate(templateOption);
            }
        }));
    };
    CreateSitePanel.prototype.AddTaskCreateSite = function (createSiteParam, template) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this.createSiteForm) {
                _this.createSiteForm.AddTaskCreateSite(createSiteParam, template);
            }
        }));
    };
    CreateSitePanel.prototype.AddTaskFinish = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.AddTask(undefined, _this.addMemberForm.WaitForDoneButton());
            _this.addMemberForm.AddTaskClickDone();
        }));
    };
    CreateSitePanel.prototype.addTaskVerifyChooseTemplateForm = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying Template Picker form');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.chooseTemplateForm = new ChooseTemplateForm(_this.rootElement);
            _this.chooseTemplateForm.AddTaskVerifyForm();
        }));
    };
    CreateSitePanel.prototype.addTaskVerifyCreateSiteForm = function (siteTemplate) {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying Create Site form');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.createSiteForm = new CreateSiteForm(_this.rootElement, siteTemplate);
            _this.createSiteForm.AddTaskVerifyForm();
        }));
    };
    CreateSitePanel.prototype.addTaskVerifyAddMemberForm = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying Add Member form');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.addMemberForm = new AddMemberForm(_this.rootElement);
            _this.addMemberForm.AddTaskVerifyForm();
        }));
    };
    return CreateSitePanel;
}());



/***/ }),

/***/ "KBAH":
/*!*************************************************!*\
  !*** ./lib/SPTaskLib/Controls/EventsWebPart.js ***!
  \*************************************************/
/*! exports provided: EventsWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventsWebPart", function() { return EventsWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _EventPage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./EventPage */ "lIY2");
/* harmony import */ var _SPPerfExperimentUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../SPPerfExperimentUtil */ "xAAm");








/**
 * @public
 */
var EventsWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(EventsWebPart, _super);
    function EventsWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].Events, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].Events.toString()) || this;
    }
    EventsWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this._addTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(_this);
        }), this._waitForWebPartToExist());
    };
    EventsWebPart.prototype.AddTaskAddEvent = function (title) {
        var _this = this;
        var eventPage;
        TAB.MakeTask(function () {
            TAB.Log.Comment('Events web part starts creating an new event.');
            _this.AddTaskCreateEmptyEvent(function (instance) { return (eventPage = instance); });
        }).WaitFor(TAB.MakeWaiter(function () { return eventPage !== undefined; }));
        TAB.MakeTask(function () {
            eventPage.AddTaskInputEventTitle(title);
            eventPage.AddTaskInputEventLink('http://example.net');
            eventPage.AddTaskInputLocation('Jiangsu, Suzhou');
            eventPage.AddTaskInputEventDate();
            eventPage.AddTaskSaveEvent();
            eventPage.AddTaskNavigateBack(true /* ensure event item */);
        }).WaitFor(undefined);
    };
    EventsWebPart.prototype.AddTaskEditFirstEvent = function (title) {
        var _this = this;
        var eventPage;
        TAB.MakeTask(function () {
            TAB.Log.Comment('Event page starts editing the first event.');
            _this.AddTaskNavigateToFirstEvent(function (instance) { return (eventPage = instance); });
        }).WaitFor(TAB.MakeWaiter(function () { return eventPage !== undefined; }));
        TAB.MakeTask(function () {
            eventPage.AddTaskEditEvent();
            eventPage.AddTaskInputEventTitle(title);
            eventPage.AddTaskInputEventLink('http://newLink.net');
            eventPage.AddTaskInputLocation('Jiangsu, Suzhou');
            eventPage.AddTaskInputEventDate();
            eventPage.AddTaskSaveEvent();
            eventPage.AddTaskNavigateBack(true /* ensure event item*/);
        }).WaitFor(undefined);
    };
    EventsWebPart.prototype.AddTaskDeleteFirstEvent = function () {
        var _this = this;
        var eventPage;
        TAB.MakeTask(function () {
            TAB.Log.Comment('Event page starts deleting the first event.');
            _this.AddTaskNavigateToFirstEvent(function (instance) { return (eventPage = instance); });
        }).WaitFor(TAB.MakeWaiter(function () { return eventPage !== undefined; }));
        TAB.MakeTask(function () {
            eventPage.AddTaskDeleteEvent();
            eventPage.AddTaskNavigateBack(true /* ensure event item*/);
        }).WaitFor(undefined);
    };
    EventsWebPart.prototype.AddTaskCreateEmptyEvent = function (ref) {
        var _this = this;
        var eventPage;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._sitePageUrl = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_5__["TeamSitePage"].PageUrl || TAB.Win.location.href;
            eventPage = new _EventPage__WEBPACK_IMPORTED_MODULE_6__["EventPage"](_this._sitePageUrl);
            ref(eventPage);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var addEvent = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'eventsAddButton');
            TAB.ClickElement(addEvent);
        }), TAB.MakeWaiter(function () {
            return eventPage.InEditMode;
        }));
    };
    EventsWebPart.prototype.AddTaskNavigateToFirstEvent = function (ref) {
        var _this = this;
        var eventPage;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._sitePageUrl = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_5__["TeamSitePage"].PageUrl || TAB.Win.location.href;
            eventPage = new _EventPage__WEBPACK_IMPORTED_MODULE_6__["EventPage"](_this._sitePageUrl);
            var firstEventElement;
            if (_SPPerfExperimentUtil__WEBPACK_IMPORTED_MODULE_7__["SPPerfExperimentUtil"].getPerfExperimentVariant(90074) === 1) {
                firstEventElement = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='event-card-title']")[0];
            }
            else {
                var eventElement = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='multipleDayBox']");
                if (eventElement && eventElement.length >= 1) {
                    firstEventElement = eventElement[0];
                }
                else {
                    firstEventElement = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='singleDayBox']")[0];
                }
            }
            TAB.ClickElement(firstEventElement);
        }), TAB.MakeWaiter(function () { return eventPage.InReadMode; }));
        TAB.AddTask(TAB.MakeTask(function () {
            ref(eventPage);
        }));
    };
    EventsWebPart.prototype.GetEventItemCount = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="event-card-title"]')
            .length;
    };
    EventsWebPart.prototype.AddTaskAssertHasEvent = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this.GetEventItemCount() === 0) {
                throw 'No event item shown in event web part.';
            }
        }));
    };
    EventsWebPart.prototype._waitForWebPartToExist = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            return _this._isEventsWebPartExist();
        });
    };
    EventsWebPart.prototype._addTaskAssertWebPartNotExist = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Assert Events web part not exist');
            if (_this._isEventsWebPartExist()) {
                throw 'Events web part should not exist.';
            }
        }), undefined);
    };
    EventsWebPart.prototype._isEventsWebPartExist = function () {
        if (_SPPerfExperimentUtil__WEBPACK_IMPORTED_MODULE_7__["SPPerfExperimentUtil"].getPerfExperimentVariant(90074) === 1) {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='event-card-title']") ||
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='empty-state-preview']"));
        }
        return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='multipleDayBox']") ||
            TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='singleDayBox']") ||
            TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='empty-state-preview']"));
    };
    return EventsWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "LH7+":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Pages/TranslationUtil.js ***!
  \************************************************/
/*! exports provided: TranslationUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TranslationUtil", function() { return TranslationUtil; });
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../PageUtil */ "jK1H");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Controls__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Controls */ "iDSo");
/* harmony import */ var _PropertyPane__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PropertyPane */ "M/CL");





/**
 * @internal
 */
var TranslationUtil = /** @class */ (function () {
    function TranslationUtil() {
    }
    Object.defineProperty(TranslationUtil, "panelRoot", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'translatePanelMain');
        },
        enumerable: true,
        configurable: true
    });
    TranslationUtil.AddTaskVerifyLanguageSelector = function (siteURL) {
        TAB.AddTask(TAB.MakeTask(function () {
            var currentPageTitle;
            var originalPageButton;
            var languageButtons;
            var currentURL = siteURL;
            var msCallout;
            var unSelectedButton = [];
            var originalNewsPostItems = [];
            var translatedNewsPostItems = [];
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.AddTaskComment('Record Page Title');
                currentPageTitle = TAB.Win.document.title;
            }));
            TranslationUtil.AddTaskScrollToBottom();
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.AddTaskComment('record original news post items');
            }), TAB.MakeWaiter(function () {
                originalNewsPostItems = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementsByDataAutomationId(TAB.Win, 'newsItemTitle');
                if (!!originalNewsPostItems && originalNewsPostItems.length === 1) {
                    return true;
                }
                return false;
            }));
            TranslationUtil.AddTaskClickOnLanguageSelector(msCallout);
            TAB.AddTask(TAB.MakeTask(function () {
                msCallout = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-items');
                languageButtons = TAB.GetElements(msCallout, TAB.searchBy.tag, 'button');
                languageButtons.forEach(function (button) {
                    if (button.attributes['aria-selected'].value !== 'true') {
                        unSelectedButton.push(button);
                    }
                    else {
                        originalPageButton = button;
                    }
                });
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.ClickElement(unSelectedButton[0]);
            }), TAB.AndWaiters(TAB.MakeWaiter(function () {
                var url = currentURL;
                if (url.indexOf('?') > -1) {
                    url = url.substr(0, url.indexOf('?'));
                }
                return TAB.Win.location.href.localeCompare(url) !== 0;
            }), _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].PageReady()));
            TAB.Log.AddTaskPass('Verified URL changed');
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.AddTaskComment('Verify Page Title changed');
            }), TAB.MakeWaiter(function () {
                return TAB.Win.document.title.localeCompare(currentPageTitle) !== 0;
            }));
            TAB.Log.AddTaskPass('Verify Page Title changed');
            TranslationUtil.AddTaskScrollToBottom();
            TAB.AddTask(TAB.MakeTask(function () {
                translatedNewsPostItems = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementsByDataAutomationId(TAB.Win, 'newsItemTitle');
                var originalTitle = originalNewsPostItems[0]
                    ? TAB.GetTextContent(originalNewsPostItems[0])
                    : '';
                var translatedTitle = translatedNewsPostItems[0]
                    ? TAB.GetTextContent(translatedNewsPostItems[0])
                    : '';
                TAB.Log.Comment("originalTitle: " + originalTitle);
                TAB.Log.Comment("translatedTitle: " + translatedTitle);
            }), TAB.MakeWaiter(function () {
                var originalTitle = originalNewsPostItems[0]
                    ? TAB.GetTextContent(originalNewsPostItems[0])
                    : '';
                var translatedTitle = translatedNewsPostItems[0]
                    ? TAB.GetTextContent(translatedNewsPostItems[0])
                    : '';
                return translatedNewsPostItems.length === 1 && translatedTitle.localeCompare(originalTitle) !== 0;
            }));
            TAB.Log.AddTaskPass('Verified news post title changed in news webpart');
            var documentCards;
            TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                return TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-DocumentCardTitle');
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('compare news post in highlighted content with news webpart');
                documentCards = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-DocumentCardTitle');
                for (var i = 0; i < documentCards.length; i++) {
                    if (TAB.GetTextContent(documentCards[i]).localeCompare(TAB.GetTextContent(translatedNewsPostItems[0])) === 0) {
                        return true;
                    }
                }
                TAB.Log.AddTaskFail("news post title don't match between highlighted content webpart and news webpart");
            }));
            TAB.Log.AddTaskPass('Verified Content Rollup works');
            TAB.Log.AddTaskComment('go back to original page');
            TranslationUtil.AddTaskClickOnLanguageSelector(msCallout);
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.AddTaskComment('Click on original page button');
                msCallout = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-items');
                languageButtons = TAB.GetElements(msCallout, TAB.searchBy.tag, 'button');
                for (var i = 0; i < languageButtons.length; i++) {
                    if (languageButtons[i].attributes['aria-label'].value.localeCompare(originalPageButton.attributes['aria-label'].value) === 0) {
                        TAB.ClickElement(languageButtons[i]);
                        break;
                    }
                }
            }), TAB.MakeWaiter(function () {
                var url = currentURL;
                if (url.indexOf('?') > -1) {
                    url = url.substr(0, url.indexOf('?'));
                }
                return TAB.Win.location.href.localeCompare(url) === 0;
            }));
            TAB.Log.AddTaskPass('Verify URL matches with original URL');
        }));
    };
    TranslationUtil.AddTaskCreateTranslatedPage = function (pageName, siteInfo) {
        var news = new _Controls__WEBPACK_IMPORTED_MODULE_3__["NewsWebPart"]();
        this.highlightedContent = new _Controls__WEBPACK_IMPORTED_MODULE_3__["HighlightedContentWebPart"]();
        _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].AddTaskCreateSitePage(false /* Not news*/, siteInfo.SiteName, 'teams');
        TAB.Log.AddTaskComment('Navigated to new page');
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskEditPage();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskAddPageTitle(pageName);
        news.AddTaskAddWebpartOnPage(false);
        this.highlightedContent.addWebPartToPage();
        this.highlightedContent.AddTaskOpenPropertyPane();
        this.highlightedContent.AddTaskSelectContentSitePageOption();
        _PropertyPane__WEBPACK_IMPORTED_MODULE_4__["PropertyPane"].AddTaskClosePropertyPane();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskSavePage();
        TranslationUtil.AddTaskCreatePageTranslations(false);
    };
    TranslationUtil.AddTaskAddNewsPostAndTranslate = function (siteName) {
        TAB.Log.AddTaskComment('translate news page');
        _PageUtil__WEBPACK_IMPORTED_MODULE_0__["PageUtil"].AddTaskCreateSitePage(true /* shouldCreateNewsPage*/, siteName, 'teams');
        // disable FRE modal
        var localStorage = TAB.Win.window.localStorage;
        if (localStorage) {
            TAB.Log.AddTaskComment('Disabling First Run Experience for pages.');
            localStorage.setItem(
            /* libraries/sp-coachmark-utility/src/FirstRunExperience/Constants */
            'CompletedFirstRunExp', '99.0');
        }
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskCreateNewsPostFromNewsPage();
        TAB.Log.AddTaskPass('Created a news post');
        // real issue, page can't be saved due to enter name too fast
        // TODO: remove once https://onedrive.visualstudio.com/WEX!/_workitems/edit/869121/
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskAddPageTitle('translated-news-page-1');
        TranslationUtil.AddTaskVerifyPageSaveStatusSaved();
        // retrigger focus and blur otherwise sometimes it won't save
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskAddPageTitle('');
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskAddPageTitle('translated-news-page-1');
        TranslationUtil.AddTaskVerifyPageSaveStatusReset();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskSavePage();
        TranslationUtil.AddTaskCreatePageTranslations(true);
    };
    TranslationUtil.AddTaskCreatePageTranslations = function (isNewsPage) {
        TranslationUtil.AddTaskWaitForTranslationButtonToBeEnabled();
        // Click translation command bar button
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Open translation panel');
            var translationButton = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'translationCommandBarButton');
            TAB.ClickElement(translationButton);
        }), 
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TranslationUtil.panelRoot, 'translateToAllEnabled'));
        // Click start all translations button inside the translation panel
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Start translating for all languages');
            var translateButton = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TranslationUtil.panelRoot, 'translateToAllEnabled');
            TAB.ClickElement(translateButton);
        }), TAB.AndWaiters(_Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'translatePanelMain'), TAB.MakeWaiter(function () {
            var elements = TAB.GetElements(TranslationUtil.panelRoot, TAB.searchBy.customQuery, "[data-automation-id^='viewTranslation_']");
            return !!elements && elements.length > 0;
        })));
        TAB.Log.AddTaskPass('Started translating for all languages');
        // Go to translation
        TAB.AddTask(TAB.MakeTask(function () {
            var viewPageLinks = [];
            TAB.GetElements(TranslationUtil.panelRoot, TAB.searchBy.customQuery, "[data-automation-id^='viewTranslation_']").forEach(function (link) { return viewPageLinks.push(link.getAttribute('href')); });
            var _loop_1 = function (link) {
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.AddTask(TAB.LoadPage("" + link), TAB.AndWaiters(TAB.MakeWaiter(function () {
                        return "" + link === TAB.Win.location.href;
                    }), TAB.PageReady()));
                    // 1. check translation banner appear and disappear properly
                    // 2. edit button shows and hide
                    // because sometimes command bar shows a placeholder and render an empty bar,
                    // there is no good way detect it so just wait for translation banner disappear
                    _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskWaitForPageStatusNotifierAppearAndDisappear();
                    _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskPublishPage(false, isNewsPage);
                    TAB.AddTask(TAB.MakeTask(function () {
                        TAB.Log.Comment('wait for publish button disappear');
                    }), TAB.MakeWaiter(function () {
                        try {
                            return !_Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].GetCommandBar(), 'pageCommandBarPublishButton');
                        }
                        catch (e) {
                            return true;
                        }
                    }));
                }), undefined);
            };
            for (var _i = 0, viewPageLinks_1 = viewPageLinks; _i < viewPageLinks_1.length; _i++) {
                var link = viewPageLinks_1[_i];
                _loop_1(link);
            }
            // The above tasks will take us away from the current page, so we need to go back to it
            var currentUrl = TAB.Win.location.href;
            // Get rid of the ?Mode=Edit and add ?stay=true so that we don't get redirected for any reason
            if (currentUrl.indexOf('?') > -1) {
                currentUrl = currentUrl.substr(0, currentUrl.indexOf('?')) + '?stay=true';
            }
            TAB.Log.AddTaskComment("Going to main page at " + currentUrl);
            if (isNewsPage) {
                TAB.AddTask(TAB.LoadPage(currentUrl), TAB.AndWaiters(TAB.MakeWaiter(function () {
                    return currentUrl === TAB.Win.location.href;
                }), TAB.PageReady()));
                _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskWaitForCommandBar();
                _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskWaitForEditButton();
                _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskEditPage();
                _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].AddTaskPublishPage(false, true);
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.Log.Comment('wait for publish button disappear');
                }), TAB.MakeWaiter(function () {
                    try {
                        return !_Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].GetCommandBar(), 'pageCommandBarPublishButton');
                    }
                    catch (e) {
                        return true;
                    }
                }));
            }
            else {
                TAB.AddTask(TAB.LoadPage(currentUrl), TAB.PageReady());
            }
        }), 
        /* tslint:disable-next-line:no-any */
        _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'LanguageSelector'));
    };
    TranslationUtil.AddTaskWaitForTranslationButtonToBeEnabled = function () {
        var translationButtonOnCommandBar;
        TAB.AddTask(TAB.MakeTask(function () { return TAB.Log.Comment('Start waiting for translation command bar button'); }));
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].MakeTaskFindButtonInCommandBar('translationCommandBarButton');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Wait translation button to be enabled');
            translationButtonOnCommandBar = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'translationCommandBarButton');
        }), TAB.MakeWaiter(function () {
            return ((translationButtonOnCommandBar.attributes['data-is-focusable'] &&
                translationButtonOnCommandBar.attributes['data-is-focusable'].value === 'true') ||
                (translationButtonOnCommandBar.attributes['aria-disabled'] &&
                    translationButtonOnCommandBar.attributes['aria-disabled'].value === 'false'));
        }));
    };
    TranslationUtil.AddTaskVerifyPageSaveStatusSaved = function () {
        TAB.AddTask(TAB.MakeTask(function () { return TAB.Log.Comment("wait for page save status to be displayed"); }), _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'pageCommandBarStatus'));
        TAB.AddTask(TAB.MakeTask(function () { return TAB.Log.Comment("wait for page save status to become Saved"); }), TAB.MakeWaiter(function () {
            var pageCommandBarStatus = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'pageCommandBarStatus');
            return (pageCommandBarStatus.attributes['data-automation-icon'] &&
                pageCommandBarStatus.attributes['data-automation-icon'].value === 'CheckMark');
        }));
    };
    TranslationUtil.AddTaskVerifyPageSaveStatusReset = function () {
        TAB.AddTask(undefined, _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'pageCommandBarStatus'));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var pageCommandBarStatus = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'pageCommandBarStatus');
            return (pageCommandBarStatus.attributes['data-automation-icon'] &&
                pageCommandBarStatus.attributes['data-automation-icon'].value !== 'CheckMark');
        }));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var pageCommandBarStatus = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'pageCommandBarStatus');
            return (pageCommandBarStatus.attributes['data-automation-icon'] &&
                pageCommandBarStatus.attributes['data-automation-icon'].value === 'CheckMark');
        }));
    };
    TranslationUtil.AddTaskScrollToBottom = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-is-scrollable='true']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Verify news post title changed in news webpart');
            // scroll to bottom to make sure all webparts are loaded
            var scrollRegion = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-is-scrollable='true']");
            scrollRegion.scrollTo(0, scrollRegion.scrollHeight);
        }), _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'newsItemTitle'));
    };
    TranslationUtil.AddTaskClickOnLanguageSelector = function (msCallout) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('scroll to top');
            // scroll to bottom to make sure all webparts are loaded
            var scrollRegion = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-is-scrollable='true']");
            scrollRegion.scrollTo(0, 0);
        }), TAB.MakeWaiter(function () {
            try {
                return !!_Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'LanguageSelector');
            }
            catch (_a) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click on language selector and wait for langauge dropdown');
            TAB.ClickElement(_Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win, 'LanguageSelector'));
        }), TAB.MakeWaiter(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-items')) {
                msCallout = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-items');
                return (!!TAB.GetElements(msCallout, TAB.searchBy.tag, 'button') &&
                    TAB.GetElements(msCallout, TAB.searchBy.tag, 'button').length > 0);
            }
            return false;
        }));
        TAB.Log.AddTaskPass('Click on language selector and wait for langauge dropdown');
    };
    return TranslationUtil;
}());



/***/ }),

/***/ "Lp+w":
/*!********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/DocumentEmbedWebpart.js ***!
  \********************************************************/
/*! exports provided: DocumentEmbedWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentEmbedWebpart", function() { return DocumentEmbedWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");




/**
 * @public
 */
var DocumentEmbedWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(DocumentEmbedWebpart, _super);
    function DocumentEmbedWebpart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Document, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Document.toString()) || this;
    }
    DocumentEmbedWebpart.prototype.AddTaskAddOnExistingTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(this.WaitForWebPartToExist());
    };
    DocumentEmbedWebpart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this.AddTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(this.WaitForWebPartToExist());
    };
    DocumentEmbedWebpart.prototype.AddTaskUploadFile = function (fileInput) {
        TAB.AddTask(undefined /* task */, this.WaitForFilePickerToExist());
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskCreateFilePicker();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Upload file');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].FilePicker.AddTaskUploadItem(fileInput);
        }), this._waitForNewAddedItemToExist());
    };
    DocumentEmbedWebpart.prototype.AddTaskOpenFile = function (fileUrl) {
        TAB.AddTask(undefined /* task */, this.WaitForFilePickerToExist());
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskCreateFilePicker();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Upload file');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].FilePicker.AddTaskAddFromUrl(fileUrl);
        }), this._waitForNewAddedItemToExist());
    };
    DocumentEmbedWebpart.prototype.WaitForWebPartToExist = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + DocumentEmbedWebpart.documentAutomationId + "']");
    };
    DocumentEmbedWebpart.prototype.WaitForFilePickerToExist = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="filePicker"]');
    };
    DocumentEmbedWebpart.prototype.WaitForFilePickerToClose = function () {
        return TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="filePicker"]');
        });
    };
    DocumentEmbedWebpart.prototype.AddTaskClickDocument = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking on the document');
            var elements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + DocumentEmbedWebpart.documentAutomationId + "']");
            var imageArea = TAB.GetElements(elements[0], TAB.searchBy.partialClassName, 'ms-Image');
            TAB.ClickElement(imageArea[0]);
        }));
    };
    DocumentEmbedWebpart.prototype.AddTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + DocumentEmbedWebpart.documentAutomationId + "']")) {
                throw 'Document web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    DocumentEmbedWebpart.prototype._waitForNewAddedItemToExist = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            return _this._newAddedItemExistsNewWebpart() || _this._newAddedItemExistsOldWebpart();
        });
    };
    DocumentEmbedWebpart.prototype._newAddedItemExistsNewWebpart = function () {
        var elements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-sp-feature-tag='DocumentEmbedWebPart web part (File viewer)']");
        return elements.length > 0;
    };
    DocumentEmbedWebpart.prototype._newAddedItemExistsOldWebpart = function () {
        var elements = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-DocumentCard');
        return elements.length > 0;
    };
    DocumentEmbedWebpart.documentAutomationId = 'DocumentEmbed';
    return DocumentEmbedWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "Lu9u":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/Pages/TopicPage.js ***!
  \******************************************/
/*! exports provided: TopicPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopicPage", function() { return TopicPage; });
/* harmony import */ var _ListLibrary__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ListLibrary */ "7on5");
/* harmony import */ var _Mocks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Mocks */ "4upd");
/**
 * @Copyright (c) Microsoft Corporation.  All rights reserved.
 */


/**
 * @public
 */
var TopicPage = /** @class */ (function () {
    function TopicPage() {
    }
    /**
     * Config mock topic data before access any topic feature which requires substrate or sphome API call.
     */
    TopicPage.AddTaskConfigTopicMockDataForTab = function () {
        TAB.AddTask(TAB.LoadPage(TAB.Settings.Get('ProductServer')), TAB.PageReady());
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Win.window.sessionStorage.setItem(TopicPage.isRunTABKey, 'true');
            TAB.Win.window.sessionStorage.setItem(_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"].TOPIC_SUGGESTION, JSON.stringify(_Mocks__WEBPACK_IMPORTED_MODULE_1__["CortexMockData"][_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"].TOPIC_SUGGESTION]));
            TAB.Win.window.sessionStorage.setItem(_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"].MYTOPICS, JSON.stringify(_Mocks__WEBPACK_IMPORTED_MODULE_1__["CortexMockData"][_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"].MYTOPICS]));
        }), undefined);
        TopicPage.AddTaskClearCortexDisbleFlag();
    };
    TopicPage.AddTaskRemoveTopicMockDataForTab = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Win.window.sessionStorage.removeItem(TopicPage.isRunTABKey);
            TAB.Win.window.sessionStorage.removeItem(_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"].TOPIC_SUGGESTION);
            TAB.Win.window.sessionStorage.removeItem(_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"].MYTOPICS);
        }), undefined);
        TopicPage.AddTaskClearCortexDisbleFlag();
    };
    TopicPage.AddTaskLoadTopicCenter = function () {
        var topicCenterUrl = TAB.Settings.Get('ProductServer') + ("" + this.knowledgePath);
        TAB.AddTask(TAB.LoadPage(topicCenterUrl), TAB.AndWaiters(TAB.PageReady(), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'ms-CommandBar')));
        TopicPage.AddTaskClearCortexDisbleFlag();
    };
    TopicPage.AddTaskClickNewTopicPageCommand = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for New button exist on the command bar');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarNewButton']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for 2 seconds...');
            setTimeout(function () {
                TAB.Log.Comment('Clicking New button');
                var newButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarNewButton']");
                TAB.ClickElement(newButton);
                TAB.Log.Comment('Waiting for New Topic Page button exist on the menu');
            }, 2000);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='CommandBarNewTopicButton']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking New Topic Page button');
            var newTopicPageButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='CommandBarNewTopicButton']");
            TAB.ClickElement(newTopicPageButton);
        }), TopicPage.waitForEditTopicPageReady());
        TopicPage.AddTaskClearCortexDisbleFlag();
    };
    TopicPage.AddTaskCreateNewTopicPageByUrl = function () {
        var newPageUrl = TAB.Settings.Get('ProductServer') + ("" + this.knowledgePath) + ("" + this.createNewTopicUrl);
        TAB.AddTask(TAB.LoadPage(newPageUrl), TAB.AndWaiters(TAB.PageReady(), TopicPage.waitForEditTopicPageReady()));
    };
    TopicPage.AddTaskAddTopicTitle = function (value) {
        TopicPage.AddTaskClearCortexDisbleFlag();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for page title to finish rendering in edit mode');
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageTitleInput']");
        }));
        var titleInputElement = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            titleInputElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageTitleInput']");
            var focusEv = TAB.Win.document.createEvent('HTMLEvents');
            focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
            titleInputElement.dispatchEvent(focusEv);
            titleInputElement.value = value;
            var inputEvent = TAB.Win.document.createEvent('HTMLEvents');
            inputEvent.initEvent('input', true /*bubble*/, false /*cancelable*/);
            titleInputElement.dispatchEvent(inputEvent);
            TAB.FireKeyboardEvent(titleInputElement, 'keypress', 13 /*Enter*/);
            var blurEv = TAB.Win.document.createEvent('HTMLEvents');
            blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
            titleInputElement.dispatchEvent(blurEv);
        }), TAB.MakeWaiter(function () {
            if (titleInputElement) {
                return !!titleInputElement.value;
            }
            return false;
        }));
    };
    TopicPage.AddTaskAddTopicDefinition = function (value) {
        TopicPage.AddTaskClearCortexDisbleFlag();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for RTE webpart to finish rendering in edit mode');
        }), TAB.MakeWaiter(function () {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='textBox']") &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'cke_editable'));
        }));
        var textboxElement = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Clicking inside topic definition editor");
            var textboxContainer = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='textBox']");
            textboxElement = TAB.GetElement(textboxContainer, TAB.searchBy.customQuery, "[role='textbox']");
            TAB.ClickElement(textboxElement);
            TAB.Log.Comment("Set text content to \"" + value + "\"");
            textboxElement.innerHTML = value;
            // Setting textContent programmatically won't fire change event of CKEditor.
            // While user typing can file the event successfully.
            TAB.Log.Comment('Fire change events to make sure text content got serialized');
            var ckeditorInstances = TAB.Win.window.CKEDITOR.instances;
            Object.keys(ckeditorInstances).forEach(function (key) {
                try {
                    ckeditorInstances[key].fire('change');
                    TAB.Log.Comment('Change event fired');
                }
                catch (error) {
                    TAB.Log.Comment('There might be some instances left on previous pages, but we do not want to fail' +
                        ' the tab test since we will check the serialized data');
                    TAB.Log.Comment("Error Message: " + error.message);
                }
            });
        }), TAB.MakeWaiter(function () {
            if (textboxElement) {
                return textboxElement.innerHTML === value;
            }
            return false;
        }));
    };
    TopicPage.AddTaskPublishTopicPage = function () {
        TopicPage.AddTaskClearCortexDisbleFlag();
        var publishButton = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for the publish button');
        }), TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'commandBarWrapper'), TAB.MakeWaiter(function () {
            try {
                publishButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarPublishButton']");
                if (publishButton) {
                    TAB.Log.Comment('Publish button is on the page');
                    return true;
                }
                return false;
            }
            catch (e) {
                return false;
            }
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for 2 seconds...');
            // Make sure the PageStore fields data get updated by timer.
            setTimeout(function () {
                TAB.Log.Comment('Clicking the publish button on the command bar');
                TAB.ClickElement(publishButton);
            }, 2000);
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('Waiting for pre-publish callout');
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublishPanel']");
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking the publish button on the pre-publish panel');
            var submitButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-SubmitButton']");
            TAB.ClickElement(submitButton);
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('Waiting for page to be published');
            if (!TopicPage.editMode) {
                return true;
            }
            return false;
        }));
    };
    /**
     * This flag is set when any substrate or sphome API get 403 error.
     * Clear the flag so any topic related UI can be rendered.
     */
    TopicPage.AddTaskClearCortexDisbleFlag = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clearing cortexDisableFlag in session storage');
            TAB.Win.window.sessionStorage.removeItem(TopicPage.cortexDisableFlagKey);
        }), undefined);
    };
    TopicPage.AddRestTaskDeleteNewCreatedTopicPage = function () {
        TopicPage.AddTaskClearCortexDisbleFlag();
        TAB.Log.Comment('Deleting new created topic test page...');
        var pageUrl = TAB.Win.location.href;
        pageUrl = pageUrl.split('?', 1)[0];
        var rootUrl = TAB.Settings.Get('ProductServer');
        var siteUrl = rootUrl + this.knowledgePath;
        pageUrl = pageUrl.substr(rootUrl.length);
        _ListLibrary__WEBPACK_IMPORTED_MODULE_0__["List"].addRestTaskDeleteItem(siteUrl, siteUrl, pageUrl);
    };
    Object.defineProperty(TopicPage, "editMode", {
        get: function () {
            try {
                return TAB.Win.location.search.indexOf('Mode=Edit') > -1;
            }
            catch (error) {
                return false;
            }
        },
        enumerable: true,
        configurable: true
    });
    TopicPage.waitForEditTopicPageReady = function () {
        // Make sure edit mode render completed.
        return TAB.AndWaiters(TAB.MakeWaiter(function () {
            return (TAB.Win.location.search.indexOf('Mode=Edit') > -1 &&
                TAB.Win.location.search.indexOf('isNewTopicPage=true') > -1);
        }), TAB.MakeWaiter(function () {
            try {
                var rteElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='textBox']");
                return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageTitleInput']") &&
                    TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='alternate-names-list']") &&
                    TAB.ElementExists(rteElement, TAB.searchBy.customQuery, "[role='textbox']"));
            }
            catch (_a) {
                return false;
            }
        }));
    };
    TopicPage.knowledgePath = '/sites/TopicCenter';
    TopicPage.createNewTopicUrl = '/_layouts/15/CreateTopicPage.aspx';
    TopicPage.cortexDisableFlagKey = 'cortexDisableFlag';
    TopicPage.isRunTABKey = 'isRunTAB';
    return TopicPage;
}());



/***/ }),

/***/ "M/CL":
/*!*********************************************!*\
  !*** ./lib/SPTaskLib/Pages/PropertyPane.js ***!
  \*********************************************/
/*! exports provided: PropertyPane */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PropertyPane", function() { return PropertyPane; });
/* harmony import */ var _Canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Canvas */ "mmJW");

/**
 * @public
 */
var PropertyPane = /** @class */ (function () {
    function PropertyPane() {
    }
    PropertyPane.AddTaskOpenPropertyPane = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Open Property pane');
            _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].SelectedWebpart.AddTaskClickConfigureButton();
        }), 
        // There is a delay before the property pane is actually opened.
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='showPane']"));
    };
    PropertyPane.AddTaskVerifyEmptyPropertyPane = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Verify Empty Property Pane');
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='noConfigurationPropertyPane']");
        }));
    };
    PropertyPane.AddTaskVerifyNonEmptyPropertyPane = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Verify Non-Empty Property Pane');
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
        }));
    };
    PropertyPane.AddTaskClickChangeButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click Change button');
            var propertyPaneContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var changeButton = TAB.GetElements(propertyPaneContainer, TAB.searchBy.customQuery, "[data-automation-id='changePath']")[0];
            TAB.ClickElement(changeButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']"));
    };
    PropertyPane.AddTaskClosePropertyPane = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Close Property Pane');
            var propertyPaneContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var closePropertyPaneButton = TAB.GetElements(propertyPaneContainer, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneClose']");
            TAB.ClickElement(closePropertyPaneButton[0]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='hidePane']");
        }));
    };
    PropertyPane.AddTaskToggleDynamicFilter = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('ClickToggleOn Dynamic Filtering');
            var propertyPaneContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var toggleButton = TAB.GetElements(propertyPaneContainer, TAB.searchBy.customQuery, "[data-automation-id='dynamicFilterToggle']")[0];
            TAB.ClickElement(toggleButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='DynamicDataWidgetSource']"));
    };
    PropertyPane.AddTaskSetDynamicDataWidgetSource = function (sourceList) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Set Dynamic data source list');
            var propertyPaneContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var srcDropdownParent = TAB.GetElements(propertyPaneContainer, TAB.searchBy.customQuery, "[data-automation-id='DynamicDataWidgetSource']")[0];
            var dropdown = TAB.GetElements(srcDropdownParent, TAB.searchBy.hasClassName, 'ms-Dropdown-title')[0];
            TAB.ClickElement(dropdown);
            var callout = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-callout')[0];
            var menuItems = TAB.GetElements(callout, TAB.searchBy.hasClassName, 'ms-Dropdown-item');
            for (var i = 0; i < menuItems.length; i++) {
                if (menuItems[i].title === sourceList) {
                    TAB.ClickElement(menuItems[i]);
                }
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='DynamicDataWidgetEntryDropdown']"));
    };
    PropertyPane.AddTaskSetDropdownByAutomationId = function (propVal, dropdownAutomationId) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Set Dynamic data target Filtering field');
            var propertyPaneContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var dropdownParent = TAB.GetElements(propertyPaneContainer, TAB.searchBy.customQuery, "[data-automation-id=\"" + dropdownAutomationId + "\"]")[0];
            var dropdown = TAB.GetElements(dropdownParent, TAB.searchBy.hasClassName, 'ms-Dropdown-title')[0];
            TAB.ClickElement(dropdown);
            var callout = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-callout')[0];
            var menuItems = TAB.GetElements(callout, TAB.searchBy.hasClassName, 'ms-Dropdown-item');
            for (var i = 0; i < menuItems.length; i++) {
                if (menuItems[i].title === propVal) {
                    TAB.ClickElement(menuItems[i]);
                    break;
                }
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneApplyButton']"));
    };
    PropertyPane.AddTaskClickApplyButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click Apply button');
            var propertyPaneContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var applyButton = TAB.GetElements(propertyPaneContainer, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneApplyButton']")[0];
            TAB.ClickElement(applyButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='DynamicDataWidgetSource']"));
    };
    return PropertyPane;
}());



/***/ }),

/***/ "MKab":
/*!********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/GroupCalendarWebPart.js ***!
  \********************************************************/
/*! exports provided: GroupCalendarWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupCalendarWebPart", function() { return GroupCalendarWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");



/**
 * @public
 */
var GroupCalendarWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(GroupCalendarWebPart, _super);
    function GroupCalendarWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].GroupCalendar, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].GroupCalendar.toString()) || this;
    }
    GroupCalendarWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this._addTaskAssertWebPartNotExist();
            _this.AddTaskSetupNewPage();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(this._waitForWebPartToExist());
    };
    GroupCalendarWebPart.prototype.AddTaskOpenPropertyPane = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var addGroupCalendarBtn = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="placeholderButton"]');
            addGroupCalendarBtn.click();
        }), TAB.MakeWaiter(function () {
            var propertyPane = _this._propertyPane;
            if (!propertyPane) {
                return false;
            }
            return !TAB.ElementExists(propertyPane, TAB.searchBy.customQuery, '[aria-disabled="true"]');
        }));
    };
    GroupCalendarWebPart.prototype.AddTaskSelectGroupAndCheckEventItem = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var dropDownElement = TAB.GetElement(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-Dropdown-title');
            dropDownElement.click();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'ms-Callout-container'));
        TAB.AddTask(TAB.MakeTask(function () {
            var groupsContainers = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-Callout-container');
            var visibilityGroupContainer;
            groupsContainers.forEach(function (container) {
                if (!visibilityGroupContainer && (!container.style || container.style.visibility !== 'hidden')) {
                    visibilityGroupContainer = container;
                }
            });
            var groupsBtn = TAB.GetElements(visibilityGroupContainer, TAB.searchBy.customQuery, '[type="button"]');
            if (groupsBtn.length > 0) {
                groupsBtn[0].click();
            }
            else {
                TAB.Log.Comment('Add group failed, no group found.');
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='syncButtonContainer']"));
    };
    Object.defineProperty(GroupCalendarWebPart.prototype, "_propertyPane", {
        get: function () {
            if (!TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneGroupContent']")) {
                return undefined;
            }
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneGroupContent']");
        },
        enumerable: true,
        configurable: true
    });
    GroupCalendarWebPart.prototype._addTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'Placeholder-container')) {
                throw 'Group Calendar web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    GroupCalendarWebPart.prototype._waitForWebPartToExist = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.className, 'Placeholder-container');
    };
    return GroupCalendarWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "N935":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/Controls/NewsLink.js ***!
  \********************************************/
/*! exports provided: NewsLink */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewsLink", function() { return NewsLink; });
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _FilePicker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FilePicker */ "8uLm");



// data automation ids
var NEWSLINK_COMPONENT = 'newslink-component';
var NEWSLINK_DESCRIPTION = 'newslink-description';
var NEWSLINK_LINK = 'newslink-link';
var NEWSLINK_POSTBUTTON = 'newslink-post-button';
var NEWSLINK_THUMBNAIL = 'newslink-thumbnail';
var NEWSLINK_TITLE = 'newslink-title';
var NEWSLINK_URL = 'newslink-url';
var NEWSLINK_CHANGE_BUTTON = 'newslink-change-button';
/**
 * @public
 */
var NewsLink = /** @class */ (function () {
    function NewsLink() {
    }
    NewsLink.prototype.EnterNewsLinkUrl = function (link) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._parentElement = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, NEWSLINK_COMPONENT);
            var linkInput = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, NEWSLINK_URL);
            TAB.Log.Comment("Input link " + link + ". If the TAB test times out on this waiter, then the preview image isn't available");
            _this._makeEntry(linkInput, NEWSLINK_URL, link);
        }), TAB.MakeWaiter(function () {
            // Waiting for image preview without the placeholder image and waiting for title and description inputs
            try {
                return (Boolean(_this.GetImagePreview()) &&
                    Boolean(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, NEWSLINK_TITLE)) &&
                    Boolean(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, NEWSLINK_DESCRIPTION)) &&
                    Boolean(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, NEWSLINK_LINK)));
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsLink.prototype.EnterTitle = function (title) {
        this._addTaskMakeEntry(NEWSLINK_TITLE, title);
    };
    NewsLink.prototype.VerifyTitle = function (title) {
        this._addTaskCheckEntry(NEWSLINK_TITLE, title);
    };
    NewsLink.prototype.VerifyDescription = function (description) {
        this._addTaskCheckEntry(NEWSLINK_DESCRIPTION, description);
    };
    NewsLink.prototype.EnterDescription = function (description) {
        this._addTaskMakeEntry(NEWSLINK_DESCRIPTION, description);
    };
    NewsLink.prototype.AddTaskOpenFilePicker = function (filePicker) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this._newsLinkChangeButton) {
                TAB.ClickElement(_this._newsLinkChangeButton);
                TAB.Log.Comment('Opened File Picker for News Link');
            }
        }), _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'sp-filepicker'));
        TAB.AddTask(TAB.MakeTask(function () {
            filePicker.SetRoot(_this._filePicker);
        }), filePicker.WaitForViewLoad(_FilePicker__WEBPACK_IMPORTED_MODULE_2__["FilePickerView"].Recent));
    };
    // Return image element only if the preview is not the placeholder image.
    NewsLink.prototype.GetImagePreview = function () {
        var img = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(this._parentElement, NEWSLINK_THUMBNAIL);
        if (img) {
            var src = img.src;
            // Placeholder image is in the format of photo_{guid}.png; guid is 32 chars
            if (!src || (src.indexOf('photo_') === 0 && src.length === 42 && src.indexOf('.png') === 38)) {
                // detected no image or a placeholder image, so the thumbnail for the page was not set
                return undefined;
            }
            else {
                // detected a non-placeholder image
                return img;
            }
        }
        else {
            return undefined;
        }
    };
    NewsLink.prototype.Post = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var postButton = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, NEWSLINK_POSTBUTTON);
            TAB.Log.Comment("Post news link and confirm the news post is displayed in the news web part");
            postButton.click();
        }), TAB.MakeWaiter(function () {
            return true;
        }));
    };
    NewsLink.prototype.ClickDetailsLink = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var linkButton = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, NEWSLINK_LINK);
            TAB.Log.Comment("Save news link and navigate to the details page for additional editing");
            linkButton.click();
        }), TAB.MakeWaiter(function () {
            try {
                return (_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].editMode &&
                    Boolean(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, NEWSLINK_CHANGE_BUTTON)));
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            _this._parentElement = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, NEWSLINK_COMPONENT);
        }), undefined);
    };
    Object.defineProperty(NewsLink.prototype, "_newsLinkChangeButton", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(this._parentElement, NEWSLINK_CHANGE_BUTTON);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NewsLink.prototype, "_filePicker", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(TAB.Win, 'sp-filepicker');
        },
        enumerable: true,
        configurable: true
    });
    NewsLink.prototype._makeEntry = function (input, dataAutomationId, text) {
        var focusEv = TAB.Win.document.createEvent('HTMLEvents');
        focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
        input.dispatchEvent(focusEv);
        input.value = text;
        var ev = TAB.Win.document.createEvent('HTMLEvents');
        ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
        input.dispatchEvent(ev);
        // press Enter
        TAB.FireKeyboardEvent(input, 'keydown', 13);
        var blurEv = TAB.Win.document.createEvent('HTMLEvents');
        blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
        input.dispatchEvent(blurEv);
    };
    NewsLink.prototype._addTaskCheckEntry = function (dataAutomationId, text) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("getting " + dataAutomationId);
            var input = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, dataAutomationId);
            TAB.Log.Comment("found " + dataAutomationId + ": " + Boolean(input));
            if (!input) {
                throw new Error("did not find element for " + dataAutomationId + " data automation id");
            }
            if (input.value !== text) {
                throw new Error("did not find " + text + " for " + dataAutomationId + " data automation id");
            }
            TAB.Log.Comment("found " + text + " for " + dataAutomationId + " data automation id");
        }), TAB.MakeWaiter(function () {
            return true;
        }));
    };
    NewsLink.prototype._addTaskMakeEntry = function (dataAutomationId, text) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("getting " + dataAutomationId);
            var input = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_this._parentElement, dataAutomationId);
            TAB.Log.Comment("found " + dataAutomationId + ": " + Boolean(input));
            if (!input) {
                throw new Error("did not find element for " + dataAutomationId + " data automation id");
            }
            _this._makeEntry(input, dataAutomationId, text);
        }), TAB.MakeWaiter(function () {
            return true;
        }));
    };
    return NewsLink;
}());



/***/ }),

/***/ "Nthi":
/*!*****************************************!*\
  !*** ./lib/SPTaskLib/Pages/UndoRedo.js ***!
  \*****************************************/
/*! exports provided: UndoRedo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UndoRedo", function() { return UndoRedo; });
/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");

/**
 * @public
 */
var UndoRedo = /** @class */ (function () {
    function UndoRedo() {
    }
    UndoRedo.AddTaskUndo = function (count) {
        if (count === void 0) { count = 1; }
        while (count--) {
            UndoRedo._addTaskClickUndoButton();
            UndoRedo.AddTaskWaitForMinUndoTime();
        }
    };
    UndoRedo.AddTaskRedo = function (count) {
        if (count === void 0) { count = 1; }
        while (count--) {
            UndoRedo._addTaskClickRedoButton();
            UndoRedo.AddTaskWaitForMinUndoTime();
        }
    };
    UndoRedo.AddTaskWaitForMinUndoTime = function (count) {
        if (count === void 0) { count = 1; }
        var startTimeInMs;
        TAB.AddTask(TAB.MakeTask(function () {
            startTimeInMs = new Date().getTime();
        }), TAB.MakeWaiter(function () {
            return new Date().getTime() - startTimeInMs >= 1000 * count;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            // Dispatching an event to mock user action.
            var mockEvent = document.createEvent('MouseEvents');
            mockEvent.initEvent('mousedown', true, true);
            TAB.Win.document.dispatchEvent(mockEvent);
        }));
    };
    UndoRedo.AddTaskVerifyUndoStack = function (undoable) {
        UndoRedo._addTaskVerifyUndoOrRedoButtonState(undoable /* enabled */, "Undo" /* Undo */);
    };
    UndoRedo.AddTaskVerifyRedoStack = function (redoable) {
        UndoRedo._addTaskVerifyUndoOrRedoButtonState(redoable /* enabled */, "Redo" /* Redo */);
    };
    UndoRedo._addTaskClickUndoButton = function () {
        UndoRedo._addTaskVerifyUndoOrRedoButtonState(true /* enabled */, "Undo" /* Undo */);
        TAB.AddTask(TAB.MakeTask(function () {
            var undoMenu = UndoRedo._undoMenu;
            TAB.Log.Comment('Click undo button');
            undoMenu.click();
        }));
    };
    UndoRedo._addTaskClickRedoButton = function () {
        UndoRedo._addTaskVerifyUndoOrRedoButtonState(true /* enabled */, "Redo" /* Redo */);
        TAB.AddTask(TAB.MakeTask(function () {
            var redoMenu = UndoRedo._redoMenu;
            TAB.Log.Comment('Click redo button');
            redoMenu.click();
        }));
    };
    UndoRedo._addTaskVerifyUndoOrRedoButtonState = function (enabled, action) {
        var shouldOpenSplitMenu = false;
        UndoRedo.AddTaskWaitForMinUndoTime();
        TAB.AddTask(TAB.MakeTask(function () {
            try {
                if (UndoRedo._undoMenu && UndoRedo._redoMenu) {
                    TAB.Log.Comment('Undo redo sub menu already open');
                    return;
                }
            }
            catch (error) {
                TAB.Log.Comment('Undo redo sub menu not found, go find and click split button');
            }
            TAB.AddTask(TAB.MakeTask(function () {
                var root = UndoRedo._undoButtonRoot;
                TAB.Log.AddTaskComment('Checking if the whole Undo split button is visible on command bar, if not click the ellipsis');
                if (!root) {
                    var ellipsisButton = TAB.GetElement(_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].GetCommandBar(), TAB.searchBy.hasClassName, 'ms-CommandBar-overflowButton');
                    TAB.ClickElement(ellipsisButton);
                }
            }), TAB.MakeWaiter(function () {
                try {
                    return Boolean(UndoRedo._undoButtonRoot);
                }
                catch (error) {
                    return false;
                }
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                var splitButton = UndoRedo._undoSplitButton;
                if (UndoRedo._isButtonDisabled(splitButton) && !enabled) {
                    TAB.Log.AddTaskPass('Expected: split button is disabled');
                }
                else if (UndoRedo._isButtonDisabled(splitButton) && enabled) {
                    TAB.Log.AddTaskFail("Split button is disabled while expecting " + action + " to be enabled");
                }
                else {
                    TAB.Log.Comment('Click on split button to toggle split button menu');
                    shouldOpenSplitMenu = true;
                    splitButton.click();
                }
            }));
        }), TAB.MakeWaiter(function () {
            try {
                if (!shouldOpenSplitMenu) {
                    return true;
                }
                var isMenuShown = Boolean(UndoRedo._undoMenu && UndoRedo._redoMenu);
                if (!isMenuShown) {
                    var splitButton = UndoRedo._undoSplitButton;
                    // Re-click the split button if submenu is not open due to render race condition.
                    splitButton.click();
                }
                return isMenuShown;
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (shouldOpenSplitMenu) {
                var menu = action === "Undo" /* Undo */ ? UndoRedo._undoMenu : UndoRedo._redoMenu;
                var buttonState = UndoRedo._isButtonDisabled(menu) ? 'disabled' : 'enabled';
                var expectedButtonState = enabled ? 'enabled' : 'disabled';
                if (buttonState === expectedButtonState) {
                    TAB.Log.Pass(action + " button is " + buttonState + " as expected");
                }
                else {
                    TAB.Log.Fail(action + " button is " + buttonState + ". However it is expected to be " + expectedButtonState);
                }
            }
        }));
    };
    Object.defineProperty(UndoRedo, "_undoMenu", {
        get: function () {
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + UndoRedo.UNDO_SUB_MENU_AUTOMATION_ID + "']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UndoRedo, "_redoMenu", {
        get: function () {
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + UndoRedo.REDO_SUB_MENU_AUTOMATION_ID + "']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UndoRedo, "_undoSplitButton", {
        get: function () {
            var root = UndoRedo._undoButtonRoot;
            var buttons = TAB.GetElements(root, TAB.searchBy.tag, 'button');
            if (!buttons || buttons.length !== 2) {
                TAB.Log.Fail('Failed to get split button due to unexpected split button DOM structure');
            }
            // Getting split button by second button inside split button DOM because there isn't a way yet to pass customized props
            // to the split button.
            return buttons[1];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UndoRedo, "_undoButtonRoot", {
        get: function () {
            return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + UndoRedo.UNDO_BUTTON_ROOT_AUTOMATION_ID + "']")[0];
        },
        enumerable: true,
        configurable: true
    });
    UndoRedo._isButtonDisabled = function (button) {
        return button.classList.contains('is-disabled') || button['aria-disabled'];
    };
    UndoRedo.UNDO_BUTTON_ROOT_AUTOMATION_ID = 'undo-redo-split-button';
    UndoRedo.UNDO_SUB_MENU_AUTOMATION_ID = 'undo-menu';
    UndoRedo.REDO_SUB_MENU_AUTOMATION_ID = 'redo-menu';
    return UndoRedo;
}());



/***/ }),

/***/ "Ogso":
/*!***************************************!*\
  !*** ./lib/SPTaskLib/Pages/Footer.js ***!
  \***************************************/
/*! exports provided: Footer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Footer", function() { return Footer; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../SPKillSwitchUtil */ "y5Zv");


/**
 * @public
 */
var Footer = /** @class */ (function () {
    function Footer() {
    }
    Footer.AddTaskSetFooterVisibility = function (visible) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment((visible ? 'Enabling' : 'Disabling') + " Footer");
            TAB.Log.AddTaskComment('Launch change the look panel');
            Footer._addTaskWaitOnSettingsGear(); // Wait for settings & CTL panel code to be loaded with suite nav
            Footer._addTaskLaunchFooterCTLPanel();
            // click on the footer section
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.AddTaskComment('Click footer panel');
                Footer._ctlElem = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'sp-ChangeTheLookPanel');
                var footerElem = TAB.GetElement(Footer._ctlElem, TAB.searchBy.customQuery, '[data-chrome-type="Footer"]');
                TAB.ClickElement(footerElem);
            }), TAB.MakeWaiter(function () {
                return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-ChangeTheLookPanel-footerVisibility"]');
            }));
            // ensure footer visibility button is pressed
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.AddTaskComment('Click footer visibility');
                var visibilityToggle = TAB.GetElements(Footer._ctlElem, TAB.searchBy.hasClassName, 'ms-Toggle-background')[0];
                if (visibilityToggle.attributes['aria-checked'].value !== visible) {
                    TAB.ClickElement(visibilityToggle);
                }
            }));
            Footer._addTaskSaveCloseCTLPanel();
        }), Footer.waitForFooter(visible));
    };
    Footer.AddTaskGetFooterLinks = function (siteUrl, footerResult) {
        TAB.Log.AddTaskComment('Getting footer links');
        var targetUrl = siteUrl + "/_api/navigation/MenuState?menuNodeKey='3a94b35f-030b-468e-80e3-b75ee84ae0ad'";
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendGetRequest(siteUrl, targetUrl, result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success && result.retVal) {
                footerResult.MenuState = result.retVal;
            }
            else {
                TAB.Log.AddTaskFail('Failed to fetch footer links');
            }
        }));
    };
    Footer.AddTaskAddFooterLinks = function (name, url, siteUrl, audienceIds, deleteFirst) {
        if (deleteFirst === void 0) { deleteFirst = true; }
        var result = {};
        Footer.AddTaskGetFooterLinks(siteUrl, result);
        TAB.Log.AddTaskComment("Adding footer node " + name);
        TAB.AddTask(TAB.MakeTask(function () {
            var links = result.MenuState && result.MenuState.Nodes;
            if (links && links.length > 0) {
                if (deleteFirst) {
                    TAB.Log.AddTaskComment('First deleting existing footer links');
                    links.forEach(function (link) { return (link.IsDeleted = true); });
                }
            }
            else {
                links = [];
            }
            var newLink = {
                NodeType: 0,
                Title: name,
                SimpleUrl: url,
                FriendlyUrlSegment: '',
                AudienceIds: audienceIds
            };
            links.unshift(newLink);
            var postContent = {
                menuState: {
                    SPWebPrefix: result.MenuState && result.MenuState.SPWebPrefix,
                    StartingNodeTitle: '3a94b35f-030b-468e-80e3-b75ee84ae0ad' /* NavNodeKeys.footerNavLinks */,
                    Version: new Date().toTimeString(),
                    Nodes: links
                }
            };
            TAB.Log.AddTaskComment('Then adding new footer link');
            Footer._updateFooterContent(postContent, siteUrl);
            Footer._addTaskReloadFooter();
        }));
    };
    Footer.AddTaskDeleteAllFooterLinks = function (siteUrl) {
        var result = {};
        Footer.AddTaskGetFooterLinks(siteUrl, result);
        TAB.Log.AddTaskComment('Deleting existing footer links');
        TAB.AddTask(TAB.MakeTask(function () {
            var links = result.MenuState && result.MenuState.Nodes;
            TAB.Log.AddTaskComment('Delete existing footer links');
            if (links && links.length > 0) {
                links.forEach(function (link) { return (link.IsDeleted = true); });
                var postContent = {
                    menuState: {
                        SPWebPrefix: result.MenuState && result.MenuState.SPWebPrefix,
                        StartingNodeTitle: '3a94b35f-030b-468e-80e3-b75ee84ae0ad' /* NavNodeKeys.footerNavLinks */,
                        Version: new Date().toTimeString(),
                        Nodes: links
                    }
                };
                Footer._updateFooterContent(postContent, siteUrl);
                Footer._addTaskReloadFooter();
            }
        }));
    };
    Footer.AddTaskVerifyNameField = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Making sure the name input exists on the pane');
        }), TAB.MakeWaiter(function () {
            var ctlPanel = Footer._getCTLPanel();
            return TAB.ElementExists(ctlPanel, TAB.searchBy.partialClassName, 'ms-TextField-field');
        }));
    };
    Footer.AddTaskVerifyFooterAtBottomOfPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Checking that the footer is at the bottom of the page');
        }), TAB.AndWaiters(Footer.waitForFooter(), TAB.MakeWaiter(function () {
            var windowHeight = TAB.Win.window.innerHeight;
            var footerElem = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automationid="SimpleFooter"]');
            var rect = footerElem.getBoundingClientRect();
            return rect.bottom === windowHeight;
        })));
    };
    Footer.AddTaskOpenFooterSectionCTL = function () {
        Footer._addTaskLaunchFooterCTLPanel();
        Footer._addTaskClickFooterSectionCtl();
    };
    Footer.AddTaskCloseCTLPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Close CTL');
            var ctlPanel = Footer._getCTLPanel();
            try {
                var closeButton = TAB.GetElement(ctlPanel, TAB.searchBy.hasClassName, 'ms-Panel-closeButton');
                TAB.ClickElement(closeButton);
            }
            catch (e) {
                TAB.Log.AddTaskComment('Could not find the close button for the CTL. This probably means the panel is already closed.');
            }
        }));
    };
    Footer.AddTaskReloadPage = function () {
        Footer._addTaskReloadFooter();
    };
    Footer.AddTaskDeleteFooterLinkUI = function (index) {
        TAB.Log.AddTaskComment('Deleting footer link at index: ' + index);
        // Click edit link
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking edit link in the footer');
            var editLinkDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='SimpleFooter-edit']");
            var editLinkButton = TAB.GetElement(editLinkDiv, TAB.searchBy.tag, 'button');
            TAB.ClickElement(editLinkButton);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'ms-EditNav');
        }));
        // Click ... next to first item
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking edit menu for the item');
            var editNavButtons = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav-linkButton');
            TAB.ClickElement(editNavButtons[index]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav_contextMenu');
        }));
        // Click delete on contextual menu
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking the remove button');
            var contextualMenu = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-EditNav_contextMenu');
            var buttons = TAB.GetElements(contextualMenu, TAB.searchBy.tag, 'button');
            var lastElemIndex = buttons.length - 1;
            var removeButton = buttons[lastElemIndex];
            TAB.ClickElement(removeButton);
        }), TAB.MakeWaiter(function () {
            var saveButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='EditNav-SaveButton']");
            return !saveButton.classList.contains('is-disabled');
        }));
        // Click save in edit nav panel
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking save button on edit nav panel');
            var saveButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='EditNav-SaveButton']");
            TAB.ClickElement(saveButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'ms-EditNav');
        }));
    };
    Footer.waitForFooter = function (visible) {
        if (visible === void 0) { visible = true; }
        return TAB.MakeWaiter(function () {
            try {
                var isFooterLoadedOnDemand = !_SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_1__["SPKillSwitchUtil"].isActivated('545a230c-c0bf-4a7c-a309-562ca7d949c4');
                var checkFooterExistsFunction = function () {
                    return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automationid="SimpleFooter"]') ===
                        visible;
                };
                if (isFooterLoadedOnDemand) {
                    var footerViewPortContainer = TAB.GetElements(TAB.Win.window, TAB.searchBy.customQuery, '[data-viewport-id="Page.SiteFooter.internal.03025612-a400-4804-a78e-e1493200a43b"]')[0];
                    if (!footerViewPortContainer && !visible) {
                        return true;
                    }
                    // Footer is loaded on-demand by scroll, so scroll to the element and wait for next waiter
                    // cycle to detect footer.
                    footerViewPortContainer.scrollIntoView();
                    return checkFooterExistsFunction();
                }
                else {
                    return checkFooterExistsFunction();
                }
            }
            catch (error) {
                return false;
            }
        });
    };
    Footer._addTaskClickFooterSectionCtl = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click footer panel');
            var ctlElem = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'sp-ChangeTheLookPanel');
            var footerElem = TAB.GetElement(ctlElem, TAB.searchBy.customQuery, '[data-chrome-type="Footer"]');
            TAB.ClickElement(footerElem);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-ChangeTheLookPanel-footerVisibility"]');
        }));
    };
    Footer._getCTLPanel = function () {
        try {
            var ctlPanel = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'sp-ChangeTheLookPanel')[0];
            return ctlPanel;
        }
        catch (error) {
            return undefined;
        }
    };
    Footer._updateFooterContent = function (footerContent, siteUrl) {
        var targetUrl = siteUrl + '/_api/navigation/SaveMenuState';
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendPostRequest(siteUrl, targetUrl, JSON.stringify(footerContent), result, true /* fetchCanary */);
    };
    Footer._addTaskLaunchFooterCTLPanel = function () {
        var launchCTLFunction;
        TAB.AddTask(TAB.MakeTask(function () {
            // tslint:disable-next-line:no-string-literal no-unused-expression
            launchCTLFunction = TAB.Win.window['_spLaunchChangeTheLookPanel'];
            if (launchCTLFunction) {
                launchCTLFunction();
            }
            else {
                TAB.Log.Comment("Can't find _spLaunchChangeTheLookPanel");
            }
        }), TAB.MakeWaiter(function () {
            if (launchCTLFunction) {
                return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-chrome-type="Footer"]');
            }
            else {
                // tslint:disable-next-line:no-string-literal no-unused-expression
                launchCTLFunction = TAB.Win.window['_spLaunchChangeTheLookPanel'];
                if (launchCTLFunction) {
                    launchCTLFunction();
                }
                return false;
            }
        }));
    };
    Footer._addTaskSaveCloseCTLPanel = function () {
        // click to save change
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click save footer change');
            var saveButton = TAB.GetElement(Footer._ctlElem, TAB.searchBy.customQuery, '[data-automationid="changethelookpanel-savebutton"]');
            TAB.ClickElement(saveButton);
        }));
        // click to close CTL
        Footer.AddTaskCloseCTLPanel();
    };
    Footer._addTaskReloadFooter = function () {
        TAB.AddTask(TAB.ReloadPage(), Footer.waitForFooter());
    };
    Footer._addTaskWaitOnSettingsGear = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[title="Settings"]');
        }));
    };
    return Footer;
}());



/***/ }),

/***/ "PGxG":
/*!********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/EmbeddedVideoWebPart.js ***!
  \********************************************************/
/*! exports provided: EmbeddedVideoWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EmbeddedVideoWebPart", function() { return EmbeddedVideoWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var EmbeddedVideoWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(EmbeddedVideoWebPart, _super);
    function EmbeddedVideoWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].EmbeddedVideo, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].EmbeddedVideo.toString()) || this;
    }
    EmbeddedVideoWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskAssertWebPartNotExist();
            _this.AddTaskSetupNewPage();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="o365video-source-input"]'));
    };
    EmbeddedVideoWebPart.prototype.AddTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[class^="HTMLEmbed"]')) {
                throw 'Embedded video web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    EmbeddedVideoWebPart.prototype.AddTaskTryInputEmbedCode = function (embedCode, shouldBeRenderSuccessful) {
        TAB.AddTask(TAB.MakeTask(function () {
            var inputEmbedCodeArea = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="o365video-source-input"]');
            // input url
            inputEmbedCodeArea.focus();
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(inputEmbedCodeArea, embedCode);
        }), shouldBeRenderSuccessful
            ? TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='embedCode']")
            : this.WaitForElementWithClassToExist('ms-TextField-errorMessage'));
    };
    EmbeddedVideoWebPart.prototype.PropertyPaneExisits = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[class^="spPropertyPaneContainer"]');
    };
    EmbeddedVideoWebPart.prototype.WaitForElementWithClassToExist = function (className) {
        // The className is the first class, or the second one. See https://stackoverflow.com/a/8588532/1436671
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[class^=\"" + className + "\"], [class*=\" " + className + "\"]");
    };
    return EmbeddedVideoWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "QcF0":
/*!***************************************!*\
  !*** ./lib/SPTaskLib/Pages/Router.js ***!
  \***************************************/
/*! exports provided: Router */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Router", function() { return Router; });
/**
 * @public
 */
var Router = /** @class */ (function () {
    function Router() {
    }
    // In Hybrid mobile view, this mocks callback for native app.
    Router.AddTaskToEmulateNativeAppCallback = function (webpart, expectedArgs) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Setting the web view callback handler');
            TAB.Win.window[Router.Callbackhandler] = {
                postMessage: function (args) {
                    if (!args) {
                        TAB.Log.AddTaskFail('args should not be undefined');
                    }
                    webpart.ValidationMobileViewParameters(args, expectedArgs);
                }
            };
        }), Router.WaitForCallbackHandler());
    };
    Router.WaitForCallbackHandler = function () {
        var callbackHandler = undefined;
        return TAB.MakeWaiter(function () {
            callbackHandler = TAB.Win.window[Router.Callbackhandler];
            return Boolean(callbackHandler);
        });
    };
    Router.Callbackhandler = '__callbackHandler';
    return Router;
}());



/***/ }),

/***/ "Qf+y":
/*!************************************!*\
  !*** ./lib/SPTaskLib/ReactUtil.js ***!
  \************************************/
/*! exports provided: ReactUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReactUtil", function() { return ReactUtil; });
/* tslint:disable */
/**
 * @public
 */
var ReactUtil = /** @class */ (function () {
    function ReactUtil() {
    }
    // Refer to https://github.com/vitalyq/react-trigger-change
    // Ihis method is to trigger onChange event for React components. It doesn't cover all the element type and browsers.
    // If you found it doesn't work for your element, please add your triggering logic here. Thanks!
    ReactUtil.TriggerOnChange = function (element, value) {
        element.focus();
        var focusEvent = TAB.Win.document.createEvent('HTMLEvents');
        focusEvent.initEvent('focus', true, false);
        element.dispatchEvent(focusEvent);
        element.value = value;
        // For React >= 15.6.0
        var initialValue = element.value;
        var descriptor = Object.getOwnPropertyDescriptor(element, 'value');
        element.value = initialValue + ' ';
        if (descriptor && descriptor.configurable) {
            delete element['value'];
        }
        element.value = initialValue;
        if (TAB.browserIs.ie) {
            // This is a non-standard event just for IE
            var propertyChangeEvent = TAB.Win.document.createEvent('HTMLEvents'); // tslint:disable-line:no-any
            propertyChangeEvent.initEvent('propertychange', true, false);
            propertyChangeEvent.propertyName = 'value';
            element.dispatchEvent(propertyChangeEvent);
        }
        else {
            var inputEvent = TAB.Win.document.createEvent('HTMLEvents');
            inputEvent.initEvent('input', true, false);
            element.dispatchEvent(inputEvent);
        }
    };
    return ReactUtil;
}());



/***/ }),

/***/ "R7tR":
/*!***************************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ListViewWebparWithItemsView.js ***!
  \***************************************************************/
/*! exports provided: ListViewWebparWithItemsView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListViewWebparWithItemsView", function() { return ListViewWebparWithItemsView; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _ListViewWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListViewWebpart */ "Aitv");
/* harmony import */ var _CommandBar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CommandBar */ "CPNt");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _ContextMenu__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ContextMenu */ "yis5");





/**
 * @public
 */
var ListViewWebparWithItemsView = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(ListViewWebparWithItemsView, _super);
    function ListViewWebparWithItemsView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListViewWebparWithItemsView.prototype.AddTaskDeleteFolder = function (folderName) {
        var _this = this;
        var checkbox;
        TAB.Log.AddTaskComment('Waiting for target folder to render');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var items = TAB.GetElements(_this.root, TAB.searchBy.customQuery, '[data-automationid="ListCell"]');
                for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {
                    var item = items_1[_i];
                    var name_1 = _this._getTitleElement(item);
                    if (TAB.GetTextContent(name_1).indexOf(folderName) > -1) {
                        checkbox = TAB.GetElement(item, TAB.searchBy.customQuery, '[data-automationid="DetailsRowCheck"]');
                        return true;
                    }
                }
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting folder');
            TAB.ClickElement(checkbox);
        }));
        TAB.AddTask(undefined, _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"].WaitForCommandBar({ area: 'primary', waitForItems: true }));
        // Delete the selected folder
        TAB.AddTask(this._getClickDeleteCommandTask());
    };
    ListViewWebparWithItemsView.prototype.AddTaskVerifyFolderDeleted = function (folderName, result) {
        var _this = this;
        TAB.Log.AddTaskComment('Verifying deleted folder does not appear in list');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var items = TAB.GetElements(_this.root, TAB.searchBy.customQuery, '[data-automationid="ListCell"]');
                for (var _i = 0, items_2 = items; _i < items_2.length; _i++) {
                    var item = items_2[_i];
                    var nameElements = TAB.GetElements(item, TAB.searchBy.customQuery, '[data-automationid="FieldRenderer-name"]');
                    // skip the placeholder elements.
                    if (!nameElements || nameElements.length < 1) {
                        continue;
                    }
                    var name_2 = nameElements[0];
                    if (TAB.GetTextContent(name_2) === folderName) {
                        result.success = false;
                        return false;
                    }
                }
                TAB.Log.Pass('Deleted folder does not appear in list');
                result.success = true;
                return true;
            }
            catch (e) {
                return false;
            }
        }));
    };
    ListViewWebparWithItemsView.prototype.AddTaskDeleteFirstItem = function () {
        var _this = this;
        var titleToDelete;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting first item');
            var items = TAB.GetElements(_this.root, TAB.searchBy.customQuery, '[data-automationid="ListCell"]');
            var firstItem = items[0];
            titleToDelete = TAB.GetTextContent(_this._getTitleElement(firstItem));
            var checkbox = TAB.GetElement(firstItem, TAB.searchBy.customQuery, '[data-automationid="DetailsRowCheck"]');
            TAB.ClickElement(checkbox);
        }));
        TAB.AddTask(undefined, _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"].WaitForCommandBar({ area: 'primary', waitForItems: true }));
        // Delete the selected item
        TAB.AddTask(this._getClickDeleteCommandTask());
        TAB.Log.AddTaskComment('Waiting for item to be removed from list');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var items = TAB.GetElements(_this.root, TAB.searchBy.customQuery, '[data-automationid="ListCell"]');
                var itemStillExists = false;
                for (var _i = 0, items_3 = items; _i < items_3.length; _i++) {
                    var item = items_3[_i];
                    var titleElement = _this._getTitleElement(item);
                    if (!titleElement) {
                        // Items are shimmer items.
                        return false;
                    }
                    var currentTitle = TAB.GetTextContent(titleElement);
                    if (currentTitle === titleToDelete) {
                        itemStillExists = true;
                        break;
                    }
                }
                if (!itemStillExists) {
                    TAB.Log.Pass('Item successfully deleted');
                    return true;
                }
            }
            catch (e) {
                return false;
            }
        }));
    };
    ListViewWebparWithItemsView.prototype.AddTaskFilter = function (columnName, filterValue) {
        this._addTaskClickColumnHeader(columnName);
        this._addTaskClickContextMenuItemByIndex('Filter by', 2); // "Filter by" is third item in column context menu
        TAB.Log.AddTaskComment('Waiting for filter pane to render');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel-content'));
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automationid="CheckboxGroup"]'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Selecting filter by " + filterValue);
            var filterPane = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel-content');
            var targetField = TAB.GetElement(filterPane, TAB.searchBy.customQuery, "[data-checked-label=\"" + filterValue + "\"]");
            var checkbox = TAB.GetElement(targetField, TAB.searchBy.tag, 'input');
            TAB.ClickElement(checkbox);
            TAB.Log.Comment('Clicking "Apply" filter');
            var applyButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automationid="FilterPanel-Apply"]');
            TAB.ClickElement(applyButton);
        }));
    };
    ListViewWebparWithItemsView.prototype.AddTaskAddNewFolder = function (folderName) {
        var _this = this;
        var commandBar;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting for CommandBar');
            TAB.AddTask(undefined, _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"].WaitForCommandBar({ area: 'primary' }, _this.root));
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting for "New" button');
            commandBar = new _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"]({ area: 'primary', rootElement: _this.root });
            commandBar.AddTaskEnsureCommandBarItem({ iconClassName: 'CalculatorAddition', automationId: 'newCommand', title: undefined }, true, // Reset root because command bar loads async
            { area: 'primary', rootElement: _this.root, isReact: _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"].isReact });
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking "New" button');
            commandBar.AddTaskEnsureClickCommandBarItem({
                iconClassName: 'CalculatorAddition',
                automationId: 'newCommand',
                title: undefined
            });
        }));
        TAB.AddTask(undefined, _ContextMenu__WEBPACK_IMPORTED_MODULE_4__["ContextMenu"].WaitForOpen());
        this._addTaskClickContextMenuItemByIndex('Folder', 0); // Folder is first item in "New" context menu
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Adding new folder');
            var dialog = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-main');
            var input = TAB.GetElement(dialog, TAB.searchBy.tag, 'input');
            input.focus();
            input.value = folderName;
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(input, folderName);
            var createButton = TAB.GetElement(dialog, TAB.searchBy.hasClassName, 'ms-Button--primary');
            TAB.ClickElement(createButton);
        }));
    };
    ListViewWebparWithItemsView.prototype.AddTaskGoToQuickEdit = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Going to quick edit.');
        TAB.AddTask(undefined, _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"].WaitForCommandBar({ area: 'primary', waitForItems: true }));
        TAB.AddTask(TAB.MakeTask(function () {
            var commandBar = new _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"]({ area: 'primary', rootElement: _this.root });
            commandBar.AddTaskEnsureClickCommandBarItem({
                title: undefined,
                iconClassName: 'Edit',
                automationId: 'quickEditCommand'
            });
        }));
    };
    ListViewWebparWithItemsView.prototype._getTitleElement = function (item) {
        try {
            var elements = TAB.GetElements(item, TAB.searchBy.customQuery, "[data-automationid=\"FieldRenderer-name\"]");
            if (!elements || elements.length === 0) {
                elements = TAB.GetElements(item, TAB.searchBy.customQuery, "[data-automationid=\"FieldRenderer-title\"]");
            }
            return elements[0];
        }
        catch (e) {
            return undefined;
        }
    };
    ListViewWebparWithItemsView.prototype._getClickDeleteCommandTask = function () {
        var _this = this;
        return TAB.MakeTask(function () {
            var commandBar = new _CommandBar__WEBPACK_IMPORTED_MODULE_2__["CommandBar"]({ area: 'primary', rootElement: _this.root });
            commandBar.AddTaskEnsureClickCommandBarItem({
                title: undefined,
                iconClassName: 'delete',
                automationId: 'deleteCommand'
            });
            TAB.Log.AddTaskComment('Waiting for confirm delete dialog');
            TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                try {
                    var dialog = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-actions');
                    if (dialog && dialog.length) {
                        return true;
                    }
                }
                catch (e) {
                    return false;
                }
            }));
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Confirming delete');
                var dialogActions = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-actions');
                var confirmDeleteBtn = TAB.GetElements(dialogActions, TAB.searchBy.tag, 'button')[0];
                TAB.ClickElement(confirmDeleteBtn);
            }));
        });
    };
    return ListViewWebparWithItemsView;
}(_ListViewWebpart__WEBPACK_IMPORTED_MODULE_1__["ListViewWebpart"]));



/***/ }),

/***/ "S6R0":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Controls/FormsWebPart.js ***!
  \************************************************/
/*! exports provided: FormsWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormsWebPart", function() { return FormsWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var FormsWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(FormsWebPart, _super);
    function FormsWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Forms, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Forms.toString()) || this;
    }
    FormsWebPart.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Add forms web part');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), this.waitForFormsLayout());
    };
    FormsWebPart.prototype.deleteWebPartToPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Delete forms web part');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskDeleteZone(0);
        }));
    };
    FormsWebPart.prototype.waitForFormsLayout = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                TAB.Log.AddTaskComment('Verify Forms placeholder layout');
                var elements = _this._placeHolderButtons;
                return elements.length === 2;
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    FormsWebPart.prototype.addTaskOpenCreateFormsPropertyPane = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click create new form button');
            TAB.ClickElement(_this._placeHolderButtons[0]);
        }), this._waitForEditPaneOpen());
    };
    FormsWebPart.prototype.addTaskOpenEmbedFormsPropertyPane = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click embed existing form button');
            TAB.ClickElement(_this._placeHolderButtons[1]);
        }), this._waitForEditPaneOpen());
    };
    FormsWebPart.prototype.addTaskEmbedForms = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Embed existing forms');
            if (_this._urlTextBox) {
                var formsUrl = 'https://forms.office.com/Pages/DesignPage.aspx#FormId=zCCya5GPbkGcbObiBv4OLsGPLFdgjeFKi_LeApIS1sFUOUNLV0JBWFQyVkZQOTQzU0k5TU03TktUNi4u';
                _this._urlTextBox.focus();
                _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(_this._urlTextBox, formsUrl);
            }
        }), this._waitForUrlFilled());
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click OK button to embed forms');
            if (_this._propertyPaneOKButton) {
                TAB.ClickElement(_this._propertyPaneOKButton);
            }
        }), this._waitForEmbedForms());
    };
    FormsWebPart.prototype.waitForCreateFormsPropertyPaneLayout = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                TAB.Log.AddTaskComment('Wait for create new form property pane');
                var textBox = TAB.GetElement(_this._propertyPane, TAB.searchBy.customQuery, "[type='text']");
                var link = TAB.GetElement(_this._propertyPane, TAB.searchBy.tag, 'a');
                var createButton = TAB.GetElement(_this._propertyPane, TAB.searchBy.customQuery, "[type='button']");
                return textBox && link && createButton;
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    FormsWebPart.prototype.waitForEmbedFormsPropertyPaneLayout = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                TAB.Log.AddTaskComment('Wait for embed existing form property pane');
                var links = TAB.GetElements(_this._propertyPane, TAB.searchBy.tag, 'a');
                var radioButtons = TAB.GetElements(_this._propertyPane, TAB.searchBy.customQuery, "[type='radio']");
                return (_this._urlTextBox && _this._propertyPaneOKButton && links.length === 2 && radioButtons.length === 2);
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    Object.defineProperty(FormsWebPart.prototype, "_placeHolder", {
        get: function () {
            TAB.Log.AddTaskComment('Get placeholder');
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='forms-webpart-container']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormsWebPart.prototype, "_placeHolderButtons", {
        get: function () {
            TAB.Log.AddTaskComment('Get placeholder buttons');
            return TAB.GetElements(this._placeHolder, TAB.searchBy.customQuery, "[type='button']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormsWebPart.prototype, "_propertyPane", {
        get: function () {
            TAB.Log.AddTaskComment('Get property pane');
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormsWebPart.prototype, "_propertyPaneOKButton", {
        get: function () {
            TAB.Log.AddTaskComment('Get property pane OK button');
            return TAB.GetElement(this._propertyPane, TAB.searchBy.customQuery, "[type='button']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormsWebPart.prototype, "_urlTextBox", {
        get: function () {
            TAB.Log.AddTaskComment('Get web address text box');
            return TAB.GetElement(this._propertyPane, TAB.searchBy.tag, 'textarea');
        },
        enumerable: true,
        configurable: true
    });
    FormsWebPart.prototype._waitForEditPaneOpen = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Verify edit pane is open');
        var waiter = TAB.MakeWaiter(function () {
            try {
                return !!_this._propertyPane;
            }
            catch (e) {
                TAB.Log.Comment('Failure in open edit pane: ' + e.message);
                return false;
            }
        });
        return waiter;
    };
    FormsWebPart.prototype._waitForUrlFilled = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Verify forms url is filled');
        var waiter = TAB.MakeWaiter(function () {
            try {
                return !!TAB.GetTextContent(_this._urlTextBox);
            }
            catch (e) {
                TAB.Log.Comment('Failure in insert url: ' + e.message);
                return false;
            }
        });
        return waiter;
    };
    FormsWebPart.prototype._waitForEmbedForms = function () {
        TAB.Log.AddTaskComment('Verify form is embeded');
        var waiter = TAB.MakeWaiter(function () {
            try {
                var formsIframe = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[aria-label='For TAB test']");
                return !!formsIframe;
            }
            catch (e) {
                TAB.Log.Comment('Failure in embed forms: ' + e.message);
                return false;
            }
        });
        return waiter;
    };
    return FormsWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "SKFh":
/*!***************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ModernQuickEdit.js ***!
  \***************************************************/
/*! exports provided: ModernQuickEdit */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModernQuickEdit", function() { return ModernQuickEdit; });
/* harmony import */ var _Utilities_ClientFeatures__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Utilities/ClientFeatures */ "zTnS");

/**
 * @public
 */
var ModernQuickEdit = /** @class */ (function () {
    function ModernQuickEdit() {
        this._visualRefreshFlightEnabled = ModernQuickEdit.VisualRefreshFlightEnabled();
        this.AddTaskInitializeQuickEdit();
    }
    ModernQuickEdit.VisualRefreshFlightEnabled = function () {
        return _Utilities_ClientFeatures__WEBPACK_IMPORTED_MODULE_0__["ClientFeatures"].IsODBFeatureEnabled(1725); // NewQuickEditVisualRefresh
    };
    ModernQuickEdit.WaitForQuickEdit = function () {
        return TAB.MakeWaiter(function () {
            var cellClassName = ModernQuickEdit.VisualRefreshFlightEnabled() ? 'gridCell' : 'spGridCell';
            var gridCells = TAB.GetElements(TAB.Win, [TAB.searchBy.tag, TAB.searchBy.partialClassName], ['td', cellClassName]);
            return gridCells.length > 0;
        });
    };
    ModernQuickEdit.prototype.AddTaskInitializeQuickEdit = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Waiting for Quick Edit');
        TAB.AddTask(undefined, ModernQuickEdit.WaitForQuickEdit());
        TAB.AddTask(TAB.MakeTask(function () {
            var spgrids = TAB.GetElements(TAB.Win, [TAB.searchBy.tag, TAB.searchBy.partialClassName], ['div', 'spGridRoot']);
            if (spgrids.length > 0) {
                _this._spgrid = spgrids[0];
                TAB.Log.AddTaskComment('Found and initialized the quick edit grid.');
            }
            else {
                TAB.Log.AddTaskFail("There is no quick edit grid present on the page.");
            }
        }));
    };
    ModernQuickEdit.prototype.AddTaskQuickEditAddNewRow = function (firstFieldValue, numberOfColumns) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var cellClassName = _this._visualRefreshFlightEnabled ? 'gridCell' : 'spGridCell';
            var gridCells = TAB.GetElements(_this._spgrid, [TAB.searchBy.tag, TAB.searchBy.partialClassName], ['td', cellClassName]);
            var firstCellInNewRow = gridCells[gridCells.length - numberOfColumns - 1 /*the last "+" column*/];
            var rect = firstCellInNewRow.getBoundingClientRect();
            var event = new MouseEvent('mousedown', {
                view: window,
                bubbles: true,
                cancelable: true,
                clientX: rect.left + 5,
                clientY: rect.top + 5
            });
            firstCellInNewRow.dispatchEvent(event);
            firstCellInNewRow.dispatchEvent(event);
            _this.AddTaskQuickEditSetActiveTextCellvalue(firstFieldValue);
        }));
    };
    ModernQuickEdit.prototype.AddTaskQuickEditSetActiveTextCellvalue = function (value) {
        var _this = this;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            _this._refreshRoot();
            var firstCellInput = TAB.GetElement(_this._spgrid, [TAB.searchBy.tag, TAB.searchBy.id], ['input', 'jsgrid_editboxspgridcontainer_WPQ1']);
            return !!firstCellInput;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var firstCellInput = TAB.GetElement(_this._spgrid, [TAB.searchBy.tag, TAB.searchBy.id], ['input', 'jsgrid_editboxspgridcontainer_WPQ1']);
            var innerRect = firstCellInput.getBoundingClientRect();
            var innerEvent = new MouseEvent('mousedown', {
                view: window,
                bubbles: true,
                cancelable: true,
                clientX: innerRect.left + 2,
                clientY: innerRect.top + 2
            });
            firstCellInput.dispatchEvent(innerEvent);
            firstCellInput.value = value;
            var keyboardEvent = new KeyboardEvent('keyup', {
                bubbles: true,
                cancelable: true,
                key: '1',
                shiftKey: false
            });
            firstCellInput.dispatchEvent(keyboardEvent);
            var keyboardEnterEvent = new KeyboardEvent('keydown', {
                bubbles: true,
                cancelable: true,
                key: 'Enter',
                code: '13',
                keyCode: 13,
                shiftKey: false
            });
            firstCellInput.dispatchEvent(keyboardEnterEvent);
        }));
    };
    // NOTE: must be called inside a task
    ModernQuickEdit.prototype.GetQuickEditCellValue = function (row, column, numberOfColumns) {
        this._refreshRoot();
        var cellClassName = this._visualRefreshFlightEnabled ? 'gridCell' : 'spGridCell';
        var gridCells = TAB.GetElements(this._spgrid, [TAB.searchBy.tag, TAB.searchBy.partialClassName], ['td', cellClassName]);
        var cellInQuestion = gridCells[row * (numberOfColumns + 2) + (column + 1)];
        return cellInQuestion.innerText;
    };
    ModernQuickEdit.prototype.AddTaskQuickEditValidateRowColumnValue = function (row, column, numberOfColumns, value, waitForFieldValues) {
        var _this = this;
        if (!Boolean(waitForFieldValues)) {
            TAB.AddTask(TAB.MakeTask(function () {
                var cellValue = _this.GetQuickEditCellValue(row, column, numberOfColumns);
                if (cellValue === value) {
                    TAB.Log.AddTaskPass("The value of the cell is ( " + cellValue + " ), which equals the expected value of ( " + value + " )");
                }
                else {
                    TAB.Log.AddTaskFail("The value of the cell is ( " + cellValue + " ), and we were expecting ( " + value + " )");
                }
            }));
        }
        else {
            TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                try {
                    var cellValue = _this.GetQuickEditCellValue(row, column, numberOfColumns);
                    return cellValue === value;
                }
                catch (e) {
                    // ignore
                }
                return false;
            }));
        }
    };
    ModernQuickEdit.prototype.WaitForQuickEditSaves = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var spinners = TAB.GetElements(_this._spgrid, [TAB.searchBy.tag, TAB.searchBy.partialClassName], ['div', 'ms-Spinner-circle']);
            return spinners.length === 0;
        });
    };
    ModernQuickEdit.prototype._refreshRoot = function () {
        var spgrids = TAB.GetElements(TAB.Win, [TAB.searchBy.tag, TAB.searchBy.partialClassName], ['div', 'spGridRoot']);
        if (spgrids.length > 0) {
            this._spgrid = spgrids[0];
        }
    };
    return ModernQuickEdit;
}());



/***/ }),

/***/ "SMhQ":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/CommandBarItem.js ***!
  \**************************************************/
/*! exports provided: CommandBarItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CommandBarItem", function() { return CommandBarItem; });
/* harmony import */ var _ContextMenu__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContextMenu */ "yis5");
/* harmony import */ var _CommandBar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CommandBar */ "CPNt");


/**
 * @public
 */
var CommandBarItem = /** @class */ (function () {
    function CommandBarItem(root) {
        this.title = '';
        this.root = root;
        var isReact = _CommandBar__WEBPACK_IMPORTED_MODULE_1__["CommandBar"].isReact;
        var iconElement = this._getIconElement(this.root, isReact);
        if (iconElement) {
            this.iconClassName = iconElement.getAttribute('data-icon-name');
            if (this.iconClassName === 'More') {
                this.isOverflow = true;
                return;
            }
        }
        var textClass = isReact ? 'ms-Button-label' : 'CommandBarItem-commandText';
        var textContainer = TAB.GetElements(this.root, TAB.searchBy.hasClassName, textClass);
        if (textContainer && textContainer.length) {
            this.title = TAB.GetTextContent(textContainer[0]);
        }
        if (this.root.style.display !== 'none') {
            this.isVisible = true;
        }
        this.automationId = this.root.getAttribute('data-automationid');
    }
    Object.defineProperty(CommandBarItem.prototype, "Title", {
        get: function () {
            return this.title;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CommandBarItem.prototype, "IconClassName", {
        get: function () {
            return this.iconClassName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CommandBarItem.prototype, "AutomationId", {
        get: function () {
            return this.automationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CommandBarItem.prototype, "IsOverflow", {
        get: function () {
            return this.isOverflow;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CommandBarItem.prototype, "IsVisible", {
        get: function () {
            return this.isVisible;
        },
        enumerable: true,
        configurable: true
    });
    CommandBarItem.prototype.AddTaskOpenContextMenu = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (!_ContextMenu__WEBPACK_IMPORTED_MODULE_0__["ContextMenu"].MenuAlreadyOpen()) {
                TAB.Log.AddTaskComment('CommandBarItem: Context menu is not open. Opening it.');
                // add waiter for context menu item
                if (_CommandBar__WEBPACK_IMPORTED_MODULE_1__["CommandBar"].isReact) {
                    TAB.Log.AddTaskComment('Clicking React CommandBar context menu');
                    TAB.ClickElement(_this.root);
                    TAB.AddTask(undefined, _ContextMenu__WEBPACK_IMPORTED_MODULE_0__["ContextMenu"].WaitForOpen());
                }
                else {
                    TAB.Log.AddTaskComment('Clicking Knockout CommandBar context menu');
                    TAB.AddTaskClickElement(_this.root, TAB.searchBy.hasClassName, 'CommandBarItem-link', _ContextMenu__WEBPACK_IMPORTED_MODULE_0__["ContextMenu"].WaitForOpen());
                }
            }
            else {
                TAB.Log.AddTaskComment('CommandBarItem: Context menu is already open.');
            }
        }));
    };
    CommandBarItem.prototype.AddTaskClick = function () {
        if (_CommandBar__WEBPACK_IMPORTED_MODULE_1__["CommandBar"].isReact) {
            TAB.Log.AddTaskComment("Clicking React CommandBar item \"" + this.Title + "\"");
            TAB.ClickElement(this.root);
        }
        else {
            TAB.Log.AddTaskComment("Clicking Knockout CommandBar item \"" + this.Title + "\"");
            TAB.AddTaskClickElement(this.root, TAB.searchBy.hasClassName, 'CommandBarItem-link');
        }
    };
    CommandBarItem.prototype._getIconElement = function (root, isReact) {
        if (isReact) {
            var primary = TAB.GetElements(root, TAB.searchBy.hasClassName, 'ms-Button-icon')[0];
            return primary || TAB.GetElements(root, TAB.searchBy.hasClassName, 'ms-Button-menuIcon')[0];
        }
        else {
            return TAB.GetElements(root, TAB.searchBy.hasClassName, 'ms-Icon')[0];
        }
    };
    return CommandBarItem;
}());



/***/ }),

/***/ "TwX4":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Controls/NewsWebPart.js ***!
  \***********************************************/
/*! exports provided: NewsWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewsWebPart", function() { return NewsWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _RTEWebPart__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RTEWebPart */ "mXly");
/* harmony import */ var _TitleRegion__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TitleRegion */ "e5Kj");
/* harmony import */ var _Upload__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Upload */ "dAVj");








var NewsWebpartId;
(function (NewsWebpartId) {
    NewsWebpartId["CarouselNewsLayout"] = "CarouselNewsLayout";
    NewsWebpartId["FeaturedNewsLayout"] = "featuredNewsLayout";
    NewsWebpartId["GridNewsLayout"] = "gridNewsLayout";
    NewsWebpartId["HeroNewsLayout"] = "Tiles";
    NewsWebpartId["HubNewsLayout"] = "hubNewsLayout";
    NewsWebpartId["ListNewsLayout"] = "listNewsLayout";
    NewsWebpartId["RecommendedSite"] = "PropertyPaneChoiceGroup-4";
    NewsWebpartId["SelectSite"] = "PropertyPaneChoiceGroup-3";
    NewsWebpartId["ThisSite"] = "PropertyPaneChoiceGroup-1";
    NewsWebpartId["PropertyPaneCarouselNewsLayout"] = "PropertyPaneChoiceGroup-Carousel";
    NewsWebpartId["PropertyPaneFeaturedNewsLayout"] = "PropertyPaneChoiceGroup-FeaturedNews";
    NewsWebpartId["PropertyPaneGridNewsLayout"] = "PropertyPaneChoiceGroup-GridNews";
    NewsWebpartId["PropertyPaneHeroNewsLayout"] = "PropertyPaneChoiceGroup-Hero";
    NewsWebpartId["PropertyPaneHubNewsLayout"] = "PropertyPaneChoiceGroup-NewsHub";
    NewsWebpartId["PropertyPaneListNewsLayout"] = "PropertyPaneChoiceGroup-ListNews";
})(NewsWebpartId || (NewsWebpartId = {}));
var ElementAutomationId;
(function (ElementAutomationId) {
    ElementAutomationId["AddButton"] = "newsAddButton";
    ElementAutomationId["Description"] = "newsItemDescription";
    ElementAutomationId["Item"] = "newsItem";
    ElementAutomationId["LinkOption"] = "newsLinkOption";
    ElementAutomationId["LinkUrl"] = "newslink-url";
    ElementAutomationId["PostOption"] = "newsPostOption";
    ElementAutomationId["SeeAll"] = "newsSeeAllLink";
    ElementAutomationId["TemplateCreateButton"] = "template-panel-create-button";
    ElementAutomationId["Title"] = "newsItemTitle";
})(ElementAutomationId || (ElementAutomationId = {}));
var ElementClassName;
(function (ElementClassName) {
    ElementClassName["MSMainPanel"] = "ms-Panel-main";
})(ElementClassName || (ElementClassName = {}));
/**
 * @public
 */
var NewsWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(NewsWebPart, _super);
    function NewsWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].News, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].News.toString()) || this;
    }
    NewsWebPart.AddTaskWaitTimer = function () {
        var startTimeInMs;
        TAB.AddTask(TAB.MakeTask(function () {
            startTimeInMs = new Date().getTime();
        }), TAB.MakeWaiter(function () {
            return new Date().getTime() - startTimeInMs >= 3000;
        }));
    };
    NewsWebPart._byAutoId = function (id) {
        return "[data-automation-id='" + id + "']";
    };
    NewsWebPart.prototype.AddTaskAddWebPartOnNewTeamSitePage = function (useExistingPage, site, title) {
        if (useExistingPage) {
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskEditPage();
        }
        else {
            this.AddTaskSetupNewPage(site);
            var pageTitle = title || TAB.GetUniqueName('News Test Page');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskAddPageTitle(pageTitle);
        }
        _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(this);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting for news webpart to render on page');
        }), this.WaitForWebPartEmptyStateToExist());
    };
    NewsWebPart.prototype.AddTaskAddWebpartOnPage = function (publishPage) {
        publishPage = typeof publishPage !== 'undefined' ? publishPage : true;
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskEditPage();
        _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(this, {
            skipWebPartBind: true
        });
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for news webpart to render on page');
        }), this.WaitForWebPartEmptyStateToExist());
        if (publishPage) {
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskPublishPage(true);
        }
    };
    NewsWebPart.prototype.AddTaskClickAddButton = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for add button. If the TAB test times out on this waiter,\n        then the button either isn't on the page or it is not clickable.");
        }), TAB.MakeWaiter(function () {
            try {
                return _this.GetAddButton(true);
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking news webpart add button');
            TAB.ClickElement(_this.GetAddButton(true));
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment('Waiting for news post menu');
                return _this._hasElementWithAutoId(ElementAutomationId.PostOption);
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsWebPart.prototype.AddTaskClickNewsPostOption = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for the \"News post\" menu option. If the TAB test times out on this waiter,\n        then the news post option either isn't on the page or it is not clickable.");
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment('Waiting for news post menu to click');
                return Boolean(_this.GetNewsPostOption());
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking news post option');
            TAB.ClickElement(_this.GetNewsPostOption());
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment('Waiting to navigate to page template panel');
                return _this._hasElementByClassName(ElementClassName.MSMainPanel);
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsWebPart.prototype.AddTaskClickNewsLinkOption = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for the \"News link\" menu option. If the TAB test times out on this waiter,\n        then the news link option either isn't on the page or it is not clickable.");
        }), TAB.MakeWaiter(function () {
            return Boolean(_this.GetNewsLinkOption());
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking news link option');
            TAB.ClickElement(_this.GetNewsLinkOption());
        }), TAB.MakeWaiter(function () {
            return Boolean(_this.GetNewsLinkUrlInput());
        }));
    };
    NewsWebPart.prototype.AddTaskSelectStubFromBlankPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting to click on create page button');
        }), TAB.MakeWaiter(function () {
            try {
                var propertyPane = _this._getMainPanel();
                if (!propertyPane) {
                    return false;
                }
                if (!_this._hasElementWithAutoId(ElementAutomationId.TemplateCreateButton, propertyPane)) {
                    return false;
                }
                var createButton = _this._getElementByAutoId(ElementAutomationId.TemplateCreateButton, propertyPane);
                return createButton && !createButton.disabled;
            }
            catch (error) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var propertyPane = _this._getMainPanel();
            if (!propertyPane) {
                return undefined;
            }
            TAB.ClickElement(_this._getElementByAutoId(ElementAutomationId.TemplateCreateButton, propertyPane));
        }), TAB.MakeWaiter(function () {
            try {
                return !_this._hasElementByClassName(ElementClassName.MSMainPanel);
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsWebPart.prototype.AddTaskCreateNewsArticle = function (title, description, titleImageUpload) {
        var _this = this;
        var textWebPart = new _RTEWebPart__WEBPACK_IMPORTED_MODULE_5__["RTEWebPart"]();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskAddPageTitle(title);
        if (titleImageUpload) {
            this.AddTaskUploadTitleImage();
        }
        if (description) {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(textWebPart, {
                skipWebPartBind: true
            });
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Waiting for RTE webpart to appear');
            }), TAB.MakeWaiter(function () {
                return _this._hasElementWithAutoId(_Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].CanvasControlId);
            }));
            // called here instead of in Canvas.AddTaskCreateWebPart so that it can be run in deterministic order
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskBindWebPart(textWebPart, false /* isAddingFromToolbox */);
            textWebPart.AddTaskToAddTextInRTE(description);
        }
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskPublishPage(true, true);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for news article to render');
        }), this._waitForNewsArticleToRender(title, description, titleImageUpload));
    };
    NewsWebPart.prototype.AddTaskClickSeeAllLink = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for see-all link');
        }), TAB.MakeWaiter(function () {
            return Boolean(_this.GetSeeAllLinks()[0]);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking news see-all link');
            TAB.ClickElement(_this.GetSeeAllLinks()[0]);
            TAB.Log.Comment('Waiting to redirect to news L2 page');
        }), TAB.MakeWaiter(function () {
            return (TAB.Win.location.href.indexOf('_layouts/15/news.aspx') > -1 &&
                _this._hasLayout(NewsWebpartId.ListNewsLayout));
        }));
    };
    NewsWebPart.prototype.AddTaskSetFeaturedNewsLayout = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.PropertyPaneFeaturedNewsLayout, NewsWebpartId.FeaturedNewsLayout);
    };
    NewsWebPart.prototype.AddTaskSetListNewsLayout = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.PropertyPaneListNewsLayout, NewsWebpartId.ListNewsLayout);
    };
    NewsWebPart.prototype.AddTaskSetGridNewsLayout = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.PropertyPaneGridNewsLayout, NewsWebpartId.GridNewsLayout);
    };
    NewsWebPart.prototype.AddTaskSetHubNewsLayout = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.PropertyPaneHubNewsLayout, NewsWebpartId.HubNewsLayout);
    };
    NewsWebPart.prototype.AddTaskSetHeroNewsLayout = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.PropertyPaneHeroNewsLayout, NewsWebpartId.HeroNewsLayout, NewsWebpartId.CarouselNewsLayout);
    };
    NewsWebPart.prototype.AddTaskSetCarouselNewsLayout = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.PropertyPaneCarouselNewsLayout, NewsWebpartId.CarouselNewsLayout);
    };
    NewsWebPart.prototype.AddTaskSetThisSite = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.ThisSite, NewsWebpartId.ThisSite);
    };
    NewsWebPart.prototype.AddTaskSetSelectSite = function () {
        this.AddTaskSetSitePicker(NewsWebpartId.SelectSite);
    };
    NewsWebPart.prototype.AddTaskSetRecommendedSite = function () {
        this.AddTaskSetNewsChoiceGroupConfig(NewsWebpartId.RecommendedSite, NewsWebpartId.GridNewsLayout);
    };
    NewsWebPart.prototype.WaitForWebPartEmptyStateToExist = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                return (_this._hasLayout(NewsWebpartId.FeaturedNewsLayout) ||
                    _this._hasLayout(NewsWebpartId.ListNewsLayout) ||
                    _this._hasLayout(NewsWebpartId.GridNewsLayout) ||
                    _this._hasLayout(NewsWebpartId.HubNewsLayout) ||
                    _this._hasLayout(NewsWebpartId.CarouselNewsLayout) ||
                    _this._hasLayout(NewsWebpartId.HeroNewsLayout));
            }
            catch (error) {
                return false;
            }
        });
    };
    NewsWebPart.prototype.GetAddButton = function (verboseLogging) {
        if (verboseLogging === void 0) { verboseLogging = false; }
        return this._getClickableButton(ElementAutomationId.AddButton, 'add button', verboseLogging);
    };
    NewsWebPart.prototype.GetNewsPostOption = function () {
        return this._getElementByAutoId(ElementAutomationId.PostOption);
    };
    NewsWebPart.prototype.GetNewsLinkOption = function () {
        return this._getElementByAutoId(ElementAutomationId.LinkOption);
    };
    NewsWebPart.prototype.GetNewsLinkUrlInput = function () {
        return this._getElementByAutoId(ElementAutomationId.LinkUrl);
    };
    NewsWebPart.prototype.GetSeeAllLink = function () {
        return this._getElementByAutoId(ElementAutomationId.SeeAll);
    };
    NewsWebPart.prototype.GetSeeAllLinks = function () {
        return this._getAllByAutoId(ElementAutomationId.SeeAll);
    };
    NewsWebPart.prototype.AddTaskValidateNewsItem = function (title) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            return;
        }), TAB.MakeWaiter(function () {
            // find all news titles
            var elements = _this._getAllByAutoId(ElementAutomationId.Title, TAB.Win.document.body);
            // find the news post with a matching title (.filter not available in the returned object)
            for (var i = 0; i < elements.length; i++) {
                if (elements[i].textContent === title) {
                    // signal done if a match was found
                    return true;
                }
            }
            return false;
        }));
    };
    NewsWebPart.prototype.AddTaskValidateNewsItemsByAuthor = function (author) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            return;
        }), TAB.MakeWaiter(function () {
            var elements = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-id='newsAuthorDate']");
            // find the news post with a matching author
            for (var i = 0; i < elements.length; i++) {
                if (elements[i].getElementsByTagName('span') && elements[i].getElementsByTagName('span')[0]) {
                    var spanAuthor = elements[i].getElementsByTagName('span')[0];
                    if (spanAuthor.innerHTML.toLocaleLowerCase().search(author.toLocaleLowerCase()) === -1) {
                        return false;
                    }
                }
            }
            return true;
        }));
    };
    NewsWebPart.prototype.AddTaskValidateOneNewsItemRendered = function (title) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            return;
        }), TAB.MakeWaiter(function () {
            var webparts = _this._getAllByAutoId(_Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].CanvasControlId);
            if (!webparts || !webparts[0]) {
                return false;
            }
            var elements = _this._getAllByAutoId(ElementAutomationId.Title, webparts[0]);
            return elements.length === 1 && elements[0].textContent === title;
        }));
    };
    NewsWebPart.prototype._getMainPanel = function () {
        return this._getElementByClassName(ElementClassName.MSMainPanel);
    };
    /**
     * return element with specified class name in specified scope
     * @param className - className attribute value
     * @param searchObj - container to search within, or full window if not specified
     */
    NewsWebPart.prototype._getElementByClassName = function (className, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        return TAB.GetElement(searchObj, TAB.searchBy.hasClassName, className);
    };
    /**
     * return elements with specified class name in specified scope
     * @param className - className attribute value
     * @param searchObj - container to search within, or full window if not specified
     */
    NewsWebPart.prototype._hasElementByClassName = function (className, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        return TAB.ElementExists(searchObj, TAB.searchBy.hasClassName, className);
    };
    NewsWebPart.prototype._hasLayout = function (layout) {
        return this._hasElementWithAutoId(layout);
    };
    /**
     * Checks if theres any elements with specified automation id in specified scope
     * @param dataAutomationId - data-automation-id attribute value
     * @param searchObj - container to search within, or full window if not specified
     */
    NewsWebPart.prototype._hasElementWithAutoId = function (dataAutomationId, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.ElementExists(searchObj, TAB.searchBy.customQuery, NewsWebPart._byAutoId(dataAutomationId));
        }
        catch (e) {
            return false;
        }
    };
    /**
     * Returns a single element with data automation id in specified scope
     * @param dataAutomationId - data-automation-id attribute value
     * @param searchObj - container to search within, or full window if not specified
     */
    NewsWebPart.prototype._getElementByAutoId = function (dataAutomationId, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElement(searchObj, TAB.searchBy.customQuery, NewsWebPart._byAutoId(dataAutomationId));
        }
        catch (e) {
            return undefined;
        }
    };
    /**
     * Returns an array of elements with provided automation id in specified scope
     * @param dataAutomationId - data-automation-id attribute value
     * @param searchObj - container to search within, or full window if not specified
     */
    NewsWebPart.prototype._getAllByAutoId = function (dataAutomationId, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElements(searchObj, TAB.searchBy.customQuery, NewsWebPart._byAutoId(dataAutomationId));
        }
        catch (e) {
            return undefined;
        }
    };
    NewsWebPart.prototype._getClickableButton = function (dataAutomationId, clickableElementNameForComment, verboseLogging) {
        if (verboseLogging === void 0) { verboseLogging = false; }
        try {
            var addBtn = this._getElementByAutoId(dataAutomationId);
            if (addBtn && addBtn.attributes['data-is-focusable'].value === 'true' && addBtn.tagName === 'BUTTON') {
                return addBtn;
            }
            else if (verboseLogging) {
                if (!addBtn) {
                    TAB.Log.Comment("Cannot find the " + clickableElementNameForComment + ".");
                }
                else {
                    TAB.Log.Comment("Found the " + clickableElementNameForComment + ", but it is not clickable.");
                }
            }
        }
        catch (e) {
            return undefined;
        }
        return undefined;
    };
    NewsWebPart.prototype._waitForNewsArticleToRender = function (articleTitle, description, titleImageUpload) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var newsItems = _this._getAllByAutoId(ElementAutomationId.Item);
                var articleFound = false;
                for (var _i = 0, newsItems_1 = newsItems; _i < newsItems_1.length; _i++) {
                    var item = newsItems_1[_i];
                    var titleFound = _this._hasElementWithAutoId(ElementAutomationId.Title, item) &&
                        TAB.GetTextContent(_this._getElementByAutoId(ElementAutomationId.Title, item)) === articleTitle;
                    var textFound = true;
                    var maxDescriptionChars = 20;
                    if (description) {
                        textFound =
                            _this._hasElementWithAutoId(ElementAutomationId.Description, item) &&
                                TAB.GetTextContent(_this._getElementByAutoId(ElementAutomationId.Description, item)).substr(0, maxDescriptionChars) === description.substr(0, maxDescriptionChars);
                    }
                    var thumbNailFound = true;
                    if (titleImageUpload) {
                        thumbNailFound =
                            TAB.ElementExists(item, TAB.searchBy.tag, 'img') &&
                                TAB.ElementExists(item, TAB.searchBy.customQuery, "[title=\"" + articleTitle + "\"]");
                    }
                    articleFound = articleFound || (titleFound && textFound && thumbNailFound);
                }
                return articleFound;
            }
            catch (e) {
                return undefined;
            }
        });
    };
    NewsWebPart.prototype.AddTaskUploadTitleImage = function () {
        var titleRegionWebpart = _TitleRegion__WEBPACK_IMPORTED_MODULE_6__["TitleRegion"].GetTitleRegionWebPart();
        /* tslint:disable-next-line:max-line-length */
        var fileMimeString = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAAAuCAYAAABK69fpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTAwQkM2Mzk4NDBBMTFFNjhDQkVCOTdDMjE1NkM3RkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTAwQkM2Mzg4NDBBMTFFNjhDQkVCOTdDMjE1NkM3RkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMkM5MzFBNDcwQTExMUU2QUVERkExNDU3ODU1M0I3QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMkM5MzFBNTcwQTExMUU2QUVERkExNDU3ODU1M0I3QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgQJy/MAAAxESURBVHja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';
        TAB.Log.AddTaskComment('Picking Custom Title Image');
        var filePicker = titleRegionWebpart.AddTaskOpenFilePicker();
        var fileInput = Object(_Upload__WEBPACK_IMPORTED_MODULE_7__["dataURItoFile"])(fileMimeString, 'test_file.png');
        filePicker.AddTaskUploadItem(fileInput);
        TAB.Log.AddTaskPass('Picking Custom Title Image Success');
    };
    NewsWebPart.prototype.AddTaskSetNewsChoiceGroupConfig = function (buttonId, renderedElementId, altRenderElementId) {
        var _this = this;
        TAB.Log.AddTaskComment("Waiting for layout button: " + buttonId);
        TAB.AddTask(undefined, this._waitForLayoutButton(buttonId));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(_this._getLayoutButton(buttonId));
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment("Waiting for " + renderedElementId + " or " + altRenderElementId + " to render");
                return (_this._hasElementWithAutoId(renderedElementId) ||
                    (altRenderElementId && _this._hasElementWithAutoId(altRenderElementId)));
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsWebPart.prototype.AddTaskSetSitePicker = function (buttonId) {
        var _this = this;
        TAB.Log.AddTaskComment("Waiting for layout button: " + buttonId);
        TAB.AddTask(undefined, this._waitForLayoutButton(buttonId));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(_this._getLayoutButton(buttonId));
        }), TAB.MakeWaiter(function () {
            return Boolean(_this._getLayoutButton('sitesPicker'));
        }));
    };
    NewsWebPart.prototype._getLayoutButton = function (buttonId) {
        try {
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
            if (!propertyPane) {
                return undefined;
            }
            return this._getElementByAutoId(buttonId, propertyPane);
        }
        catch (e) {
            return undefined;
        }
    };
    NewsWebPart.prototype._waitForLayoutButton = function (buttonId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._getLayoutButton(buttonId));
            }
            catch (error) {
                return false;
            }
        });
    };
    return NewsWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "UB0n":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/ServiceWorkerUtil.js ***!
  \********************************************/
/*! exports provided: ServiceWorkerUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServiceWorkerUtil", function() { return ServiceWorkerUtil; });
/**
 * @public
 */
var ServiceWorkerUtil = /** @class */ (function () {
    function ServiceWorkerUtil() {
    }
    ServiceWorkerUtil.isGeneratedByServiceWorker = function () {
        // Do not put logs in this func as it is called inside a waiter from func WaitForPageGeneratedBySW
        var expectedGenerator = 'Microsoft SharePoint (Service worker)';
        try {
            var serviceWorker = TAB.Win.window.navigator.serviceWorker.controller;
            var generatorElement = TAB.Win.document.querySelector('meta[name=GENERATOR]');
            var generator = generatorElement.content;
            return !!(serviceWorker && serviceWorker.state === 'activated' && generator === expectedGenerator);
        }
        catch (e) {
            return false;
        }
    };
    ServiceWorkerUtil.printServiceWorkerLog = function () {
        return this.isGeneratedByServiceWorker()
            ? TAB.Log.Comment("Page generated by Service Worker.")
            : TAB.Log.Comment("Page not generated by Service Worker.");
    };
    ServiceWorkerUtil.LoadCurrentPageWithServiceWorker = function () {
        TAB.Log.Comment("Checking if page was generated by service worker");
        if (!this.isGeneratedByServiceWorker()) {
            TAB.Log.Comment("Page not generated by Service Worker. Reloading page");
            ServiceWorkerUtil.WaitForCurrentPageGeneratedBySW();
        }
        else {
            TAB.Log.Comment("Page generated by Service Worker. Not reloading page");
        }
    };
    ServiceWorkerUtil.WaitForCurrentPageGeneratedBySW = function () {
        var _this = this;
        var timerID = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            timerID = setInterval(function () {
                TAB.Win.document.location.reload();
            }, 10000);
        }), TAB.MakeWaiter(function () {
            if (_this.isGeneratedByServiceWorker()) {
                clearInterval(timerID);
                return true;
            }
            else {
                return false;
            }
        }));
    };
    ServiceWorkerUtil.dropIndexedDBTables = function () {
        var isRouteDBDeleted = false;
        var isSPConfigDBDeleted = false;
        var isSPFxConfigDBDeleted = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Dropping all indexedDB tables.');
            var RouteDBReq = window.indexedDB.deleteDatabase('Route.Config');
            var SPConfigDBReq = window.indexedDB.deleteDatabase('SP.Config');
            var SPFxConfigDBReq = window.indexedDB.deleteDatabase('SPFx.Config');
            RouteDBReq.onsuccess = function () {
                isRouteDBDeleted = true;
            };
            SPConfigDBReq.onsuccess = function () {
                isSPConfigDBDeleted = true;
            };
            SPFxConfigDBReq.onsuccess = function () {
                isSPFxConfigDBDeleted = true;
            };
        }), TAB.MakeWaiter(function () {
            return isRouteDBDeleted && isSPConfigDBDeleted && isSPFxConfigDBDeleted;
        }));
    };
    ServiceWorkerUtil.deleteItem = function (db, objStore, itemKey) {
        var isTransactionComplete = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Deleting item ' + itemKey + ' from objStore ' + objStore + ' in db ' + db);
            var DBOpenRequest = window.indexedDB.open(db);
            DBOpenRequest.onsuccess = function () {
                var dbReq = DBOpenRequest.result;
                var transaction = dbReq
                    .transaction([objStore], 'readwrite')
                    .objectStore(objStore)
                    .delete(itemKey);
                transaction.onsuccess = function () {
                    TAB.Log.Pass('Transaction complete');
                    dbReq.close();
                    isTransactionComplete = true;
                };
            };
        }), TAB.MakeWaiter(function () {
            return isTransactionComplete;
        }));
    };
    ServiceWorkerUtil.clearObjStore = function (db, objStore) {
        var isTransactionComplete = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clearing all rows from objStore ' + objStore + ' in db ' + db);
            var DBOpenRequest = window.indexedDB.open(db);
            DBOpenRequest.onsuccess = function () {
                var dbReq = DBOpenRequest.result;
                var transaction = dbReq
                    .transaction([objStore], 'readwrite')
                    .objectStore(objStore)
                    .clear();
                transaction.onsuccess = function () {
                    TAB.Log.Pass('Transaction complete');
                    dbReq.close();
                    isTransactionComplete = true;
                };
            };
        }), TAB.MakeWaiter(function () {
            return isTransactionComplete;
        }));
    };
    ServiceWorkerUtil.updateItem = function (db, objStore, updatedItem) {
        var isTransactionComplete = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Updating objStore ' + objStore + ' in db ' + db + ' with item ' + updatedItem);
            var DBOpenRequest = window.indexedDB.open(db);
            DBOpenRequest.onsuccess = function () {
                var dbReq = DBOpenRequest.result;
                var transaction = dbReq
                    .transaction([objStore], 'readwrite')
                    .objectStore(objStore)
                    .put(updatedItem);
                transaction.onsuccess = function () {
                    TAB.Log.Pass('Transaction complete');
                    dbReq.close();
                    isTransactionComplete = true;
                };
            };
        }), TAB.MakeWaiter(function () {
            return isTransactionComplete;
        }));
    };
    ServiceWorkerUtil.reloadConfigs = function () {
        var reg;
        var reloadCompleted = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Reloading configs');
            reg = navigator.serviceWorker.getRegistration();
            reg
                .then(function (registration) {
                registration.sync
                    .register('{ "applicationId": "SPHome", "tag": "ReloadConfigs" }')
                    .then(function () {
                    reloadCompleted = true;
                })
                    .catch(function () {
                    reloadCompleted = false;
                });
            })
                .catch(function () {
                reloadCompleted = false;
            });
        }), TAB.MakeWaiter(function () {
            return reloadCompleted;
        }));
    };
    ServiceWorkerUtil.ValidateTimings = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            try {
                var p = TAB.Win.window.performance;
                var timing = p && p.timing;
                if (timing) {
                    var ttfb = timing.responseStart - timing.navigationStart;
                    TAB.Log.Comment("TTFB: " + ttfb.toFixed(1) + "ms");
                }
                else {
                    TAB.Log.Warning("TTFB timing not found");
                }
                // tslint:disable-next-line:no-any
                var rumoneData = 
                // tslint:disable-next-line:no-string-literal
                TAB.Win.window['spModuleLoader']._bundledComponents['8217e442-8ed3-41fd-957d-b112e841286a']
                    ._PerformanceLogger._logger._rumoneData;
                if (rumoneData) {
                    var headStart = rumoneData.headStart;
                    if (headStart) {
                        TAB.Log.Comment("headStart: " + headStart.toFixed(1) + "ms");
                    }
                    else {
                        TAB.Log.Warning("headStart timing not found");
                    }
                    var fmp = rumoneData.EUPL;
                    if (fmp) {
                        TAB.Log.Comment("FMP (EUPL): " + fmp.toFixed(1) + "ms");
                    }
                    else {
                        // NOTE: we need to investigate why (not specific to service worker) ~10% never reports FMP/FCI/TTI
                        TAB.Log.Warning("FMP (EUPL) timing not found");
                    }
                    var tti = rumoneData.TTI;
                    if (tti) {
                        TAB.Log.Comment("TTI: " + tti.toFixed(1) + "ms");
                    }
                    else {
                        // NOTE: we need to investigate why (not specific to service worker) ~10% never reports FMP/FCI/TTI
                        TAB.Log.Warning("TTI timing not found");
                    }
                    var fci = rumoneData.FCI;
                    if (fci) {
                        TAB.Log.Comment("FCI: " + fci.toFixed(1) + "ms");
                    }
                    else {
                        // NOTE: we need to investigate why (not specific to service worker) ~10% never reports FMP/FCI/TTI
                        TAB.Log.Warning("FCI timing not found");
                    }
                }
                else {
                    TAB.Log.Warning("rumoneData not found. Unable to calculate performance metrics.");
                }
            }
            catch (e) {
                TAB.Log.Warning("window.performance is not available");
            }
        }));
    };
    return ServiceWorkerUtil;
}());



/***/ }),

/***/ "UXDa":
/*!***********************************!*\
  !*** ./lib/SPTaskLib/CsomUtil.js ***!
  \***********************************/
/*! exports provided: Csom */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Csom", function() { return Csom; });
/* tslint:disable */
/**
 * @public
 */
var Csom = /** @class */ (function () {
    function Csom() {
    }
    /**
     * Adds a CSOM call to the TAB task queue with the correct waiter.
     * The context object returned by getContextObject should be ready for an
     * immediate call to executeQueryAsync(onSuccess, onError).
     * If getContextObject returns null, the task will be cancelled.
     */
    Csom.AddTask = function (getContextObject, onSuccess, onError) {
        var successFunction = typeof onSuccess === 'object' ? onSuccess && onSuccess.call : onSuccess;
        var errorFunction = typeof onError === 'object' ? onError && onError.call : onError;
        var wrapper = new TabCallbackWrapper(successFunction, errorFunction);
        var executeQuery = function () {
            return TAB.MakeTask(function () {
                var clictx = getContextObject();
                if (clictx) {
                    clictx.executeQueryAsync(wrapper.success.bind(wrapper), wrapper.error.bind(wrapper));
                }
                else {
                    wrapper.cancel();
                }
            });
        };
        TAB.AddTask(executeQuery(), wrapper.waiter());
    };
    return Csom;
}());

/**
 * Use TabCallbackWrapper to wrap callbacks you want to hand to potentially
 * asynchronous methods. Then use the wrapper object's Success and Error
 * methods instead of your asynch callbacks, and use the Waiter with AddTask.
 */
var TabCallbackWrapper = /** @class */ (function () {
    function TabCallbackWrapper(onSuccess, onError) {
        this._isDone = false;
        this._isError = false;
        this._onSuccess = onSuccess || (function () { return undefined; });
        this._onError = onError || (function () { return undefined; });
    }
    TabCallbackWrapper.prototype.success = function () {
        this._isDone = true;
        try {
            this._onSuccess.apply(null, arguments);
        }
        catch (e) {
            // Log the error.
            TAB.Log.Comment('Failure in CSOM success callback: ' + e.message);
        }
    };
    TabCallbackWrapper.prototype.error = function () {
        this._isDone = true;
        this._isError = true;
        try {
            this._onError.apply(null, arguments);
        }
        catch (e) {
            // Log the error.
            TAB.Log.Comment('Failure in CSOM error callback: ' + e.message);
        }
    };
    TabCallbackWrapper.prototype.waiter = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            if (_this._isError) {
                // throw an exception
            }
            return _this._isDone;
        });
    };
    TabCallbackWrapper.prototype.cancel = function () {
        this._isDone = true;
        this._isError = false;
    };
    return TabCallbackWrapper;
}());


/***/ }),

/***/ "UcNL":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Controls/LayoutOption.js ***!
  \************************************************/
/*! exports provided: LayoutOption */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutOption", function() { return LayoutOption; });
/**
 * @public
 */
var LayoutOption;
(function (LayoutOption) {
    LayoutOption[LayoutOption["Tiles"] = 0] = "Tiles";
    LayoutOption[LayoutOption["Layers"] = 1] = "Layers";
})(LayoutOption || (LayoutOption = {}));


/***/ }),

/***/ "UjPA":
/*!*********************************************!*\
  !*** ./lib/SPTaskLib/Pages/TeamSitePage.js ***!
  \*********************************************/
/*! exports provided: SiteDesignId, TeamSitePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SiteDesignId", function() { return SiteDesignId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TeamSitePage", function() { return TeamSitePage; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Controls/CreateSitePanel */ "JmdK");
/* harmony import */ var _ListLibrary__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ListLibrary */ "7on5");
/* harmony import */ var _Controls_FilePicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Controls/FilePicker */ "8uLm");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Controls_SitePermissionPanel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Controls/SitePermissionPanel */ "DM7Z");
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../PageUtil */ "jK1H");
/* harmony import */ var _Controls_LayoutOption__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Controls/LayoutOption */ "UcNL");
/* harmony import */ var _Pages_PageSettingsPanel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../Pages/PageSettingsPanel */ "YfnZ");










/**
 * @public
 */
var SiteDesignId;
(function (SiteDesignId) {
    SiteDesignId["PortfolioDesignID"] = "6142d2a0-63a5-4ba0-aede-d9fefca2c767";
    SiteDesignId["BlankDesignId"] = "f6cc5403-0d63-442e-96c0-285923709ffc";
    SiteDesignId["CompanyPortalDesignPackageId"] = "fbf8ec01-846c-44c4-b17b-8fe1e4e5adae";
    SiteDesignId["ODSPWebCommunicationSite"] = "00000000-0000-0000-0000-000000000000";
})(SiteDesignId || (SiteDesignId = {}));
/**
 * @public
 */
var TeamSitePage = /** @class */ (function () {
    function TeamSitePage() {
    }
    TeamSitePage.PageReady = function (expectedTitle) {
        var waiter = TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'ms-CommandBar');
        if (TeamSitePage.editMode) {
            waiter = TAB.AndWaiters(waiter, _Pages_Canvas__WEBPACK_IMPORTED_MODULE_4__["Canvas"].WaitForWebPartToolboxButton());
        }
        return waiter;
    };
    TeamSitePage.AddTaskWaitForCommandBar = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return !!TeamSitePage.GetCommandBar();
        }));
    };
    TeamSitePage.AddTaskWaitForEditButton = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarEditButton']"));
    };
    TeamSitePage.AddTaskEditPage = function () {
        var timeWhenEditButtonIsClicked;
        var isAlreadyEdit = false;
        TAB.AddTask(TAB.MakeTask(function () {
            if (TeamSitePage.editMode) {
                TAB.Log.Comment('Page is in Edit Mode already');
                isAlreadyEdit = true;
            }
            else {
                TAB.Log.Comment('Edit Page');
                var editButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarEditButton');
                TAB.ClickElement(editButton);
                timeWhenEditButtonIsClicked = performance.now();
            }
        }), TAB.AndWaiters(TAB.MakeWaiter(function () {
            if (isAlreadyEdit) {
                return true;
            }
            // Wait for at least 1 second because there is a 500ms delay of launching checkout dialog after clicking edit.
            // After 1 second, if checkout dialog is absence, we can then assume the checkout action is complete by either
            // 1. checkout finishes less than 500ms, the checkout dialog never launched.
            // 2. checkout dialogs dismissed after the it's launched 500ms after checkout button is clicked.
            return (performance.now() - timeWhenEditButtonIsClicked > 1000 &&
                TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='checkout-dialog']")
                    .length === 0);
        }), _Pages_Canvas__WEBPACK_IMPORTED_MODULE_4__["Canvas"].WaitForWebPartToolboxButton()));
    };
    TeamSitePage.AddTaskInvokeSharePanel = function (sitePermissionPanel) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('waiting for share button to be loaded');
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('getting shareSiteButton');
            var shareSiteButton = TeamSitePage.GetShareSiteButton();
            TAB.Log.Comment("shareSiteButton is " + shareSiteButton);
            return !!shareSiteButton;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(TeamSitePage.GetShareSiteButton());
        }), _Controls_SitePermissionPanel__WEBPACK_IMPORTED_MODULE_5__["SitePermissionPanel"].WaitForPanel());
        sitePermissionPanel.SetRootElementForPanel();
    };
    TeamSitePage.AddTaskLoadSitePage = function (pageRelativeUrl) {
        _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].AddTaskSetDebugManifests();
        var pageUrl = "" + TAB.Settings.Get('ProductServer') + pageRelativeUrl;
        TAB.AddTask(TAB.LoadPage(pageUrl), TAB.PageReady());
    };
    TeamSitePage.MakeTaskFindButtonInCommandBar = function (targetDataAutomationId, skipClickingOverflow) {
        if (skipClickingOverflow === void 0) { skipClickingOverflow = false; }
        return TAB.AddTask(TAB.MakeTask(function () {
            if (!skipClickingOverflow) {
                var ellipsisButton = TAB.GetElements(TeamSitePage.GetCommandBar(), TAB.searchBy.hasClassName, 'ms-CommandBar-overflowButton')[0];
                if (ellipsisButton) {
                    TAB.Log.Comment('Find the ellipsis button, click on it');
                    TAB.ClickElement(ellipsisButton);
                }
                else {
                    TAB.Log.Comment('Not find the ellipsis button');
                }
            }
        }), _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, targetDataAutomationId));
    };
    TeamSitePage.AddTaskSavePage = function (homePage) {
        if (homePage === void 0) { homePage = false; }
        TAB.Log.AddTaskComment('Start to save page');
        TAB.AddTask(TAB.MakeTask(function () {
            var ellipsisButton = TAB.GetElements(TeamSitePage.GetCommandBar(), TAB.searchBy.hasClassName, 'ms-CommandBar-overflowButton')[0];
            if (ellipsisButton) {
                TAB.Log.Comment('Find the ellipsis button, click on it');
                TAB.ClickElement(ellipsisButton);
            }
            else {
                TAB.Log.Comment('Not find the ellipsis button');
            }
        }), TAB.MakeWaiter(function () {
            return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'pageCommandBarSaveButton');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on the save button');
            var saveButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'pageCommandBarSaveButton');
            TAB.ClickElement(saveButton);
        }), homePage ? TeamSitePage.WaitForHomeViewModeTransition() : TeamSitePage.WaitForViewModeTransition());
        TAB.Log.AddTaskPass('Success to save page');
    };
    TeamSitePage.AddTaskPublishPage = function (homePage, isNewsPage) {
        if (homePage === void 0) { homePage = false; }
        if (isNewsPage === void 0) { isNewsPage = false; }
        var publishButton = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('First waiting for the publish button');
        }), TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'commandBarWrapper'), TAB.MakeWaiter(function () {
            try {
                publishButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarPublishButton');
                if (publishButton) {
                    TAB.Log.Comment('publish button is on the page');
                    return true;
                }
                return false;
            }
            catch (e) {
                return false;
            }
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking the publish button on the command bar');
            TAB.ClickElement(publishButton);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for page to be published');
            TeamSitePage.AddTaskWaitForPagePublished(homePage, isNewsPage);
        }));
    };
    TeamSitePage.AddTaskPublishFromPrePubPanel = function (homePage) {
        var _this = this;
        if (homePage === void 0) { homePage = false; }
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for the publish button on the pre-publish panel');
        }), TAB.MakeWaiter(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublishPanel']")) {
                return true;
            }
            return false;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Pre-publish panel opened');
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-RequiredPropsLabel']")) {
                TAB.Log.Fail('There is a required property on the panel.');
            }
            TAB.Log.Comment('Clicking the publish button on the pre-publish panel, which publishes the page or opens approvals pane');
            var publishButton = _this._getPanelPublishButton();
            if (publishButton) {
                TAB.ClickElement(publishButton);
            }
        }), homePage ? TeamSitePage.WaitForHomeViewModeTransition() : TeamSitePage.WaitForViewModeTransition());
    };
    TeamSitePage.AddTaskWaitForPagePublished = function (homePage, isNewsPage) {
        if (homePage === void 0) { homePage = false; }
        if (isNewsPage === void 0) { isNewsPage = false; }
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for view mode transition after publish');
        }), homePage ? TeamSitePage.WaitForHomeViewModeTransition() : TeamSitePage.WaitForViewModeTransition());
        if (!isNewsPage) {
            TeamSitePage.AddTaskDismissPostPublishPanelIfExists();
        }
        TAB.Log.AddTaskComment('Done with page publish task');
    };
    TeamSitePage.AddTaskWaitForScheduleButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Looking for command bar');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'commandBarWrapper'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Looking for command bar schedule button');
        }), TAB.MakeWaiter(function () {
            try {
                var buttonId = 'pageCommandBarScheduleButton';
                var publishButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), buttonId);
                if (publishButton) {
                    return true;
                }
                return false;
            }
            catch (e) {
                return false;
            }
        }));
    };
    TeamSitePage.AddTaskWaitForPageStatusNotifierAppearAndDisappear = function () {
        var startTime;
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="pageStatusNotifier"]'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('wait for banner or 6 seconds');
            startTime = performance.now();
        }), TAB.MakeWaiter(function () {
            // sometimes publish banner or translation banner won't be displayed due to
            // clicking publish button too fast
            // and race condition for setState inside a setTimeout in PageStatusNotifier.tsx isn't handled very well
            // so wait for 6 seconds here instead of waiting for banner forever
            // the goal is to make sure publish fieldsActions are loaded in CommandBar.tsx
            return TeamSitePage.BannerIsVisible() || performance.now() - startTime > 6000;
        }));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return !TeamSitePage.BannerIsVisible();
        }));
    };
    TeamSitePage.AddTaskClickSubmitPageOnCommandBar = function () {
        TAB.Log.AddTaskComment('Task to Click on Submit button from command bar');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click on Submit button');
            var submitButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarSubmitButton');
            TAB.ClickElement(submitButton);
        }), undefined);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for page to be submitted');
            TAB.AddTask(undefined, TeamSitePage.WaitForViewModeTransition());
        }));
        TeamSitePage.AddTaskSubmitFromOOBPanel();
    };
    TeamSitePage.AddTaskClickApprovePageOnCommandBar = function () {
        TAB.Log.AddTaskComment('Task to Click on Approve button from command bar');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for Approve Button');
            return (_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarReviewButton') !==
                undefined);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on Approve Button');
            var reviewButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarReviewButton');
            TAB.ClickElement(reviewButton);
        }));
        TeamSitePage.AddTaskApproveFromOOBPanel();
    };
    TeamSitePage.AddTaskClickRejectPageOnCommandBar = function () {
        TAB.Log.AddTaskComment('Task to Click on Reject button from command bar');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for Reject Button');
            return (_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarReviewButton') !==
                undefined);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on Reject Button');
            var reviewButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarReviewButton');
            TAB.ClickElement(reviewButton);
        }));
        TeamSitePage.AddTaskRejectFromOOBPanel();
    };
    TeamSitePage.AddTaskSubmitFromOOBPanel = function () {
        var actionButton = undefined;
        TeamSitePage.AddTaskToWaitForCommentsTextOnPanel();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting on Submit Button');
            actionButton = TeamSitePage.GetActionButtonFromOOBPanel('submit');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='submit_button']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on Submit button from OOB panel');
            TAB.ClickElement(actionButton);
        }), TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for status to change to pending');
            return TeamSitePage.hasExpectedStatusChangeHappened('Pending');
        }));
    };
    TeamSitePage.AddTaskApproveFromOOBPanel = function () {
        var actionButton = undefined;
        TeamSitePage.AddTaskToWaitForCommentsTextOnPanel();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting on Approve Button');
            actionButton = TeamSitePage.GetActionButtonFromOOBPanel('approve');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='approve_button']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on Approve button from OOB panel');
            TAB.ClickElement(actionButton);
        }), TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for status to change to approved');
            return TeamSitePage.hasExpectedStatusChangeHappened('Published');
        }));
    };
    TeamSitePage.AddTaskRejectFromOOBPanel = function () {
        var actionButton = undefined;
        TeamSitePage.AddTaskToWaitForCommentsTextOnPanel();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting on Reject Button');
            actionButton = TeamSitePage.GetActionButtonFromOOBPanel('reject');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='reject_button']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on Reject button from OOB panel');
            TAB.ClickElement(actionButton);
        }), TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for status to change to rejeced');
            return TeamSitePage.hasExpectedStatusChangeHappened('Rejected');
        }));
    };
    TeamSitePage.GetActionButtonFromOOBPanel = function (action) {
        switch (action) {
            case 'submit':
                return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='submit_button']");
            case 'approve':
                return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='approve_button']");
            case 'reject':
                return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='reject_button']");
        }
    };
    TeamSitePage.AddTaskDiscardChange = function (homePage) {
        if (homePage === void 0) { homePage = false; }
        TAB.AddTask(TAB.MakeTask(function () {
            var discardButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'discardButton');
            TAB.ClickElement(discardButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='yesButton']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click yes on Discard Change dialog');
            var confirmButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(TAB.Win, 'yesButton')[0];
            if (confirmButton) {
                TAB.ClickElement(confirmButton);
            }
            else {
                TAB.Log.Warning('Yes dialog button not found to click on.');
            }
        }), homePage ? TeamSitePage.WaitForHomeViewModeTransition() : TeamSitePage.WaitForViewModeTransition());
    };
    TeamSitePage.WaitForViewModeTransition = function () {
        return TAB.AndWaiters(TAB.MakeWaiter(function () {
            if (!TeamSitePage.editMode) {
                return true;
            }
            return false;
        }), TeamSitePage.WaitForPageRename());
    };
    TeamSitePage.WaitForHomeViewModeTransition = function () {
        return TAB.MakeWaiter(function () {
            if (!TeamSitePage.editMode) {
                return true;
            }
        });
    };
    TeamSitePage.AddTaskCreateNewPageStubFromBlankPage = function () {
        // Wait for the new button to exist
        TeamSitePage.AddTaskWaitForNewbutton();
        TAB.AddTask(TAB.MakeTask(function () {
            var newButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarNewButton');
            TAB.ClickElement(newButton);
            var calloutField = (TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-ContextualMenu-list'));
            var startFromBlankPageButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(calloutField, 'ChooseFromTemplate');
            TAB.ClickElement(startFromBlankPageButton);
        }), TAB.MakeWaiter(function () {
            return TeamSitePage.isNewStubCreated;
        }));
    };
    TeamSitePage.AddTaskClickNewInCommandBar = function () {
        // Wait for the new button to exist
        TeamSitePage.AddTaskWaitForNewbutton();
        TAB.AddTask(TAB.MakeTask(function () {
            var newButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarNewButton');
            TAB.ClickElement(newButton);
            var calloutField = (TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-list'));
            var pageButton = TAB.GetElements(calloutField, TAB.searchBy.hasClassName, 'ms-ContextualMenu-link');
            TAB.ClickElement(pageButton[2]);
        }), TAB.MakeWaiter(function () {
            var dialog = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Modal')[0];
            return Boolean(dialog);
        }));
        TeamSitePage.AddTaskClickCreateInTemplateDialog();
    };
    TeamSitePage.AddTaskWaitForNewbutton = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var commandBar = TeamSitePage.GetCommandBar();
            if (commandBar) {
                return !!_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(commandBar, 'pageCommandBarNewButton');
            }
            else {
                return false;
            }
        }));
    };
    TeamSitePage.AddTaskCreateNewsPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var newButton = TeamSitePage.GetNewsAddButton();
            TAB.ClickElement(newButton);
        }), TAB.MakeWaiter(function () {
            return TeamSitePage.isNewStubCreated;
        }));
    };
    TeamSitePage.AddTaskCreateNewsPostFromNewsPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Wait for newsAddButton');
        }), TAB.MakeWaiter(function () {
            return !!TeamSitePage.GetNewsAddButtonFromNewsPage();
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var newButton = TeamSitePage.GetNewsAddButtonFromNewsPage();
            TAB.ClickElement(newButton);
        }), TAB.MakeWaiter(function () {
            return !!_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'newsPostOption');
        }));
        var createButton;
        TAB.AddTask(TAB.MakeTask(function () {
            var newButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'newsPostOption');
            TAB.ClickElement(newButton);
        }), TAB.MakeWaiter(function () {
            if (!!_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'template-panel-create-button')) {
                createButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'template-panel-create-button');
                if (createButton.attributes['data-is-focusable'] &&
                    createButton.attributes['data-is-focusable'].value === 'true') {
                    return true;
                }
            }
            return false;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(createButton);
        }), TAB.MakeWaiter(function () {
            return !_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'template-panel-create-button');
        }));
    };
    TeamSitePage.AddTaskOpenFilePicker = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Open Filepicker');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_4__["Canvas"].SelectedWebpart.AddTaskClickFilePickerButton();
        }), TeamSitePage.FilePicker.WaitForViewLoad(_Controls_FilePicker__WEBPACK_IMPORTED_MODULE_3__["FilePickerView"].Recent));
    };
    /**
     * Opens command bar 'New' contextual menu menu
     */
    TeamSitePage.AddTaskOpenNewContexualMenu = function () {
        // Wait for the new button to exist
        TeamSitePage.AddTaskWaitForNewbutton();
        TAB.AddTask(TAB.MakeTask(function () {
            var newButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarNewButton');
            TAB.ClickElement(newButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Callout'));
    };
    /**
     * Creates a new 'Plan' page
     */
    TeamSitePage.AddTaskCreatePlanPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var planButton = TeamSitePage.GetNewPlanButton();
            TAB.ClickElement(planButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel-contentInner'));
    };
    TeamSitePage.AddTaskCreateFilePicker = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Create Filepicker');
            TeamSitePage.FilePicker = new _Controls_FilePicker__WEBPACK_IMPORTED_MODULE_3__["FilePicker"](_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win, 'sp-filepicker'));
        }));
    };
    TeamSitePage.GetPageHeader = function () {
        try {
            var pageHeader = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win, 'pageHeader');
            return pageHeader;
        }
        catch (e) {
            return undefined;
        }
    };
    TeamSitePage.AddTaskWaitForPageHeader = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for the page header');
        }), TeamSitePage.WaitForPageHeader());
    };
    TeamSitePage.AddTaskAddPageTitle = function (value) {
        TAB.AddTask(undefined, TeamSitePage.WaitForPageHeader());
        TAB.AddTask(undefined, TeamSitePage.WaitForTitleRegion());
        TAB.AddTask(TAB.MakeTask(function () {
            var titleText = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetPageHeader(), 'pageTitleInput');
            var focusEv = TAB.Win.document.createEvent('HTMLEvents');
            focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
            titleText.dispatchEvent(focusEv);
            titleText.value = value;
            var ev = TAB.Win.document.createEvent('HTMLEvents');
            ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
            titleText.dispatchEvent(ev);
            // press Enter
            TAB.FireKeyboardEvent(titleText, 'keydown', 13);
            var blurEv = TAB.Win.document.createEvent('HTMLEvents');
            blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
            titleText.dispatchEvent(blurEv);
            TeamSitePage.Title = value;
        }), TeamSitePage.WaitForPageTitleNotEmpty());
    };
    TeamSitePage.AddTaskCancelFilePicker = function () {
        // click cancel button
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Cancel Filepicker');
            TeamSitePage.FilePicker.AddTaskCancel();
        }), undefined);
    };
    TeamSitePage.WaitForPageSave = function () {
        return TAB.MakeWaiter(function () {
            var statusBar = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'pageCommandBarStatus');
            var savedIcon = 'CheckMark';
            var pageSaved = !TeamSitePage.editMode || (statusBar && statusBar.getAttribute('data-automation-icon') === savedIcon);
            if (pageSaved) {
                TAB.Log.Comment('Page has been saved');
            }
            return pageSaved;
        });
    };
    TeamSitePage.WaitForPageTitleNotEmpty = function () {
        return TAB.MakeWaiter(function () {
            var titleText = TeamSitePage.GetPageTitleElement();
            return titleText.value !== undefined || titleText.value !== '';
        });
    };
    TeamSitePage.WaitForTitleRegion = function () {
        return TAB.MakeWaiter(function () {
            var titleText = TeamSitePage.GetPageTitleElement();
            if (titleText) {
                return true;
            }
            else {
                return false;
            }
        });
    };
    TeamSitePage.AddTaskOpenPostPublishPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var ellipsisButton = TAB.GetElements(TeamSitePage.GetCommandBar(), TAB.searchBy.hasClassName, 'ms-CommandBar-overflowButton')[0];
            if (ellipsisButton) {
                TAB.ClickElement(ellipsisButton);
            }
            var promoteButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetCommandBar(), 'promoteButton');
            TAB.ClickElement(promoteButton);
        }), TeamSitePage.WaitForPostPublishPanel());
    };
    TeamSitePage.AddTaskOpenPageSettingsPanel = function (isSchedulingEnabled) {
        if (isSchedulingEnabled === void 0) { isSchedulingEnabled = false; }
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Checking if button is visible, if not click the ellipsis');
            var pageSettingsPanelButton = TeamSitePage.GetPageSettingsCommandBarButton();
            if (!pageSettingsPanelButton) {
                var ellipsisButton = TAB.GetElements(TeamSitePage.GetCommandBar(), TAB.searchBy.hasClassName, 'ms-CommandBar-overflowButton')[0];
                if (ellipsisButton) {
                    TAB.ClickElement(ellipsisButton);
                }
            }
        }), TeamSitePage.WaitForPageSettingsCommandBarButton());
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Open the page settings panel');
            var pageSettingsPanelButton = TeamSitePage.GetPageSettingsCommandBarButton();
            TAB.ClickElement(pageSettingsPanelButton);
        }));
        _Pages_PageSettingsPanel__WEBPACK_IMPORTED_MODULE_8__["PageSettingsPanel"].AddTaskWaitForPageSettingsPanel(isSchedulingEnabled);
    };
    TeamSitePage.AddTaskDismissPostPublishPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for the post publish panel and the close button on it');
        }), TeamSitePage.WaitForPostPublishPanelCloseButton());
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking the close button on the post publish panel');
            var closeButton = TeamSitePage.GetCloseButtonForPostPublishPanel();
            TAB.ClickElement(closeButton);
            TAB.Log.Comment('Clicked the close button, now waiting for the panel to disappear');
        }), TAB.MakeWaiter(function () {
            return TeamSitePage.WaitForPostPublishPanelNotVisible();
        }));
    };
    TeamSitePage.AddTaskDismissPostPublishPanelIfExists = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Checking whether the post publish panel placeholder div is rendered');
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"PostPublishPanel-placeholder\"]")) {
                TAB.Log.Comment('Post publish panel placeholder exists');
                TeamSitePage.AddTaskDismissPostPublishPanel();
            }
            else {
                TAB.Log.Comment('Post publish panel placeholder does not exist. No need to dismiss the panel');
            }
        }));
    };
    Object.defineProperty(TeamSitePage, "editMode", {
        get: function () {
            try {
                return TAB.Win.location.search.indexOf('Mode=Edit') > -1;
            }
            catch (error) {
                return false;
            }
        },
        enumerable: true,
        configurable: true
    });
    TeamSitePage.AddRestTaskDeletePage2 = function (siteName, path) {
        if (siteName === void 0) { siteName = undefined; }
        if (path === void 0) { path = 'sites'; }
        var pageUrl = TeamSitePage.PageUrl;
        if (pageUrl) {
            pageUrl = pageUrl.split('?', 1)[0];
            var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
            pageUrl = pageUrl.substr(rootSiteUrl.length);
            rootSiteUrl += "/" + path + "/" + siteName;
            _ListLibrary__WEBPACK_IMPORTED_MODULE_2__["List"].addRestTaskDeleteItem2(rootSiteUrl, pageUrl);
        }
    };
    TeamSitePage.AddRestTaskDeletePageByPageName = function (siteName, pageUrl, path, fetchCanary) {
        var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        path = path || TeamSitePage.Path;
        if (siteName !== '/' && path !== '/') {
            rootSiteUrl += "/" + path + "/" + siteName;
        }
        pageUrl = rootSiteUrl + "/" + pageUrl;
        _ListLibrary__WEBPACK_IMPORTED_MODULE_2__["List"].addRestTaskDeleteItem(rootSiteUrl, rootSiteUrl, pageUrl, fetchCanary);
    };
    TeamSitePage.AddRestTaskDeletePage = function () {
        // TeamSitePage.PageUrl is undefined unless the page name is saved.
        var pageUrl = TeamSitePage.PageUrl || TAB.Win.location.href;
        pageUrl = pageUrl.split('?', 1)[0];
        var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        pageUrl = pageUrl.substr(rootSiteUrl.length);
        _ListLibrary__WEBPACK_IMPORTED_MODULE_2__["List"].addRestTaskDeleteItem(rootSiteUrl, rootSiteUrl, pageUrl);
    };
    TeamSitePage.AddRestTaskDeleteImages = function (urls) {
        var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        urls.forEach(function (imageUrl) {
            _ListLibrary__WEBPACK_IMPORTED_MODULE_2__["List"].addRestTaskDeleteItem(rootSiteUrl, rootSiteUrl, imageUrl);
            TAB.Log.AddTaskComment('Deleted ' + imageUrl);
        });
    };
    TeamSitePage.AddRestTaskDeleteImagesOnSite = function (siteName, urls, path) {
        if (!siteName) {
            TeamSitePage.AddRestTaskDeleteImages(urls);
        }
        else {
            urls.forEach(function (imageUrl) {
                var sitePath = path ? path : 'sites';
                var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
                var currentSiteUrl = rootSiteUrl + "/" + sitePath + "/" + siteName;
                _ListLibrary__WEBPACK_IMPORTED_MODULE_2__["List"].addRestTaskDeleteItem(currentSiteUrl, currentSiteUrl, imageUrl);
                TAB.Log.AddTaskComment('Deleted ' + imageUrl);
            });
        }
    };
    TeamSitePage.AddTaskDeleteNavigationLink = function (siteUrl, navResult, linkTitle) {
        TAB.Log.AddTaskComment('Getting nav links');
        var targetUrl = siteUrl + "/_api/navigation/MenuState";
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendGetRequest(siteUrl, targetUrl, result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success && result.retVal) {
                navResult.MenuState = result.retVal;
                var links_1 = navResult.MenuState && navResult.MenuState.Nodes;
                if (links_1) {
                    TAB.Log.AddTaskComment('Finding nav link with the title: ' + linkTitle + ' to delete.');
                    links_1.forEach(function (link) {
                        if (link.Title.indexOf(linkTitle) > -1) {
                            TAB.Log.AddTaskComment('Found the link to delete, marking it for deletion.');
                            TeamSitePage.SetLinkAsDeleted(link);
                            // Send the post request to update the nav
                            var postTargetUrl = siteUrl + '/_api/navigation/SaveMenuState';
                            var postContent = {
                                menuState: {
                                    SPWebPrefix: navResult.MenuState && navResult.MenuState.SPWebPrefix,
                                    StartingNodeKey: '1025' /* Quick launch node key */,
                                    Version: new Date().toTimeString(),
                                    Nodes: links_1
                                }
                            };
                            var postResult = {};
                            _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendPostRequest(siteUrl, postTargetUrl, JSON.stringify(postContent), postResult, true /** fetchCanary */);
                        }
                    });
                }
            }
            else {
                TAB.Log.AddTaskFail('Failed to fetch nav links');
            }
        }));
    };
    TeamSitePage.SetLinkAsDeleted = function (link) {
        link.IsDeleted = true;
        if (link.Nodes) {
            link.Nodes.forEach(function (node) { return TeamSitePage.SetLinkAsDeleted(node); });
        }
    };
    TeamSitePage.GetPropertyPane = function () {
        return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
    };
    TeamSitePage.AddTaskVerifySiteHeader = function (expectedSiteTitle) {
        TAB.Log.AddTaskComment('Waiting for Site header...');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var siteHeader = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='SiteHeader']");
                var currentUrl = TAB.Win.location.href;
                if (currentUrl && currentUrl.indexOf('error.aspx') !== -1) {
                    TAB.Log.Fail('Navigated to error page: ' + currentUrl);
                    // return true to end waiter.
                    return true;
                }
                return siteHeader.length > 0;
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Verify information in Site header');
            var siteHeader = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='SiteHeader']");
            var siteTitle = TAB.GetTextContent(_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(siteHeader, 'SiteHeaderTitle'));
            TAB.Log.Verify(siteTitle === expectedSiteTitle, 'Verifying the display name of the group. Expected: [' +
                expectedSiteTitle +
                '], Actual: [' +
                siteTitle +
                ']');
        }));
    };
    TeamSitePage.AddTaskCreationCommunicationSite = function (createSiteParams) {
        TAB.Log.AddTaskComment('Verifying Create Communication Site Panel');
        var createSitePanel = new _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanel"](true /*inPage*/, false /*SPHomePanel*/);
        var template = _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSiteTemplateOption"].Publishing;
        createSitePanel.AddTaskVerifyForm(_Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanelForm"].ChooseTemplate, undefined);
        createSitePanel.AddTaskChooseTemplate(template);
        createSitePanel.AddTaskVerifyForm(_Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanelForm"].CreateSite, template);
        createSitePanel.AddTaskCreateSite(createSiteParams, template);
    };
    TeamSitePage.AddTaskCreateTeamSite = function (createSiteParams) {
        TAB.Log.AddTaskComment('Verifying Create Team Site Panel');
        var createSitePanel = new _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanel"](true /*inPage*/, false /*SPHomePanel*/);
        var template = _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSiteTemplateOption"].TeamSite;
        createSitePanel.AddTaskVerifyForm(_Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanelForm"].ChooseTemplate, undefined);
        createSitePanel.AddTaskChooseTemplate(template);
        createSitePanel.AddTaskVerifyForm(_Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanelForm"].CreateSite, template);
        createSitePanel.AddTaskCreateSite(createSiteParams, template);
        createSitePanel.AddTaskVerifyForm(_Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_1__["CreateSitePanelForm"].AddMember, undefined);
        createSitePanel.AddTaskFinish();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () { return _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].CheckPageLoaded(); }));
    };
    TeamSitePage.EnsureNewsTestSiteExists = function (siteUrl) {
        var result = {};
        var testPage1 = 'DoNotDeleteNews1';
        var testPage2 = 'DoNotDeleteNews2';
        var testPage3 = 'DoNotDeleteNews3';
        var testPage4 = 'DoNotDeleteNews4';
        var testPage5 = 'DoNotDeleteNews5';
        var promotedState = 2; // News post
        var publishPage = true;
        var jsonContent = {};
        TAB.AddTask(TAB.MakeTask(function () {
            TeamSitePage.EnsureCommSiteExists(siteUrl, result);
            _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].EnsurePageExist(testPage1, undefined, siteUrl, jsonContent, jsonContent, publishPage, promotedState);
            _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].EnsurePageExist(testPage2, undefined, siteUrl, jsonContent, jsonContent, publishPage, promotedState);
            _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].EnsurePageExist(testPage3, undefined, siteUrl, jsonContent, jsonContent, publishPage, promotedState);
            _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].EnsurePageExist(testPage4, undefined, siteUrl, jsonContent, jsonContent, publishPage, promotedState);
            _PageUtil__WEBPACK_IMPORTED_MODULE_6__["PageUtil"].EnsurePageExist(testPage5, undefined, siteUrl, jsonContent, jsonContent, publishPage, promotedState);
        }));
    };
    TeamSitePage.AddTaskCreateCommSite = function (siteName, result, designID, lcid) {
        if (undefined !== lcid) {
            TeamSitePage.CreateSPSite(siteName, result, true /*failIfExists*/, designID, lcid);
        }
        else {
            TeamSitePage.CreateSPSite(siteName, result, true /*failIfExists*/, designID);
        }
    };
    TeamSitePage.EnsureCommSiteExists = function (siteName, result, designID) {
        TeamSitePage.CreateSPSite(siteName, result, false /*failIfExists*/, designID);
    };
    TeamSitePage.EnsureTeamSiteExists = function (siteName, result, designID) {
        TeamSitePage.CreateSPSite(siteName, result, false /*failIfExists*/, designID, undefined, 'STS#3');
    };
    TeamSitePage.AddTaskDeleteSite = function (siteUrl) {
        if (!siteUrl) {
            TAB.Log.Fail('Tries to delete root site collection: ' + siteUrl);
            return;
        }
        // Make sure this doesn't accidently delete root site collection
        var trimmedUrl = siteUrl.trim().toLowerCase();
        var domainIndex = trimmedUrl.lastIndexOf('.sharepoint.com');
        if (domainIndex !== -1 &&
            (trimmedUrl.length === domainIndex + 15 || trimmedUrl.length === domainIndex + 16)) {
            TAB.Log.Fail('Tries to delete root site collection: ' + siteUrl);
            return;
        }
        TAB.Log.AddTaskComment('Deleting communication site at the following URL: ' + siteUrl);
        var targetUrl = siteUrl + '/_api/site/id';
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendRestRequest(siteUrl, targetUrl, '', result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result.retVal && result.retVal.d && result.retVal.d.Id) {
                targetUrl = siteUrl + '/_api/SPSiteManager/Delete';
                var siteId = { siteId: result.retVal.d.Id };
                var body = JSON.stringify(siteId);
                result = {};
                _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendRestRequest(siteUrl, targetUrl, body, result, true /** fetchCanary */);
            }
        }));
    };
    TeamSitePage.AddTaskValidateHeroOOB = function (layout, expectedItemCount) {
        TAB.AddTask(undefined, TeamSitePage._CheckHeroOOBItems(layout, expectedItemCount));
    };
    TeamSitePage.WaitForPostPublishPanel = function () {
        return TAB.MakeWaiter(function () {
            return TeamSitePage.PostPublishPanelExists();
        });
    };
    TeamSitePage.WaitForPostPublishPanelCloseButton = function () {
        return TAB.MakeWaiter(function () {
            return !!TeamSitePage.GetCloseButtonForPostPublishPanel();
        });
    };
    TeamSitePage.PostPublishPanelExists = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="managePagePanelContainer"]');
    };
    TeamSitePage.WaitForPageSettingsCommandBarButton = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageSettingsButton']");
    };
    TeamSitePage.PageSettingsPanelExists = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-icon=\"pageSettingsPanel\"]");
    };
    TeamSitePage.AddTaskClearConfirmUnsavedChanges = function () {
        TAB.Log.AddTaskComment('Clear window.confirm');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Win.window.confirm = function () {
                return true;
            };
        }));
    };
    TeamSitePage.GetPageTitleElement = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TeamSitePage.GetPageHeader(), 'pageTitleInput');
    };
    TeamSitePage.GetCommandBar = function () {
        // using check mark to decide if the page has been saved
        try {
            var commandBar = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'commandBarWrapper');
            return commandBar;
        }
        catch (e) {
            return undefined;
        }
    };
    TeamSitePage.BannerIsVisible = function () {
        try {
            var bannerElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="pageStatusNotifier"]');
            var classList = bannerElement.classList.toString();
            return classList.indexOf('isVisible') !== -1;
        }
        catch (_a) {
            return false;
        }
    };
    /*
    Supported templates are:
     - SITEPAGEPUBLISHING#0 (for SPO Site Page Publishing Site Template - aka Comm sites)
     - STS#3 (for SP Modern Team Site Template for both OnPrem and SPO)
     - TEAMCHANNEL#0 (for SPO TeamChannel)
    */
    TeamSitePage.CreateSPSite = function (siteName, result, failIfExists, designID, lcid, template) {
        if (lcid === void 0) { lcid = 1033; }
        if (template === void 0) { template = 'SITEPAGEPUBLISHING#0'; }
        var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        var siteUrl = rootSiteUrl + "/" + TeamSitePage.Path + "/" + siteName;
        var webExistResult = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].addCsomTaskDoesWebExist(siteUrl, webExistResult);
        TAB.AddTask(TAB.MakeTask(function () {
            if (webExistResult.success) {
                TAB.Log.AddTaskComment("Found the test site \"" + siteUrl + "\".");
                if (failIfExists) {
                    TAB.Log.AddTaskFail('Could not create SPSite since another already exists at this URL');
                }
                else {
                    TAB.AddTask(TAB.LoadPage(siteUrl), TAB.PageReady());
                }
            }
            else {
                TAB.Log.AddTaskComment('Test site not found, attempting to create one ..');
                var body = {
                    request: {
                        __metadata: {
                            type: 'Microsoft.SharePoint.Portal.SPSiteCreationRequest'
                        },
                        WebTemplate: template,
                        Title: siteName,
                        Url: "" + siteUrl,
                        Description: '',
                        Classification: '',
                        Lcid: lcid,
                        ShareByEmailEnabled: false,
                        WebTemplateExtensionId: '00000000-0000-0000-0000-000000000000',
                        HubSiteId: '00000000-0000-0000-0000-000000000000',
                        SiteDesignId: designID
                    }
                };
                _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendRestRequest(rootSiteUrl, rootSiteUrl + '/_api/SPSiteManager/Create', JSON.stringify(body), result);
                TAB.AddTask(TAB.MakeTask(function () {
                    if (result.retVal && result.retVal.d && result.retVal.d.Create.SiteUrl) {
                        TAB.Log.AddTaskPass("Site creation succeeded " + result.retVal.d.Create.SiteUrl);
                        TAB.AddTask(TAB.LoadPage(result.retVal.d.Create.SiteUrl), TAB.PageReady());
                    }
                    else {
                        TAB.Log.AddTaskFail('Could not create sp site.');
                    }
                }));
            }
        }));
    };
    TeamSitePage.AddTaskToWaitForCommentsTextOnPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waiting for the comment text box to show up on content approval panel');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='content-approval-comments']"));
    };
    TeamSitePage.GetShareSiteButton = function () {
        /* todo: Use a data-automation-id: This id has been added in odsp-shared-react. This bug is to track making the change once it is consumed in sp-client
        https://onedrive.visualstudio.com/WEX!/_workitems/edit/469819 */
        var shareSiteButton = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='ShareSiteButton']");
        return shareSiteButton[0];
    };
    TeamSitePage.WaitForPageHeader = function () {
        return TAB.MakeWaiter(function () {
            return !!_Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win, 'pageHeader');
        });
    };
    TeamSitePage.WaitForPageRename = function () {
        return TAB.MakeWaiter(function () {
            try {
                /* bug 357411 - Use URL once, it is available to be used in TAB */
                var url = TAB.Win.location.href;
                TAB.Log.Comment("URL for page rename " + url);
                var normalizedUrl = url.toLowerCase();
                var extensionStart = normalizedUrl.indexOf('.aspx');
                var filenameStart = normalizedUrl.indexOf('sitepages') + 'SitePages'.length + 1;
                var filename = normalizedUrl.substring(filenameStart, extensionStart);
                TAB.Log.Comment('this is the file' + filename);
                // Keep this in sync with SitePageUtility.IllegalChars + whitespace in cms\publishing\om\sitepages\sitepageutility.cs
                var expectedFilename = TeamSitePage.Title.toLowerCase().replace(/[\s\^\'\"\#\%\*\:\<\>\?\/\\\.\|\&\,\;\+]/, '-');
                if (filename.indexOf(expectedFilename) > -1) {
                    TeamSitePage.PageUrl = url.toString();
                    return true;
                }
                else {
                    return false;
                }
            }
            catch (error) {
                return false;
            }
        });
    };
    TeamSitePage.WaitForPostPublishPanelNotVisible = function () {
        return TAB.MakeWaiter(function () {
            return !TeamSitePage.PostPublishPanelExists();
        });
    };
    TeamSitePage.isNewStubCreated = function () {
        return TAB.Win.location.search.indexOf('newpage') > -1;
    };
    TeamSitePage.GetPostPublishPanel = function () {
        try {
            var postPublishPanel = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel-main');
            return postPublishPanel;
        }
        catch (error) {
            return undefined;
        }
    };
    TeamSitePage.GetCloseButtonForPostPublishPanel = function () {
        try {
            var panel = TeamSitePage.GetPostPublishPanel();
            var closeButton = TAB.GetElement(panel, TAB.searchBy.hasClassName, 'ms-Panel-closeButton');
            return closeButton;
        }
        catch (e) {
            return undefined;
        }
    };
    TeamSitePage.GetNewsAddButtonFromNewsPage = function () {
        try {
            var addButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'newsAddButton');
            return addButton;
        }
        catch (e) {
            return undefined;
        }
    };
    TeamSitePage.GetNewsAddButton = function () {
        try {
            var newsWrapper = TAB.GetElement(TAB.Win, TAB.searchBy.className, 'ControlZone-control');
            var addButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(newsWrapper, 'AddNews');
            return addButton;
        }
        catch (e) {
            return undefined;
        }
    };
    TeamSitePage.GetPageSettingsCommandBarButton = function () {
        try {
            var pageSettingsButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'pageSettingsButton');
            return pageSettingsButton;
        }
        catch (e) {
            return undefined;
        }
    };
    /**
     * Returns a 'Plan' button element from a new contextual menu from the command bar
     */
    TeamSitePage.GetNewPlanButton = function () {
        try {
            var addButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'CommandBarNewPlanButton');
            return addButton;
        }
        catch (e) {
            return undefined;
        }
    };
    TeamSitePage._CheckHeroOOBItems = function (layout, expectedItemCount) {
        var tag = undefined;
        if (layout === _Controls_LayoutOption__WEBPACK_IMPORTED_MODULE_7__["LayoutOption"].Tiles) {
            tag = 'Tiles';
        }
        else {
            tag = 'Layers';
        }
        var waiter = TAB.MakeWaiter(function () {
            try {
                // check if it is tile layout
                var heroLayoutElements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + tag + "']");
                // check if there are 5 items
                var heroElements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='HeroPatternElement']");
                if (heroElements !== undefined && heroLayoutElements[0] !== undefined) {
                    return heroElements.length === expectedItemCount;
                }
                else {
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    TeamSitePage.AddTaskClickCreateInTemplateDialog = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var dialog = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Modal')[0];
            var chooseFromTemplate = TAB.GetElements(dialog, TAB.searchBy.hasClassName, 'ms-ChoiceField-labelWrapper')[2];
            TAB.ClickElement(chooseFromTemplate);
            var createButton = TAB.GetElements(dialog, TAB.searchBy.hasClassName, 'ms-Button--primary');
            TAB.ClickElement(createButton[0]);
        }), TAB.MakeWaiter(function () {
            return TeamSitePage.isNewStubCreated;
        }));
    };
    TeamSitePage.hasExpectedStatusChangeHappened = function (status) {
        var pageStatusElements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarStatus']");
        // In fabric-react@6, there is an intermediate status with two command bar in the page.
        if (pageStatusElements.length === 1) {
            return pageStatusElements[0].getAttribute('data-automation-text').lastIndexOf(status) > -1;
        }
    };
    TeamSitePage._getPanelPublishButton = function () {
        try {
            var publishButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-SubmitButton']");
            return publishButton;
        }
        catch (error) {
            return undefined;
        }
    };
    TeamSitePage.Path = 'teams';
    return TeamSitePage;
}());



/***/ }),

/***/ "Vi7M":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Controls/SitesWebPart.js ***!
  \************************************************/
/*! exports provided: SitesWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SitesWebPart", function() { return SitesWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");






/**
 * @public
 */
var SitesWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(SitesWebPart, _super);
    function SitesWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].Sites, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].Sites.toString()) || this;
    }
    SitesWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Add Sites webpart');
            _this.AddTaskSetupNewPage();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(_this);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='emptyStateCard']"));
    };
    SitesWebPart.prototype.AddTaskAddSiteByTitle = function (title) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Open property pane');
            _this.AddTaskClickConfigureButton();
        }), _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'sitesPicker'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the search box of sites picker in property pane');
            var sitesPicker = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'sitesPicker');
            var searchBox = TAB.GetElement(sitesPicker, TAB.searchBy.leadingId, 'SearchBox');
            TAB.Log.Comment('Input the title in search box');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_5__["ReactUtil"].TriggerOnChange(searchBox, title);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='itemInfo']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the search results');
            var searchResults = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'sitesPickerList');
            var sitesPickerItems = TAB.GetElements(searchResults, TAB.searchBy.tag, 'button');
            TAB.Log.Comment('Add the first site in search results');
            TAB.ClickElement(sitesPickerItems[0]);
        }), TAB.MakeWaiter(function () {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + SitesWebPart.siteCardId + "']") && TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='card-control-bar']"));
        }));
    };
    SitesWebPart.prototype.AddTaskDeleteSiteCardByIndex = function (index) {
        var siteCardToDelete;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the site card to delete');
            siteCardToDelete = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, SitesWebPart.siteCardId)[index];
            if (siteCardToDelete) {
                TAB.Log.Comment('Click the delete button');
                var deleteButton = TAB.GetElement(siteCardToDelete, TAB.searchBy.customQuery, "[data-automation-id='removeButton']");
                TAB.ClickElement(deleteButton);
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-main'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click the Yes button on confirm dialog');
            var confirmDialog = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-main');
            var yesButton = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(confirmDialog, 'yesButton');
            TAB.ClickElement(yesButton);
        }), TAB.MakeWaiter(function () { return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, SitesWebPart.siteCardId)[index] !== siteCardToDelete; }));
    };
    SitesWebPart.prototype.AddTaskGoToSeeAllPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Wait for See all link showing');
        }), TAB.MakeWaiter(function () {
            var seeAllLink = _this.GetSeeAllLink();
            return Boolean(seeAllLink) && seeAllLink.href.indexOf('pagestub') > -1;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click the See all link');
            TAB.ClickElement(_this.GetSeeAllLink());
        }), TAB.MakeWaiter(function () {
            return (TAB.Win.location.href.indexOf('_layouts/15/Sites.aspx') > -1 &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + SitesWebPart.siteCardId + "']"));
        }));
    };
    Object.defineProperty(SitesWebPart.prototype, "ShouldHaveSeeAllLink", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    SitesWebPart.siteCardId = 'siteCard';
    return SitesWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "W/DA":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/TenantAdmin/HomePage.js ***!
  \***********************************************/
/*! exports provided: HomePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HomePage", function() { return HomePage; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

var PAGE_KEYS = [
    'siteManagement',
    'recycleBin',
    'sharing',
    'accessControl',
    'settings',
    'geoLocations',
    'webApiPermissionManagement',
    'migrationCenter',
    'classicFeatures'
];
/**
 * @public
 */
var HomePage = /** @class */ (function () {
    function HomePage() {
    }
    HomePage.AddTaskLoadHomePage = function () {
        // debugFlights=!1683, will disable flight for Term store analytics card on home page.
        // debugFlights=!632, will disable flight for swap rootsite recommendation card on home page.
        // debugFlights=!1446, will disable flight for hvc dashboard on home page.
        // As it requires AAD Token, Tab test was failing. So disabling the flight for time being.
        var adminPageUrl = TAB.Settings.Get('ProductServer') +
            '/_layouts/15/online/AdminHome.aspx?debugFlights=!1683,!632,!1446#/home';
        TAB.AddTask(TAB.LoadPage(adminPageUrl), HomePage.PageReady('home'));
    };
    HomePage.AddTaskLoadContentTypeGallery = function () {
        // since TAB doesn't support AAD auth, adding isTabTest query param to get token from Acquire
        // this query param will be checked and depending on environment
        // we hit Acquire if TAB test else AAD in all other cases for token
        var contentTypeGalleryPageUrl = TAB.Settings.Get('ProductServer') + '/_layouts/15/online/AdminHome.aspx?isTabTest=true#/contentTypes';
        TAB.AddTask(TAB.LoadPage(contentTypeGalleryPageUrl), HomePage.PageReady('contentTypes'));
    };
    HomePage.AddTaskLoadTermStoreAdminCenter = function () {
        // since TAB doesn't support AAD auth, adding isTabTest query param to get token from Acquire
        // this query param will be checked and depending on environment
        // we hit Acquire if TAB test else AAD in all other cases for token
        var termStoreAdminCenterUrl = TAB.Settings.Get('ProductServer') +
            '/_layouts/15/online/AdminHome.aspx?isTabTest=true#/termStoreAdminCenter';
        TAB.AddTask(TAB.LoadPage(termStoreAdminCenterUrl), HomePage.PageReady('termStoreAdminCenter'));
    };
    HomePage.PageReady = function (key) {
        var waiter = TAB.AndWaiters(TAB.PageReady(), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-page-key='" + key + "']"));
        /**
         * adding an additional waiter in case of siteManagement page.
         * because this page loads the list lazily which was causing the test to fail,
         * if we navigated away from active sites page before DetailsList is populated
         *
         * Might need to change the [data-automationid='DetailsList'] according to changes in fabric.
         * Currently DetailsList fabric component does not process the value passed to data-automation-id prop and
         * has an fixed data-automationid='DetailsList'
         */
        if (key === 'siteManagement') {
            waiter = TAB.AndWaiters(waiter, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='DetailsList']"));
        }
        return waiter;
    };
    // TODO: We should use data-automation-id instead of href. Please refer bug #377123 on VSO.
    HomePage.AddTaskNavigatePages = function () {
        TAB.Log.AddTaskComment('Begin to navigate to each page.');
        var liList = this.GetNavItems();
        var pageHref = undefined;
        var _loop_1 = function (i) {
            var tagA = TAB.GetElements(liList[i], TAB.searchBy.tag, 'a');
            if (tagA.length !== 1) {
                return "continue";
            }
            pageHref = tagA[0].getAttribute('href');
            if (!pageHref) {
                return "continue";
            }
            var pageKey = HomePage.GetPageKeyByPageHref(pageHref);
            if (PAGE_KEYS.indexOf(pageKey) !== -1) {
                TAB.Log.AddTaskComment("Start navigating to page " + pageKey);
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.ClickElement(tagA[0]);
                }), HomePage.PageReady(pageKey));
                TAB.Log.AddTaskComment("Done navigating to page " + pageKey);
            }
        };
        for (var i = 1; i < liList.length; i++) {
            _loop_1(i);
        }
        TAB.Log.AddTaskComment('Finish navigating to each page.');
    };
    HomePage.GetNavItems = function () {
        var navItem = HomePage._getNavItemsElement();
        var liList = TAB.GetElements(navItem, TAB.searchBy.tag, 'li');
        return liList;
    };
    HomePage.GetPageKeyByPageHref = function (href) {
        return href.substr(2);
    };
    HomePage._getNavItemsElement = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.documentElement, 'navItems');
    };
    return HomePage;
}());



/***/ }),

/***/ "WS4A":
/*!******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/LinkPreviewWebpart.js ***!
  \******************************************************/
/*! exports provided: LinkPreviewWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkPreviewWebpart", function() { return LinkPreviewWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../SPKillSwitchUtil */ "y5Zv");





/**
 * @public
 */
var LinkPreviewWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(LinkPreviewWebpart, _super);
    function LinkPreviewWebpart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Link, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Link.toString()) || this;
    }
    LinkPreviewWebpart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskAssertWebPartNotExist();
            _this.AddTaskSetupNewPage();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(this.WaitForWebPartToExist());
    };
    LinkPreviewWebpart.prototype.AddTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]')) {
                throw 'Link Preview web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    LinkPreviewWebpart.prototype.WaitForWebPartToExist = function () {
        return this.WaitForElementWithDataAutomationId('inputContainer');
    };
    LinkPreviewWebpart.prototype.TryInputUrl = function (url) {
        var inputContainerDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]');
        var addUrlInput = TAB.GetElement(inputContainerDiv, TAB.searchBy.leadingId, 'TextField');
        // input url
        addUrlInput.focus();
        _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(addUrlInput, url);
    };
    LinkPreviewWebpart.prototype.TryInputLiveUrl = function (getUrl) {
        this.TryInputUrl(getUrl());
    };
    LinkPreviewWebpart.prototype.AddTaskTryInputLiveUrl = function (getUrl, shouldBeFound) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () { return _this.TryInputLiveUrl(getUrl); }), this.WaitForPreviewContent(shouldBeFound));
    };
    LinkPreviewWebpart.prototype.AddTaskTryInputUrl = function (url, shouldBeFound) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () { return _this.TryInputUrl(url); }), this.WaitForPreviewContent(shouldBeFound));
    };
    LinkPreviewWebpart.prototype.AddTaskDeleteInputControl = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var inputContainerDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]');
            var deleteButton = TAB.GetElement(inputContainerDiv, TAB.searchBy.customQuery, '[type="button"]');
            // click delete button
            TAB.ClickElement(deleteButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]');
        }));
    };
    LinkPreviewWebpart.prototype.AddTaskEditPreviewContent = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var previewContentDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="embedContainer"]');
            var editButton = TAB.GetElement(previewContentDiv, TAB.searchBy.customQuery, '[type="button"]');
            // click edit button
            TAB.ClickElement(editButton);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]');
        }));
    };
    LinkPreviewWebpart.prototype.AddTaskDeletePreviewContent = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var previewContentDiv = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="embedContainer"]');
            var deleteButton = TAB.GetElement(previewContentDiv, TAB.searchBy.customQuery, '[type="button"]');
            // click delete button
            TAB.ClickElement(deleteButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="embedContainer"]');
        }));
    };
    LinkPreviewWebpart.prototype.ClickUrlElement = function () {
        var _this = this;
        return TAB.MakeTask(function () {
            TAB.ClickElement(_this.getUrlElement());
        });
    };
    LinkPreviewWebpart.prototype.getUrlElement = function () {
        try {
            var inputContainerDiv = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]')[0];
            return TAB.GetElements(inputContainerDiv, TAB.searchBy.tag, 'a')[0];
        }
        catch (error) {
            return undefined;
        }
    };
    LinkPreviewWebpart.prototype.AddTaskClickUrlElement = function () {
        TAB.AddTask(this.ClickUrlElement());
    };
    LinkPreviewWebpart.prototype.UrlInputExists = function () {
        if (!_SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_4__["SPKillSwitchUtil"].isActivated('cbd8c0a2-9505-4989-aed5-4a8e30226015')) {
            var inputContainerDivs = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]');
            if (inputContainerDivs.length > 0) {
                return TAB.GetElements(inputContainerDivs[0], TAB.searchBy.tag, 'a').length > 0;
            }
            else {
                return false;
            }
        }
        else {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="inputContainer"]');
        }
    };
    LinkPreviewWebpart.prototype.WaitForPreviewContent = function (shouldBeFound) {
        return shouldBeFound
            ? this.WaitForElementWithDataAutomationId('embedContainer') &&
                this.WaitForElementWithDataAutomationId('metadataTitle')
            : this.WaitForElementWithDataAutomationId('previewRenderFailureErrorMessage');
    };
    LinkPreviewWebpart.prototype.WaitForElementWithDataAutomationId = function (dataAutomationId) {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + dataAutomationId + "\"");
    };
    return LinkPreviewWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "WYdG":
/*!****************************************************************************************************!*\
  !*** /agent/_work/1/s/common/temp/node_modules/.pnpm/tslib@1.10.0/node_modules/tslib/tslib.es6.js ***!
  \****************************************************************************************************/
/*! exports provided: __extends, __assign, __rest, __decorate, __param, __metadata, __awaiter, __generator, __exportStar, __values, __read, __spread, __spreadArrays, __await, __asyncGenerator, __asyncDelegator, __asyncValues, __makeTemplateObject, __importStar, __importDefault */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "XK4g":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Controls/EmbedWebPart.js ***!
  \************************************************/
/*! exports provided: EmbedWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EmbedWebPart", function() { return EmbedWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");





/**
 * @public
 */
var EmbedWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(EmbedWebPart, _super);
    function EmbedWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].ContentEmbed, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].ContentEmbed.toString()) || this;
    }
    EmbedWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskAssertWebPartNotExist();
            _this.AddTaskSetupNewPage();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="embed-code-input"]'));
    };
    EmbedWebPart.prototype.AddTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="HTMLEmbed"]')) {
                throw 'Embed web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    EmbedWebPart.prototype.AddTaskTryInputEmbedCode = function (embedCode, shouldBeRenderSuccessful) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (!embedCode) {
                embedCode = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].PageUrl || TAB.Win.location.href;
            }
            var inputEmbedCodeArea = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="embed-code-input"]');
            // input url
            inputEmbedCodeArea.focus();
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(inputEmbedCodeArea, embedCode);
        }), shouldBeRenderSuccessful
            ? TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='embedCode']")
            : this.WaitForElementWithClassToExist('ms-TextField-errorMessage'));
    };
    EmbedWebPart.prototype.PropertyPaneExisits = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[class^="spPropertyPaneContainer"]');
    };
    EmbedWebPart.prototype.WaitForElementWithClassToExist = function (className) {
        // The className is the first class, or the second one. See https://stackoverflow.com/a/8588532/1436671
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[class^=\"" + className + "\"], [class*=\" " + className + "\"]");
    };
    return EmbedWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "XvS+":
/*!********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/SiteInformationPanel.js ***!
  \********************************************************/
/*! exports provided: SiteInformationPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SiteInformationPanel", function() { return SiteInformationPanel; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

/**
 * @public
 */
var SiteInformationPanel = /** @class */ (function () {
    function SiteInformationPanel() {
    }
    SiteInformationPanel.WaitForPanel = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-SiteSettingsPanel');
    };
    SiteInformationPanel.prototype.AddTaskLaunchSiteInformationPanelFromSuiteNav = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Launching site information panel...');
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'O365_NavHeader'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Settings', TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nav-contextMenu'));
            TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_SubLink_SUITENAV_SITE_INFORMATION', SiteInformationPanel.WaitForPanel());
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            _this._rootElement = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-SiteSettingsPanel');
            TAB.Log.Pass('Site information panel was successfully launched.');
        }));
    };
    SiteInformationPanel.prototype.AddTaskLaunchSiteInformationPanelDirectly = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Launching site information panel...');
        var siteInfoPanelLaunchFunction = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            siteInfoPanelLaunchFunction = TAB.Win.window['_spLaunchSiteSettings']; // tslint:disable-line:no-string-literal
            return Boolean(siteInfoPanelLaunchFunction);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            siteInfoPanelLaunchFunction();
        }), SiteInformationPanel.WaitForPanel());
        TAB.AddTask(TAB.MakeTask(function () {
            _this._rootElement = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-SiteSettingsPanel');
            TAB.Log.Pass('Site information panel was successfully launched.');
        }));
    };
    SiteInformationPanel.prototype.WaitForSiteLogo = function () {
        return TAB.WaitForElementToExist(this._rootElement, TAB.searchBy.customQuery, '[data-automationid="SiteSettingsPanelSiteLogo"]');
    };
    SiteInformationPanel.prototype.WaitForSiteInfo = function () {
        return TAB.WaitForElementToExist(this._rootElement, TAB.searchBy.customQuery, '[data-automationid="SiteSettingsPanelSiteInfo"]');
    };
    SiteInformationPanel.prototype.GetSiteInfoPanelLabels = function () {
        return TAB.GetElements(this._rootElement, TAB.searchBy.hasClassName, 'ms-Label');
    };
    SiteInformationPanel.prototype.GetNameTextField = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._rootElement, 'SiteSettingsPanelNameText');
    };
    SiteInformationPanel.prototype.GetDescriptionTextField = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._rootElement, 'SiteSettingsPanelDescriptionText');
    };
    SiteInformationPanel.prototype.GetDropdownItems = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-item');
    };
    SiteInformationPanel.prototype.OpenPrivacySettingDropdown = function () {
        TAB.AddTaskClickElement(this._rootElement, TAB.searchBy.hasClassName, 'ms-SiteSettingsPanel-PrivacyDropdown', TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-item'));
    };
    SiteInformationPanel.prototype.OpenClassificationDropdown = function () {
        TAB.AddTaskClickElement(this._rootElement, TAB.searchBy.hasClassName, 'ms-SiteSettingsPanel-ClassificationDropdown', TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-item'));
    };
    // Dismiss dropdown menu by click header text.
    SiteInformationPanel.prototype.DismissDropdownMenu = function () {
        TAB.AddTaskClickElement(this._rootElement, TAB.searchBy.hasClassName, 'ms-Panel-headerText', TAB.MakeWaiter(function () {
            var dropdown = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-item');
            return Boolean(dropdown.length === 0);
        }));
    };
    SiteInformationPanel.prototype.AddTaskDismissSiteInformationPanel = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Dismiss site information panel...');
        TAB.AddTask(TAB.MakeTask(function () {
            // We just click this close button, but removed the waiter, because Phamton JS has issue with the waiter.
            TAB.AddTaskClickElement(_this._rootElement, TAB.searchBy.hasClassName, 'ms-Panel-closeButton');
            TAB.Log.Pass('Site information panel was dismissed.');
        }));
    };
    SiteInformationPanel.prototype.DoesElementExist = function (targetDataAutomationId, targetClassName) {
        if (!targetDataAutomationId && !targetClassName) {
            return false;
        }
        var targetElement = targetDataAutomationId
            ? _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementsByDataAutomationId(this._rootElement, targetDataAutomationId)
            : TAB.GetElements(this._rootElement, TAB.searchBy.hasClassName, targetClassName);
        return Boolean(targetElement && targetElement.length > 0);
    };
    SiteInformationPanel.prototype.GetElementTextContent = function (targetDataAutomationId, targetClassName) {
        if (!targetDataAutomationId && !targetClassName) {
            return undefined;
        }
        var targetElement = targetDataAutomationId
            ? _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(this._rootElement, targetDataAutomationId)
            : TAB.GetElement(this._rootElement, TAB.searchBy.hasClassName, targetClassName);
        return TAB.GetTextContent(targetElement);
    };
    return SiteInformationPanel;
}());



/***/ }),

/***/ "Y4ae":
/*!****************************************************!*\
  !*** ./lib/SPTaskLib/MemoryTest/MemoryTestUtil.js ***!
  \****************************************************/
/*! exports provided: MemoryTestWebPartType, MemoryTestUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryTestWebPartType", function() { return MemoryTestWebPartType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MemoryTestUtils", function() { return MemoryTestUtils; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasContentTemplate */ "8vep");


/**
 * @public
 */
var MemoryTestWebPartType;
(function (MemoryTestWebPartType) {
    MemoryTestWebPartType["Blank"] = "Blank";
    MemoryTestWebPartType["Image"] = "Image";
})(MemoryTestWebPartType || (MemoryTestWebPartType = {}));
var MEMORY_TEST_PAGE_SUFFIX = '-32511d91c213';
/**
 * @public
 */
var MemoryTestUtils = /** @class */ (function () {
    function MemoryTestUtils() {
    }
    MemoryTestUtils.AddTaskEnsureWebPartPageWithLink = function (siteUrl, webPartType, linkToWebPartType) {
        TAB.Log.AddTaskComment("Ensure " + webPartType + " page existing.");
        var createPageUrl = siteUrl + "/_api/sitepages/pages";
        var canvasContent = MemoryTestUtils._getCanvasContentTemplate(webPartType, linkToWebPartType);
        var pageContent = {
            PageLayoutType: 'Article',
            Title: MemoryTestUtils._getWebPartPageTitle(webPartType),
            Name: MemoryTestUtils._getWebPartPageTitle(webPartType) + ".aspx",
            CanvasContent1: JSON.stringify(canvasContent)
        };
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendPostRequest(siteUrl, createPageUrl, JSON.stringify(pageContent), result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success && result.retVal) {
                TAB.Log.AddTaskComment("Web part Page " + webPartType + " created successfully.");
            }
            else {
                TAB.Log.AddTaskComment("Web part Page " + webPartType + " already exists. If you want to create a new one, delete it first.");
            }
        }));
    };
    MemoryTestUtils.AddTaskClickLinkToLoadPage = function (linkToWebPartType) {
        var linkToPageTitle = MemoryTestUtils._getWebPartPageTitle(linkToWebPartType);
        TAB.Log.AddTaskComment("click " + linkToPageTitle + " to load the page");
        TAB.AddTask(TAB.MakeTask(function () {
            var link = _CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__["CanvasContentTemplate"].getLinkElement();
            TAB.ClickElement(link);
        }), MemoryTestUtils._waitForWebPartPageToLoad(linkToWebPartType));
    };
    MemoryTestUtils.AddTaskLoadPage = function (siteUrl, webPartType) {
        var linkToPageTitle = MemoryTestUtils._getWebPartPageTitle(webPartType);
        TAB.Log.AddTaskComment("Load " + linkToPageTitle + " Page");
        TAB.AddTask(TAB.LoadPage(siteUrl + ("/sitepages/" + linkToPageTitle + ".aspx")), MemoryTestUtils._waitForWebPartPageToLoad(webPartType));
    };
    MemoryTestUtils.AddTaskWaitForSeconds = function (sec) {
        TAB.Log.AddTaskComment("wait for " + sec + " second(s).");
        var done = false;
        TAB.AddTask(TAB.MakeTask(function () { return setTimeout(function () { return (done = true); }, sec * 1000); }), TAB.MakeWaiter(function () { return done; }));
    };
    MemoryTestUtils._waitForWebPartPageToLoad = function (webPartType) {
        return TAB.MakeWaiter(function () {
            switch (webPartType) {
                case MemoryTestWebPartType.Blank:
                    return _CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__["CanvasContentTemplate"].isCanvasWithLinkLoaded();
                case MemoryTestWebPartType.Image:
                    return (_CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__["CanvasContentTemplate"].isCanvasWithImagesLoaded() && _CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__["CanvasContentTemplate"].isCanvasWithLinkLoaded());
                default:
                    throw new Error("Web part " + webPartType + " is not supported for memory test.");
            }
        });
    };
    MemoryTestUtils._getWebPartPageTitle = function (webPartType) {
        return "" + webPartType + MEMORY_TEST_PAGE_SUFFIX;
    };
    MemoryTestUtils._getCanvasContentTemplate = function (webPartType, linkToWebPartType) {
        switch (webPartType) {
            case MemoryTestWebPartType.Blank:
                return _CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__["CanvasContentTemplate"].GetLinkCanvasContent(MemoryTestUtils._getWebPartPageTitle(linkToWebPartType));
            case MemoryTestWebPartType.Image:
                return _CanvasContentTemplate__WEBPACK_IMPORTED_MODULE_1__["CanvasContentTemplate"].GetImagesCanvasContent(MemoryTestUtils._getWebPartPageTitle(linkToWebPartType));
            default:
                throw new Error("Webpart page " + webPartType + " is not supported for memory test.");
        }
    };
    return MemoryTestUtils;
}());



/***/ }),

/***/ "YfnZ":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Pages/PageSettingsPanel.js ***!
  \**************************************************/
/*! exports provided: PageSettingsPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageSettingsPanel", function() { return PageSettingsPanel; });
/* harmony import */ var _Canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _Controls_FilePicker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Controls/FilePicker */ "8uLm");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../SPKillSwitchUtil */ "y5Zv");
/* harmony import */ var _SPFlightUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../SPFlightUtil */ "i6xm");






var DESCRIPTION_PROPERTY_NAME = 'Description';
/**
 * @public
 */
var PageSettingsPanel = /** @class */ (function () {
    function PageSettingsPanel() {
    }
    PageSettingsPanel.AddTaskWaitForPageSettingsPanel = function (isPageScheduled) {
        if (isPageScheduled === void 0) { isPageScheduled = false; }
        TAB.AddTask(undefined, PageSettingsPanel.WaitForReactClientFormLoaded(isPageScheduled));
    };
    PageSettingsPanel.AddTaskEditProperty = function (propertyName, newValue) {
        if (propertyName === DESCRIPTION_PROPERTY_NAME) {
            this._addTaskEditPropertyCustomControls(propertyName, newValue);
        }
        else {
            this._addTaskEditPropertyReactClientForm(propertyName, newValue);
        }
    };
    PageSettingsPanel.AddTaskAssertIsDefaultDescription = function (value) {
        _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].AddRestTaskGetCanvasContentJson();
        TAB.AddTask(TAB.MakeTask(function () {
            var pageSettingsSlice = PageSettingsPanel._getPageSettingsSliceFromCanvasContent();
            if (pageSettingsSlice.isDefaultDescription === value) {
                TAB.Log.AddTaskPass("Flag value correct - isDefaultDescription: " + value);
            }
            else {
                TAB.Log.AddTaskFail("Wrong value of flag isDefaultDescription.\nExpected " + value + ". Actual " + pageSettingsSlice.isDefaultDescription);
            }
        }));
    };
    PageSettingsPanel.AddTaskAssertIsDefaultThumbnail = function (value) {
        TAB.Log.AddTaskComment("Asserting that the value of isDefaultThumbnail is: " + value);
        _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].AddRestTaskGetCanvasContentJson();
        TAB.AddTask(TAB.MakeTask(function () {
            var pageSettingsSlice = PageSettingsPanel._getPageSettingsSliceFromCanvasContent();
            if (pageSettingsSlice.isDefaultThumbnail === value) {
                TAB.Log.Pass("Flag value correct - isDefaultThumbnail: " + value);
            }
            else {
                TAB.Log.Fail("Wrong value of flag isDefaultThumbnail.\nExpected: " + value + ". Actual: " + pageSettingsSlice.isDefaultThumbnail);
            }
        }));
    };
    PageSettingsPanel.AddTaskVerifyImageRenderedByImageInfo = function (imageInfo) {
        var _this = this;
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PageDetailsThumbnail']").Then(TAB.MakeTask(function () {
            var src = _this._renderedImageUrl;
            if (!src) {
                TAB.Log.Fail('src is empty!');
            }
            if (src.length > 5 && src.substr(0, 5).toLowerCase() === 'blob:') {
                TAB.Log.Warning('src is blob URL. Can not verify');
                return;
            }
            if (!imageInfo || !imageInfo.siteId || !imageInfo.webId || !imageInfo.uniqueId) {
                TAB.Log.Fail('imageInfo is invalid!');
            }
            if (PageSettingsPanel.doesSourceContainGuid(src, imageInfo.siteId) &&
                PageSettingsPanel.doesSourceContainGuid(src, imageInfo.webId) &&
                PageSettingsPanel.doesSourceContainGuid(src, imageInfo.uniqueId)) {
                TAB.Log.Pass('Thumbnail is rendering the specified image correctly');
            }
            else {
                TAB.Log.Fail("Thumbnail is rendering some other image. Expected item to have\nsite id: " + imageInfo.siteId + ", web id: " + imageInfo.webId + " unique id: " + imageInfo.uniqueId + "\nActual rendered image url is: " + src);
            }
        }));
    };
    PageSettingsPanel.AddTaskSetPublishStartDate = function () {
        TAB.Log.AddTaskComment('Start task set publish start date');
        TAB.AddTask(TAB.MakeTask(function () {
            try {
                var propertiesWrapper = PageSettingsPanel.GetPageSettingsPanelWithScheduling();
                TAB.Log.Comment('Click toggle scheduling on');
                var schedulingToggle = TAB.GetElements(propertiesWrapper[0], TAB.searchBy.hasClassName, 'ms-Toggle-background')[0];
                if (!JSON.parse(schedulingToggle.attributes['aria-checked'].value)) {
                    TAB.ClickElement(schedulingToggle);
                }
                if (!JSON.parse(schedulingToggle.attributes['aria-checked'].value)) {
                    TAB.Log.Fail('Failed to turn on scheduling toggle.');
                }
            }
            catch (e) {
                TAB.Log.Fail("Failed to turn on scheduling toggle. Exception: " + e);
            }
        }));
        this._addTaskEditSchedulingDateReactClientForm();
    };
    PageSettingsPanel.AddTaskUploadImageFromBingSearch = function (filePicker, listName, index) {
        var oldImage;
        var i = index ? index : 1;
        TAB.AddTask(TAB.MakeTask(function () {
            oldImage = PageSettingsPanel._originalImageUrl;
        }));
        PageSettingsPanel._addTaskOpenFilePickerToChangeThumbnail();
        filePicker.AddTaskSelectView(_Controls_FilePicker__WEBPACK_IMPORTED_MODULE_2__["FilePickerView"].Search);
        filePicker.AddTaskOpenFile(i); // Select image other than Image web part uploaded.
        TAB.Log.AddTaskComment("Wait until upload complete and thubmnail changed. Current URL");
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return PageSettingsPanel._originalImageUrl !== oldImage;
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (TAB[listName]) {
                TAB[listName].push(PageSettingsPanel._originalImageUrl);
            }
        }));
    };
    PageSettingsPanel.AddTaskClosePanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var closeButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="propertyPaneClose"]');
            TAB.ClickElement(closeButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageSettingsPanel']");
        }));
    };
    PageSettingsPanel.WaitForReactClientFormLoaded = function (isSchedulingEnabled) {
        var _this = this;
        if (isSchedulingEnabled === void 0) { isSchedulingEnabled = false; }
        return TAB.MakeWaiter(function () {
            try {
                if (isSchedulingEnabled) {
                    var pageSettingsProperties = PageSettingsPanel.GetPageSettingsPanelWithScheduling();
                    var hasMultiplePropertiesSections = pageSettingsProperties.length > 1;
                    if (hasMultiplePropertiesSections) {
                        for (var i = 0; i < pageSettingsProperties.length; i++) {
                            if (!_this._reactClientFormExists(pageSettingsProperties[i])) {
                                return false;
                            }
                        }
                        return true;
                    }
                    return false;
                }
                else {
                    var propertiesWrapper = PageSettingsPanel.GetPageSettingsPanelProperties();
                    return propertiesWrapper && _this._reactClientFormExists(propertiesWrapper);
                }
            }
            catch (_a) {
                return false;
            }
        });
    };
    PageSettingsPanel.getDescriptionValue = function () {
        var description = PageSettingsPanel.GetDescriptionField();
        var value = description.value;
        TAB.Log.AddTaskComment("Description value: " + value);
        return value;
    };
    PageSettingsPanel.GetPageSettingsPanelProperties = function () {
        try {
            var panel = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageSettingsPanel-properties']");
            return panel;
        }
        catch (e) {
            return undefined;
        }
    };
    PageSettingsPanel.GetPageSettingsPanelWithScheduling = function () {
        try {
            var panel = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageSettingsPanel-properties']");
            return panel;
        }
        catch (e) {
            return undefined;
        }
    };
    PageSettingsPanel.GetReactClientFormFields = function () {
        try {
            var fields = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ReactFieldEditor');
            return fields;
        }
        catch (e) {
            return undefined;
        }
    };
    PageSettingsPanel.GetDescriptionField = function () {
        TAB.Log.AddTaskComment('Looking for description field from PageSettingsPanel');
        var description = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'PageSettingsDescription');
        if (!description) {
            TAB.Log.AddTaskFail('Description field not present');
            throw new Error();
        }
        else {
            return description;
        }
    };
    PageSettingsPanel.PageSettingsPanelExists = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageSettingsPanel']");
    };
    PageSettingsPanel.doesSourceContainGuid = function (src, guid) {
        // Preview URL might be with or without dashes '-'.
        return src.indexOf(guid) !== -1 || src.indexOf(guid.replace(/-/g, '')) !== -1;
    };
    PageSettingsPanel._reactClientFormExists = function (section) {
        return (TAB.ElementExists(section, TAB.searchBy.className, 'ReactClientForm') ||
            TAB.ElementExists(section, TAB.searchBy.customQuery, "[data-automation-id=\"pageSettings-noFields\"]")); // No fields
    };
    PageSettingsPanel._addTaskEditSchedulingDateReactClientForm = function () {
        var schedulingSection;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Task edit scheduled field');
            schedulingSection = [].slice.call(PageSettingsPanel.GetReactClientFormFields())[0];
            var readableField = schedulingSection.querySelector('.ReactFieldEditor-placeHolder');
            TAB.Log.Comment('Click on field to switch it to edit mode');
            var clickEvent = TAB.Win.document.createEvent('HTMLEvents');
            clickEvent.initEvent('click', true, false);
            readableField.dispatchEvent(clickEvent);
        }), TAB.MakeWaiter(function () {
            var input = TAB.GetElements(PageSettingsPanel.GetPageSettingsPanelWithScheduling()[0], [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['input', 'ms-TextField-field']);
            return input && input.length > 0;
        }));
        if (PageSettingsPanel._isUsingModernDateTimePicker()) {
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Focus input box to pop up date time callout');
                var dateInput = TAB.GetElement(schedulingSection, [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['input', 'ms-TextField-field']);
                dateInput.focus();
                var focusEvent = TAB.Win.document.createEvent('HTMLEvents');
                focusEvent.initEvent('focus', true, false);
                dateInput.dispatchEvent(focusEvent);
            }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'sp-DateTimePicker-DateTimeCallout'));
        }
        TAB.AddTask(TAB.MakeTask(function () {
            if (PageSettingsPanel._isUsingModernDateTimePicker()) {
                var dateTimeCallout = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'sp-DateTimePicker-DateTimeCallout');
                TAB.Log.Comment('Update the date to today');
                var todayDayButton = TAB.GetElement(dateTimeCallout, [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['button', 'ms-DatePicker-day--today']);
                TAB.ClickElement(todayDayButton);
                TAB.Log.Comment('Update the time to 23:59 to ensure it is a future time');
                var timeInput = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(dateTimeCallout, 'sp-DateTimePicker-Native-Time');
                _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(timeInput, '23:59');
                TAB.Log.Comment('Click the accept button');
                var acceptButton = TAB.GetElement(dateTimeCallout, TAB.searchBy.id, 'acceptButtonInCommonEditorCallout');
                TAB.ClickElement(acceptButton);
            }
            else {
                var tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                var date = tomorrow.toLocaleDateString();
                TAB.Log.Comment("Update the value to " + date);
                var editableField = TAB.GetElement(PageSettingsPanel.GetPageSettingsPanelWithScheduling()[0], [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['input', 'ms-TextField-field']);
                editableField.value = date;
                _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(editableField, date);
                TAB.FireKeyboardEvent(editableField, 'keydown', 13 /*Enter*/);
                schedulingSection.blur();
            }
        }), TAB.MakeWaiter(function () {
            // Wait for the message that says the property is saved
            var schedulingClientFormSection = [].slice.call(PageSettingsPanel.GetReactClientFormFields())[0];
            var fieldState = schedulingClientFormSection.querySelector('.ReactFieldEditor-state');
            var stateMessage = fieldState.querySelector('.ReactFieldEditor-stateMessageContainer');
            return TAB.ElementExists(stateMessage, TAB.searchBy.customQuery, "[data-icon-name='CheckMark']");
        }));
    };
    PageSettingsPanel._addTaskEditPropertyReactClientForm = function (propertyName, newValue) {
        var textFieldToEdit;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Task edit property " + propertyName + " to value " + newValue);
            var properties = [].slice.call(PageSettingsPanel.GetReactClientFormFields());
            textFieldToEdit = properties.filter(function (element) { return element.textContent.indexOf(propertyName) > -1; })[0];
            var readableField = textFieldToEdit.querySelector('.ReactFieldEditor-placeHolder');
            TAB.Log.Comment('Click on field to switch it to edit mode');
            var clickEvent = TAB.Win.document.createEvent('HTMLEvents');
            clickEvent.initEvent('click', true, false);
            readableField.dispatchEvent(clickEvent);
        }), TAB.MakeWaiter(function () {
            var input = TAB.GetElements(PageSettingsPanel.GetPageSettingsPanelProperties(), [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['input', 'ms-TextField-field']);
            return input && input.length > 0;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Update the value');
            var editableField = TAB.GetElement(PageSettingsPanel.GetPageSettingsPanelProperties(), [TAB.searchBy.tag, TAB.searchBy.hasClassName], ['input', 'ms-TextField-field']);
            editableField.value = newValue;
            _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(editableField, newValue);
            TAB.FireKeyboardEvent(editableField, 'keydown', 13 /*Enter*/);
            textFieldToEdit.blur();
        }), TAB.MakeWaiter(function () {
            // Wait for the message that says the property is saved
            var properties = [].slice.call(PageSettingsPanel.GetReactClientFormFields());
            var textFieldEdit = properties.filter(function (element) { return element.textContent.indexOf(propertyName) > -1; })[0];
            var fieldState = textFieldEdit.querySelector('.ReactFieldEditor-state');
            var stateMessage = fieldState.querySelector('.ReactFieldEditor-stateMessageContainer');
            return TAB.ElementExists(stateMessage, TAB.searchBy.customQuery, "[data-icon-name='CheckMark']");
        }));
    };
    PageSettingsPanel._addTaskEditPropertyCustomControls = function (propertyName, newValue) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (propertyName === DESCRIPTION_PROPERTY_NAME) {
                var description = PageSettingsPanel.GetDescriptionField();
                var focusEv = TAB.Win.document.createEvent('HTMLEvents');
                focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
                description.dispatchEvent(focusEv);
                description.value = newValue;
                var ev = TAB.Win.document.createEvent('HTMLEvents');
                ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
                description.dispatchEvent(ev);
                // press Enter
                TAB.FireKeyboardEvent(description, 'keydown', 13);
                var blurEv = TAB.Win.document.createEvent('HTMLEvents');
                blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
                description.dispatchEvent(blurEv);
            }
            else {
                TAB.Log.Fail('Unsupported property name requested to change');
            }
        }), TAB.MakeWaiter(function () {
            return PageSettingsPanel.getDescriptionValue() === newValue;
        }));
    };
    PageSettingsPanel._addTaskOpenFilePickerToChangeThumbnail = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var changeThumbnailButton = PageSettingsPanel._getChangeThumbnailButton();
            TAB.Log.Comment('Click change thumbnail button to trigger file picker');
            changeThumbnailButton.click();
        }), TAB.MakeWaiter(function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(TAB.Win, _Controls_FilePicker__WEBPACK_IMPORTED_MODULE_2__["FILE_PICKER_AUTOMATION_ID"]);
            }
            catch (error) {
                return false;
            }
        }));
    };
    PageSettingsPanel._getPageSettingsSliceFromCanvasContent = function () {
        var metadata = _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].CanvasContentJson.filter(function (canvasControl) { return canvasControl.controlType === 0; })[0];
        if (!metadata || !metadata.pageSettingsSlice) {
            TAB.Log.AddTaskFail('Metadata control is missing from canvas content, make sure flight MakeContentShine is enabled');
        }
        else {
            return metadata.pageSettingsSlice;
        }
    };
    PageSettingsPanel._getChangeThumbnailButton = function () {
        TAB.Log.AddTaskComment('Looking for change thumbnail button from PageSettingsPanel');
        var button = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='changeThumbnailButton']");
        if (!button) {
            TAB.Log.AddTaskFail('Change thumbnail button not present');
            throw new Error();
        }
        else {
            return button;
        }
    };
    PageSettingsPanel._getThumbnailElement = function () {
        TAB.Log.Comment('Looking for thumbnail field from PageSettingsPanel');
        var image = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PageDetailsThumbnail']");
        if (!image) {
            TAB.Log.Fail('Thumbnail field not present');
            throw new Error();
        }
        else {
            return image;
        }
    };
    Object.defineProperty(PageSettingsPanel, "_originalImageUrl", {
        get: function () {
            return PageSettingsPanel._getThumbnailElement().getAttribute('data-sp-originalimgsrc');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageSettingsPanel, "_renderedImageUrl", {
        get: function () {
            return PageSettingsPanel._getThumbnailElement().querySelector('img').getAttribute('src');
        },
        enumerable: true,
        configurable: true
    });
    PageSettingsPanel._isUsingModernDateTimePicker = function () {
        return (!_SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_4__["SPKillSwitchUtil"].isActivated('6fadd1a1-e66a-4110-ac3d-c3dfc22a9965') &&
            _SPFlightUtil__WEBPACK_IMPORTED_MODULE_5__["SPFlightUtil"].isEnabled(/* FabricDatePickerInClientForm */ 1857));
    };
    return PageSettingsPanel;
}());



/***/ }),

/***/ "bl+Y":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/Pages/CanvasToolbox.js ***!
  \**********************************************/
/*! exports provided: CanvasToolbox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CanvasToolbox", function() { return CanvasToolbox; });
/* harmony import */ var _Canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Canvas */ "mmJW");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");



/**
 * @public
 */
var CanvasToolbox = /** @class */ (function () {
    function CanvasToolbox() {
    }
    Object.defineProperty(CanvasToolbox, "canvasLargeToolboxBodyAutomationId", {
        get: function () {
            return 'spPageCanvasLargeToolboxBody';
        },
        enumerable: true,
        configurable: true
    });
    CanvasToolbox.AddTaskOpenToolbox = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].AddTaskOpenToolbox(_Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].rootCanvasElement, _Canvas__WEBPACK_IMPORTED_MODULE_0__["HintType"].WebPartHint);
        }));
    };
    CanvasToolbox.AddTaskExpandToolbox = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(CanvasToolbox._toolboxFarButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-item-size='large']"));
    };
    CanvasToolbox.AddTaskAddControlFromLargeToolbox = function (webpart) {
        var numberOfControlsBefore = NaN;
        _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].AddTaskAddExperimentOverride();
        TAB.AddTask(TAB.MakeTask(function () {
            numberOfControlsBefore = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(_Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].rootCanvasElement, _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].CanvasControlId).length;
            TAB.Log.AddTaskComment('Add webpart from large toolbox');
            var toolboxItem = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(CanvasToolbox._pageCanvasLargeToolboxBody, webpart.entryId);
            TAB.ClickElement(toolboxItem);
        }), TAB.MakeWaiter(function () {
            var numberOfControls = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(_Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].rootCanvasElement, _Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].CanvasControlId).length;
            return numberOfControls === numberOfControlsBefore + 1;
        }));
    };
    CanvasToolbox.AddTaskSearchByKeyword = function (keyword, assert) {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            TAB.Log.Comment('Wait for search box to show up');
            try {
                return !!CanvasToolbox._searchBoxInput;
            }
            catch (err) {
                return false;
            }
        }));
        TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Search by keyword in toolbox. keyword=" + keyword);
            _ReactUtil__WEBPACK_IMPORTED_MODULE_2__["ReactUtil"].TriggerOnChange(CanvasToolbox._searchBoxInput, keyword);
        }).WaitFor(TAB.MakeWaiter(function () { return assert(CanvasToolbox._toolboxItemCount); }));
    };
    // Web part title and description are localized so we should use the automation ID to get
    // the web part element and then get the web part title for searching.
    CanvasToolbox.AddTaskSearchWebPart = function (webpart, assert) {
        TAB.Log.AddTaskComment('Reset user input in search box');
        TAB.MakeTask(function () {
            _ReactUtil__WEBPACK_IMPORTED_MODULE_2__["ReactUtil"].TriggerOnChange(CanvasToolbox._searchBoxInput, '');
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + webpart.entryId + "\"]"));
        TAB.Log.AddTaskComment('Search webpart in toolbox');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the web part title and search it');
            // There might be multiple same web parts in the large toolbox view so we use GetElements.
            var webpartEntry = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + webpart.entryId + "\"]")[0];
            var webpartTitle = TAB.GetElement(webpartEntry, TAB.searchBy.customQuery, "[data-automation-id='less-text']");
            var keyword = TAB.GetTextContent(webpartTitle);
            if (keyword && keyword[keyword.length - 1] === '') {
                // We remove the ellipsis added by LessText.
                keyword = keyword.slice(0, keyword.length - 1);
            }
            CanvasToolbox.AddTaskSearchByKeyword(keyword, assert);
        }));
    };
    CanvasToolbox.AddTaskAssertWebPartExists = function (webpart) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (!TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + webpart.entryId + "\"]")) {
                throw new Error('Assert web part exits fail');
            }
        }));
    };
    Object.defineProperty(CanvasToolbox, "_toolboxItemCount", {
        get: function () {
            return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-item-size]').length;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CanvasToolbox, "_toolboxFarButton", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(_Canvas__WEBPACK_IMPORTED_MODULE_0__["Canvas"].toolboxElement, 'toolbox-farButton');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CanvasToolbox, "_searchBoxInput", {
        get: function () {
            return TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-SearchBox-field');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CanvasToolbox, "_pageCanvasLargeToolboxBody", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(TAB.Win, CanvasToolbox.canvasLargeToolboxBodyAutomationId)[0];
            }
            catch (e) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    return CanvasToolbox;
}());



/***/ }),

/***/ "bqQT":
/*!*************************************************!*\
  !*** ./lib/SPTaskLib/Pages/TopicAnnotations.js ***!
  \*************************************************/
/*! exports provided: TopicAnnotations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopicAnnotations", function() { return TopicAnnotations; });
/**
 * @public
 */
var TopicAnnotations = /** @class */ (function () {
    function TopicAnnotations() {
    }
    TopicAnnotations.AddTaskWaitForAnnotationToExist = function (query) {
        TAB.AddTask(undefined, TopicAnnotations.WaitForAnnotationToExist(query));
    };
    TopicAnnotations.WaitForAnnotationToExist = function (query) {
        TAB.Log.AddTaskComment('Waiting for annotation to Exist');
        return TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, query);
        });
    };
    TopicAnnotations.AddTaskHoverAnnotation = function (annotationQuery, topicCardQuery) {
        TAB.Log.AddTaskComment('Hover over annotation and Wait for Topic Card');
        TAB.AddTask(TAB.MakeTask(function () {
            var annotation = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, annotationQuery);
            var eventObj = TAB.Win.document.createEvent('Events');
            eventObj.initEvent('mouseenter', true, false);
            annotation.dispatchEvent(eventObj);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, topicCardQuery);
        }));
    };
    return TopicAnnotations;
}());



/***/ }),

/***/ "cVxD":
/*!*********************************************************!*\
  !*** ./lib/SPTaskLib/Pages/PublishingPageMonitoring.js ***!
  \*********************************************************/
/*! exports provided: PublishingPageMonitoring */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PublishingPageMonitoring", function() { return PublishingPageMonitoring; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

var navNodeText = 'TestPage';
/**
 * @public
 */
var PublishingPageMonitoring = /** @class */ (function () {
    function PublishingPageMonitoring() {
    }
    PublishingPageMonitoring.MonitorClassicPublishingPage = function (options) {
        var _this = this;
        var result = {};
        var siteUrl = options.siteUrl, targetUrl = options.targetUrl, managedNavigation = options.managedNavigation;
        try {
            _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendGetRequestClassicPage(siteUrl, targetUrl, result);
        }
        catch (e) {
            TAB.Log.Comment("Get Request Failed: " + e);
        }
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success) {
                TAB.Log.AddTaskComment("Publishing page returns 200. Correlation id is " + result.correlationId);
                if (_this.CheckNavNodes(result, managedNavigation)) {
                    TAB.Log.AddTaskComment("Publishing Page contains the correct text \"" + navNodeText + "\" in the top nav and quick launch");
                }
                else {
                    TAB.Log.AddTaskComment('Publishing Page does not contain the correct nav nodes');
                }
            }
            else {
                TAB.Log.AddTaskComment('Publishing Page does not return 200');
            }
        }));
    };
    PublishingPageMonitoring.CheckNavNodes = function (result, managedNavigation) {
        var topNavId = 'DeltaTopNavigation';
        var quickLaunchId = 'QuickLaunchNavigation';
        var navNodeTextClassname = 'menu-item-text';
        var topNav = TAB.GetElement(result.retVal, TAB.searchBy.id, topNavId);
        var quickLaunch = TAB.GetElement(result.retVal, TAB.searchBy.partialId, quickLaunchId);
        var topNavElems = TAB.GetElements(topNav, TAB.searchBy.partialClassName, navNodeTextClassname);
        var quickLaunchElems = TAB.GetElements(quickLaunch, TAB.searchBy.partialClassName, navNodeTextClassname);
        if (!topNavElems || topNavElems.length < 1 || !quickLaunchElems || quickLaunchElems.length < 1) {
            return false;
        }
        // Managed Nav contains the first page as the first top nav and quicklaunch node
        if (managedNavigation &&
            topNavElems[0].textContent.search(navNodeText) > -1 &&
            quickLaunchElems[0].textContent.search(navNodeText) > -1) {
            return true;
        }
        // Structured Nav contains the site name as the first top nav node and the first page as the second node
        if (!managedNavigation &&
            topNavElems[1].textContent.search(navNodeText) > -1 &&
            quickLaunchElems[0].textContent.search(navNodeText) > -1) {
            return true;
        }
        return false;
    };
    return PublishingPageMonitoring;
}());



/***/ }),

/***/ "dAVj":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/Controls/Upload.js ***!
  \******************************************/
/*! exports provided: upload, dataURItoFile, setFileInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "upload", function() { return upload; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dataURItoFile", function() { return dataURItoFile; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setFileInput", function() { return setFileInput; });
/**
 * @public
 */
function upload(inputElement, fileInputs) {
    var files = [];
    var size = 0;
    for (var _i = 0, fileInputs_1 = fileInputs; _i < fileInputs_1.length; _i++) {
        var fileInput = fileInputs_1[_i];
        var file = new Blob(['Hello World!'], {
            type: 'text/plain'
        });
        file.name = fileInput.name;
        files.push(file);
        size += file.size;
        TAB.Log.Comment("Attached file '" + fileInput.name + "' to input element.");
    }
    inputElement.test_files = files;
    TAB.FireChangeEvent(inputElement);
    TAB.Log.Comment('Fired change event to start uploading.');
    return {
        names: files.map(function (file) { return file.name; }),
        size: size
    };
}
/**
 * @public
 */
function dataURItoFile(dataURI, fileName) {
    var dataURIComponents = dataURI.split(',');
    var byteString = atob(dataURIComponents[1]);
    var mimeString = dataURIComponents[0].split(':')[1].split(';')[0];
    var ab = new ArrayBuffer(byteString.length);
    var ia = new Uint8Array(ab);
    for (var i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }
    return new File([ab], fileName, { type: mimeString });
}
/**
 * @public
 */
function setFileInput(inputElement, fileInputs) {
    inputElement.test_files = fileInputs;
    TAB.FireChangeEvent(inputElement);
}


/***/ }),

/***/ "dp3n":
/*!*******************************************************!*\
  !*** ./lib/SPTaskLib/Utilities/ReactTriggerChange.js ***!
  \*******************************************************/
/*! exports provided: ReactTriggerChange, ReactSetValueChange */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReactTriggerChange", function() { return ReactTriggerChange; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReactSetValueChange", function() { return ReactSetValueChange; });
// This is mostly a drop of https://github.com/vitalyq/react-trigger-change at 1.0.2
// (because importing dependencies properly within TAB is difficult)
// This has been used in odsp-next for React trigger change events. Importing this
// to sp-client for the same purpose.
/* tslint:disable */
/**
 * Trigger React's synthetic change events on input, textarea and select elements.
 *
 * WARNING!!! As of writing, this has only been tested in odsp-next for text fields in Chrome.
 * To use it with other field types or browsers, additional work may be needed.
 * (example: the section guarded by TAB.BrowserIs.ie was originally run in all browsers)
 *
 * @public
 */
function ReactTriggerChange(node) {
    var supportedInputTypes = {
        color: true,
        date: true,
        datetime: true,
        'datetime-local': true,
        email: true,
        month: true,
        number: true,
        password: true,
        range: true,
        search: true,
        tel: true,
        text: true,
        time: true,
        url: true,
        week: true
    };
    var nodeName = node.nodeName.toLowerCase();
    var type = node.type;
    var event;
    var descriptor;
    var initialValue;
    var initialChecked;
    var initialCheckedRadio;
    // Do not try to delete non-configurable properties.
    // Value and checked properties on DOM elements are non-configurable in PhantomJS.
    function deletePropertySafe(elem, prop) {
        var desc = Object.getOwnPropertyDescriptor(elem, prop);
        if (desc && desc.configurable) {
            delete elem[prop];
        }
    }
    // In IE10 propertychange is not dispatched on range input if invalid
    // value is set.
    function changeRangeValue(range) {
        // "any" because there doesn't seem to be a radio input type
        var initMin = range.min;
        var initMax = range.max;
        var initStep = range.step;
        var initVal = Number(range.value);
        range.min = initVal;
        range.max = initVal + 1;
        range.step = 1;
        range.value = initVal + 1;
        deletePropertySafe(range, 'value');
        range.min = initMin;
        range.max = initMax;
        range.step = initStep;
        range.value = initVal;
    }
    function getCheckedRadio(radio) {
        var name = radio.name;
        var radios;
        var i;
        if (name) {
            radios = TAB.Win.document.querySelectorAll('input[type="radio"][name="' + name + '"]');
            for (i = 0; i < radios.length; i += 1) {
                if (radios[i].checked) {
                    return radios[i] !== radio ? radios[i] : null;
                }
            }
        }
        return null;
    }
    function preventChecking(e) {
        e.preventDefault();
        if (!initialChecked) {
            e.target.checked = false;
        }
        if (initialCheckedRadio) {
            initialCheckedRadio.checked = true;
        }
    }
    if (nodeName === 'select' || (nodeName === 'input' && type === 'file')) {
        // IE9-IE11, non-IE
        // Dispatch change.
        event = TAB.Win.document.createEvent('HTMLEvents');
        event.initEvent('change', true, false);
        node.dispatchEvent(event);
    }
    else if ((nodeName === 'input' && supportedInputTypes[type]) || nodeName === 'textarea') {
        //
        // !!! NOTE !!!
        // react-trigger-change runs this next section in all browsers, but it seemed to break
        // text field updates in Chrome (hasn't been tested in IE as of writing)
        //
        if (TAB.browserIs.ie) {
            // React 0.14: IE9
            // React 15: IE9-IE11
            // React 16: IE9
            // Dispatch focus.
            // React 16
            // Cache artificial value property descriptor.
            // Property doesn't exist in React <16, descriptor is undefined.
            descriptor = Object.getOwnPropertyDescriptor(node, 'value');
            event = TAB.Win.document.createEvent('UIEvents');
            event.initEvent('focus', false, false);
            node.dispatchEvent(event);
            // React 0.14: IE9
            // React 15: IE9-IE11
            // React 16
            // In IE9-10 imperative change of node value triggers propertychange event.
            // Update inputValueTracking cached value.
            // Remove artificial value property.
            // Restore initial value to trigger event with it.
            if (type === 'range') {
                changeRangeValue(node);
            }
            else {
                initialValue = node.value;
                node.value = initialValue + '#';
                deletePropertySafe(node, 'value');
                node.value = initialValue;
            }
            // React 15: IE11
            // For unknown reason React 15 added listener for propertychange with addEventListener.
            // This doesn't work, propertychange events are deprecated in IE11,
            // but allows us to dispatch fake propertychange which is handled by IE11.
            event = TAB.Win.document.createEvent('HTMLEvents');
            event.initEvent('propertychange', false, false);
            event.propertyName = 'value';
            node.dispatchEvent(event);
        }
        // React 0.14: IE10-IE11, non-IE
        // React 15: non-IE
        // React 16: IE10-IE11, non-IE
        event = TAB.Win.document.createEvent('HTMLEvents');
        event.initEvent('input', true, false);
        node.dispatchEvent(event);
        // React 16
        // Restore artificial value property descriptor.
        if (descriptor) {
            Object.defineProperty(node, 'value', descriptor);
        }
    }
    else if (nodeName === 'input') {
        var input = node;
        if (type === 'checkbox') {
            // Invert inputValueTracking cached value.
            input.checked = !input.checked;
            // Dispatch click.
            // Click event inverts checked value.
            event = TAB.Win.document.createEvent('MouseEvents');
            event.initEvent('click', true, true);
            input.dispatchEvent(event);
        }
        else if (type === 'radio') {
            // Cache initial checked value.
            initialChecked = input.checked;
            // Find and cache initially checked radio in the group.
            initialCheckedRadio = getCheckedRadio(input);
            // React 16
            // Cache property descriptor.
            // Invert inputValueTracking cached value.
            // Remove artificial checked property.
            // Restore initial value, otherwise preventDefault will eventually revert the value.
            descriptor = Object.getOwnPropertyDescriptor(input, 'checked');
            input.checked = !initialChecked;
            deletePropertySafe(input, 'checked');
            input.checked = initialChecked;
            // Prevent toggling during event capturing phase.
            // Set checked value to false if initialChecked is false,
            // otherwise next listeners will see true.
            // Restore initially checked radio in the group.
            /* tslint:disable:ban-native-functions */
            input.addEventListener('click', preventChecking, true);
            /* tslint:enable:ban-native-functions */
            // Dispatch click.
            // Click event inverts checked value.
            event = TAB.Win.document.createEvent('MouseEvents');
            event.initEvent('click', true, true);
            input.dispatchEvent(event);
            // Remove listener to stop further change prevention.
            input.removeEventListener('click', preventChecking, true);
            // React 16
            // Restore artificial checked property descriptor.
            if (descriptor) {
                Object.defineProperty(input, 'checked', descriptor);
            }
        }
    }
}
/**
 * Change the value of a react element and trigger onChange()
 *
 * @remarks
 * React overrides the setting of input/textbox,
 * and thus the synthetic event trigger thats needed here to trigger onChange()
 * reference: https://github.com/facebook/react/issues/11488
 *
 * @param node - element that has a value change
 * @param inputValue - new value to set to the element
 *
 * @public
 */
function ReactSetValueChange(node, inputValue) {
    var event = new Event('input', { bubbles: true });
    var lastValue = node['lastValue'];
    node.value = inputValue;
    var tracker = node['_valueTracker'];
    if (tracker) {
        tracker.setValue(lastValue);
    }
    event.simulated = true;
    node.dispatchEvent(event);
}
/* tslint:enable */


/***/ }),

/***/ "e5Kj":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Controls/TitleRegion.js ***!
  \***********************************************/
/*! exports provided: TitleRegion */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TitleRegion", function() { return TitleRegion; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _FilePicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./FilePicker */ "8uLm");






/**
 * @public
 */
var TitleRegion = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(TitleRegion, _super);
    function TitleRegion() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].TitleRegion, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].TitleRegion.toString()) || this;
    }
    TitleRegion.GetTitleRegionWebPart = function () {
        TAB.AddTask(undefined, _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].WaitForTitleRegion());
        return new TitleRegion();
    };
    Object.defineProperty(TitleRegion.prototype, "_root", {
        get: function () {
            return _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].GetPageHeader();
        },
        enumerable: true,
        configurable: true
    });
    TitleRegion.prototype.AddTaskSwitchToLayout = function (layout) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Switch to title region " + layout + " layout");
            var layoutGroupRadio = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, "PropertyPaneChoiceGroup-" + layout)[0];
            if (layoutGroupRadio) {
                TAB.ClickElement(layoutGroupRadio);
            }
            else {
                TAB.Log.Fail("Fail to switch to " + layout + " layout in Title Region");
            }
        }), this.WaitForLayoutIsSelected(layout));
    };
    TitleRegion.prototype.AddTaskRemovePageAuthor = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Remove the page author");
            var authorByLine = TAB.GetElement(_this._root, TAB.searchBy.customQuery, "[data-automation-id='authorByLine']");
            var deleteAuthorButton = TAB.GetElement(authorByLine, TAB.searchBy.customQuery, "[data-automation-id='deleteAuthor']");
            deleteAuthorButton.click();
        }), TAB.MakeWaiter(function () {
            try {
                return _this._authorInput;
            }
            catch (_a) {
                return false;
            }
        }));
    };
    TitleRegion.prototype.AddTaskAddPageAuthor = function (user) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Input " + user + " as page author");
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(_this._authorInput, user);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-PeoplePicker-personaContent'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Press enter to select the person');
            TAB.FireKeyboardEvent(_this._authorInput, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].enter);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='authorByLine']") &&
            TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='personaDetails']"));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensure person is added successfully');
        }), TAB.MakeWaiter(function () {
            var authorByLine = TAB.GetElement(_this._root, TAB.searchBy.customQuery, "[data-automation-id='authorByLine']");
            var authorDetails = TAB.GetElement(authorByLine, TAB.searchBy.customQuery, "[data-automation-id='personaDetails']");
            return authorDetails.textContent.indexOf(user) !== -1;
        }));
    };
    TitleRegion.prototype.AddTaskResetImage = function () {
        var _this = this;
        // Click on the reset button and verify that there is a background image but no focal point
        TAB.AddTask(TAB.MakeTask(function () {
            var resetButton = _this._getTitleToolbarElementById('titleToolbarResetButton');
            if (resetButton) {
                TAB.ClickElement(resetButton);
            }
            else {
                TAB.Log.Fail('Failure in resetting image for Title Region');
            }
        }), TAB.MakeWaiter(function () {
            return !_this._toolbarFocalPointButton && _this._backgroundImage;
        }));
    };
    TitleRegion.prototype.AddTaskOpenFilePicker = function () {
        var _this = this;
        var filePicker = new _FilePicker__WEBPACK_IMPORTED_MODULE_5__["FilePicker"]();
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this._toolbarEditButton) {
                TAB.ClickElement(_this._toolbarEditButton);
                TAB.Log.Comment('Opened File Picker for Title Region');
            }
        }), _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'sp-filepicker'));
        TAB.AddTask(TAB.MakeTask(function () {
            filePicker.SetRoot(_this._filePicker);
        }), filePicker.WaitForViewLoad(_FilePicker__WEBPACK_IMPORTED_MODULE_5__["FilePickerView"].Recent));
        return filePicker;
    };
    TitleRegion.prototype.AddTaskMoveFocalPoint = function (offsetX, offsetY) {
        var _this = this;
        // Make sure uploading is finished
        TAB.AddTask(undefined, this.WaitForElementsByDataAutomationId('localFilePreview', 0));
        // FireMouseEvent is not allowed in Edge due to initMouseEvent deprecation
        // Fix required in TABCore VSO#405141
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskWarning('Fire mouse event is not permitted in Edge.');
            return;
        }
        TAB.Log.AddTaskComment("Move focal point to offset (" + offsetX + ", " + offsetY + ")");
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this._toolbarFocalPointButton) {
                TAB.ClickElement(_this._toolbarFocalPointButton);
                TAB.Log.Comment('Opened Focal Point Setting for Title Region');
            }
            else if (_this._focalFrame) {
                TAB.Log.Comment('Already in Focal Point Setting');
            }
            else {
                TAB.Log.Fail('Focal Point Setting Button Not Found');
            }
        }), this.WaitForElementsByDataAutomationId('focalFrameIsSetting'));
        TAB.Log.AddTaskComment('MouseMove to a new position');
        TAB.AddTask(TAB.MakeTask(function () {
            var pos = _this._focalCircle.getBoundingClientRect();
            var newX = pos.left + pos.width / 2;
            var newY = pos.top + pos.height / 2;
            TAB.FireMouseEvent(_this._focalFrame, TAB.mouseEvent.mouseDown, new TAB.MouseEventData(newX, newY));
        }), this.WaitForElementsByDataAutomationId('focalFrameIsDragging'));
        TAB.Log.AddTaskComment('MouseDown on the center of the focal point setting handle');
        TAB.AddTask(TAB.MakeTask(function () {
            var framePos = _this._focalFrame.getBoundingClientRect();
            var targetX = framePos.left + (framePos.width * offsetX) / 100;
            var targetY = framePos.top + (framePos.height * offsetY) / 100;
            TAB.Log.Comment("Mouse focal circle position to (" + targetX + ", " + targetY + ")");
            TAB.FireMouseEvent(_this._focalFrame, TAB.mouseEvent.mouseMove, new TAB.MouseEventData(targetX, targetY));
        }), TAB.MakeWaiter(function () {
            var framePos = _this._focalFrame.getBoundingClientRect();
            var targetX = framePos.left + (framePos.width * offsetX) / 100;
            var targetY = framePos.top + (framePos.height * offsetY) / 100;
            TAB.Log.Comment("Expect focal circle position to (" + targetX + ", " + targetY + ")");
            var circlePos = _this._focalCircle.getBoundingClientRect();
            var newX = circlePos.left + circlePos.width / 2;
            var newY = circlePos.top + circlePos.height / 2;
            TAB.Log.Comment("Actual focal circle position to (" + newX + ", " + newY + ")");
            var result = Math.abs(targetX - newX) < 5 && Math.abs(targetY - newY) < 5;
            return result;
        }));
        TAB.Log.AddTaskComment('MouseUp to finish focal point setting');
        TAB.AddTask(TAB.MakeTask(function () {
            var circlePos = _this._focalCircle.getBoundingClientRect();
            var targetX = circlePos.left + circlePos.width / 2;
            var targetY = circlePos.top + circlePos.height / 2;
            TAB.FireMouseEvent(_this._focalFrame, TAB.mouseEvent.mouseUp, new TAB.MouseEventData(targetX, targetY));
        }), this.WaitForElementsByDataAutomationId('focalFrameIsSetting', 0));
    };
    TitleRegion.prototype.AddTaskInputTopicHeader = function (inputTopicHeaderText) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var propertyPane = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer')[0];
            var topicHeaderFieldGroup = TAB.GetElements(propertyPane, TAB.searchBy.partialClassName, 'ms-TextField-fieldGroup')[0];
            var inputHeading = TAB.GetElement(topicHeaderFieldGroup, TAB.searchBy.tag, 'input');
            inputHeading.focus();
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(inputHeading, inputTopicHeaderText);
            _this._turnOnToggle(TAB.GetElements(propertyPane, TAB.searchBy.partialClassName, 'ms-Toggle-innerContainer')[0]);
        }), TAB.MakeWaiter(function () {
            return _this._topicHeaderText === inputTopicHeaderText.toUpperCase();
        }));
    };
    TitleRegion.prototype.AddTaskPublishDate = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var propertyPane = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer')[0];
            _this._turnOnToggle(TAB.GetElements(propertyPane, TAB.searchBy.partialClassName, 'ms-Toggle-innerContainer')[1]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(_this._root, TAB.searchBy.customQuery, "[data-automation-id='publishDate']");
        }));
    };
    TitleRegion.prototype.AddTaskCenterAlignment = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var centerAlignmentInput = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, 'PropertyPaneChoiceGroup-Center')[0];
            centerAlignmentInput.click();
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(_this._root, TAB.searchBy.customQuery, "[data-alignment='Center']");
        }));
    };
    TitleRegion.prototype.AddTaskOpenPropertyPane = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            if (_Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'PropertyPaneChoiceGroup-NoImage')) {
                // The property pane has open, do nothing.
                return;
            }
            var togglePropertyPaneButton = _this._getTitleToolbarElementById('titleToolbarTogglePropertyPaneButton');
            if (togglePropertyPaneButton) {
                TAB.ClickElement(togglePropertyPaneButton);
            }
            else {
                TAB.Log.Fail('Failure at toggling property pane for Title Region');
            }
        }), _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'PropertyPaneChoiceGroup-NoImage'));
    };
    TitleRegion.prototype.WaitForLayoutIsSelected = function (layout) {
        return TAB.MakeWaiter(function () {
            var layoutGroupRadio = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, "PropertyPaneChoiceGroup-" + layout)[0];
            return layoutGroupRadio.checked;
        });
    };
    TitleRegion.prototype._getTitleToolbarElementById = function (dataAutomationId) {
        try {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, dataAutomationId);
        }
        catch (e) {
            return undefined;
        }
    };
    Object.defineProperty(TitleRegion.prototype, "_focalFrame", {
        get: function () {
            return (_Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'focalFrameIsDragging') ||
                _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'focalFrameIsSetting') ||
                _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'titleRegionFocalFrame'));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_focalCircle", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'titleRegionFocalCircle');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_toolbarEditButton", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'titleToolbarEditButton');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_toolbarFocalPointButton", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'titleToolbarFocalPointButton');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_backgroundImage", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this._root, 'titleRegionBackgroundImage');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_filePicker", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win, 'sp-filepicker');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_topicHeaderText", {
        get: function () {
            var topicHeaderContainers = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='topicHeader']");
            if (!topicHeaderContainers || topicHeaderContainers.length <= 0) {
                return '';
            }
            var topicHeader = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(topicHeaderContainers[0], 'topicHeaderText');
            return topicHeader.innerText;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TitleRegion.prototype, "_authorInput", {
        get: function () {
            var authorByLine = TAB.GetElement(this._root, TAB.searchBy.customQuery, "[data-automation-id='authorByLine']");
            var authorInput = TAB.GetElement(authorByLine, TAB.searchBy.partialClassName, 'pickerInput');
            return authorInput;
        },
        enumerable: true,
        configurable: true
    });
    TitleRegion.prototype._turnOnToggle = function (toggleContainer) {
        var toggle = TAB.GetElements(toggleContainer, TAB.searchBy.tag, 'button')[0];
        if (toggle.attributes['aria-checked'].value === 'false') {
            toggle.click();
        }
    };
    return TitleRegion;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "fWKq":
/*!*****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/QuickChartWebPart.js ***!
  \*****************************************************/
/*! exports provided: QuickChartWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuickChartWebPart", function() { return QuickChartWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");



/**
 * @public
 */
var QuickChartWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(QuickChartWebPart, _super);
    function QuickChartWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].QuickChart, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].QuickChart.toString()) || this;
    }
    return QuickChartWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "fWaU":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Controls/HeroWebPart.js ***!
  \***********************************************/
/*! exports provided: HeroWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HeroWebPart", function() { return HeroWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Pages/PropertyPane */ "M/CL");





var ChoiceGroup;
(function (ChoiceGroup) {
    ChoiceGroup[ChoiceGroup["Tiles"] = 0] = "Tiles";
    ChoiceGroup[ChoiceGroup["Layers"] = 1] = "Layers";
    ChoiceGroup[ChoiceGroup["OnePiece"] = 2] = "OnePiece";
    ChoiceGroup[ChoiceGroup["TwoPieces"] = 3] = "TwoPieces";
    ChoiceGroup[ChoiceGroup["ThreePieces"] = 4] = "ThreePieces";
    ChoiceGroup[ChoiceGroup["FourPieces"] = 5] = "FourPieces";
    ChoiceGroup[ChoiceGroup["FivePieces"] = 6] = "FivePieces";
})(ChoiceGroup || (ChoiceGroup = {}));
/**
 * @public
 */
var HeroWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(HeroWebPart, _super);
    function HeroWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Hero, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Hero.toString()) || this;
    }
    HeroWebPart.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), this.waitForTilesLayout());
    };
    HeroWebPart.prototype.deleteWebPartToPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskDeleteZone(0);
        }));
    };
    HeroWebPart.prototype.waitForLayersLayout = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var elements = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-id='Layers']");
                return elements.length > 0;
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype.waitForTilesLayout = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var elements = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-id='Tiles']");
                return elements.length > 0;
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype.waitForOnePiecePlaceholderLayout = function () {
        this._displayLayout(ChoiceGroup.OnePiece, this._getPlaceholdWaiter(1));
    };
    HeroWebPart.prototype.waitForTwoPiecesPlaceholderLayout = function () {
        this._displayLayout(ChoiceGroup.TwoPieces, this._getPlaceholdWaiter(2));
    };
    HeroWebPart.prototype.waitForThreePiecesPlaceholderLayout = function () {
        this._displayLayout(ChoiceGroup.ThreePieces, this._getPlaceholdWaiter(3));
    };
    HeroWebPart.prototype.waitForFourPiecesPlaceholderLayout = function () {
        this._displayLayout(ChoiceGroup.FourPieces, this._getPlaceholdWaiter(4));
    };
    HeroWebPart.prototype.waitForFivePiecesPlaceholderLayout = function () {
        this._displayLayout(ChoiceGroup.FivePieces, this._getPlaceholdWaiter(5));
    };
    HeroWebPart.prototype.SwitchToTilesLayout = function () {
        this._displayLayout(ChoiceGroup.Tiles, this.waitForTilesLayout());
    };
    HeroWebPart.prototype.SwitchToLayersLayout = function () {
        this._displayLayout(ChoiceGroup.Layers, this.waitForLayersLayout());
    };
    HeroWebPart.prototype.switchToTilesLayout = function () {
        return this._selectLayoutOption(ChoiceGroup.Tiles);
    };
    HeroWebPart.prototype.switchToLayersLayout = function () {
        return this._selectLayoutOption(ChoiceGroup.Layers);
    };
    HeroWebPart.prototype.AddTaskAddHeroItemFromUploading = function (fileInput) {
        this._addTaskOpenFilePickerForAddItem(0);
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskCreateFilePicker();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Add compact item from uploading');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].FilePicker.AddTaskUploadItem(fileInput);
        }), this._waitForNewAddedItemToExist());
    };
    HeroWebPart.prototype.AddTaskUpdatePathFromUploading = function (url) {
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_4__["PropertyPane"].AddTaskClickChangeButton();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskCreateFilePicker();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Add compact item from uploading');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].FilePicker.AddTaskAddFromUrl(url);
        }), this._waitForPathUpdated(url));
    };
    HeroWebPart.prototype.AddTaskAddHeroItemFromUrl = function (url) {
        this._addTaskOpenFilePickerForAddItem(0);
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskCreateFilePicker();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Add hero item for ' + url);
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].FilePicker.AddTaskAddFromUrl(url);
        }), this._waitForNewAddedItemToExist());
    };
    HeroWebPart.prototype.AddTaskOpenItemEditPropertyPane = function (index, url) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click edit button');
            var inputs = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-id='edit-button']");
            TAB.ClickElement(inputs[index]);
        }), this._waitForPropertyPaneAndLinkExist(url));
    };
    HeroWebPart.prototype.AddTaskAddTitleInPropertyPane = function (value) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var titleTextField = TAB.GetElements(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-TextField-field')[1];
            var focusEv = TAB.Win.document.createEvent('HTMLEvents');
            focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
            titleTextField.dispatchEvent(focusEv);
            titleTextField.value = value;
            var ev = TAB.Win.document.createEvent('HTMLEvents');
            ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
            titleTextField.dispatchEvent(ev);
        }), TAB.MakeWaiter(function () {
            var titleTextField = TAB.GetElements(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-TextField-field')[1];
            var showTitleToggle = TAB.GetElements(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-Toggle-background')[0];
            return titleTextField.value === value && showTitleToggle.attributes['aria-checked'].value === 'true';
        }));
    };
    HeroWebPart.prototype.AddTaskValidateItemProperties = function (index, title, shouldHaveCallToAction) {
        if (!shouldHaveCallToAction) {
            TAB.AddTask(undefined, this._waitForItemTitleExist(index, title));
            TAB.Log.AddTaskComment('Toggle showtile the property pane');
            this.AddTaskCheckTitleToggle(0);
        }
        else {
            TAB.AddTask(undefined, TAB.AndWaiters(this._waitForItemTitleExist(index, title), this._waitForItemCallToActionExist(index)));
            TAB.Log.AddTaskComment('Toggle showtile the property pane');
            this.AddTaskCheckTitleToggle(0);
            TAB.Log.AddTaskComment('Toggle calltoaction the property pane');
            this.AddTaskCheckCallToActionToggle(0);
        }
    };
    HeroWebPart.prototype.AddTaskCheckTitleToggle = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var inputs = TAB.GetElements(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-Toggle-background');
            TAB.ClickElement(inputs[0]);
        }), this._waitForItemTitleDisappear(index));
    };
    HeroWebPart.prototype.AddTaskCheckCallToActionToggle = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            // this is options
            var option = TAB.GetElements(_this._propertyPane, TAB.searchBy.customQuery, '[data-automation-state="collapsed"]')[1];
            if (option !== undefined) {
                TAB.ClickElement(option);
            }
            var inputs = TAB.GetElements(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-Toggle-background');
            TAB.ClickElement(inputs[1]);
        }), this._waitForItemCallToActionDisappear(index));
    };
    HeroWebPart.prototype._displayLayout = function (id, waiter) {
        var _this = this;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var inputs = TAB.GetElements(_this._propertyPane, TAB.searchBy.customQuery, 'input[type="radio"]');
                if (inputs && inputs.length > 0) {
                    return true;
                }
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(this._selectLayoutOption(id), waiter);
    };
    HeroWebPart.prototype._addTaskOpenFilePickerForAddItem = function (index) {
        var _this = this;
        var elements;
        TAB.MakeWaiter(function () {
            elements = _this._getPlaceholdElements();
            return elements && elements.length;
        })
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Click select button');
            TAB.ClickElement(elements[index]);
        }))
            .WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']"));
    };
    HeroWebPart.prototype._getPlaceholdWaiter = function (elementCount) {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var elements = _this._getPlaceholdElements();
                return Boolean(elements.length === elementCount);
            }
            catch (error) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype._selectLayoutOption = function (optionId) {
        var _this = this;
        return TAB.MakeTask(function () {
            var inputs = TAB.GetElements(_this._propertyPane, TAB.searchBy.customQuery, 'input[type="radio"]');
            inputs[optionId].click();
        });
    };
    HeroWebPart.prototype._waitForNewAddedItemToExist = function () {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            var elements = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-id='HeroImage']");
            return Boolean(elements.length > 0);
        });
        return waiter;
    };
    HeroWebPart.prototype._waitForPathUpdated = function (url) {
        var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
        url = url.substr(rootSiteUrl.length);
        return this._waitForLinkExist(url);
    };
    HeroWebPart.prototype._waitForPropertyPaneAndLinkExist = function (url) {
        var _this = this;
        var waiter1 = TAB.MakeWaiter(function () {
            try {
                return Boolean(_this._propertyPane);
            }
            catch (e) {
                return false;
            }
        });
        return TAB.AndWaiters(waiter1, this._waitForLinkExist(url));
    };
    HeroWebPart.prototype._waitForLinkExist = function (url) {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var element = TAB.GetElement(_this._propertyPane, TAB.searchBy.partialClassName, 'ms-Link');
                return element.getAttribute('href').search(url) !== -1 && element.getAttribute('target') === '_blank';
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype._getPlaceholdElements = function () {
        var placeholdElements = TAB.GetElements(this.root, TAB.searchBy.customQuery, "[data-automation-id='placeholder-add']");
        if (placeholdElements) {
            return placeholdElements;
        }
        else {
            return undefined;
        }
    };
    HeroWebPart.prototype._getHeroElement = function (index) {
        var heroElements = TAB.GetElements(this.firstHeroTileRoot, TAB.searchBy.customQuery, "[data-automation-id='HeroPatternElement']");
        if (heroElements) {
            return heroElements[index];
        }
        else {
            return undefined;
        }
    };
    HeroWebPart.prototype._getHeroTitleElement = function (heroElement) {
        try {
            var element = TAB.GetElement(heroElement, TAB.searchBy.customQuery, "[data-automation-id='HeroTitle']");
            if (element) {
                return element;
            }
            else {
                return undefined;
            }
        }
        catch (e) {
            return undefined;
        }
    };
    HeroWebPart.prototype._getHeroCallToActionElement = function (heroElement) {
        try {
            var element = TAB.GetElement(heroElement, TAB.searchBy.customQuery, "[data-automation-id='HeroCallToAction']");
            if (element) {
                return element;
            }
            else {
                return undefined;
            }
        }
        catch (e) {
            return undefined;
        }
    };
    HeroWebPart.prototype._waitForItemTitleExist = function (index, title) {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var heroElement = _this._getHeroElement(index);
                if (heroElement) {
                    var element = _this._getHeroTitleElement(heroElement);
                    if (element) {
                        return element.innerText === title;
                    }
                    else {
                        return false;
                    }
                }
                else {
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype._waitForItemTitleDisappear = function (index) {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var heroElement = _this._getHeroElement(index);
                if (heroElement) {
                    var element = _this._getHeroTitleElement(heroElement);
                    return element === undefined;
                }
                else {
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype._waitForItemCallToActionExist = function (index) {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var heroElement = _this._getHeroElement(index);
                if (heroElement) {
                    return !!_this._getHeroCallToActionElement(heroElement);
                }
                else {
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    HeroWebPart.prototype._waitForItemCallToActionDisappear = function (index) {
        var _this = this;
        var waiter = TAB.MakeWaiter(function () {
            try {
                var heroElement = _this._getHeroElement(index);
                if (heroElement) {
                    var element = _this._getHeroCallToActionElement(heroElement);
                    return element === undefined;
                }
                else {
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        });
        return waiter;
    };
    Object.defineProperty(HeroWebPart.prototype, "_propertyPane", {
        get: function () {
            return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='showPane']");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HeroWebPart.prototype, "firstHeroTileRoot", {
        get: function () {
            var elements = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='Tiles']");
            if (elements) {
                return elements[0];
            }
            else {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    return HeroWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "hfq8":
/*!*****************************************!*\
  !*** ./lib/SPTaskLib/Controls/Field.js ***!
  \*****************************************/
/*! exports provided: FieldType, Field */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FieldType", function() { return FieldType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Field", function() { return Field; });
/**
 * @public
 */
var FieldType;
(function (FieldType) {
    FieldType[FieldType["Text"] = 0] = "Text";
    FieldType[FieldType["Number"] = 1] = "Number";
    FieldType[FieldType["DateTime"] = 2] = "DateTime";
    FieldType[FieldType["Choice"] = 3] = "Choice";
    FieldType[FieldType["User"] = 4] = "User";
    FieldType[FieldType["File"] = 5] = "File";
})(FieldType || (FieldType = {}));
/**
 * @public
 */
var Field = /** @class */ (function () {
    function Field(fieldName, fieldDescription, fieldType, isRequired, isHidden, dateTimeFormat, dateTimeDisplayFormat) {
        if (fieldType === void 0) { fieldType = FieldType.Text; }
        if (isRequired === void 0) { isRequired = false; }
        if (isHidden === void 0) { isHidden = false; }
        this._name = fieldName;
        this._description = fieldDescription;
        this._type = fieldType;
        this._isRequired = isRequired;
        this._isHidden = isHidden;
        this._dateTimeFormat = dateTimeFormat;
        this._dateTimeDisplayFormat = dateTimeDisplayFormat;
    }
    Object.defineProperty(Field.prototype, "Name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Field.prototype, "Description", {
        get: function () {
            return this._description;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Field.prototype, "Type", {
        get: function () {
            return this._type;
        },
        enumerable: true,
        configurable: true
    });
    Field.prototype.ConstructXml = function () {
        var typeName = FieldType[this._type];
        var schemaXml = '<Field Type="' +
            typeName +
            '" Name="' +
            this._name +
            '" DisplayName="' +
            this._name +
            '" Required="' +
            String(this._isRequired).toUpperCase() +
            '" Hidden="' +
            String(this._isHidden).toUpperCase() +
            '" Description="' +
            this._description +
            '"';
        // Additional parameters for different types
        if (this._type === FieldType.DateTime) {
            if (Boolean(this._dateTimeFormat)) {
                schemaXml = schemaXml + ' Format="' + this._dateTimeFormat + '"';
            }
            if (Boolean(this._dateTimeDisplayFormat)) {
                schemaXml = schemaXml + ' FriendlyDisplayFormat="' + this._dateTimeDisplayFormat + '"';
            }
        }
        // Closing Field tag.
        schemaXml = schemaXml + '/>';
        return schemaXml;
    };
    return Field;
}());



/***/ }),

/***/ "i6xm":
/*!***************************************!*\
  !*** ./lib/SPTaskLib/SPFlightUtil.js ***!
  \***************************************/
/*! exports provided: SPFlightUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SPFlightUtil", function() { return SPFlightUtil; });
/**
 * @public
 */
var SPFlightUtil = /** @class */ (function () {
    function SPFlightUtil() {
    }
    /**
     * This function will determine if a flight is enabled in the global list.
     * @param expFeatureId - The ExpFeature Id of the flight
     */
    SPFlightUtil.isEnabled = function (expFeatureId) {
        return TAB.Win.window[this.spModuleLoader]._bundledComponents[this.spCoreLibraryComponentId]._SPFlight.isEnabled(expFeatureId);
    };
    SPFlightUtil.spModuleLoader = 'spModuleLoader';
    SPFlightUtil.spCoreLibraryComponentId = '7263c7d0-1d6a-45ec-8d85-d4d1d234171b';
    return SPFlightUtil;
}());



/***/ }),

/***/ "iDSo":
/*!*****************************************!*\
  !*** ./lib/SPTaskLib/Controls/index.js ***!
  \*****************************************/
/*! exports provided: BaseCollectionWebPart, WebpartType, KeyCodes, FireKeyboardEvent, BaseWebpart, BingMapWebpart, Carousel, CommandBar, CommandBarItem, ConnectorWebPart, ContextMenu, CreateSitePanelForm, CreateSiteTemplateOption, GroupPrivacyOption, DesignPackageOption, CreateSitePanel, DocumentEmbedWebpart, DynamicDataConsumerWebPart, EmbedWebPart, EmbeddedVideoWebPart, EventPage, EventsWebPart, FieldType, Field, FieldsWebPart, FILE_PICKER_AUTOMATION_ID, FilePickerView, FilePicker, FormsWebPart, GroupCalendarWebPart, GroupMembershipPanel, HeroWebPart, ContentRollupLayout, HighlightedContentWebPart, Layout, ImageSourceType, ImageGalleryWebPart, ImageWebpart, LayoutOption, LinkPreviewWebpart, ListViewWebparWithItemsView, ListViewWebpart, ModernQuickEdit, NewsDigest, NewsFilter, NewsLink, NewsPinning, NewsWebPart, OfficeFeedWebPart, PeopleCardLayout, PeopleWebpart, OrgChartWebPart, PlannerWebpart, QuickChartWebPart, QuickLinksLayoutId, QuickLinksWebPart, RSSConnectorWebPart, RTELinkDialogOperation, RTEWebPart, ScopingControl, SendByEmailDialog, SendByYammerDialog, SiteActivityWebPart, SiteInformationPanel, SitePermissionPanel, SitesWebPart, SuiteNav, TeamsTabPicker, TeamsTabUrlConfigTest, TitleRegion, TwitterWebPart, upload, dataURItoFile, setFileInput, WeatherWebPart, WorldClockWebPart, YammerConversations, YammerHighlights, YouTubeEmbed */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseCollectionWebPart", function() { return _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_0__["BaseCollectionWebPart"]; });

/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebpartType", function() { return _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KeyCodes", function() { return _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FireKeyboardEvent", function() { return _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["FireKeyboardEvent"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseWebpart", function() { return _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]; });

/* harmony import */ var _BingMapWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BingMapWebpart */ "mutv");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BingMapWebpart", function() { return _BingMapWebpart__WEBPACK_IMPORTED_MODULE_2__["BingMapWebpart"]; });

/* harmony import */ var _Carousel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Carousel */ "iRE7");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Carousel", function() { return _Carousel__WEBPACK_IMPORTED_MODULE_3__["Carousel"]; });

/* harmony import */ var _CommandBar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CommandBar */ "CPNt");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommandBar", function() { return _CommandBar__WEBPACK_IMPORTED_MODULE_4__["CommandBar"]; });

/* harmony import */ var _CommandBarItem__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./CommandBarItem */ "SMhQ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommandBarItem", function() { return _CommandBarItem__WEBPACK_IMPORTED_MODULE_5__["CommandBarItem"]; });

/* harmony import */ var _ConnectorWebPart__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ConnectorWebPart */ "sQpn");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ConnectorWebPart", function() { return _ConnectorWebPart__WEBPACK_IMPORTED_MODULE_6__["ConnectorWebPart"]; });

/* harmony import */ var _ContextMenu__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ContextMenu */ "yis5");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ContextMenu", function() { return _ContextMenu__WEBPACK_IMPORTED_MODULE_7__["ContextMenu"]; });

/* harmony import */ var _CreateSitePanel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./CreateSitePanel */ "JmdK");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CreateSitePanelForm", function() { return _CreateSitePanel__WEBPACK_IMPORTED_MODULE_8__["CreateSitePanelForm"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CreateSiteTemplateOption", function() { return _CreateSitePanel__WEBPACK_IMPORTED_MODULE_8__["CreateSiteTemplateOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupPrivacyOption", function() { return _CreateSitePanel__WEBPACK_IMPORTED_MODULE_8__["GroupPrivacyOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DesignPackageOption", function() { return _CreateSitePanel__WEBPACK_IMPORTED_MODULE_8__["DesignPackageOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CreateSitePanel", function() { return _CreateSitePanel__WEBPACK_IMPORTED_MODULE_8__["CreateSitePanel"]; });

/* harmony import */ var _DocumentEmbedWebpart__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./DocumentEmbedWebpart */ "Lp+w");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentEmbedWebpart", function() { return _DocumentEmbedWebpart__WEBPACK_IMPORTED_MODULE_9__["DocumentEmbedWebpart"]; });

/* harmony import */ var _DynamicDataConsumerWebPart__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./DynamicDataConsumerWebPart */ "EfLR");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DynamicDataConsumerWebPart", function() { return _DynamicDataConsumerWebPart__WEBPACK_IMPORTED_MODULE_10__["DynamicDataConsumerWebPart"]; });

/* harmony import */ var _EmbedWebPart__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./EmbedWebPart */ "XK4g");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EmbedWebPart", function() { return _EmbedWebPart__WEBPACK_IMPORTED_MODULE_11__["EmbedWebPart"]; });

/* harmony import */ var _EmbeddedVideoWebPart__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./EmbeddedVideoWebPart */ "PGxG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EmbeddedVideoWebPart", function() { return _EmbeddedVideoWebPart__WEBPACK_IMPORTED_MODULE_12__["EmbeddedVideoWebPart"]; });

/* harmony import */ var _EventPage__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./EventPage */ "lIY2");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventPage", function() { return _EventPage__WEBPACK_IMPORTED_MODULE_13__["EventPage"]; });

/* harmony import */ var _EventsWebPart__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./EventsWebPart */ "KBAH");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventsWebPart", function() { return _EventsWebPart__WEBPACK_IMPORTED_MODULE_14__["EventsWebPart"]; });

/* harmony import */ var _Field__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./Field */ "hfq8");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FieldType", function() { return _Field__WEBPACK_IMPORTED_MODULE_15__["FieldType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Field", function() { return _Field__WEBPACK_IMPORTED_MODULE_15__["Field"]; });

/* harmony import */ var _FieldsWebPart__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./FieldsWebPart */ "1AE4");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FieldsWebPart", function() { return _FieldsWebPart__WEBPACK_IMPORTED_MODULE_16__["FieldsWebPart"]; });

/* harmony import */ var _FilePicker__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./FilePicker */ "8uLm");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FILE_PICKER_AUTOMATION_ID", function() { return _FilePicker__WEBPACK_IMPORTED_MODULE_17__["FILE_PICKER_AUTOMATION_ID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FilePickerView", function() { return _FilePicker__WEBPACK_IMPORTED_MODULE_17__["FilePickerView"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FilePicker", function() { return _FilePicker__WEBPACK_IMPORTED_MODULE_17__["FilePicker"]; });

/* harmony import */ var _FormsWebPart__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./FormsWebPart */ "S6R0");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FormsWebPart", function() { return _FormsWebPart__WEBPACK_IMPORTED_MODULE_18__["FormsWebPart"]; });

/* harmony import */ var _GroupCalendarWebPart__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./GroupCalendarWebPart */ "MKab");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupCalendarWebPart", function() { return _GroupCalendarWebPart__WEBPACK_IMPORTED_MODULE_19__["GroupCalendarWebPart"]; });

/* harmony import */ var _GroupMembershipPanel__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./GroupMembershipPanel */ "0FqO");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupMembershipPanel", function() { return _GroupMembershipPanel__WEBPACK_IMPORTED_MODULE_20__["GroupMembershipPanel"]; });

/* harmony import */ var _HeroWebPart__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./HeroWebPart */ "fWaU");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HeroWebPart", function() { return _HeroWebPart__WEBPACK_IMPORTED_MODULE_21__["HeroWebPart"]; });

/* harmony import */ var _HighlightedContentWebPart__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./HighlightedContentWebPart */ "+01b");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ContentRollupLayout", function() { return _HighlightedContentWebPart__WEBPACK_IMPORTED_MODULE_22__["ContentRollupLayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HighlightedContentWebPart", function() { return _HighlightedContentWebPart__WEBPACK_IMPORTED_MODULE_22__["HighlightedContentWebPart"]; });

/* harmony import */ var _ImageGalleryWebPart__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./ImageGalleryWebPart */ "pMbQ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return _ImageGalleryWebPart__WEBPACK_IMPORTED_MODULE_23__["Layout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageSourceType", function() { return _ImageGalleryWebPart__WEBPACK_IMPORTED_MODULE_23__["ImageSourceType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageGalleryWebPart", function() { return _ImageGalleryWebPart__WEBPACK_IMPORTED_MODULE_23__["ImageGalleryWebPart"]; });

/* harmony import */ var _ImageWebpart__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./ImageWebpart */ "7fnt");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageWebpart", function() { return _ImageWebpart__WEBPACK_IMPORTED_MODULE_24__["ImageWebpart"]; });

/* harmony import */ var _LayoutOption__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./LayoutOption */ "UcNL");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LayoutOption", function() { return _LayoutOption__WEBPACK_IMPORTED_MODULE_25__["LayoutOption"]; });

/* harmony import */ var _LinkPreviewWebpart__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./LinkPreviewWebpart */ "WS4A");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LinkPreviewWebpart", function() { return _LinkPreviewWebpart__WEBPACK_IMPORTED_MODULE_26__["LinkPreviewWebpart"]; });

/* harmony import */ var _ListViewWebparWithItemsView__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./ListViewWebparWithItemsView */ "R7tR");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ListViewWebparWithItemsView", function() { return _ListViewWebparWithItemsView__WEBPACK_IMPORTED_MODULE_27__["ListViewWebparWithItemsView"]; });

/* harmony import */ var _ListViewWebpart__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./ListViewWebpart */ "Aitv");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ListViewWebpart", function() { return _ListViewWebpart__WEBPACK_IMPORTED_MODULE_28__["ListViewWebpart"]; });

/* harmony import */ var _ModernQuickEdit__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./ModernQuickEdit */ "SKFh");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ModernQuickEdit", function() { return _ModernQuickEdit__WEBPACK_IMPORTED_MODULE_29__["ModernQuickEdit"]; });

/* harmony import */ var _NewsDigest__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./NewsDigest */ "2ZRy");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsDigest", function() { return _NewsDigest__WEBPACK_IMPORTED_MODULE_30__["NewsDigest"]; });

/* harmony import */ var _NewsFilter__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./NewsFilter */ "BW9v");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsFilter", function() { return _NewsFilter__WEBPACK_IMPORTED_MODULE_31__["NewsFilter"]; });

/* harmony import */ var _NewsLink__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./NewsLink */ "N935");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsLink", function() { return _NewsLink__WEBPACK_IMPORTED_MODULE_32__["NewsLink"]; });

/* harmony import */ var _NewsPinning__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./NewsPinning */ "zI0m");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsPinning", function() { return _NewsPinning__WEBPACK_IMPORTED_MODULE_33__["NewsPinning"]; });

/* harmony import */ var _NewsWebPart__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./NewsWebPart */ "TwX4");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsWebPart", function() { return _NewsWebPart__WEBPACK_IMPORTED_MODULE_34__["NewsWebPart"]; });

/* harmony import */ var _OfficeFeedWebPart__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./OfficeFeedWebPart */ "iHGF");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OfficeFeedWebPart", function() { return _OfficeFeedWebPart__WEBPACK_IMPORTED_MODULE_35__["OfficeFeedWebPart"]; });

/* harmony import */ var _PeopleWebpart__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./PeopleWebpart */ "ymC6");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PeopleCardLayout", function() { return _PeopleWebpart__WEBPACK_IMPORTED_MODULE_36__["PeopleCardLayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PeopleWebpart", function() { return _PeopleWebpart__WEBPACK_IMPORTED_MODULE_36__["PeopleWebpart"]; });

/* harmony import */ var _OrgChartWebPart__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./OrgChartWebPart */ "xTQM");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OrgChartWebPart", function() { return _OrgChartWebPart__WEBPACK_IMPORTED_MODULE_37__["OrgChartWebPart"]; });

/* harmony import */ var _PlannerWebpart__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./PlannerWebpart */ "m/ZX");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PlannerWebpart", function() { return _PlannerWebpart__WEBPACK_IMPORTED_MODULE_38__["PlannerWebpart"]; });

/* harmony import */ var _QuickChartWebPart__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./QuickChartWebPart */ "fWKq");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuickChartWebPart", function() { return _QuickChartWebPart__WEBPACK_IMPORTED_MODULE_39__["QuickChartWebPart"]; });

/* harmony import */ var _QuickLinksWebPart__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./QuickLinksWebPart */ "qC36");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuickLinksLayoutId", function() { return _QuickLinksWebPart__WEBPACK_IMPORTED_MODULE_40__["QuickLinksLayoutId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuickLinksWebPart", function() { return _QuickLinksWebPart__WEBPACK_IMPORTED_MODULE_40__["QuickLinksWebPart"]; });

/* harmony import */ var _RSSConnectorWebPart__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./RSSConnectorWebPart */ "Is2z");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RSSConnectorWebPart", function() { return _RSSConnectorWebPart__WEBPACK_IMPORTED_MODULE_41__["RSSConnectorWebPart"]; });

/* harmony import */ var _RTEWebPart__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./RTEWebPart */ "mXly");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RTELinkDialogOperation", function() { return _RTEWebPart__WEBPACK_IMPORTED_MODULE_42__["RTELinkDialogOperation"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RTEWebPart", function() { return _RTEWebPart__WEBPACK_IMPORTED_MODULE_42__["RTEWebPart"]; });

/* harmony import */ var _ScopingControl__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./ScopingControl */ "47KH");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScopingControl", function() { return _ScopingControl__WEBPACK_IMPORTED_MODULE_43__["ScopingControl"]; });

/* harmony import */ var _SendByEmailDialog__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./SendByEmailDialog */ "milH");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SendByEmailDialog", function() { return _SendByEmailDialog__WEBPACK_IMPORTED_MODULE_44__["SendByEmailDialog"]; });

/* harmony import */ var _SendByYammerDialog__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./SendByYammerDialog */ "FtYJ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SendByYammerDialog", function() { return _SendByYammerDialog__WEBPACK_IMPORTED_MODULE_45__["SendByYammerDialog"]; });

/* harmony import */ var _SiteActivityWebPart__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./SiteActivityWebPart */ "HZDx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SiteActivityWebPart", function() { return _SiteActivityWebPart__WEBPACK_IMPORTED_MODULE_46__["SiteActivityWebPart"]; });

/* harmony import */ var _SiteInformationPanel__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./SiteInformationPanel */ "XvS+");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SiteInformationPanel", function() { return _SiteInformationPanel__WEBPACK_IMPORTED_MODULE_47__["SiteInformationPanel"]; });

/* harmony import */ var _SitePermissionPanel__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./SitePermissionPanel */ "DM7Z");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SitePermissionPanel", function() { return _SitePermissionPanel__WEBPACK_IMPORTED_MODULE_48__["SitePermissionPanel"]; });

/* harmony import */ var _SitesWebPart__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./SitesWebPart */ "Vi7M");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SitesWebPart", function() { return _SitesWebPart__WEBPACK_IMPORTED_MODULE_49__["SitesWebPart"]; });

/* harmony import */ var _SuiteNav__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./SuiteNav */ "mJeo");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SuiteNav", function() { return _SuiteNav__WEBPACK_IMPORTED_MODULE_50__["SuiteNav"]; });

/* harmony import */ var _TeamsTabPicker__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ./TeamsTabPicker */ "pWCE");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsTabPicker", function() { return _TeamsTabPicker__WEBPACK_IMPORTED_MODULE_51__["TeamsTabPicker"]; });

/* harmony import */ var _TeamsTabUrlConfigTest__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ./TeamsTabUrlConfigTest */ "ASfe");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsTabUrlConfigTest", function() { return _TeamsTabUrlConfigTest__WEBPACK_IMPORTED_MODULE_52__["TeamsTabUrlConfigTest"]; });

/* harmony import */ var _TitleRegion__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ./TitleRegion */ "e5Kj");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TitleRegion", function() { return _TitleRegion__WEBPACK_IMPORTED_MODULE_53__["TitleRegion"]; });

/* harmony import */ var _TwitterWebPart__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./TwitterWebPart */ "HRpY");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TwitterWebPart", function() { return _TwitterWebPart__WEBPACK_IMPORTED_MODULE_54__["TwitterWebPart"]; });

/* harmony import */ var _Upload__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ./Upload */ "dAVj");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "upload", function() { return _Upload__WEBPACK_IMPORTED_MODULE_55__["upload"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "dataURItoFile", function() { return _Upload__WEBPACK_IMPORTED_MODULE_55__["dataURItoFile"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "setFileInput", function() { return _Upload__WEBPACK_IMPORTED_MODULE_55__["setFileInput"]; });

/* harmony import */ var _WeatherWebPart__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ./WeatherWebPart */ "ueW2");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeatherWebPart", function() { return _WeatherWebPart__WEBPACK_IMPORTED_MODULE_56__["WeatherWebPart"]; });

/* harmony import */ var _WorldClockWebPart__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ./WorldClockWebPart */ "qmer");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WorldClockWebPart", function() { return _WorldClockWebPart__WEBPACK_IMPORTED_MODULE_57__["WorldClockWebPart"]; });

/* harmony import */ var _YammerConversations__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ./YammerConversations */ "m98m");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "YammerConversations", function() { return _YammerConversations__WEBPACK_IMPORTED_MODULE_58__["YammerConversations"]; });

/* harmony import */ var _YammerHighlights__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ./YammerHighlights */ "umcD");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "YammerHighlights", function() { return _YammerHighlights__WEBPACK_IMPORTED_MODULE_59__["YammerHighlights"]; });

/* harmony import */ var _YouTubeEmbed__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ./YouTubeEmbed */ "mgJ4");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "YouTubeEmbed", function() { return _YouTubeEmbed__WEBPACK_IMPORTED_MODULE_60__["YouTubeEmbed"]; });
































































/***/ }),

/***/ "iHGF":
/*!*****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/OfficeFeedWebPart.js ***!
  \*****************************************************/
/*! exports provided: OfficeFeedWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OfficeFeedWebPart", function() { return OfficeFeedWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");




/**
 * @public
 */
var OfficeFeedWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(OfficeFeedWebPart, _super);
    function OfficeFeedWebPart() {
        var _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].OfficeFeed, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].OfficeFeed.toString()) || this;
        _this.WEBPART_TAB_ID = "[data-automation-id='officefeedwebpart']";
        _this.WEBPART_FEED_CONTAINER_TAB_ID = "[data-automation-id='officefeedcontainer']";
        _this.WEBPART_FEED_CONTAINER_SEEALL_TAB_ID = "[data-automation-id='officefeedcontainer_seeall']";
        _this.WEBPART_FEED_SEEALL_TAB_ID = 'officefeedwebpart_seeall_link';
        return _this;
    }
    OfficeFeedWebPart.prototype.AddTaskAddOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this.AddTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        })
            .WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, this.WEBPART_TAB_ID))
            .WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, this.WEBPART_FEED_CONTAINER_TAB_ID));
    };
    OfficeFeedWebPart.prototype.AddTaskNavigateSeeAll = function () {
        var _this = this;
        var seeAllLink;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Looking for "See all" link');
            seeAllLink = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(TAB.Win, _this.WEBPART_FEED_SEEALL_TAB_ID);
            if (seeAllLink) {
                TAB.Log.Pass('SeeAll link found.');
            }
            else {
                TAB.Log.AddTaskFail('SeeAll link not found.');
            }
        })
            .Then(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Navigating to " + seeAllLink.href + " page.");
            TAB.AddTask(TAB.LoadPage(seeAllLink.href), TAB.PageReady());
            TAB.Log.AddTaskComment("Waiting for '" + _this.WEBPART_FEED_CONTAINER_SEEALL_TAB_ID + "' to exist.");
        }))
            .WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, this.WEBPART_FEED_CONTAINER_SEEALL_TAB_ID))
            .Then(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Verifying that 'SeeAll' link is not rendered on SeeAll page.");
            seeAllLink = _this.FindSeeAllLink();
            if (!seeAllLink) {
                TAB.Log.Pass('SeeAll link was not found on SeeAll page.');
            }
            else {
                TAB.Log.AddTaskFail('SeeAll link was found on SeeAll page.');
            }
        })));
    };
    OfficeFeedWebPart.prototype.AddTaskAssertWebPartNotExist = function () {
        var _this = this;
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, _this.WEBPART_TAB_ID)) {
                throw 'OfficeFeed web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    OfficeFeedWebPart.prototype.FindSeeAllLink = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(TAB.Win, this.WEBPART_FEED_SEEALL_TAB_ID);
    };
    return OfficeFeedWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "iRE7":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/Controls/Carousel.js ***!
  \********************************************/
/*! exports provided: Carousel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Carousel", function() { return Carousel; });
/**
 * @public
 */
var Carousel = /** @class */ (function () {
    function Carousel() {
    }
    Carousel.carouselValidation = function (region, carouselDataAutomationId) {
        var _this = this;
        var carouselOuterContainer;
        TAB.Log.AddTaskComment('Checking if Carousel outer container exists');
        TAB.AddTask(TAB.MakeTask(function () {
            carouselOuterContainer = TAB.GetElement(region, TAB.searchBy.customQuery, "[data-automation-id='" + carouselDataAutomationId + "']");
        }));
        var carouselItemsContainer;
        TAB.Log.AddTaskComment('Checking if Carousel items container exists');
        TAB.AddTask(TAB.MakeTask(function () {
            carouselItemsContainer = TAB.GetElement(carouselOuterContainer, TAB.searchBy.customQuery, "[data-automation-id='SP-carouselItemsContainer']");
        }));
        var carouselItems;
        TAB.Log.AddTaskComment('Checking how many Carousel items exist');
        TAB.AddTask(TAB.MakeTask(function () {
            carouselItems = TAB.GetElements(carouselItemsContainer, TAB.searchBy.customQuery, "[data-automation-id='SP-carouselItem']");
            if (carouselItems.length !== 1) {
                TAB.Log.AddTaskComment('More than one Carousel item exists');
                _this.checkDotsAndArrows(carouselItems.length, carouselOuterContainer, region, carouselDataAutomationId);
            }
            else {
                TAB.Log.Pass('Only one carousel item exists. Do not check for arrows and dots.');
            }
        }));
        TAB.Log.AddTaskPass('Carousel Test Complete');
    };
    Carousel.checkDotsAndArrows = function (carouselItemsLength, carouselOuterContainer, region, carouselDataAutomationId) {
        TAB.Log.AddTaskComment('Checking if a Carousel dot exists for each carousel item');
        TAB.AddTask(TAB.MakeTask(function () {
            for (var i = 0; i < carouselItemsLength; i++) {
                var carouselDot = void 0;
                carouselDot = TAB.GetElement(region, TAB.searchBy.customQuery, "[data-automation-id='" + carouselDataAutomationId + "-carouselDot-" + i + "']");
                if (!carouselDot) {
                    TAB.Log.Fail("Carousel dot no." + (i + 1) + " not found for corresponding item container");
                }
            }
        }));
        TAB.Log.AddTaskComment('Checking if Carousel arrows are being loaded');
        TAB.AddTask(TAB.MakeTask(function () {
            if (TAB.ElementExists(carouselOuterContainer, TAB.searchBy.customQuery, "[data-automation-id='SP-carouselArrowLeft']") &&
                TAB.GetElement(carouselOuterContainer, TAB.searchBy.customQuery, "[data-automation-id='SP-carouselArrowRight']")) {
                TAB.Log.Pass('All elements of the carousel exist.');
            }
            else {
                TAB.Log.Fail('Left or/and right arrow of carousel does not exist.');
            }
        }));
    };
    return Carousel;
}());



/***/ }),

/***/ "iWcL":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Pages/CommentsMention.js ***!
  \************************************************/
/*! exports provided: CommentsMention */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CommentsMention", function() { return CommentsMention; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _Controls_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Controls/BaseWebpart */ "35UN");
/* harmony import */ var _Comments__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Comments */ "tJmU");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");




/**
 * @public
 */
var CommentsMention = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(CommentsMention, _super);
    function CommentsMention() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CommentsMention.AddTaskPostCommentsWithMentions = function (text, mentionedUsers) {
        TAB.Win.window.localStorage.setItem('DismissedMentionCoachmark', '1');
        CommentsMention._addTaskChangeCommentText(text);
        mentionedUsers.forEach(function (mention) {
            CommentsMention._addTaskCreateMention(mention);
        });
        TAB.Log.AddTaskComment('Posting the comment by clicking the post button');
        TAB.AddTask(TAB.MakeTask(function () {
            var postButton = CommentsMention._postButtonElement;
            TAB.ClickElement(postButton);
        }), TAB.MakeWaiter(function () {
            return (TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="comment-more-button"]')
                .length === 1);
        }));
        TAB.Log.AddTaskPass('Comment posted');
    };
    CommentsMention._getClickableSuggestion = function (i) {
        var suggestion = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.id, CommentsMention.SUGGESTION_ID + i.toString());
        return TAB.GetElement(suggestion, TAB.searchBy.tag, 'button');
    };
    Object.defineProperty(CommentsMention, "_inputElement", {
        get: function () {
            return TAB.GetElement(TAB.Win, TAB.searchBy.id, _Comments__WEBPACK_IMPORTED_MODULE_2__["Comments"].COMMENT_INPUT);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CommentsMention, "_postButtonElement", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, _Comments__WEBPACK_IMPORTED_MODULE_2__["Comments"].COMMENT_POST);
        },
        enumerable: true,
        configurable: true
    });
    CommentsMention._addTaskChangeCommentText = function (text) {
        TAB.Log.AddTaskComment('Adding Comment with content: ' + text);
        TAB.AddTask(TAB.MakeTask(function () {
            var input = CommentsMention._inputElement;
            TAB.ClickElement(input);
            if (TAB.Win.document.activeElement !== input) {
                input.focus();
            }
            TAB.SetTextContent(input, text);
            TAB.Log.Comment('Fire Keyup to trigger @Mention module deferred loading');
            TAB.FireKeyboardEvent(input, 'keyup', _Controls_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].right);
        }), TAB.MakeWaiter(function () {
            return CommentsMention._inputElement.innerText === text;
        }));
        TAB.Log.AddTaskPass('Comment content changed to: ' + text);
    };
    Object.defineProperty(CommentsMention, "_suggestionCount", {
        get: function () {
            return TAB.GetElements(TAB.Win.document.body, TAB.searchBy.partialId, CommentsMention.SUGGESTION_ID)
                .length;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CommentsMention, "_searchButton", {
        get: function () {
            return TAB.GetElements(TAB.Win.document.body, TAB.searchBy.partialClassName, 'ms-SearchMore-button')[0];
        },
        enumerable: true,
        configurable: true
    });
    CommentsMention._addTaskCreateMention = function (personName) {
        var _this = this;
        TAB.Log.Comment('Adding mention in comment: ' + personName);
        TAB.AddTask(TAB.MakeTask(function () {
            var input = CommentsMention._inputElement;
            input.innerHTML += ' @' + personName;
            var pos = input.lastChild.textContent.length;
            TAB.Win.document.getSelection().collapse(input.lastChild, pos);
            TAB.Log.Comment('Fire Keyup to trigger @Mention fire query to show picker');
            TAB.FireKeyboardEvent(input, 'keyup', _Controls_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].right);
        }), TAB.MakeWaiter(function () {
            return _this._suggestionCount > 0 || _this._searchButton;
        }));
        TAB.Log.Comment('Click Search More button to ensure results for: ' + personName);
        TAB.AddTask(TAB.MakeTask(function () {
            if (_this._suggestionCount === 0 && _this._searchButton) {
                TAB.ClickElement(_this._searchButton);
                _this._isSearch = true;
            }
            else {
                _this._isSearch = false;
            }
        }), TAB.MakeWaiter(function () {
            return _this._suggestionCount > 0;
        }));
        TAB.Log.AddTaskComment('Adding mention in comment: ' + personName);
        TAB.AddTask(TAB.MakeTask(function () {
            var input = CommentsMention._inputElement;
            TAB.Log.Comment('Fire Keydown/Keyup to trigger mention anchor transformation');
            if (_this._isSearch) {
                // if SearchMore has been used, need to press up to go back to suggestions
                TAB.FireKeyboardEvent(input, 'keydown', _Controls_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].up);
            }
            TAB.Log.Comment('Click on the first available suggestion for ' + personName);
            TAB.ClickElement(_this._getClickableSuggestion(0));
        }), TAB.MakeWaiter(function () {
            return (CommentsMention._inputElement.getElementsByTagName('a').length ===
                CommentsMention._totalMention + 1 && _this._suggestionCount === 0);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            CommentsMention._totalMention += 1;
        }), undefined);
        TAB.Log.AddTaskPass(personName + ' mentioned in comment');
    };
    CommentsMention._totalMention = 0;
    CommentsMention._isSearch = false;
    CommentsMention.SUGGESTION_ID = 'sug-';
    return CommentsMention;
}(_Comments__WEBPACK_IMPORTED_MODULE_2__["Comments"]));



/***/ }),

/***/ "itp8":
/*!*********************************************************!*\
  !*** ./lib/SPTaskLib/TenantAdmin/ContentTypeGallery.js ***!
  \*********************************************************/
/*! exports provided: ContentTypeGallery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContentTypeGallery", function() { return ContentTypeGallery; });
/**
 * @public
 */
var ContentTypeGallery = /** @class */ (function () {
    function ContentTypeGallery() {
    }
    ContentTypeGallery.AddTaskVerifyCTHomeAndDetailsLoad = function () {
        var _this = this;
        var contentTypeList;
        var contentTypeColumnlist;
        TAB.AddTask(TAB.MakeTask(function () {
            return (contentTypeList = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid=\"DetailsList\"]"));
        }));
        // wait for content type list to load
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var listCells = TAB.GetElements(contentTypeList, TAB.searchBy.customQuery, "[data-automationid=\"ListCell\"]");
            return listCells[0].children[0].getAttribute('class').indexOf('ms-Shimmer-container') < 0;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var documentCTRow = _this.findContentTypeRowById('0x0101', contentTypeList);
            if (documentCTRow !== undefined) {
                TAB.Log.Pass('Found document content type');
                TAB.Log.Comment('Going to details page of document content type...');
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.ClickElement(documentCTRow[0].firstChild);
                }));
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.Log.Pass('Content type details page loaded successfully');
                    contentTypeColumnlist = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid=\"DetailsList\"]");
                }));
                // wait for content type column list to load
                TAB.AddTask(undefined, TAB.MakeWaiter(function () {
                    var listCells = TAB.GetElements(contentTypeColumnlist, TAB.searchBy.customQuery, "[data-automationid=\"ListCell\"]");
                    var listCellChild = listCells[0].children[0];
                    return listCellChild.getAttribute('class') === null;
                }));
                TAB.AddTask(TAB.MakeTask(function () {
                    TAB.Log.Pass('Content type columns loaded');
                    var columnsDetailsList = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid=\"DetailsList\"]");
                    var columns = TAB.GetElements(columnsDetailsList, TAB.searchBy.customQuery, "[data-automationid=\"ListCell\"]");
                    if (columns.length === 2) {
                        TAB.Log.Pass('Found 2 columns of Document CT');
                    }
                    else {
                        TAB.Log.Fail("Expected to find 2 columns of Document CT but found " + columns.length + " instead.");
                    }
                }), undefined);
            }
            else {
                TAB.Log.Fail('Could not find OOB document content type');
            }
        }));
    };
    /**
     * Helper function to find a content type row on the content type
     * gallery home page list by its id
     */
    ContentTypeGallery.findContentTypeRowById = function (id, contentTypeList) {
        var rowItems = TAB.GetElements(contentTypeList, TAB.searchBy.customQuery, "[data-automationid=\"DetailsRowFields\"]");
        var contentType = undefined;
        for (var _i = 0, rowItems_1 = rowItems; _i < rowItems_1.length; _i++) {
            var rowItem = rowItems_1[_i];
            if (rowItem) {
                var cellItems = TAB.GetElements(rowItem, TAB.searchBy.customQuery, "[data-automationid=\"DetailsRowCell\"]");
                if (cellItems[0].children &&
                    cellItems[0].children.length === 1 &&
                    cellItems[0].children[0].getAttribute('id') === id) {
                    contentType = cellItems;
                    break;
                }
            }
        }
        return contentType;
    };
    return ContentTypeGallery;
}());



/***/ }),

/***/ "iw6+":
/*!****************************************!*\
  !*** ./lib/SPTaskLib/ExtensionUtil.js ***!
  \****************************************/
/*! exports provided: ExtensionUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ExtensionUtil", function() { return ExtensionUtil; });
/* harmony import */ var _Controls_Field__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Controls/Field */ "hfq8");
/* harmony import */ var _ListLibrary__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListLibrary */ "7on5");


/**
 * @public
 */
var ExtensionUtil = /** @class */ (function () {
    function ExtensionUtil() {
    }
    /**
     * Loads a list, and if it doesn't exist, it creates it.
     * It sets up the list with a few sample data:
     * Field "Percent" (number), with items with values 10, 50 and 80
     * Field "Rating" (number), with items with values 50, 50 and 50
     * Field "Description" (text), with three occurrences of 'default text'
     *
     * @param listName - Name for the list.
     * @returns List object for the newly created list.
     */
    ExtensionUtil.loadList = function (listName) {
        var listFields = [
            new _Controls_Field__WEBPACK_IMPORTED_MODULE_0__["Field"]('Percent', 'A simple number field.', _Controls_Field__WEBPACK_IMPORTED_MODULE_0__["FieldType"].Number, false /*IsRequired*/, false /*IsHidden*/),
            new _Controls_Field__WEBPACK_IMPORTED_MODULE_0__["Field"]('Rating', 'A simple number field.', _Controls_Field__WEBPACK_IMPORTED_MODULE_0__["FieldType"].Number, false /*IsRequired*/, false /*IsHidden*/),
            new _Controls_Field__WEBPACK_IMPORTED_MODULE_0__["Field"]('Description', 'A simple text field.', _Controls_Field__WEBPACK_IMPORTED_MODULE_0__["FieldType"].Text, false /*IsRequired*/, false /*IsHidden*/)
        ];
        var listFieldInternalValues = [
            [10, 50, 'default text'],
            [50, 50, 'default text'],
            [80, 100, 'default text']
        ];
        var loadList = { success: false };
        var list = new _ListLibrary__WEBPACK_IMPORTED_MODULE_1__["List"](listName);
        // Adds a task with the correct waiter to try to load the list.
        // Existence will be reflected on the 'success'
        // property of the 'ISuccessResult' interface.
        list.addCsomTaskLoadList(loadList);
        // If the list does not exist then create it
        TAB.AddTask(TAB.MakeTask(function () {
            if (!loadList.success) {
                TAB.Log.Comment("Creating list '" + listName + "'");
                list.addCsomTaskCreateList({
                    numberOfItems: listFieldInternalValues.length,
                    additionalFields: listFields,
                    fieldValues: listFieldInternalValues
                });
            }
        }));
        return list;
    };
    /**
     * Ensures that a div element was appended to the documents html body.
     *
     * @param commandItem - an item on the command bar that is registered by the customActions
     * URL parameter.
     * @param dataAutomationId - the query string that uniquely identifies the div that should
     * be added to the page after clicking the command item.
     */
    ExtensionUtil.testCommandBarItem = function (commandItem, dataAutomationId) {
        // Ensure div is not present before clicking the commandItem
        TAB.Log.AddTaskComment('Validating div has not been added before clicking the Command Item.');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + dataAutomationId + "\"]");
        }));
        // Ensure div is present upon clicking the Command Item
        TAB.Log.AddTaskComment('Validating div is added to HTML after clicking the Command Item.');
        commandItem.AddTaskClick();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + dataAutomationId + "\"]");
        }));
    };
    /**
     * Ensures a dialog is present upon clicking the 'commandItem', verifies the text
     * in the dialog matches 'expectedCommandText', and lastly ensures the dialog from the
     * 'commandItem' can be dismissed.
     * @param commandItem - an item on the command bar that is registered by the customActions
     * URL parameter.
     * @param expectedCommandText - the text that is expected to appear in the dialog
     * when the commandItem is clicked.
     */
    ExtensionUtil.testDialogCommandBarItem = function (commandItem, expectedCommandText) {
        // Ensure dialog is present upon clicking Command Item
        TAB.Log.AddTaskComment('Clicking Command Item and waiting for the dialog to appear.');
        commandItem.AddTaskClick();
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-content');
        }));
        // Ensure dialog's inner content is correct for the Command Item
        TAB.Log.AddTaskComment('Validating contents of the dialog.');
        TAB.AddTask(TAB.MakeTask(function () {
            var dialogContent = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-content');
            if (!(dialogContent.innerText.trim() === expectedCommandText)) {
                TAB.Log.AddTaskFail("Command Item One inner context expected to be '" + expectedCommandText + "'.");
            }
        }));
        // Dismiss Dialog
        TAB.Log.AddTaskComment('Dismissing dialog.');
        TAB.AddTask(TAB.MakeTask(function () {
            var dialogActions = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-action');
            for (var _i = 0, dialogActions_1 = dialogActions; _i < dialogActions_1.length; _i++) {
                var dialogAction = dialogActions_1[_i];
                if (dialogAction.innerText.trim() === 'OK') {
                    var okButton = TAB.GetElement(dialogAction, TAB.searchBy.hasClassName, 'ms-Button');
                    TAB.ClickElement(okButton);
                }
            }
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-header');
        }));
    };
    return ExtensionUtil;
}());



/***/ }),

/***/ "jK1H":
/*!***********************************!*\
  !*** ./lib/SPTaskLib/PageUtil.js ***!
  \***********************************/
/*! exports provided: PageUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageUtil", function() { return PageUtil; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Next */ "BJbA");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Controls/CreateSitePanel */ "JmdK");




// It should be consistent with the definition in /apps/sp-pages/src/chunks/sp-pages-firstRun/FirstRunExperienceKeys
var FIRST_RUN_EXPERIENCE_KEYS = [
    'FirstRunExperieneceSharePointPageAuthoring',
    'FirstRunSharePointSaveForLaterTeachingBubble',
    'FirstRunSharePointContentBarAnalyticsPanel',
    'FirstRunModernHomepage'
];
var devCookieName = 'SPClientSideFrameworkDevCookie-9076A2B0-2161-43C6-8BEA-9FECB7EA459B';
/**
 * @public
 */
var PageUtil = /** @class */ (function () {
    function PageUtil() {
    }
    PageUtil.AddTaskCreateClassicPage = function () {
        PageUtil.pageCreateAttempts += 1;
        PageUtil.generatedPageName = "testpage" + PageUtil.pageNumber.toString() + ".aspx";
        var clientContext = new SP.ClientContext(TAB.Settings.Get('ProductServer') + "/sites/testPublishingPage3");
        var web = clientContext.get_web();
        var pageLayoutItem;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Starting Get Page Layout and Add Page");
            PageUtil.isPageCreateTaskFinished = false;
            PageUtil.GetPageLayout(web, clientContext)
                .then(function (value) {
                pageLayoutItem = value;
                PageUtil.addPublishingPage(PageUtil.generatedPageName, clientContext, web, pageLayoutItem)
                    .then(function () {
                    PageUtil.createdPage = true;
                    PageUtil.isPageCreateTaskFinished = true;
                })
                    .catch(function (message) {
                    TAB.Log.AddTaskComment("Create Classic Page failed: " + message);
                    // If the page create failed because the page already exists, try a different name and retry.
                    if (message.indexOf("A file with the name Pages/" + PageUtil.generatedPageName + " already exists.") > -1) {
                        // If we have already tried a fixed number of times, fail the test.
                        if (PageUtil.pageCreateAttempts > 30) {
                            TAB.Log.AddTaskFail('Publishing Page could not be created after 30 attempts.' +
                                'It might be because existing pages are not removed properly.');
                            PageUtil.generatedPageName = undefined;
                            PageUtil.isPageCreateTaskFinished = true;
                            return;
                        }
                        PageUtil.pageNumber += 1;
                        TAB.Log.AddTaskComment("Attempting to create page by appending counter: \"" + PageUtil.pageNumber + "\", to the name.");
                        // Set the flag to true in order to allow the next 'recursively' called task to run
                        PageUtil.isPageCreateTaskFinished = true;
                        PageUtil.AddTaskCreateClassicPage();
                    }
                    else {
                        // Classic Page creation failed for unknown reason, end the test.
                        PageUtil.generatedPageName = undefined;
                        PageUtil.isPageCreateTaskFinished = true;
                    }
                });
            })
                .catch(function (message) {
                TAB.Log.AddTaskWarning("Get Page Layout failed: " + message);
            });
        }), TAB.MakeWaiter(function () {
            return PageUtil.isPageCreateTaskFinished;
        }));
    };
    /**
     * A function to delete the classic page that was created with the name 'PageUtil.generatedPageName'.
     * The caller of this function should ensure a page was created by checking the 'PageUtil.createdPage'
     * flag variable before calling this function.
     */
    PageUtil.AddTaskDeleteClassicPage = function () {
        if (!PageUtil.generatedPageName) {
            return;
        }
        var clientContext = new SP.ClientContext(TAB.Settings.Get('ProductServer') + "/sites/testPublishingPage3");
        var web = clientContext.get_web();
        var pagesFile = web.getFileByServerRelativeUrl("/sites/testPublishingPage3/Pages/" + PageUtil.generatedPageName);
        pagesFile.deleteObject();
        var isTaskFinished = false;
        TAB.AddTask(TAB.CloseWindow(TAB.Win));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Deleting Page");
            PageUtil.executeQueryAsync(clientContext)
                .then(function () {
                isTaskFinished = true;
            })
                .catch(function (message) {
                // If you cant delete the page, it might be affecting future tests.
                TAB.Log.AddTaskWarning("Error deleting publishing page: " + message);
                isTaskFinished = true;
            });
        }), TAB.MakeWaiter(function () {
            return isTaskFinished;
        }));
    };
    /**
     * A function to delete the given server relative folder url on the speficied server url
     */
    PageUtil.AddTaskDeleteFolder = function (siteUrl, serverRelativeFolderUrl) {
        var clientContext = new SP.ClientContext(siteUrl);
        var web = clientContext.get_web();
        var folder = web.getFolderByServerRelativeUrl(serverRelativeFolderUrl);
        folder.deleteObject();
        var isTaskFinished = false;
        TAB.AddTask(TAB.CloseWindow(TAB.Win));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Deleting Folder");
            PageUtil.executeQueryAsync(clientContext)
                .then(function () {
                isTaskFinished = true;
            })
                .catch(function (message) {
                // If you cant delete the folder, it might be affecting future tests.
                TAB.Log.AddTaskWarning("Error deleting folder: " + message);
                isTaskFinished = true;
            });
        }), TAB.MakeWaiter(function () {
            return isTaskFinished;
        }));
    };
    /**
     * Add task to create site page using CreateSitePage wizard.
     * @param shouldCreateNewsPage - If true news page will be created instead.
     * @param siteName - Name of the test site
     * @param path - Default to sites for backward compatibility
     */
    PageUtil.AddTaskCreateSitePage = function (shouldCreateNewsPage, siteName, path) {
        path = path || 'sites';
        var prefix = siteName
            ? TAB.Settings.Get('ProductServer') + "/" + path + "/" + siteName
            : TAB.Settings.Get('ProductServer');
        var newPageUrl = undefined;
        newPageUrl = shouldCreateNewsPage
            ? prefix + '/_layouts/15/news.aspx'
            : prefix + '/_layouts/15/CreateSitePage.aspx';
        PageUtil.disableFirstRunDialog();
        TAB.AddTask(TAB.LoadPage(newPageUrl), TAB.PageReady());
    };
    /**
     * Add task to create site page using CreateSitePage wizard.
     */
    PageUtil.AddTaskCheckForAtLeastOneResult = function (searchUrl, ecsSettings) {
        TAB.Log.AddTaskComment('Loading search page.');
        var fullSearchUrl = "" + TAB.Settings.Get('ProductServer') + searchUrl;
        fullSearchUrl = ecsSettings
            ? fullSearchUrl + "&ecsOverrides={" + ecsSettings + "}&wipeEcsConfig=true"
            : fullSearchUrl;
        PageUtil.disableFirstRunDialog();
        TAB.AddTask(TAB.LoadPage(fullSearchUrl), 
        // [aria-posinset="15"] is the 15th search result in the searchpage. Means that results have been returned and that they are present on the page.
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[aria-posinset=\"15\"]"));
        TAB.Log.AddTaskComment('Done loading search page.');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Getting searchresults');
            var searchResults = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-searchpanelcontenttype=\"body\"]");
            var numberOfSearchResults = searchResults.childElementCount;
            var hasAtLeastOneSearchResult = numberOfSearchResults > 0;
            TAB.Log.VerifyEquals(hasAtLeastOneSearchResult, true, 'Has as least one search result');
            TAB.Log.AddTaskComment('Number of searchresults: ' + numberOfSearchResults);
        }));
    };
    PageUtil.AddTaskCreatePageOnSite = function (siteName, path) {
        if (path === void 0) { path = 'sites'; }
        PageUtil.AddTaskSetDebugManifests();
        PageUtil.disableFirstRunDialog();
        var newPageUrl = TAB.Settings.Get('ProductServer') + ("/" + path + "/" + siteName + "/_layouts/15/CreateSitePage.aspx");
        TAB.AddTask(TAB.LoadPage(newPageUrl), TAB.PageReady());
    };
    PageUtil.AddTaskLoadCommunicationPage = function (siteName, ifLoadPage) {
        if (ifLoadPage === void 0) { ifLoadPage = true; }
        TAB.Log.AddTaskComment('Loading existing home page.');
        var newPageUrl = TAB.Settings.Get('ProductServer') + ("/sites/" + siteName + "/SitePages/Home.aspx");
        TAB.AddTask(TAB.LoadPage(newPageUrl), TAB.PageReady());
    };
    PageUtil.AddTaskDismissWelcomeDialogIfExists = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Waited for Welcome dialog if it exists.');
            if (PageUtil.WelcomeDialogExists()) {
                TAB.Log.AddTaskComment('Welcome dialog exists, dismissing dialog.');
                var closeButton = PageUtil.getCloseButtonForWelcomeDialog();
                TAB.ClickElement(closeButton);
            }
            else {
                TAB.Log.AddTaskComment('Welcome dialog does not exist, not dismissing.');
            }
        }), TAB.MakeWaiter(function () {
            return PageUtil.waitForWelcomeDialogNotVisible();
        }));
    };
    PageUtil.WelcomeDialogExists = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="FirstRunDialogMain"]');
    };
    PageUtil.AddTaskCreateSetupCommunicationSite = function (serverUrl, siteUrl) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.SetWaitTime(2 * 60 * 1000);
            TAB.Log.Comment('Navigating to Create Site page');
            var pageUrl = serverUrl + '/_layouts/15/creategroup.aspx';
            TAB.AddTask(TAB.LoadPage(pageUrl), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'od-GroupCreate'));
            var createSiteParams;
            createSiteParams = {
                name: siteUrl,
                description: name + '-description',
                designPackage: _Controls_CreateSitePanel__WEBPACK_IMPORTED_MODULE_3__["DesignPackageOption"].Blank
            };
            TAB.AddTask(TAB.MakeTask(function () {
                _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].AddTaskCreationCommunicationSite(createSiteParams);
                _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].AddTaskVerifySiteHeader(createSiteParams.name);
            }));
        }));
    };
    PageUtil.AddTaskLoadClassicPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Loading newly created page.');
            var path = "/sites/testPublishingPage3/Pages/" + PageUtil.generatedPageName;
            PageUtil.AddTaskSetDebugManifests({
                loaderAssemblyId: 'addf4597-640f-4316-858c-2359e0c4ec21' // sp-classic-page
            });
            TAB.AddTask(TAB.LoadPage(path), TAB.PageReady());
        }));
    };
    PageUtil.AddTaskLoadPage = function (url) {
        TAB.Log.AddTaskComment('Loading existing page.');
        var newPageUrl = TAB.Settings.Get('ProductServer') + url;
        TAB.AddTask(TAB.LoadPage(newPageUrl), TAB.PageReady());
    };
    PageUtil.CheckPageLoaded = function () {
        try {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'SPPageChrome');
        }
        catch (error) {
            return false;
        }
    };
    PageUtil.AddTaskSetDebugManifests = function (partialOptions) {
        PageUtil.disableFirstRunDialog();
        if (!PageUtil.debugManifestRequired) {
            return;
        }
        var azurePath = (TAB.Settings.Get('AzurePath') || '').replace(/\/+$/, '');
        if (azurePath || partialOptions.manifestsFileUrl) {
            var options_1 = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"])({ loaderAssemblyId: 'b5cca424-63d0-4e35-b6c5-794d04f61206', manifestsFileUrl: azurePath + "/manifests.js" }, (partialOptions || {}));
            TAB.LoadScripts([options_1.manifestsFileUrl], []);
            TAB.AddTask(TAB.MakeTask(function () {
                var extendedWindow = window;
                var manifests = extendedWindow.debugManifests.getManifests();
                var assemblyUrl = undefined;
                for (var _i = 0, manifests_1 = manifests; _i < manifests_1.length; _i++) {
                    var manifest = manifests_1[_i];
                    if (manifest.id === options_1.loaderAssemblyId) {
                        var loaderConfig = manifest.loaderConfig;
                        var entryModule = loaderConfig.scriptResources[loaderConfig.entryModuleId];
                        var disambiguatePath = function (path) {
                            var pathSuffix = typeof path === 'string' ? path : path.default || path.debug;
                            return azurePath + "/" + pathSuffix;
                        };
                        switch (entryModule.type) {
                            case 'path': {
                                var pathEntryModule = entryModule;
                                assemblyUrl = disambiguatePath(pathEntryModule.path);
                                break;
                            }
                            case 'localizedPath': {
                                var localizedPathEntryModule = entryModule;
                                // tslint:disable:no-string-literal
                                assemblyUrl = disambiguatePath(localizedPathEntryModule.paths['qps-ploc'] ||
                                    localizedPathEntryModule.defaultPath ||
                                    localizedPathEntryModule.paths['default'] ||
                                    localizedPathEntryModule.paths['en-us']);
                                // tslint:enable:no-string-literal
                                break;
                            }
                            default: {
                                throw new Error("Unable to load loader assembly. Found entry module type " + entryModule.type + ".");
                            }
                        }
                        break;
                    }
                }
                if (!assemblyUrl) {
                    throw new Error("Unable to find manifest for required assembly " + options_1.loaderAssemblyId + ". Try running the TAB test with --rush");
                }
                TAB.Log.Comment("Using loaderUrl \"" + assemblyUrl + "\" and manifestsFileUrl \"" + options_1.manifestsFileUrl + "\"");
                TAB.Win.window.sessionStorage.setItem('spfx-debug', JSON.stringify({
                    loaderUrl: assemblyUrl,
                    manifestsFileUrl: options_1.manifestsFileUrl,
                    testMode: true
                }));
                TAB.Win.document.cookie = devCookieName + "=debug=true;path=/";
                PageUtil.debugManifestsHaveBeenSet = true;
            }));
        }
    };
    PageUtil.ResetDebugManifests = function () {
        TAB.Win.window.sessionStorage.removeItem('spfx-debug');
        TAB.Win.document.cookie = devCookieName + "=;max-age=0";
        PageUtil.debugManifestsHaveBeenSet = false;
    };
    PageUtil.ReloadPageInMobileView = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Reloading the page with the WebView parameter');
            TAB.Win.location.href += (TAB.Win.location.href.indexOf('?') === -1 ? '?' : '&') + "env=MobileWebView";
            TAB.ReloadPage();
        }), TAB.PageReady());
    };
    PageUtil.LoadTestPage = function () {
        PageUtil.AddTaskSetDebugManifests();
        var newPageURl = TAB.Settings.Get('ProductServerSet').split(';')[0] + '/SitePages/NewPage.aspx';
        TAB.AddTask(TAB.LoadPage(newPageURl), TAB.PageReady());
    };
    PageUtil.AddTaskCreateWorkbench = function () {
        var path = '/_layouts/15/workbench.aspx';
        var spQueryParams = {
            noredir: true
        };
        var newPageUrl = PageUtil.CreatePageUrl(path, spQueryParams);
        /* Load the create new page url */
        TAB.AddTask(TAB.LoadPage(newPageUrl), TAB.PageReady());
        PageUtil.AddTaskValidateAutomationIdExists('toolboxHint-webPart');
    };
    /**
     * Utility function that waits for the existence of an element with data-automation-id
     * that matches the given parameter.
     * @param dataAutomationID - the text that is provided on the element after 'data-automation-id='. For example,
     * if we have 'data-automation-id = WebPartContent' then we would pass 'WebPartContent' as the parameter.
     */
    PageUtil.AddTaskValidateAutomationIdExists = function (dataAutomationID) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Validating data-automation-id " + dataAutomationID + " exists.");
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + dataAutomationID + "']");
        }));
    };
    PageUtil.SPPageReady = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            return _this.IsSPPageReady();
        });
    };
    PageUtil.IsSPPageReady = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'SuiteNavWrapper');
    };
    /**
     * Boots the preload.aspx page to warm up SP-Pages app.
     */
    PageUtil.AddTaskPreloadPagesApp = function () {
        var preloadPageUrl = TAB.Settings.Get('ProductServer') + '/_layouts/15/preload.aspx';
        TAB.AddTask(TAB.LoadPage(preloadPageUrl), TAB.PageReady());
    };
    /**
     * A utility function for loading a page to test Sharepoint Extensions.
     *
     * @param path - the arguments that follow the ProductServerSet. i.e. if the url is:
     * 'https://testtab.spoppe.com/_layouts/15/viewlsts.aspx?view=14&size=24' then the path is
     * '/_layouts/15/viewlsts.aspx'.
     * @param params - url paramters (do not include the '?' character). I.e. if your desired url
     * is: 'https://testtab.spoppe.com/_layouts/15/viewlsts.aspx?view=14&size=24', then params value is
     * 'view=14&size=24'. The 'loadSPFX' and 'customActions' param will be appended for you.
     * @param customActions - a lookup object for SharePoint extensions. Please see
     * {@link https://dev.office.com/sharepoint/docs/spfx/extensions/overview-extensions | Overview Extensions}
     * for more info.
     */
    PageUtil.CreatePageUrl = function (path, spQueryParams) {
        var pageUrl = TAB.Settings.Get('ProductServerSet').split(';')[0] + ("" + path);
        var queryParamsString = PageUtil.getQueryParamsString(spQueryParams);
        if (queryParamsString) {
            pageUrl += "?" + queryParamsString;
        }
        return pageUrl;
    };
    PageUtil.GetPageUrl = function () {
        return TAB.Win.location.href;
    };
    PageUtil.AddTaskReloadPageWithQueryParams = function (spQueryParams) {
        TAB.AddTask(TAB.MakeTask(function () {
            var pageUrl = PageUtil.GetPageUrl();
            var queryParamsString = PageUtil.getQueryParamsString(spQueryParams);
            if (queryParamsString) {
                var existingQueryParamIndex = pageUrl.indexOf('?');
                pageUrl =
                    existingQueryParamIndex > -1
                        ? pageUrl + ("&" + queryParamsString)
                        : pageUrl + ("?" + queryParamsString);
                TAB.AddTask(TAB.LoadPage(pageUrl), TAB.PageReady());
            }
        }));
    };
    PageUtil.removeExtension = function (inputString) {
        var lastSlashIndex = inputString.lastIndexOf('/');
        var rawTitle = lastSlashIndex === -1 ? inputString : inputString.substring(lastSlashIndex + 1);
        var lastDotIndex = rawTitle.lastIndexOf('.');
        return lastDotIndex === -1 ? rawTitle : rawTitle.substring(0, lastDotIndex);
    };
    /**
     * Ensure page exist on site using REST API. New page will be created if does not exist already.
     * @param pageTitle - Title of the page to be ensured.
     * @param siteName  - Name of the site hosting site page.
     * @param jsonCanvasContent - Optional Canvas content if you don't want blank page if new page created.
     * @param jsonLayoutContents - Optional LayoutWebpartsContent if you don't want default title region.
     * @param publishPage - Optional set to true for publishing a page
     * @param promotedState - Optional set to 2 for News post, default is 1
     * @param path  - Optional path of the site, default is TeamSitePage.Path
     */
    PageUtil.EnsurePageExist = function (pageTitle, pageResult, siteName, jsonCanvasContent, jsonLayoutContents, publishPage, promotedState, path) {
        if (pageResult === void 0) { pageResult = {}; }
        path = path || _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].Path;
        promotedState = isNaN(promotedState) ? 1 : promotedState;
        var siteUrl = TAB.Settings.Get('ProductServer') + "/" + path + "/" + siteName;
        var testPageUrl = siteUrl + "/SitePages/" + pageTitle + ".aspx";
        TAB.Log.AddTaskComment("Ensure Site Page " + testPageUrl + " exist, if not create new one.");
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendGetRequest(siteUrl, testPageUrl + '?as=json', result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success && result.retVal) {
                TAB.Log.AddTaskComment("Ensured Site page already exist: " + testPageUrl);
            }
            else {
                TAB.Log.Comment("Site page  " + testPageUrl + " does not exist, lets create new one.");
                PageUtil.AddCreatePageTask(pageTitle, pageResult, siteName, jsonCanvasContent, jsonLayoutContents, path, promotedState, publishPage, true /** fetchCanary */);
                TAB.Log.AddTaskComment("New Page created: " + testPageUrl);
            }
        }));
    };
    /**
     * It will try to create a new page with provided page title using REST API.
     * The URL of the page will be also based on pageTitle. If page already exist this will end up in no-op.
     *
     * @param pageTitle - unique title of the page. Ensure page with same Name does not already exist.
     * @param result - Tells us the caller whether the page was created or not.
     * @param siteName - Site under which page to be created.
     * @param jsonCanvasContent - Optional Canvas content if you don't want blank page.
     * @param jsonLayoutContents - Optional LayoutWebpartsContent if you don't want default title region.
     * @param path - Path of the site. It is often teams or sites, default is as defined at TeamSitePage.Path
     * @param promotedState - Optional set to 2 for News post
     * @param publishPage - Optional set to true for publishing a page
     */
    PageUtil.AddCreatePageTask = function (pageTitle, result, siteName, jsonCanvasContent, jsonLayoutContents, path, promotedState, publishPage, fetchCanary) {
        if (result === void 0) { result = {}; }
        path = path || _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].Path;
        var siteUrl = TAB.Settings.Get('ProductServer') + "/" + path + "/" + siteName;
        var apiPathCreatePage = siteUrl + "/_api/sitepages/pages";
        fetchCanary = fetchCanary || false;
        var content = {
            PageLayoutType: 'Article',
            PromotedState: promotedState || 1,
            Title: pageTitle,
            Name: pageTitle + '.aspx',
            CanvasContent1: JSON.stringify(jsonCanvasContent)
        };
        if (jsonLayoutContents) {
            content.LayoutWebpartsContent = JSON.stringify(jsonLayoutContents);
        }
        _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendPostRequest(siteUrl, apiPathCreatePage, JSON.stringify(content), result, fetchCanary);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success && result.retVal) {
                TAB.Log.AddTaskComment("Site Page " + pageTitle + " created successfully.");
                if (publishPage) {
                    var apiPathPublishPage = siteUrl + "/_api/sitepages/pages(" + result.retVal.Id + ")/publish";
                    _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendPostRequest(siteUrl, apiPathPublishPage, JSON.stringify(content), result);
                }
            }
            else {
                TAB.Log.Warning("Site page  " + pageTitle + " could not be created. Most probably it already exists. See Response: " + (result && result.retVal));
            }
        }));
    };
    /**
     * This function tries to click the home page button of the comm site.
     */
    PageUtil.AddTaskClickHomeButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('PageUtil.AddTaskClickHomeButton(): Home button to be clicked from navigation bar');
            var navBarElements = TAB.GetElements(TAB.Win.document.body, TAB.searchBy.partialClassName, 'ms-HorizontalNavItem-link');
            // 0th element on the nav-bar is the Home button
            TAB.ClickElement(navBarElements[0]);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarNewButton']"));
    };
    /**
     * This function tries to click the home page button of the team site via left-nav.
     */
    PageUtil.AddTaskClickHomeButtonFromLeftNav = function () {
        var LEFT_NAV_GROUPS = 'LeftNavGroups';
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("PageUtil.AddTaskClickHomeButtonFromLeftNav(): About to click Home button from the left-nav of the team site");
            var leftNavGroups = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='" + LEFT_NAV_GROUPS + "']");
            var homeElement = TAB.GetElement(leftNavGroups, TAB.searchBy.customQuery, "[title='Home']");
            TAB.ClickElement(homeElement);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarNewButton']"));
    };
    /**
     * Checks to verify that the PageLayoutScrollRegion and inner child render with non-zero height
     */
    PageUtil.AddTaskCheckScrollRegionHeight = function () {
        var pageLayoutScrollRegion;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Checking that the main content is rendering with non-zero height.');
            TAB.Log.AddTaskComment('First checking the outer scroll region...');
        }), TAB.MakeWaiter(function () {
            var pageLayoutScrollRegionList = TAB.GetElements(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automation-id='contentScrollRegion']");
            if (!pageLayoutScrollRegionList ||
                pageLayoutScrollRegionList.length < 1 ||
                pageLayoutScrollRegionList[0].clientHeight === 0) {
                return false;
            }
            pageLayoutScrollRegion = pageLayoutScrollRegionList[0];
            return true;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Found the scroll region and verified non-zero height.');
            TAB.Log.AddTaskComment('Now checking that the content inside the scroll region has non-zero height...');
        }), TAB.MakeWaiter(function () {
            var scrollRegionInnerContent = TAB.GetElements(pageLayoutScrollRegion, TAB.searchBy.customQuery, "[data-automation-id='mainScrollRegionInnerContent']");
            if (!scrollRegionInnerContent ||
                scrollRegionInnerContent.length < 1 ||
                scrollRegionInnerContent[0].clientHeight === 0) {
                return false;
            }
            return true;
        }));
    };
    /**
     * In-place navigate to another page under the same site
     */
    PageUtil.AddTaskInplaceNavigateTo = function (pageUrl) {
        TAB.AddTask(TAB.MakeTask(function () {
            var pathname = TAB.Win.location.pathname;
            pageUrl = pathname.substring(0, pathname.lastIndexOf('/') + 1) + pageUrl;
            TAB.Win.window.postMessage("router://" + pageUrl + ".aspx", TAB.Win.location.origin);
        }), TAB.PageReady());
    };
    PageUtil.AddTaskWaitForHeaderRender = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='SiteHeader']");
        }));
    };
    /**
     * Adds a waiter that will wait for the specified number of milliseconds
     * @param ms - number of milliseconds to wait
     */
    PageUtil.AddTaskWaitForTime = function (ms) {
        var isFinishedWaiting = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Started waiting for " + ms + "ms...");
            setTimeout(function () {
                TAB.Log.Comment('Timed wait callback invoked.');
                isFinishedWaiting = true;
            }, ms);
        }), TAB.MakeWaiter(function () {
            if (isFinishedWaiting) {
                TAB.Log.Comment('Finished waiting.');
            }
            return isFinishedWaiting;
        }));
    };
    PageUtil.disableFirstRunDialog = function () {
        var localStorage = TAB.Win.window.localStorage;
        if (localStorage) {
            TAB.Log.AddTaskComment('Disabling First Run Experience for pages.');
            FIRST_RUN_EXPERIENCE_KEYS.forEach(function (key) {
                localStorage.setItem(key, 'false');
            });
            localStorage.setItem(
            /* libraries/sp-coachmark-utility/src/FirstRunExperience/Constants */
            'CompletedFirstRunExp', '99.0');
        }
    };
    PageUtil.getQueryParamsString = function (spQueryParams) {
        var queryParams = [];
        if (spQueryParams.params) {
            queryParams.push(spQueryParams.params);
        }
        if (spQueryParams.loadSPFX) {
            queryParams.push("loadSPFX=true");
        }
        if (spQueryParams.noredir) {
            queryParams.push("noredir=true");
        }
        if (spQueryParams.debug) {
            queryParams.push("debug=true");
        }
        if (spQueryParams.customActions) {
            queryParams.push("customActions=" + spQueryParams.customActions);
        }
        if (spQueryParams.fieldCustomizers) {
            queryParams.push("fieldCustomizers=" + spQueryParams.fieldCustomizers);
        }
        if (spQueryParams.debugFlights) {
            // Positive flights are returned as "<flightNumber>"
            // Negative flights are returned as "!<flightNumber>"
            var flights = spQueryParams.debugFlights
                .map(function (flight) {
                return flight > 0 ? "" + flight : "!" + Math.abs(flight);
            })
                .join(',');
            queryParams.push("debugFlights=" + flights);
        }
        // Help catch various encoding issues that could break the experience by forcing
        // pseudo locale
        queryParams.push("market=qps-ploc");
        var queryParamsString = queryParams.join('&');
        return queryParamsString;
    };
    PageUtil.addPublishingPage = function (customPageName, clientContext, web, pageLayoutItem) {
        var newPublishingPage = SP.Publishing.PublishingWeb.getPublishingWeb(clientContext, web);
        var pageInfo = new SP.Publishing.PublishingPageInformation();
        pageInfo.set_name(customPageName);
        pageInfo.set_pageLayoutListItem(pageLayoutItem);
        var newPage = newPublishingPage.addPublishingPage(pageInfo);
        // Load the new page object to the client context
        clientContext.load(newPage);
        return new Promise(function (resolve, reject) {
            clientContext.executeQueryAsync(function () {
                resolve();
            }, function (sender, args) {
                reject(args.get_message());
            });
        });
    };
    PageUtil.GetPageLayout = function (web, clientContext) {
        return new Promise(function (resolveGetPageLayout, rejectGetPageLayout) {
            // Resolve or reject in the callback function
            var oList = web.get_lists().getByTitle('Master Page Gallery');
            // Get the page layout by ID using which we will create a publishing page
            var pageLayoutitem = oList.getItemById(539);
            // Load the client context and execute the batch
            clientContext.load(web);
            clientContext.load(pageLayoutitem);
            clientContext.executeQueryAsync(function () {
                resolveGetPageLayout(pageLayoutitem);
            }, function (sender, args) {
                rejectGetPageLayout("" + args.get_message());
            });
        });
    };
    PageUtil.executeQueryAsync = function (clientContext) {
        return new Promise(function (resolve, reject) {
            clientContext.executeQueryAsync(function () {
                resolve();
            }, function (sender, args) {
                reject(args.get_message());
            });
        });
    };
    PageUtil.waitForWelcomeDialogNotVisible = function () {
        return TAB.MakeWaiter(function () {
            return !PageUtil.WelcomeDialogExists();
        });
    };
    PageUtil.getCloseButtonForWelcomeDialog = function () {
        try {
            var closeButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="FirstRunCloseButton"]');
            return closeButton;
        }
        catch (e) {
            return undefined;
        }
    };
    /*
     * To enable scenarios executed as Active monitor to run
     * on real code instead of debug links
     */
    PageUtil.debugManifestRequired = true;
    /**
     * A random number between 1 and 100.
     * We want to use an unused page name when creating certain
     * types of pages. This number is appended to the page name.
     */
    PageUtil.pageNumber = Math.floor(Math.random() * 100 + 1);
    /**
     * Page creation attempts.
     */
    PageUtil.pageCreateAttempts = 0;
    /**
     * A flag for REST calls to create a page.
     * Often the 'create' and 'delete' occur in the test setup
     * and test teardown which run independently of one
     * another success. if the page is not successfully created in
     * the 'create' function then we don't want to bother trying to
     * delete the page in the 'delete' function.
     */
    PageUtil.createdPage = true;
    /**
     * A flag to keep track of the AddTaskCreateClassicPage status. Since
     * we call AddTaskCreateClassicPage recursively if we try to create a page
     * that already exists, we need a flag variable that is outside of the scope
     * of an individual task. We need this behavior as we need to reset the status
     * of the flag inside the task definition.
     */
    PageUtil.isPageCreateTaskFinished = false;
    return PageUtil;
}());



/***/ }),

/***/ "jfni":
/*!***********************************!*\
  !*** ./lib/SPTaskLib/UserUtil.js ***!
  \***********************************/
/*! exports provided: ADMIN_TAB_USER_INDEX, USER0_TAB_USER_INDEX, USER1_TAB_USER_INDEX, USER2_TAB_USER_INDEX, USER3_TAB_USER_INDEX, UserUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ADMIN_TAB_USER_INDEX", function() { return ADMIN_TAB_USER_INDEX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "USER0_TAB_USER_INDEX", function() { return USER0_TAB_USER_INDEX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "USER1_TAB_USER_INDEX", function() { return USER1_TAB_USER_INDEX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "USER2_TAB_USER_INDEX", function() { return USER2_TAB_USER_INDEX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "USER3_TAB_USER_INDEX", function() { return USER3_TAB_USER_INDEX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserUtil", function() { return UserUtil; });
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Next */ "BJbA");
/* harmony import */ var _WebLibrary__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WebLibrary */ "Ckxo");
/* harmony import */ var _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SPKillSwitchUtil */ "y5Zv");




// You can specify user account through the parameter of TAB.GetUser to 0 (admin), 1 (user0), 2 (user1), 3 (user2), and 4 (user3).
/**
 * @public
 */
var ADMIN_TAB_USER_INDEX = 0;
/**
 * @public
 */
var USER0_TAB_USER_INDEX = 1;
/**
 * @public
 */
var USER1_TAB_USER_INDEX = 2;
/**
 * @public
 */
var USER2_TAB_USER_INDEX = 3;
/**
 * @public
 */
var USER3_TAB_USER_INDEX = 4;
var EDIT_GROUP_NAME = 'Members';
var OWNER_GROUP_NAME = 'Owners';
var READ_GROUP_NAME = 'Visitors';
/**
 * @public
 */
var UserUtil = /** @class */ (function () {
    function UserUtil() {
        var _this = this;
        this._ownerGroup = 0;
        this._editGroup = 0;
        this._readGroup = 0;
        this._onGetSiteGroupsComplete = function (xhr, onComplete) {
            var _a;
            var success = true;
            switch (xhr.status) {
                case 200:
                    var groups = JSON.parse(xhr.response).value;
                    groups.map(function (group) {
                        if (group.Title.indexOf(EDIT_GROUP_NAME) > -1) {
                            _this._editGroup = group.Id;
                        }
                        if (group.Title.indexOf(OWNER_GROUP_NAME) > -1) {
                            _this._ownerGroup = group.Id;
                        }
                        if (group.Title.indexOf(READ_GROUP_NAME) > -1) {
                            _this._readGroup = group.Id;
                        }
                    });
                    break;
                default:
                    success = false;
                    _this._logXhrFailure(xhr);
                    break;
            }
            // Validate group id found for each group
            _this._validateGroupId(OWNER_GROUP_NAME, _this._ownerGroup);
            _this._validateGroupId(EDIT_GROUP_NAME, _this._editGroup);
            _this._validateGroupId(READ_GROUP_NAME, _this._readGroup);
            (_a = onComplete) === null || _a === void 0 ? void 0 : _a(success);
        };
        this._validateGroupId = function (groupTitle, groupId) {
            if (!groupId) {
                TAB.Log.Fail("Did not find " + groupTitle + " user group");
                return false;
            }
            TAB.Log.Comment(groupTitle + " id = " + groupId);
            return true;
        };
        this._onAddSitePermissionComplete = function (xhr, onComplete) {
            var _a;
            var success = true;
            switch (xhr.status) {
                case 200:
                    // user added to the group
                    break;
                default:
                    success = false;
                    _this._logXhrFailure(xhr);
                    break;
            }
            (_a = onComplete) === null || _a === void 0 ? void 0 : _a(success);
        };
        this._onRemoveSitePerissionComplete = function (xhr, onComplete) {
            var _a;
            var success = true;
            switch (xhr.status) {
                case 200:
                    // user removed from the group
                    break;
                case 404:
                    TAB.Log.AddTaskWarning('The TAB user was not found in the group. Deletion is not necessary.');
                    break;
                default:
                    success = false;
                    _this._logXhrFailure(xhr);
                    break;
            }
            (_a = onComplete) === null || _a === void 0 ? void 0 : _a(success);
        };
        this._logXhrFailure = function (xhr) {
            TAB.Log.Warning("XHR status: " + xhr.status);
            if (xhr.responseText) {
                TAB.Log.Warning("XHR responseText: " + xhr.responseText);
            }
        };
        this._getServerURL = function (siteName) {
            var rootSiteUrl = TAB.Settings.Get('ProductServerSet').split(';')[0];
            var siteRelativeUrl = "/" + _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].Path + "/" + siteName;
            return rootSiteUrl + siteRelativeUrl;
        };
        this._addTaskEnsureUserLogin = function (expectedUser) {
            // There are some cases after login a user it is not reflected immediately.
            // We will validate 3 times to make sure the current user is the user we tried to login.
            for (var i = 0; i < 3; i++) {
                _this._addTaskCheckUserLogin(expectedUser);
            }
        };
        this._addTaskCheckUserLogin = function (expectedUser) {
            _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_3__["SPKillSwitchUtil"].AddTaskWaitForPageContextReady();
            TAB.AddTask(TAB.MakeTask(function () {
                if (TAB.Win.document.documentElement.innerText.indexOf(expectedUser.LoginName)) {
                    TAB.Log.Pass('User has logged in successfully');
                }
                else {
                    TAB.Log.Warning("User has not logged in yet.");
                    TAB.Log.AddTaskComment('Try logging again');
                    TAB.AddTaskLoginAsAnotherUser(expectedUser);
                }
            }));
        };
    }
    UserUtil.prototype.AddTaskLoginAsUser = function (user) {
        var oldPageReference = 'oldPage';
        TAB.Log.AddTaskComment("Log in as " + user.LoginName + ".");
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Win.document[oldPageReference] = true;
        }));
        TAB.AddTaskLoginAsAnotherUser(user);
        this._addTaskEnsureUserLogin(user);
        _SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_3__["SPKillSwitchUtil"].AddTaskWaitForPageContextReady();
        TAB.Log.AddTaskComment("Performance Test setup is ready.");
    };
    UserUtil.prototype.AddTaskEnsureSiteReadOnlyPermission = function (siteName, user, onComplete) {
        var _this = this;
        var serverUrl = this._getServerURL(siteName);
        var userInfo = {};
        TAB.AddTask(TAB.MakeTask(function () {
            _this._addTaskGetSiteGroups(serverUrl, onComplete);
        }), TAB.MakeWaiter(function () {
            return _this._readGroup && _this._ownerGroup && _this._editGroup;
        }));
        this._addTaskAddSiteReadPermission(serverUrl, user, onComplete);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get user info for ' + user.LoginName);
            _WebLibrary__WEBPACK_IMPORTED_MODULE_2__["Web"].addCsomTaskGetUserFromWeb(user.LoginName, userInfo);
        }), TAB.MakeWaiter(function () {
            return userInfo.id !== undefined;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('User info: ' + JSON.stringify(userInfo));
            _this._addTaskRemoveSitePermission(serverUrl, userInfo.id, _this._ownerGroup, onComplete);
            _this._addTaskRemoveSitePermission(serverUrl, userInfo.id, _this._editGroup, onComplete);
        }));
    };
    UserUtil.prototype._addTaskGetSiteGroups = function (serverUrl, onComplete) {
        var _this = this;
        var restResult = {};
        TAB.AddTask(TAB.MakeTask(function () {
            _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendGetRequest(serverUrl, serverUrl + "/_api/web/sitegroups", restResult, function (xhr) {
                return _this._onGetSiteGroupsComplete(xhr, onComplete);
            });
        }));
    };
    UserUtil.prototype._addTaskRemoveSitePermission = function (serverUrl, userId, group, onComplete) {
        var _this = this;
        var restResult = {};
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Remove user from group {id: " + group + "} so it has no edit permission.");
            _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendRestRequest(serverUrl, serverUrl + "/_api/web/sitegroups(id=" + group + ")/users/removebyid(id=" + userId + ")", '', restResult, true, // fetchCanary
            'POST', function (xhr) { return _this._onRemoveSitePerissionComplete(xhr, onComplete); });
        }));
    };
    UserUtil.prototype._addTaskAddSiteReadPermission = function (serverUrl, user, onComplete) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Add user {" + user.LoginName + "} to visitors group {id: " + _this._readGroup + "} so it has read permission.");
            var body = {
                url: serverUrl,
                peoplePickerInput: "[{\"Key\":\"" + user.LoginName + "\",\"IsResolved\":false}]",
                roleValue: "group:" + _this._readGroup,
                sendEmail: false
            };
            var retVal = {};
            _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendRestRequest(serverUrl, serverUrl + "/_api/SP.Web.ShareObject", JSON.stringify(body), retVal, true, // fetchCanary
            'POST', function (xhr) { return _this._onAddSitePermissionComplete(xhr, onComplete); });
        }));
    };
    return UserUtil;
}());



/***/ }),

/***/ "jj/V":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/Pages/Workbench.js ***!
  \******************************************/
/*! exports provided: Workbench */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Workbench", function() { return Workbench; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _PageUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../PageUtil */ "jK1H");


/**
 * @public
 */
var Workbench = /** @class */ (function () {
    function Workbench() {
    }
    Workbench.PageReady = function (expectedTitle) {
        return TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'workbenchPageContent'), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='toolboxHint-webPart']"));
    };
    /**
     * Clicks the "Ok" button on the warning dialog that appears when
     * 'gulp serve' is not running.
     */
    Workbench.AddTaskClearWarningDialog = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='GulpServeWarningOkButton']");
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clear warning dialog');
            var confirmButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win, 'GulpServeWarningOkButton');
            TAB.ClickElement(confirmButton);
        }));
    };
    Workbench.AddTaskSavePage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var saveButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(Workbench.GetCommandBar(), 'pageCommandBarSaveButton');
            TAB.ClickElement(saveButton);
        }), TAB.MakeWaiter(function () {
            Workbench.PageUrl = _PageUtil__WEBPACK_IMPORTED_MODULE_1__["PageUtil"].GetPageUrl();
            return !Workbench.editMode;
        }));
    };
    Object.defineProperty(Workbench, "editMode", {
        get: function () {
            return TAB.Win.location.search.indexOf('Mode=Edit') > -1;
        },
        enumerable: true,
        configurable: true
    });
    Workbench.GetCommandBar = function () {
        // using check mark to decide if the page has been saved
        try {
            var commandBar = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'workbenchCommandBar');
            return commandBar;
        }
        catch (e) {
            return undefined;
        }
    };
    Workbench.Webparts = [];
    return Workbench;
}());



/***/ }),

/***/ "kQju":
/*!*********************************************************!*\
  !*** ./lib/SPTaskLib/Controls/BaseCollectionWebPart.js ***!
  \*********************************************************/
/*! exports provided: BaseCollectionWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseCollectionWebPart", function() { return BaseCollectionWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");


/**
 * @public
 */
var BaseCollectionWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(BaseCollectionWebPart, _super);
    function BaseCollectionWebPart() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Get +Add button element on BaseCollectionWebPart if exists. Otherwise it will return undefined.
     */
    BaseCollectionWebPart.prototype.GetAddButton = function () {
        try {
            if (this.ShouldHaveAddButton) {
                return TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'add-');
            }
            else {
                return undefined;
            }
        }
        catch (e) {
            return undefined;
        }
    };
    /**
     * Get 'see all' link element on BaseCollectionWebPart if exists. Otherwise it will return undefined.
     */
    BaseCollectionWebPart.prototype.GetSeeAllLink = function () {
        try {
            if (this.ShouldHaveSeeAllLink) {
                return TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'seeAll-');
            }
            else {
                return undefined;
            }
        }
        catch (e) {
            return undefined;
        }
    };
    Object.defineProperty(BaseCollectionWebPart.prototype, "ShouldHaveAddButton", {
        /**
         * Whether web part has an add button for adding a new item. It is a setting for BaseCollectionWebPart.
         */
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseCollectionWebPart.prototype, "ShouldHaveSeeAllLink", {
        /**
         * Whether web part has a 'see all' link. It is a setting for BaseCollectionWebPart.
         */
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    return BaseCollectionWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "lIY2":
/*!*********************************************!*\
  !*** ./lib/SPTaskLib/Controls/EventPage.js ***!
  \*********************************************/
/*! exports provided: EventPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventPage", function() { return EventPage; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");


/**
 * @public
 */
var EventPage = /** @class */ (function () {
    function EventPage(previousPageUrl) {
        this._previousPageUrl = previousPageUrl;
    }
    EventPage.prototype.AddTaskInputEventTitle = function (title) {
        var titleInput = undefined;
        var shouldCheckTitle = false;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Event page inputs event title.');
            titleInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="pageTitleInput"]');
            var focusEv = TAB.Win.document.createEvent('HTMLEvents');
            focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
            titleInput.dispatchEvent(focusEv);
            titleInput.value = title;
            var ev = TAB.Win.document.createEvent('HTMLEvents');
            ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
            titleInput.dispatchEvent(ev);
            // It's work around for avoid event tab failure caused by an regression bug,
            // we should remove it when we solve the regression bug, use VSO#SOX#TASK#753616 to track.
            // The work around is to defer check title value 2000ms.
            setTimeout(function () {
                // press Enter
                TAB.FireKeyboardEvent(titleInput, 'keydown', 13);
                var blurEv = TAB.Win.document.createEvent('HTMLEvents');
                blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
                titleInput.dispatchEvent(blurEv);
                shouldCheckTitle = true;
            }, 2000);
        }), TAB.MakeWaiter(function () { return titleInput && titleInput.value === title && shouldCheckTitle; }));
    };
    EventPage.prototype.AddTaskInputEventLink = function (link) {
        var addressInput = undefined;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Event page inputs event link.');
            addressInput = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'eventPageEditableLinkInput');
            addressInput.focus();
            _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(addressInput, link);
        }), TAB.MakeWaiter(function () { return addressInput && addressInput.value !== '' && addressInput.value !== undefined; }));
    };
    EventPage.prototype.AddTaskInputLocation = function (locationValue) {
        var locationInput;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Event page inputs event location.');
            locationInput = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="locationTextField"]')[0];
            locationInput.focus();
            _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(locationInput, locationValue);
        }), TAB.MakeWaiter(function () { return locationInput && locationInput.value !== '' && locationInput.value !== undefined; }));
    };
    EventPage.prototype.AddTaskInputEventDate = function () {
        var startAtIcon;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Event page inputs event date.');
            var startDatePicker = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-DatePicker')[0];
            startAtIcon = TAB.GetElement(startDatePicker, TAB.searchBy.tag, 'i');
            TAB.ClickElement(startAtIcon);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'ms-DatePicker-callout'));
        TAB.AddTask(TAB.MakeTask(function () {
            var dateCollection = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-DatePicker-day');
            var startAtDate = dateCollection[dateCollection.length - 1];
            TAB.ClickElement(startAtDate);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-DatePicker-callout');
        }));
        var endAtIcon;
        TAB.AddTask(TAB.MakeTask(function () {
            var endDatePicker = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-DatePicker')[1];
            endAtIcon = TAB.GetElement(endDatePicker, TAB.searchBy.tag, 'i');
            TAB.ClickElement(endAtIcon);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'ms-DatePicker-callout'));
        TAB.AddTask(TAB.MakeTask(function () {
            var dateCollection = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-DatePicker-day');
            var endAtDate = dateCollection[dateCollection.length - 1];
            TAB.ClickElement(endAtDate);
        }), TAB.MakeWaiter(function () {
            return (!TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-DatePicker-callout') &&
                !TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'ms-MessageBar--error'));
        }));
    };
    EventPage.prototype.AddTaskSaveEvent = function () {
        var _this = this;
        TAB.AddTask(undefined, // do nothing
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'eventPageSaveButton'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Event page saves event.');
            var saveButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="eventPageSaveButton"]');
            TAB.ClickElement(saveButton);
        }), TAB.MakeWaiter(function () { return _this.InReadMode; }));
    };
    EventPage.prototype.AddTaskEditEvent = function () {
        var _this = this;
        TAB.AddTask(undefined, // do nothing
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'eventPageEditButton'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Event page starts editing.');
            var editButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="eventPageEditButton"]');
            TAB.ClickElement(editButton);
        }), TAB.MakeWaiter(function () { return _this.InEditMode; }));
    };
    EventPage.prototype.AddTaskDeleteEvent = function () {
        TAB.AddTask(undefined, // do nothing
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'eventPageDeleteButton'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Event page deletes current event.');
            var deleteBtn = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="eventPageDeleteButton"]');
            TAB.ClickElement(deleteBtn);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="yesButton"]');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var yesBtn = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="yesButton"]');
            TAB.ClickElement(yesBtn);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="eventPageDeleteButton"]');
        }));
    };
    EventPage.prototype.AddTaskNavigateBack = function (ensureEventItem) {
        var _this = this;
        if (ensureEventItem === void 0) { ensureEventItem = false; }
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Event page navigates back to previous web-part-hosting site page.');
            TAB.LoadPage(_this._previousPageUrl).WaitFor(TAB.PageReady());
        }), TAB.MakeWaiter(function () {
            return ((TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="pageCommandBarPublishButton"]') ||
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="pageCommandBarEditButton"]')) &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="event-card-title"]'));
        }));
    };
    Object.defineProperty(EventPage.prototype, "InEditMode", {
        get: function () {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="autoSuggestionContainer"]') &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="pageTitleInput"]') &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="eventPageSaveButton"]') &&
                !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ProgressIndicator'));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EventPage.prototype, "InReadMode", {
        get: function () {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="seeAllEvents"]') &&
                !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-dialogMainOverride') &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="eventPageEditButton"]'));
        },
        enumerable: true,
        configurable: true
    });
    return EventPage;
}());



/***/ }),

/***/ "ldKH":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/Pages/PromotePage.js ***!
  \********************************************/
/*! exports provided: PromotePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PromotePage", function() { return PromotePage; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");

/**
 * @public
 */
var PromotePage = /** @class */ (function () {
    function PromotePage() {
    }
    PromotePage.AddTaskWaitForManagePagePanel = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return PromotePage.GetAddToNavButton();
        }));
    };
    PromotePage.AddTaskClickAddToNav = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Adding page to the nav');
            var addToNavButton = PromotePage.GetAddToNavButton();
            TAB.ClickElement(addToNavButton);
        }), TAB.MakeWaiter(function () {
            var addToNavButton = PromotePage.GetAddToNavButton();
            return addToNavButton.classList.contains('is-disabled');
        }));
    };
    PromotePage.AddTaskPostAsNews = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Posting page as news');
            var postToNewsButton = PromotePage.GetPostToNewsButton();
            TAB.ClickElement(postToNewsButton);
        }), TAB.MakeWaiter(function () {
            var postToNewsButton = PromotePage.GetPostToNewsButton();
            return postToNewsButton.classList.contains('is-disabled');
        }));
    };
    PromotePage.AddTaskSendEmail = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Opening the send by email dialog');
            var emailButton = PromotePage.GetEmailButton();
            TAB.ClickElement(emailButton);
        }), PromotePage.WaitForEmailDialog());
    };
    PromotePage.AddTaskCloseEmailDialog = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var cancelEmailButton = PromotePage.GetCancelEmailButton();
            TAB.ClickElement(cancelEmailButton);
        }), TAB.MakeWaiter(function () {
            var emailDialog = PromotePage.GetEmailDialog();
            return !emailDialog;
        }));
    };
    PromotePage.AddTaskCheckCopyLink = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            TAB.Log.Comment('Verifying the copy link is same as window');
            var windowUrl = TAB.Win.window.location.href.split('?')[0];
            var textField = PromotePage.GetUrltextField();
            return windowUrl === textField.innerHTML.split('?')[0];
        }));
    };
    PromotePage.AddTaskCheckLinkAddedToNav = function (pageTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            var horizontalLinks = PromotePage.GetHorizontalNavLinks();
            if (!horizontalLinks || horizontalLinks.length === 0) {
                // No horizontal nav, check left nav
                PromotePage.AddTaskCheckLinkAddedToLeftNav(pageTitle);
            }
            else {
                // Check horizontal nav
                PromotePage.AddTaskCheckLinkAddedToHorizontalNav(pageTitle);
            }
        }));
    };
    PromotePage.WaitForEmailDialog = function () {
        return TAB.MakeWaiter(function () {
            return PromotePage.GetEmailDialog();
        });
    };
    PromotePage.WaitForAddedToHorizontalNav = function (pageTitle) {
        return TAB.MakeWaiter(function () {
            TAB.Log.Comment('If contextual menu is open, check overflow links');
            var contextualMenuCallout = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-ContextualMenu-Callout');
            if (contextualMenuCallout.length > 0) {
                var overFlowLinks = PromotePage.GetOverflowLinks();
                for (var _i = 0, overFlowLinks_1 = overFlowLinks; _i < overFlowLinks_1.length; _i++) {
                    var link = overFlowLinks_1[_i];
                    if (link.innerText === pageTitle) {
                        return true;
                    }
                }
            }
            TAB.Log.Comment('If contextual menu is not open, check regular links');
            var navLinks = PromotePage.GetHorizontalNavLinks();
            for (var _a = 0, navLinks_1 = navLinks; _a < navLinks_1.length; _a++) {
                var link = navLinks_1[_a];
                if (link.innerText === pageTitle) {
                    return true;
                }
            }
            TAB.Log.Comment('If not found it in regular links, try opening the overflow');
            var overflowButton = PromotePage.GetOverflowButton();
            if (overflowButton) {
                overflowButton.click();
            }
            return false;
        });
    };
    PromotePage.WaitForAddedToLeftNav = function (pageTitle) {
        return TAB.MakeWaiter(function () {
            var navLinks = PromotePage.GetLeftNavLinks();
            for (var _i = 0, navLinks_2 = navLinks; _i < navLinks_2.length; _i++) {
                var link = navLinks_2[_i];
                if (link.innerText === pageTitle) {
                    return true;
                }
            }
            return false;
        });
    };
    PromotePage.AddTaskCheckLinkAddedToHorizontalNav = function (pageTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Verifying page was added to horizontal nav');
            var overflowButton = PromotePage.GetOverflowButton();
            if (overflowButton) {
                overflowButton.click();
            }
        }), PromotePage.WaitForAddedToHorizontalNav(pageTitle));
    };
    PromotePage.AddTaskCheckLinkAddedToLeftNav = function (pageTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Verifying page was added to left nav');
        }), PromotePage.WaitForAddedToLeftNav(pageTitle));
    };
    PromotePage.GetEmailDialog = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dialog-main')[0];
    };
    PromotePage.GetManagePagePanel = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-Panel-main')[0];
    };
    PromotePage.GetHorizontalNavLinks = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-HorizontalNavItem-link');
    };
    PromotePage.GetLeftNavLinks = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-Nav-navItem');
    };
    PromotePage.GetOverflowButton = function () {
        try {
            var overflowElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='HorizontalNav-overflow']");
            var overflowButton = TAB.GetElement(overflowElement, TAB.searchBy.tag, 'button');
            return overflowButton;
        }
        catch (e) {
            return undefined;
        }
    };
    PromotePage.GetOverflowLinks = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-ContextualMenu-item');
    };
    PromotePage.GetCancelEmailButton = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dialog-button--close')[0];
    };
    PromotePage.GetAddToNavButton = function () {
        try {
            var addToNavButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(PromotePage.GetManagePagePanel(), 'promoteAddToNav');
            return addToNavButton;
        }
        catch (e) {
            return undefined;
        }
    };
    PromotePage.GetPostToNewsButton = function () {
        try {
            var postToNewsButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(PromotePage.GetManagePagePanel(), 'promotePostToNews');
            return postToNewsButton;
        }
        catch (e) {
            return undefined;
        }
    };
    PromotePage.GetEmailButton = function () {
        try {
            var emailButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(PromotePage.GetManagePagePanel(), 'promoteEmail');
            return emailButton;
        }
        catch (e) {
            return undefined;
        }
    };
    PromotePage.GetUrltextField = function () {
        try {
            var textField = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(PromotePage.GetManagePagePanel(), 'promoteUrlTextField');
            return textField;
        }
        catch (error) {
            return undefined;
        }
    };
    return PromotePage;
}());



/***/ }),

/***/ "m/ZX":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/PlannerWebpart.js ***!
  \**************************************************/
/*! exports provided: PlannerWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlannerWebpart", function() { return PlannerWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");





/**
 * @public
 */
var PlannerWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(PlannerWebpart, _super);
    function PlannerWebpart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Planner, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Planner.toString()) || this;
    }
    /**
     * Checks if AAD service is available
     */
    PlannerWebpart.prototype.isAADServiceAvailable = function (aadServiceValidationResult) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Making sure AAD service is available');
            if (!aadServiceValidationResult.isAADServiceAvailable) {
                TAB.Log.DidNotRun('ADD Service is not available');
                return false;
            }
        }));
        return true;
    };
    /**
     * Add a page, switch to an edit mode and wait until property pane is open.
     */
    PlannerWebpart.prototype.addEditPage = function (pageTitle) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Adding a page, switch to an edit more and wait until property pane is open');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskEditPage();
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskAddPageTitle(pageTitle);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='toolboxHint-webPart']"));
    };
    /**
     * Add Webpart to the page
     */
    PlannerWebpart.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Adding webpart to a page.');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }));
    };
    /**
     * Click on the 'Add a new plan' button
     */
    PlannerWebpart.prototype.clickAddPlanButton = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Clicking on the '+ Add a new plan' button.");
            var addPlanButton = TAB.GetElements(_this._getPropertyPane(), TAB.searchBy.tag, 'BUTTON')[1];
            TAB.ClickElement(addPlanButton);
        }), TAB.WaitForElementToExist(_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].GetPropertyPane(), TAB.searchBy.tag, 'INPUT'));
    };
    /**
     * Enter a new plan name to the input property pane text-field.
     */
    PlannerWebpart.prototype.addPlan = function (name) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Making sure PropertyPane is Open');
        }), TAB.AndWaiters(this._createWaiterForPropertyPaneContainer(), TAB.WaitForElementToExist(_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].GetPropertyPane(), TAB.searchBy.tag, 'INPUT')));
        // Enter the plan name
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Entering a new plan name to an input-field: ' + name);
            var inputForPlan = TAB.GetElements(_this._getPropertyPane(), TAB.searchBy.tag, 'INPUT')[0];
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(inputForPlan, name);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage'));
    };
    /**
     * Click on create plan button
     */
    PlannerWebpart.prototype.clickPlanCreateButton = function () {
        var _this = this;
        this._waitForPlanNameTextField();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Clicking on 'Create' button");
            var createButton = TAB.GetElement(_this._getPropertyPane(), TAB.searchBy.hasClassName, 'ms-Button');
            TAB.ClickElement(createButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'taskBoardView'));
    };
    /**
     * Creates a new task
     * @param taskName - Name for a new task
     */
    PlannerWebpart.prototype.createTask = function (taskName) {
        this._waitForAddNewbutton();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Clicking on '+' button in the Planner task board to add a new task");
            var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
            // Add a task to first bucket
            var plusButton = TAB.GetElements(planTaskBoard, TAB.searchBy.hasClassName, 'addButton')[0];
            TAB.ClickElement(plusButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'addControlContainer'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Enter a task name: ' + taskName);
            var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
            var addControlContainer = TAB.GetElement(planTaskBoard, TAB.searchBy.hasClassName, 'addControlContainer');
            var inputElementForTask = TAB.GetElements(addControlContainer, TAB.searchBy.tag, 'INPUT')[0];
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(inputElementForTask, taskName);
            TAB.Log.Comment("Click on 'Add Task' button");
            var addTaskButton = TAB.GetElement(addControlContainer, TAB.searchBy.hasClassName, 'addTaskButton');
            TAB.ClickElement(addTaskButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'taskCard'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Dismiss add task card');
            var addControlContainer = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'addControlContainer');
            var closeAddTaskCard = TAB.GetElement(addControlContainer, TAB.searchBy.hasClassName, 'closeAddTaskCard');
            TAB.ClickElement(closeAddTaskCard);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.partialClassName, 'addControlContainer');
        }));
    };
    /**
     * Open task details
     * @param taskName - Name of a task
     */
    PlannerWebpart.prototype.openTaskDetails = function (taskName) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Opening task: ' + taskName);
            var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
            var taskCards = TAB.GetElements(planTaskBoard, TAB.searchBy.hasClassName, 'taskBoardCard');
            // Open the task that was created by this test run.
            for (var _i = 0, taskCards_1 = taskCards; _i < taskCards_1.length; _i++) {
                var card = taskCards_1[_i];
                var taskCard = TAB.GetElement(card, TAB.searchBy.hasClassName, 'title');
                if (taskCard && taskCard.textContent === taskName) {
                    TAB.ClickElement(taskCard);
                    break;
                }
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'taskDetailsEditor'));
    };
    /**
     * Renames task title
     */
    PlannerWebpart.prototype.renameTaskTitle = function (newTaskName) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Changing task title in task details dialog');
            var taskDetailsEditor = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'taskDetailsEditor');
            var title = TAB.GetElement(taskDetailsEditor, TAB.searchBy.hasClassName, 'title');
            var input = TAB.GetElement(title, TAB.searchBy.tag, 'input');
            TAB.Log.Comment('Before: ' + input.value);
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(input, newTaskName);
            TAB.ClickElement(TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dialog-header'));
        }), TAB.MakeWaiter(function () {
            var taskDetailsEditor2 = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'taskDetailsEditor');
            var title2 = TAB.GetElement(taskDetailsEditor2, TAB.searchBy.hasClassName, 'title');
            var input2 = TAB.GetElement(title2, TAB.searchBy.tag, 'input');
            TAB.Log.Comment('After: ' + input2.value);
            return input2.value === newTaskName;
        }));
    };
    /**
     * Dismiss task details dialog
     */
    PlannerWebpart.prototype.closeTaskDetails = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Closing task details');
            var plannerAppDialog = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'plannerAppDialog');
            var topButton = TAB.GetElement(plannerAppDialog, TAB.searchBy.hasClassName, 'ms-Dialog-topButton');
            var button = TAB.GetElements(topButton, TAB.searchBy.tag, 'button')[1];
            TAB.ClickElement(button);
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('Making sure task details editor is dismissed');
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'taskDetailsEditor');
        }));
    };
    /**
     * Open the progress dropdown
     */
    PlannerWebpart.prototype.openProgress = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Opening progress dropdown');
            var dropdownTuple = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'dropdownTuple')[1];
            var dropDown = TAB.GetElement(dropdownTuple, TAB.searchBy.hasClassName, 'taskProgress');
            TAB.ClickElement(dropDown);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Callout-main'));
    };
    /**
     * Change the state of the task
     */
    PlannerWebpart.prototype.changeProgress = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Changing the task status to in-progress');
            var callout = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Callout-main');
            var inProgress = TAB.GetElements(callout, TAB.searchBy.tag, 'button');
            // 0: Not started, 1: In Progress, 2: Complete
            TAB.ClickElement(inProgress[1]);
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('Making sure callout is dismissed');
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-Callout-main');
        }));
    };
    /**
     * Deletes a task
     */
    PlannerWebpart.prototype.deleteTask = function (taskName, deleteAll) {
        var _this = this;
        if (deleteAll === void 0) { deleteAll = false; }
        TAB.AddTask(TAB.MakeTask(function () {
            var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
            var taskCards = TAB.GetElements(planTaskBoard, TAB.searchBy.hasClassName, 'taskBoardCard');
            // Delete a task that was created by this test run.
            for (var i = taskCards.length - 1; i >= 0; --i) {
                var taskTitle = TAB.GetElement(taskCards[i], TAB.searchBy.hasClassName, 'title');
                if (taskTitle) {
                    if (deleteAll) {
                        _this._openContextMenuOnTaskCard(taskCards[i]);
                        _this._clickDeleteBtnInContextMenuOnTaskCard(taskTitle.textContent);
                    }
                    else {
                        // Delete ONLY the task that was created by this test instance
                        if (taskTitle.textContent === taskName) {
                            _this._openContextMenuOnTaskCard(taskCards[i]);
                            _this._clickDeleteBtnInContextMenuOnTaskCard(taskTitle.textContent);
                            break;
                        }
                    }
                }
            }
        }), TAB.MakeWaiter(function () {
            var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
            var taskCards = TAB.GetElements(planTaskBoard, TAB.searchBy.hasClassName, 'taskBoardCard');
            // Making sure deleted task doesn't exist in the taskboard.
            for (var _i = 0, taskCards_2 = taskCards; _i < taskCards_2.length; _i++) {
                var card = taskCards_2[_i];
                var taskCard = TAB.GetElement(card, TAB.searchBy.hasClassName, 'title');
                if (taskCard && taskCard.textContent === taskName) {
                    TAB.Log.Comment('Deleted task found. Not good. Should have been deleted by the cleanup task.');
                    return false;
                }
            }
            TAB.Log.Comment('Deleted task not found. Which is good. It means cleanup task did its job and deleted the task.');
            return true;
        }));
    };
    /**
     * Returns the total number of tasks
     */
    PlannerWebpart.prototype.getTasksCount = function () {
        var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
        return TAB.GetElements(planTaskBoard, TAB.searchBy.hasClassName, 'taskBoardCard').length;
    };
    /**
     * Wait until plan board is loaded in the page
     */
    PlannerWebpart.prototype.waitForPlanTaskboardPage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Making sure planTaskboardPage exists");
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage'));
    };
    /**
     * Open contextual menu from a task card
     */
    PlannerWebpart.prototype._openContextMenuOnTaskCard = function (card) {
        TAB.AddTask(TAB.MakeTask(function () {
            var taskTitle = TAB.GetElement(card, TAB.searchBy.hasClassName, 'title');
            TAB.Log.Comment("Trying to click on 'more' section on : " + taskTitle.textContent);
            if (card) {
                var rightSection = TAB.GetElement(card, TAB.searchBy.hasClassName, 'otherCommands');
                if (rightSection) {
                    TAB.ClickElement(rightSection);
                }
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-Callout'));
    };
    /**
     * Click on the delete button in Contexual menu on task card
     */
    PlannerWebpart.prototype._clickDeleteBtnInContextMenuOnTaskCard = function (taskName) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for a contextual menu callout');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-Callout'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Deleting: ' + taskName);
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-Callout')) {
                TAB.Log.Comment("Clicking on 'Delete' button in taskCard context menu");
                var contextualMenu = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-list');
                var deleteButton = TAB.GetElements(contextualMenu, TAB.searchBy.tag, 'BUTTON')[2];
                if (deleteButton) {
                    TAB.ClickElement(deleteButton);
                    TAB.Log.Comment('Deleted: ' + taskName);
                }
            }
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-Callout');
        }));
    };
    /**
     * Wait for a text-field to enter the plan name
     */
    PlannerWebpart.prototype._waitForPlanNameTextField = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for text-field to exist to enter a plan name');
        }), TAB.WaitForElementToExist(_Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].GetPropertyPane(), TAB.searchBy.tag, 'INPUT'));
    };
    /**
     * Wait for add new task button
     */
    PlannerWebpart.prototype._waitForAddNewbutton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for a add new plan button');
        }), TAB.MakeWaiter(function () {
            var planTaskBoard = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'planTaskboardPage');
            return TAB.ElementExists(planTaskBoard, TAB.searchBy.hasClassName, 'addButton');
        }));
    };
    /**
     * Wait for the property pane
     */
    PlannerWebpart.prototype._createWaiterForPropertyPaneContainer = function () {
        return TAB.MakeWaiter(function () {
            TAB.Log.Comment('Making sure PropertyPane is open.');
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
        });
    };
    /**
     * Get the property pane
     */
    PlannerWebpart.prototype._getPropertyPane = function () {
        try {
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            return propertyPane;
        }
        catch (e) {
            TAB.Log.Comment('PropertyPane is closed.');
            return undefined;
        }
    };
    return PlannerWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "m98m":
/*!*******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/YammerConversations.js ***!
  \*******************************************************/
/*! exports provided: YammerConversations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YammerConversations", function() { return YammerConversations; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Next */ "BJbA");




/**
 * @public
 */
var YammerConversations = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(YammerConversations, _super);
    function YammerConversations() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].YammerConversations, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].YammerConversations.toString()) || this;
    }
    YammerConversations.prototype.AddWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), TAB.AndWaiters(this._waitForPlaceholder(), this._waitForOpenPropertyPane()));
    };
    YammerConversations.prototype.AddTaskClickFeedTypeDropdown = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var feedTypeDropdown = _this._feedTypeDropdown;
            if (!feedTypeDropdown) {
                throw 'Feed type dropdown not found';
            }
            TAB.ClickElement(feedTypeDropdown);
        }), this._waitForFeedTypeOptionHome());
    };
    YammerConversations.prototype.AddTaskClickHomeFeedType = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var home = _this._feedTypeOptionHome;
            if (!home) {
                throw 'Home feed type option not found';
            }
            TAB.ClickElement(home);
        }));
    };
    YammerConversations.prototype.AddTaskAddHomeFeed = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var feedTypeDropdown = _this._feedTypeDropdown;
            if (!feedTypeDropdown) {
                throw 'Feed type dropdown not found';
            }
            _this.AddTaskClickFeedTypeDropdown();
            _this.AddTaskClickHomeFeedType();
        }));
    };
    YammerConversations.prototype.CheckForWebpartContent = function () {
        TAB.AddTask(undefined, TAB.OrWaiters(this._waitForPlaceholderFetchError(), this._waitForFeedHeader()));
    };
    YammerConversations.prototype._waitForOpenPropertyPane = function () {
        TAB.Log.Comment('Property pane should open if there is no feed configured');
        return TAB.AndWaiters(TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"showPane\"]"), this._waitForFeedTypeDropdown()), this._waitForFeedIdPicker());
    };
    YammerConversations.prototype._propertyPane = function () {
        return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"showPane\"]");
    };
    YammerConversations.prototype._waitForFeedHeader = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var el = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(_this.root, 'yammer_feed');
                if (el) {
                    TAB.Log.Comment('Feed header found');
                }
                return !!el;
            }
            catch (ex) {
                return false;
            }
        });
    };
    YammerConversations.prototype._waitForPlaceholderFetchError = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var el = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(_this.root, 'placeholderContainerFetchError');
            if (el) {
                TAB.Log.DidNotRun('data-automation-id placeholderContainerFetchError found');
            }
            return !!el;
        });
    };
    YammerConversations.prototype._waitForFeedTypeDropdown = function () {
        var _this = this;
        TAB.Log.Comment('Wait for feed type dropdown to exist');
        return TAB.MakeWaiter(function () {
            try {
                var el = _this._feedTypeDropdown;
                if (el) {
                    TAB.Log.Comment('Feed type dropdown found');
                }
                return !!el;
            }
            catch (ex) {
                return false;
            }
        });
    };
    YammerConversations.prototype._waitForFeedTypeOptionHome = function () {
        var _this = this;
        TAB.Log.Comment('Wait for feed type option "Home" to exist');
        return TAB.MakeWaiter(function () {
            try {
                var el = _this._feedTypeOptionHome;
                if (el) {
                    TAB.Log.Comment('Feed type option "Home" found');
                }
                return !!el;
            }
            catch (ex) {
                return false;
            }
        });
    };
    YammerConversations.prototype._waitForFeedIdPicker = function () {
        var _this = this;
        TAB.Log.Comment('Wait for feed id picker to exist');
        return TAB.MakeWaiter(function () {
            var el = _this._feedIdPicker;
            if (el) {
                TAB.Log.Comment('Feed id picker found');
            }
            return !!el;
        });
    };
    Object.defineProperty(YammerConversations.prototype, "_feedTypeDropdown", {
        get: function () {
            TAB.Log.Comment('Getting feed type dropdown element');
            var feedTypeDropdown = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(this._propertyPane(), 'yammer_feedTypeDropdown');
            var clickableFeedTypeDropdown = TAB.GetElement(feedTypeDropdown, TAB.searchBy.customQuery, 'div[data-is-focusable="true"]');
            if (clickableFeedTypeDropdown) {
                TAB.Log.Comment('Found feed type dropdown');
            }
            return clickableFeedTypeDropdown;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(YammerConversations.prototype, "_feedIdPicker", {
        get: function () {
            TAB.Log.Comment('Getting feed id picker element');
            var feedIdPicker = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementByDataAutomationId(this._propertyPane(), 'yammer_feedIdPicker');
            if (feedIdPicker) {
                TAB.Log.Comment('Found feed id picker');
            }
            return feedIdPicker;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(YammerConversations.prototype, "_feedTypeOptionHome", {
        get: function () {
            TAB.Log.Comment('Getting feed type options list element');
            var feedTypeOptionsList = _Next__WEBPACK_IMPORTED_MODULE_3__["Next"].GetElementsByDataAutomationId(TAB.Win, 'yammer_feedTypeOption');
            if (!feedTypeOptionsList || feedTypeOptionsList.length <= 1) {
                throw 'Feed type options list not found, or "Home" not found';
            }
            TAB.Log.Comment('Feed type "Home" option found');
            return feedTypeOptionsList[4];
        },
        enumerable: true,
        configurable: true
    });
    return YammerConversations;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "mJeo":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/Controls/SuiteNav.js ***!
  \********************************************/
/*! exports provided: SuiteNav */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SuiteNav", function() { return SuiteNav; });
// Disabling typedef to have the same code in sp-client and odsp-next
// TAB.GetElements may return a HTMLElement[] or a NodeListOf<HTMLElement>
// tslint:disable:typedef
/**
 * @public
 */
var SuiteNav = /** @class */ (function () {
    function SuiteNav() {
    }
    SuiteNav.AddTaskWaitForSuiteNav = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'O365_NavHeader'));
    };
    SuiteNav.AddTaskVerifySuiteNav = function () {
        this.AddTaskWaitForSuiteNav();
        TAB.AddTask(TAB.MakeTask(function () {
            var suiteNav = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365_NavHeader');
            TAB.Log.Verify(!!suiteNav && !!suiteNav[0], 'Verify suiteNav found in the page');
        }));
    };
    SuiteNav.AddTaskWaitForProductName = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'O365_AppName'));
    };
    SuiteNav.AddTaskVerifyProductName = function (linkUrl) {
        var _this = this;
        this.AddTaskWaitForProductName();
        TAB.AddTask(TAB.MakeTask(function () {
            var productNameElements = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365_AppName');
            if (productNameElements.length === 0) {
                _this.AddTaskClickWaffle(); // Clicking on the waffle will help see if the tiles are loaded.
                TAB.Log.AddTaskFail('Product name link not found in the page');
                return;
            }
            TAB.Log.Pass('Product name link found in the page.');
            var productNameHref = productNameElements[0].href;
            TAB.Log.Comment("Product name link in page is: \"" + productNameHref + "\"");
            TAB.Log.Comment("Expected product name link is: \"" + linkUrl + "\"");
            var areUrlsSimilar = productNameHref.toLowerCase() === linkUrl.toLowerCase();
            if (areUrlsSimilar) {
                TAB.Log.Pass('Product name link points to the right page');
            }
            else {
                var spoPreprovisionLink = 'https://www.office.com/launch/sharepoint';
                if (productNameHref === spoPreprovisionLink) {
                    TAB.Log.Warning('Product name points to the pre-provision link. TAB tenant might be new.');
                }
                else {
                    TAB.Log.Fail('Product name link does not point to the right page');
                }
            }
        }));
    };
    SuiteNav.AddTaskWaitForSearchBox = function () {
        TAB.AddTask(undefined, TAB.OrWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'O365_SearchBoxContainer_container'), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'SearchBox_container')));
    };
    SuiteNav.AddTaskVerifySearchBox = function () {
        this.AddTaskWaitForSearchBox();
        TAB.AddTask(TAB.MakeTask(function () {
            var searchBox = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365_SearchBoxContainer_container');
            var input = TAB.GetElements(searchBox[0], TAB.searchBy.tag, 'input');
            TAB.Log.Verify(!!input && !!input[0] && !!input[0].offsetParent, 'Verify searchBox is found in the page');
        }));
    };
    SuiteNav.AddTaskVerifyNoSearchBox = function () {
        this.AddTaskWaitForSearchBox();
        TAB.AddTask(TAB.MakeTask(function () {
            var searchBox = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365_SearchBoxContainer_container');
            var input = TAB.GetElements(searchBox[0], TAB.searchBy.tag, 'input');
            TAB.Log.Verify(!input || !input[0] || !input[0].offsetParent, 'Verify searchBox is not found in the page');
        }));
    };
    SuiteNav.AddTaskWaitForShellPlus = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'O365fpcontainerid'));
    };
    SuiteNav.AddTaskWaitForFeatureCards = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            var featureCard0 = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nfd-fitem');
            var featureCard1 = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nfd-fo-title');
            return (featureCard0 && featureCard0.length > 0) || (featureCard1 && featureCard1.length > 0);
        }));
    };
    SuiteNav.AddTaskOpenHelpFlexPane = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            if (!SuiteNav.IsFlexPaneOpen()) {
                TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Help');
            }
        }), TAB.MakeWaiter(function () {
            return SuiteNav.IsFlexPaneOpen();
        }));
    };
    SuiteNav.AddTaskClickWaffle = function () {
        TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_MainLink_NavMenu', TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'appLauncher'));
    };
    SuiteNav.AddTaskOpenSettingsMenu = function () {
        TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Settings', TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nav-contextMenu'));
    };
    SuiteNav.IsFlexPaneOpen = function () {
        var flexPane = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365fpcontainerid');
        return flexPane && flexPane.length > 0 && flexPane[0].style.display !== 'none';
    };
    return SuiteNav;
}());

// tslint:enable:typedef


/***/ }),

/***/ "mXly":
/*!**********************************************!*\
  !*** ./lib/SPTaskLib/Controls/RTEWebPart.js ***!
  \**********************************************/
/*! exports provided: RTELinkDialogOperation, RTEWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RTELinkDialogOperation", function() { return RTELinkDialogOperation; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RTEWebPart", function() { return RTEWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Utilities_ReactTriggerChange__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Utilities/ReactTriggerChange */ "dp3n");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");





/**
 * @public
 */
var RTELinkDialogOperation;
(function (RTELinkDialogOperation) {
    RTELinkDialogOperation[RTELinkDialogOperation["Save"] = 0] = "Save";
    RTELinkDialogOperation[RTELinkDialogOperation["Cancel"] = 1] = "Cancel";
})(RTELinkDialogOperation || (RTELinkDialogOperation = {}));
/**
 * @public
 */
var RTEWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(RTEWebPart, _super);
    function RTEWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].RTE, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].RTE.toString()) || this;
    }
    RTEWebPart.prototype.AddTaskToClickOnFormattingBarButton = function (automationId, htmlRegex) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on the formatting bar button '" + automationId + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._toolbar, automationId);
        }), this._waitForAppliedFormat(htmlRegex));
    };
    RTEWebPart.prototype.AddTaskToClickOnPropertyPaneButton = function (automationId, htmlRegex) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on the property pane button '" + automationId + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._propertyPane, automationId);
        }), this._waitForAppliedFormat(htmlRegex));
    };
    RTEWebPart.prototype.AddTaskToClickOnColorPicker = function (buttonAutomationId, colorPickerAutomationId, cssClass) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on the property pane button '" + buttonAutomationId + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._propertyPane, buttonAutomationId);
        }), this._waitForColorPickerButton(colorPickerAutomationId));
        TAB.AddTask(TAB.MakeTask(function () {
            var colors = _this._colorItem(colorPickerAutomationId);
            TAB.ClickElement(colors[0]);
        }), this._waitForCssClass(cssClass));
    };
    RTEWebPart.prototype.AddTaskToClickOnTableOperationsButton = function (automationId, tagName, numberOfTableTags, shouldSelectTable) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on the property pane button '" + automationId + "'");
        if (shouldSelectTable) {
            this.AddTaskToSelectTableInRTE(automationId);
        }
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._propertyPane, automationId);
        }), this._waitForTableFormat(tagName, numberOfTableTags));
    };
    RTEWebPart.prototype.AddTaskToClickOnTableStyleButton = function (automationId, className) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on the property pane button '" + automationId + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._propertyPane, automationId);
        }), this._waitForTableStyle(className));
    };
    RTEWebPart.prototype.AddTaskToOpenPropertyPaneDropDown = function (index, dropDownLabel, selectedValueIndex, htmlRegex, cssClass) {
        TAB.Log.AddTaskComment("Clicking on the property pane drop down '" + dropDownLabel + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            var container = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            var dropDown = TAB.GetElements(container, TAB.searchBy.hasClassName, 'ms-Dropdown')[index];
            dropDown.focus();
            TAB.ClickElement(dropDown);
        }), this._waitForPropertyPaneDropDown());
        TAB.AddTask(TAB.MakeTask(function () {
            var dropDownCallout = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-callout');
            var button = TAB.GetElements(dropDownCallout, TAB.searchBy.tag, 'BUTTON')[selectedValueIndex];
            TAB.Log.Comment('Click on drop down option');
            TAB.ClickElement(button);
        }), TAB.OrWaiters(this._waitForAppliedFormat(htmlRegex), this._waitForCssClass(cssClass)));
    };
    RTEWebPart.prototype.AddTaskToClickOnMoreButton = function () {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on more formatting bar button");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._toolbar, 'more-button');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='showPane']"));
    };
    RTEWebPart.prototype.AddTaskToClickOnFormattingBarButtonWithStyle = function (automationId, style) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking on the formatting bar button '" + automationId + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this._toolbar, automationId);
        }), this._waitForAppliedStyle(style));
    };
    RTEWebPart.prototype.AddTaskToClickOnRTE = function () {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking inside RTE '" + RTEWebPart.RTE + "'");
        var startTime;
        TAB.AddTask(TAB.MakeTask(function () {
            startTime = performance.now();
            _this._clickOnElement(_this.root, RTEWebPart.RTE);
        }), TAB.MakeWaiter(function () {
            try {
                // It's trivial for formatting bar to show up, so if it doesn't show up somehow
                // bypass when it hits timeout.
                if (startTime && performance.now() - 5000 > startTime) {
                    return true;
                }
                return !!_Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(_this.root, RTEWebPart.FormattingBar);
            }
            catch (error) {
                return false;
            }
        }));
        TAB.Log.AddTaskComment('Click on RTE successfully!');
    };
    RTEWebPart.prototype.AddTaskToSelectTableInRTE = function (tableFormatButtonId) {
        var _this = this;
        TAB.Log.AddTaskComment("Selecting table'" + RTEWebPart.RTE + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this.root, RTEWebPart.RTE);
            var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
            var sel = TAB.Win.window.getSelection();
            var range = TAB.Win.document.createRange();
            var startNode = rte.getElementsByTagName('td')[0];
            startNode.textContent = 'this is some text';
            range.selectNode(startNode);
            sel.removeAllRanges();
            sel.addRange(range);
        }), this._waitForSelection());
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AddTaskToClickOnPropertyPaneButton('bold-propertyPaneButton', 'strong');
        }), this._waitForTableFormatButtons(tableFormatButtonId));
    };
    RTEWebPart.prototype.AddTaskToSelectTextInRTE = function (startIndex, endIndex) {
        var _this = this;
        TAB.Log.AddTaskComment("Selecting text'" + RTEWebPart.RTE + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            _this._clickOnElement(_this.root, RTEWebPart.RTE);
            var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
            var sel = TAB.Win.window.getSelection();
            var range = TAB.Win.document.createRange();
            var startNode = rte.firstChild;
            range.selectNodeContents(startNode);
            range.setStart(startNode, startIndex);
            range.setEnd(startNode, endIndex);
            sel.removeAllRanges();
            sel.addRange(range);
        }), this._waitForSelection());
    };
    RTEWebPart.prototype.AddTaskToAddTextInRTE = function (text) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for RTE webpart to finish rendering in edit mode');
        }), this._waitForTextInRTE());
        this.AddTaskToClickOnRTE();
        TAB.AddTask(TAB.MakeTask(function () {
            var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
            TAB.Log.Comment("Set text content to \"" + text + "\"");
            rte.innerHTML = text;
            // Setting textContent programmatically won't fire change event of CKEditor.
            // While user typing can file the event successfully.
            TAB.Log.Comment('Fire change events to make sure text content got serialized');
            var ckeditorInstances = TAB.Win.window.CKEDITOR.instances;
            Object.keys(ckeditorInstances).forEach(function (key) {
                try {
                    ckeditorInstances[key].fire('change');
                    TAB.Log.Comment('Change event fired');
                }
                catch (error) {
                    TAB.Log.Comment('There might be some instances left on previous pages, but we do not want to fail' +
                        ' the tab test since we will check the serialized data');
                    TAB.Log.Comment("Error Message: " + error.message);
                }
            });
        }), TAB.AndWaiters(this._waitForText(text, RTEWebPart.RTE), _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"].WaitForPageSave()));
    };
    RTEWebPart.prototype.AddTaskToCreateLink = function (operation, text, displayText, buttonAutomationId, isPropertyPaneButton) {
        var _this = this;
        var actionButtonAutomationId;
        var linkTextFieldAutomationId;
        var displayTextFieldAutomationId;
        actionButtonAutomationId = "pagePicker" + RTELinkDialogOperation[operation] + "Button";
        linkTextFieldAutomationId = 'pagePickerUrlTextField';
        displayTextFieldAutomationId = 'pagePickerTitleTextField';
        TAB.Log.AddTaskComment("Creating a link by clicking on '" + buttonAutomationId + "' and click on '" + actionButtonAutomationId + "'");
        TAB.AddTask(TAB.MakeTask(function () {
            if (!isPropertyPaneButton) {
                _this._clickOnElement(_this._toolbar, buttonAutomationId);
            }
            else {
                _this._clickOnElement(_this._propertyPane, buttonAutomationId);
            }
        }), TAB.AndWaiters(this._waitForElement(actionButtonAutomationId), this._waitForElement(linkTextFieldAutomationId)));
        TAB.AddTask(TAB.MakeTask(function () {
            var textField = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, linkTextFieldAutomationId)[0];
            textField.focus();
            textField.value = text;
            Object(_Utilities_ReactTriggerChange__WEBPACK_IMPORTED_MODULE_3__["ReactTriggerChange"])(textField);
            var displayTextField = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, displayTextFieldAutomationId)[0];
            displayTextField.value = displayText;
            var element = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, actionButtonAutomationId)[0];
            TAB.ClickElement(element);
        }), this._waitForDialogToClose(actionButtonAutomationId));
    };
    RTEWebPart.prototype.ensureContentSaved = function (expectedInnerHTML, shouldRemoveWhiteSpace) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                var innerHTML = shouldRemoveWhiteSpace
                    ? rte.innerHTML.replace(/\s/g, '')
                    : rte.innerHTML.trim();
                return innerHTML === expectedInnerHTML;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype.AddTaskPasteTextInRTE = function (pastedData, expectedData) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Pasting text');
            _this._dispatchPasteEvent(pastedData);
        }), TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                return rte.innerHTML === expectedData;
            }
            catch (e) {
                return false;
            }
        }));
    };
    RTEWebPart.prototype.AddTaskPasteImageInDataValue = function (pastedData, expectedNumberOfControls) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Pasting image');
            _this._dispatchPasteEvent(pastedData);
        }).WaitFor(this._waitForImageWebPart(expectedNumberOfControls)));
    };
    RTEWebPart.prototype.AddTaskPasteImageInDataTransfer = function (pastedData, expectedControls) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
            var dataTransfer = new TAB.Win.window.DataTransfer();
            // Mock a data transfer object to be pasted
            var b64Data = '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';
            var byteCharacters = atob(b64Data);
            var sliceSize = 512;
            var byteArrays = [];
            for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {
                var slice = byteCharacters.slice(offset, offset + sliceSize);
                var byteNumbers = new Array(slice.length);
                for (var i = 0; i < slice.length; i++) {
                    byteNumbers[i] = slice.charCodeAt(i);
                }
                var byteArray = new Uint8Array(byteNumbers);
                byteArrays.push(byteArray);
            }
            var file = new TAB.Win.window.File(byteArrays, 'sample.png', {
                type: 'image/png',
                lastModified: new Date().getTime()
            });
            dataTransfer.items.add(file);
            var pasteEvent = new TAB.Win.window.ClipboardEvent('paste', {
                clipboardData: dataTransfer,
                isTrusted: true
            });
            pasteEvent.clipboardData.setData('text/html', pastedData);
            rte.dispatchEvent(pasteEvent);
        }).WaitFor(this._waitForImageWebPart(expectedControls)));
    };
    RTEWebPart.prototype.AddTaskAddLinkUsingInlinePagePicker = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Opening page picker");
            var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
            TAB.ClickElement(rte);
            TAB.FireKeyboardEvent(rte, 'keyup', 219 /** KeyCode for Open Bracket */);
        }), this._waitForInLinePagePicker());
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Pressing enter on an inline page picker suggestion");
            var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
            TAB.FireKeyboardEvent(rte, 'keydown', 13 /** KeyCode for Enter */);
        }), TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                return TAB.GetElements(rte, TAB.searchBy.customQuery, "a[data-sprte-link]");
            }
            catch (error) {
                return false;
            }
        }));
    };
    Object.defineProperty(RTEWebPart.prototype, "_toolbar", {
        get: function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(this.root, RTEWebPart.FormattingBar)[0];
            }
            catch (e) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    RTEWebPart.prototype._colorItem = function (colorPickerAutomationId) {
        try {
            var colorPicker = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, colorPickerAutomationId)[0];
            var colorPickerItem = colorPicker.getElementsByTagName('td')[0];
            var colors = colorPickerItem.getElementsByTagName('button');
            return colors;
        }
        catch (e) {
            return undefined;
        }
    };
    RTEWebPart.prototype._dispatchPasteEvent = function (pastedData) {
        var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(this.root, RTEWebPart.RTE)[0];
        var dataTransfer = new TAB.Win.window.DataTransfer();
        var pasteEvent = new TAB.Win.window.ClipboardEvent('paste', {
            clipboardData: dataTransfer,
            isTrusted: true
        });
        pasteEvent.clipboardData.setData('text/html', pastedData);
        var mockData = {
            dataValue: pastedData,
            type: 'html',
            method: 'paste',
            dataTransfer: dataTransfer,
            dontFilter: true
        };
        Object.defineProperty(pasteEvent.constructor.prototype, 'data', { value: mockData });
        rte.dispatchEvent(pasteEvent);
    };
    Object.defineProperty(RTEWebPart.prototype, "_propertyPane", {
        get: function () {
            try {
                return TAB.GetElement(TAB.Win, TAB.searchBy.id, RTEWebPart.PropertyPane);
            }
            catch (e) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    RTEWebPart.prototype._waitForImageWebPart = function (expectedCount) {
        return TAB.MakeWaiter(function () {
            try {
                var imageWebPart = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='imageFrame']");
                return imageWebPart.length === expectedCount;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForInLinePagePicker = function () {
        return TAB.MakeWaiter(function () {
            try {
                return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, RTEWebPart.InLinePagePicker).length;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForTextInRTE = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                return TAB.ElementExists(_this.root, TAB.searchBy.hasClassName, 'cke_editable');
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForDialogToClose = function (button) {
        return TAB.MakeWaiter(function () {
            try {
                var elem = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, button).length;
                return elem === 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForAppliedFormat = function (value) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                return rte.innerHTML.indexOf(value) >= 0 || rte.innerHTML === value;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForAppliedStyle = function (style) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                var styleQuery = "[style='" + style + "']";
                var styleElement = TAB.GetElements(rte, TAB.searchBy.customQuery, styleQuery).length;
                return styleElement > 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForColorPickerButton = function (colorPickerAutomationId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var colors = _this._colorItem(colorPickerAutomationId);
                return colors && colors.length > 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForPropertyPaneDropDown = function () {
        return TAB.MakeWaiter(function () {
            try {
                var dropDown = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-Dropdown-callout');
                var buttons = TAB.GetElements(dropDown, TAB.searchBy.tag, 'BUTTON');
                return buttons.length > 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForTableFormat = function (tagName, numberOfTableTags) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                return rte.getElementsByTagName(tagName).length === numberOfTableTags;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForSelection = function () {
        return TAB.MakeWaiter(function () {
            try {
                var sel = TAB.Win.window.getSelection();
                return sel.rangeCount > 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForElement = function (automationId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var customQuery = "[data-automation-id='" + automationId + "']";
                return Boolean(_this._getElementsByCustomQuery(customQuery));
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._getElementsByCustomQuery = function (customQuery, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElements(searchObj, TAB.searchBy.customQuery, customQuery);
        }
        catch (e) {
            return undefined;
        }
    };
    RTEWebPart.prototype._waitForText = function (text, automationId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, automationId)[0];
                return rte.innerHTML === text;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForTableFormatButtons = function (id) {
        return TAB.MakeWaiter(function () {
            try {
                var elements = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(TAB.Win, id);
                return elements.length > 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForCssClass = function (cssClass) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                var styleQuery = "[class='" + cssClass + "']";
                var styleElement = TAB.GetElements(rte, TAB.searchBy.customQuery, styleQuery).length;
                return styleElement > 0;
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._waitForTableStyle = function (cssClass) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            try {
                var rte = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(_this.root, RTEWebPart.RTE)[0];
                var table = rte.getElementsByTagName('table')[0];
                return (table.className.indexOf(cssClass) !== -1 || table.parentElement.className.indexOf(cssClass) !== -1);
            }
            catch (error) {
                return false;
            }
        });
    };
    RTEWebPart.prototype._clickOnElement = function (root, automationId) {
        try {
            var element = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(root, automationId)[0];
            TAB.ClickElement(element);
        }
        catch (error) {
            /* No action required */
        }
    };
    RTEWebPart.RTE = 'textBox';
    RTEWebPart.FormattingBar = 'toolbar';
    RTEWebPart.PropertyPane = 'spPropertyPaneContainer';
    RTEWebPart.InLinePagePicker = 'inLinePagePicker';
    return RTEWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "mcqG":
/*!*****************************************!*\
  !*** ./lib/SPTaskLib/Pages/MegaMenu.js ***!
  \*****************************************/
/*! exports provided: MegaMenu */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MegaMenu", function() { return MegaMenu; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");
/* harmony import */ var _Navigation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Navigation */ "9yWr");



/**
 * @public
 */
var MegaMenu = /** @class */ (function () {
    function MegaMenu() {
    }
    MegaMenu.AddTaskLaunchChangeTheLookPanel = function () {
        TAB.Log.AddTaskComment('Launching ChangeTheLookPanel...');
        MegaMenu.AddTaskWaitForSettingsMenuIcon();
        MegaMenu.AddTaskOpenSettingsMenu();
        MegaMenu.AddTaskReopenSettingsMenuIfNeeded();
        TAB.AddTask(TAB.MakeTask(function () {
            // 2 different settings menu options while the new settings menu rolls out
            if (MegaMenu.FlexSettingsMenuOpen()) {
                TAB.Log.AddTaskComment('AddTaskLaunchChangeTheLookPanel: Flex menu is open');
                var linksSection = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'O365_Settings_navbardatalinks');
                var links = TAB.GetElements(linksSection, TAB.searchBy.tag, 'a');
                var ctlLink_1 = undefined;
                links.forEach(function (link) {
                    if (link.href.indexOf('_spLaunchChangeTheLookPanel') !== -1) {
                        ctlLink_1 = link;
                    }
                });
                TAB.ClickElement(ctlLink_1);
            }
            else {
                TAB.Log.AddTaskComment('AddTaskLaunchChangeTheLookPanel: Flex menu is not open');
                var changeTheLookButton = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'O365_SubLink_CHANGE_THE_LOOK');
                TAB.ClickElement(changeTheLookButton);
            }
        }), MegaMenu.WaitForCTLPanel());
        TAB.Log.AddTaskPass('ChangeTheLookPanel was successfully launched.');
    };
    MegaMenu.AddTaskEnableMegaMenu = function () {
        MegaMenu.AddTaskLaunchChangeTheLookPanel();
        MegaMenu.AddTaskOpenNavigationOptions();
        MegaMenu.AddTaskClickMegaMenuOption();
        MegaMenu.AddTaskClickCTLPanelApplyButton();
        MegaMenu.AddTaskCloseChangeTheLookPanel();
        MegaMenu.AddTaskCloseSettingsPanel();
    };
    MegaMenu.AddTaskEnableCascadingMenu = function () {
        MegaMenu.AddTaskLaunchChangeTheLookPanel();
        MegaMenu.AddTaskOpenNavigationOptions();
        MegaMenu.AddTaskClickCascadingMenuOption();
        MegaMenu.AddTaskClickCTLPanelApplyButton();
        MegaMenu.AddTaskCloseChangeTheLookPanel();
        MegaMenu.AddTaskCloseSettingsPanel();
    };
    MegaMenu.AddTaskOpenNavigationOptions = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Expanding navigation options');
            TAB.ClickElement(MegaMenu.getNavigationHeaderButton());
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ChoiceFieldGroup');
        }));
    };
    MegaMenu.AddTaskClickMegaMenuOption = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on the mega menu option');
            var megaMenuOption = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ChoiceField')[0];
            var button = TAB.GetElement(megaMenuOption, TAB.searchBy.tag, 'input');
            TAB.ClickElement(button);
        }), undefined);
    };
    MegaMenu.AddTaskClickCascadingMenuOption = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on the cascading menu option');
            var cascadingMenuOption = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ChoiceField')[1];
            var button = TAB.GetElement(cascadingMenuOption, TAB.searchBy.tag, 'input');
            TAB.ClickElement(button);
        }), undefined);
    };
    MegaMenu.AddTaskClickCTLPanelApplyButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the apply button on the change the look panel');
            var ctlApplyButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='changethelookpanel-savebutton']");
            TAB.ClickElement(ctlApplyButton);
        }), undefined);
    };
    MegaMenu.AddTaskCloseChangeTheLookPanel = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () { return MegaMenu.getPanelCloseButton() !== undefined; }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Closing change the look panel');
            TAB.ClickElement(MegaMenu.getPanelCloseButton());
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'sp-ChangeTheLookPanel-section');
        }));
    };
    MegaMenu.AddTaskCloseSettingsPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            if (MegaMenu.FlexSettingsMenuOpen()) {
                var closeButton = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'flexPaneCloseButton');
                TAB.ClickElement(closeButton);
            }
        }), TAB.MakeWaiter(function () {
            return !MegaMenu.FlexSettingsMenuOpen();
        }));
    };
    /**
     * Open the MegaMenu for the specified navigation node
     * @param navNode - Either the index or the title text of the navigation node
     * @param openViaKeyboard - Set this to use keyboard to open navigation rather than mouse hover
     */
    MegaMenu.AddTaskOpenMegaMenu = function (navNode, openViaKeyboard) {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'ms-HorizontalNavItems');
        }));
        TAB.Log.AddTaskComment('Found horizontal nav item. Now triggering a mouse over event.');
        if (openViaKeyboard) {
            MegaMenu.AddTaskOpenMenuWithKeyboard(navNode);
        }
        else {
            MegaMenu.AddTaskHoverOverHorizontalNavItem(navNode);
        }
        TAB.Log.AddTaskComment('Mouse event triggered. Waiting for menu to appear...');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-Menu-section');
        }));
    };
    /**
     * Open the CascadingMenu for the specified navigation node
     * @param navNode - Either the index or the title text of the navigation node
     * @param openViaKeyboard - Set this to use keyboard to open navigation rather than mouse hover
     */
    MegaMenu.AddTaskOpenCascadingMenu = function (navNode, openViaKeyboard) {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.className, 'ms-HorizontalNavItems');
        }));
        TAB.Log.AddTaskComment('Found horizontal nav item. Now triggering a mouse over event.');
        if (openViaKeyboard) {
            MegaMenu.AddTaskOpenMenuWithKeyboard(navNode);
        }
        else {
            MegaMenu.AddTaskHoverOverHorizontalNavItem(navNode);
        }
        TAB.Log.AddTaskComment('Mouse event triggered. Waiting for menu to appear...');
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-list');
        }));
    };
    MegaMenu.AddTaskHoverOverHorizontalNavItem = function (navNode) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Hovering over a nav item to expand the cascading or mega menu');
            var links = _Navigation__WEBPACK_IMPORTED_MODULE_2__["Navigation"].GetHeaderNavNodes();
            var matchingItem = typeof navNode === 'number'
                ? links[navNode]
                : Array.from(links).filter(function (link) { return link.innerText === navNode; })[0];
            var eventObj = TAB.Win.document.createEvent('Events');
            eventObj.initEvent('mouseover', true, false);
            matchingItem.dispatchEvent(eventObj);
        }));
    };
    MegaMenu.AddTaskOpenMenuWithKeyboard = function (navNode) {
        TAB.AddTask(TAB.MakeTask(function () {
            var links = _Navigation__WEBPACK_IMPORTED_MODULE_2__["Navigation"].GetHeaderNavNodes();
            var matchingItem = typeof navNode === 'number'
                ? links[navNode]
                : Array.from(links).filter(function (link) { return link.innerText === navNode; })[0];
            matchingItem.focus();
            TAB.FireKeyboardEvent(matchingItem, 'keydown', 40 /* down arrow key */);
        }));
    };
    MegaMenu.AddTaskGetNavigationLinks = function (siteUrl, navResult) {
        TAB.Log.AddTaskComment('Getting nav links');
        var targetUrl = siteUrl + "/_api/navigation/MenuState";
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendGetRequest(siteUrl, targetUrl, result);
        TAB.AddTask(TAB.MakeTask(function () {
            if (result && result.success && result.retVal) {
                navResult.MenuState = result.retVal;
            }
            else {
                TAB.Log.AddTaskFail('Failed to fetch nav links');
            }
        }));
    };
    MegaMenu.AddTaskAddNavLinks = function (siteUrl, newLink, shouldDeleteNodes) {
        if (shouldDeleteNodes === void 0) { shouldDeleteNodes = true; }
        var result = {};
        MegaMenu.AddTaskGetNavigationLinks(siteUrl, result);
        TAB.Log.AddTaskComment("Adding new nav node(s)");
        TAB.AddTask(TAB.MakeTask(function () {
            var links = result.MenuState && result.MenuState.Nodes;
            if (links && links.length > 0) {
                if (shouldDeleteNodes) {
                    TAB.Log.AddTaskComment('First deleting existing nodes');
                    links.forEach(function (link) { return _TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].SetLinkAsDeleted(link); });
                }
            }
            else {
                links = [];
            }
            links.unshift(newLink);
            var postContent = {
                menuState: {
                    SPWebPrefix: result.MenuState && result.MenuState.SPWebPrefix,
                    StartingNodeKey: '1025' /* Quick launch node key */,
                    Version: new Date().toTimeString(),
                    Nodes: links
                }
            };
            TAB.Log.AddTaskComment('Then adding new nav link');
            MegaMenu._updateNavigationContent(postContent, siteUrl);
            MegaMenu._addTaskReloadPage();
        }));
    };
    MegaMenu.WaitForCTLPanel = function () {
        return TAB.MakeWaiter(function () {
            var sections = MegaMenu.getChangeTheLookPanelSections();
            return sections.length > 0;
        });
    };
    MegaMenu.AddTaskWaitForSettingsMenuIcon = function () {
        TAB.AddTask(undefined, MegaMenu.WaitForSettingsMenuIcon());
    };
    MegaMenu.WaitForSettingsMenuIcon = function () {
        return TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Settings');
        });
    };
    MegaMenu.AddTaskOpenSettingsMenu = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking on the settings panel icon button');
            var settingsButton = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Settings');
            TAB.ClickElement(settingsButton);
        }), MegaMenu.WaitForSettingsMenuOpen());
    };
    MegaMenu.AddTaskReopenSettingsMenuIfNeeded = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Checking whether links are loaded');
            if (!MegaMenu._settingsPanelLinksLoaded()) {
                TAB.Log.AddTaskComment('Links are not loaded. Closing and reopening the panel.');
                MegaMenu.AddTaskCloseSettingsPanel();
                MegaMenu.AddTaskOpenSettingsMenu();
            }
        }));
    };
    MegaMenu.WaitForSettingsMenuOpen = function () {
        return TAB.MakeWaiter(function () {
            return MegaMenu.FlexSettingsMenuOpen() || MegaMenu.ContextSettingsMenuOpen();
        });
    };
    // Old settings menu
    MegaMenu.ContextSettingsMenuOpen = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nav-contextMenu');
    };
    // New settings menu
    MegaMenu.FlexSettingsMenuOpen = function () {
        return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'O365fpcontainerid');
    };
    MegaMenu._settingsPanelLinksLoaded = function () {
        var pane = undefined;
        if (MegaMenu.FlexSettingsMenuOpen()) {
            TAB.Log.AddTaskComment('Check if links loaded: Flex menu is open');
            var flexPane = TAB.GetElements(TAB.Win, TAB.searchBy.id, 'O365fpcontainerid');
            if (flexPane.length > 0) {
                pane = flexPane[0];
            }
        }
        else {
            TAB.Log.AddTaskComment('Check if links loaded: Flex menu is not open');
            var contextPane = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'o365cs-nav-contextMenu');
            if (contextPane.length > 0) {
                pane = contextPane[0];
            }
        }
        if (!pane) {
            return false;
        }
        var links = TAB.GetElements(pane, TAB.searchBy.tag, 'a');
        if (links.length > 0) {
            return true;
        }
        else {
            return false;
        }
    };
    MegaMenu._addTaskReloadPage = function () {
        TAB.AddTask(TAB.ReloadPage(), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'O365_MainLink_Settings');
        }));
    };
    MegaMenu._updateNavigationContent = function (navContent, siteUrl) {
        var targetUrl = siteUrl + '/_api/navigation/SaveMenuState';
        var result = {};
        _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].AddTaskSendPostRequest(siteUrl, targetUrl, JSON.stringify(navContent), result, true /** fetchCanary */);
    };
    MegaMenu.getChangeTheLookPanelSections = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'sp-ChangeTheLookPanel-section');
    };
    MegaMenu.getNavigationHeaderButton = function () {
        var panelSections = MegaMenu.getChangeTheLookPanelSections();
        return panelSections[2];
    };
    MegaMenu.getPanelCloseButton = function () {
        try {
            var closeButton = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel-closeButton');
            return closeButton;
        }
        catch (error) {
            return undefined;
        }
    };
    return MegaMenu;
}());



/***/ }),

/***/ "mgJ4":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Controls/YouTubeEmbed.js ***!
  \************************************************/
/*! exports provided: YouTubeEmbed */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YouTubeEmbed", function() { return YouTubeEmbed; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var YouTubeEmbed = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(YouTubeEmbed, _super);
    // Create a new YouTube web part.
    function YouTubeEmbed() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].YouTube, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].YouTube.toString()) || this;
    }
    /**
     * Add embed code to the embedCode property pane text field.
     * If video should exist (shouldBeFound), check if embedCode is rendered ('realWebPart' & 'embedCode').
     * Otherwise (!shouldBeFound), check if error message rendered ('errorMessage').
     */
    YouTubeEmbed.prototype.AddTaskTryEmbedCode = function (embedCode, shouldBeFound) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var propertyPane = _this._getPropertyPane();
            TAB.WaitForElementToExist(propertyPane, TAB.searchBy.tag, 'textarea').Then(TAB.MakeTask(function () {
                var embedCodeTextArea = TAB.GetElement(propertyPane, TAB.searchBy.tag, 'textarea');
                // input url
                embedCodeTextArea.focus();
                _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(embedCodeTextArea, embedCode);
            }));
        }), shouldBeFound ? this._waitForVideoToRender() : this._waitForErrorMessageToRender());
    };
    /**
     * Wrapper to find some element with class that contains the specified className
     */
    YouTubeEmbed.prototype.WaitForElementWithClassToExist = function (className) {
        // The className is the first class, or the second one. See https://stackoverflow.com/a/8588532/1436671
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[class^=\"" + className + "\"], [class*=\" " + className + "\"]");
    };
    YouTubeEmbed.prototype.WaitForElementWithAutomationIdToExist = function (automationId) {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=" + automationId + "]");
    };
    /**
     * Wait until webpart is created (PlaceHolder exists).
     */
    YouTubeEmbed.prototype.WaitForWebPartToExist = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'realWebPart');
    };
    /**
     * Add BaseWebpart to page.
     */
    YouTubeEmbed.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), this.WaitForWebPartToExist());
        TAB.Log.Comment('Web part added');
    };
    /**
     * Focus on PropertyPane.
     */
    YouTubeEmbed.prototype._getPropertyPane = function () {
        try {
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'spPropertyPaneContainer');
            return propertyPane;
        }
        catch (e) {
            TAB.Log.Comment('PropertyPane is closed.');
            return undefined;
        }
    };
    YouTubeEmbed.prototype._waitForVideoToRender = function () {
        return (this.WaitForElementWithClassToExist('realWebPart') &&
            this.WaitForElementWithAutomationIdToExist('embedCode'));
    };
    YouTubeEmbed.prototype._waitForErrorMessageToRender = function () {
        return this.WaitForElementWithClassToExist('errorMessage');
    };
    return YouTubeEmbed;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "milH":
/*!*****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/SendByEmailDialog.js ***!
  \*****************************************************/
/*! exports provided: SendByEmailDialog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SendByEmailDialog", function() { return SendByEmailDialog; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");



/**
 * @public
 */
var SendByEmailDialog = /** @class */ (function () {
    function SendByEmailDialog() {
    }
    SendByEmailDialog.prototype.AddTaskOpenDialog = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the Send by email button');
            var shareButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'shareButton');
            TAB.Log.Comment('Click the Send by email button');
            TAB.ClickElement(shareButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sharePageByEmail']"));
    };
    SendByEmailDialog.prototype.AddTaskAddRecipient = function (name) {
        var peoplePicker;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Input the people name in people picker: " + name);
            peoplePicker = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'sendByEmailDialogPeoplePicker');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(peoplePicker, name);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-PeoplePicker-personaContent'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment(' press Enter to select the person');
            TAB.FireKeyboardEvent(peoplePicker, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["KeyCodes"].enter);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-PickerPersona-container'));
    };
    SendByEmailDialog.prototype.AddTaskInputMessage = function (message) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Input the message: " + message);
            var messageInput = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'sendByEmailDialogTextField');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_1__["ReactUtil"].TriggerOnChange(messageInput, message);
        }));
    };
    SendByEmailDialog.prototype.AddTaskClickSendButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the Send button');
            var sendButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'sendByEmailDialogSendButton');
            TAB.Log.Comment('Click the Send button');
            TAB.ClickElement(sendButton);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sharePageByEmail']");
        }));
    };
    return SendByEmailDialog;
}());



/***/ }),

/***/ "mmJW":
/*!***************************************!*\
  !*** ./lib/SPTaskLib/Pages/Canvas.js ***!
  \***************************************/
/*! exports provided: HintType, Canvas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HintType", function() { return HintType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Canvas", function() { return Canvas; });
/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _SPExperimentUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../SPExperimentUtil */ "qDkj");



/**
 * @public
 */
var HintType;
(function (HintType) {
    HintType[HintType["SectionHint"] = 0] = "SectionHint";
    HintType[HintType["WebPartHint"] = 1] = "WebPartHint";
})(HintType || (HintType = {}));
/**
 * @public
 */
var Canvas = /** @class */ (function () {
    function Canvas() {
    }
    Object.defineProperty(Canvas, "toolboxElement", {
        // tslint:enable:variable-name
        get: function () {
            try {
                return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + Canvas.ToolboxId + "\"]");
            }
            catch (er) {
                return undefined;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Canvas, "rootCanvasElement", {
        get: function () {
            try {
                return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"" + Canvas.CanvasRootId + "\"]");
            }
            catch (er) {
                return TAB.Win.window.document.body;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Add a web part to canvas.
     * @param webpart - The web part being added to canvas
     * @param options - The options for adding the web part. {@link ICanvasCreateWebPartOptions}
     */
    Canvas.AddTaskCreateWebPart = function (webpart, options) {
        if (options === void 0) { options = {}; }
        Canvas.AddTaskAddExperimentOverride();
        var toolboxItemAutomationId = webpart.entryId;
        var zoneIndex = options.zoneIndex || 0;
        var sectionIndex = options.sectionIndex || 0;
        var controlIndex = options.controlIndex || 0;
        var layoutIndex = options.layoutIndex;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                // Wait for a complete edit mode transition.
                return !!Canvas._getSections(layoutIndex, zoneIndex)[sectionIndex];
            }
            catch (er) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var sectionRoot = Canvas._getSections(layoutIndex, zoneIndex)[sectionIndex];
            // Check if the toolbox item is available already which means it's full bleed scenario.
            if (sectionRoot && _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(sectionRoot, toolboxItemAutomationId).length) {
                var numberOfControlsBefore = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasControlId).length;
                TAB.MakeTask(function () {
                    TAB.ClickElement(_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(sectionRoot, toolboxItemAutomationId));
                }).WaitFor(Canvas.WaitForNumberOfControls(Canvas.rootCanvasElement, numberOfControlsBefore + 1, Canvas.CanvasControlId));
            }
            else {
                Canvas.AddTaskOpenToolbox(Canvas._getSections(layoutIndex, zoneIndex)[sectionIndex], HintType.WebPartHint, controlIndex);
                // find the web part icon, click on it and wait for +1 web parts show up
                Canvas.AddTaskAddControlFromToolbox('Add Webpart', // comment
                toolboxItemAutomationId, Canvas.CanvasControlId);
            }
            if (!Boolean(options.skipWebPartBind)) {
                Canvas.AddTaskBindWebPart(webpart, true /* isAddingFromToolbox */);
            }
        }));
    };
    /**
     * Add a new zone to the canvas
     * @param layoutName - The name of the layout of the new zone.
     * @param zoneIndex - The index of the zone after it's being added to the canvas.
     * @param isAddDisabled - Whether the zone is disabled. Some tests might click on disabled button intentionally to test the disabling works.
     */
    Canvas.AddTaskCreateZone = function (layoutName, zoneIndex, isAddDisabled) {
        if (zoneIndex === void 0) { zoneIndex = 0; }
        if (isAddDisabled === void 0) { isAddDisabled = false; }
        Canvas.AddTaskAddExperimentOverride();
        TAB.AddTask(TAB.MakeTask(function () {
            var sectionToolboxItem = layoutName + 'ToolboxItem';
            Canvas.AddTaskOpenToolbox(Canvas.rootCanvasElement, HintType.SectionHint, zoneIndex);
            // find the section, click on it and wait for +1 sections show up
            Canvas.AddTaskAddControlFromToolbox('Add Section', sectionToolboxItem, Canvas.CanvasZoneId, isAddDisabled);
        }));
    };
    Canvas.AddTaskAddExperimentOverride = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            // Disable the experiment for tab tests until the experiment has outcome.
            _SPExperimentUtil__WEBPACK_IMPORTED_MODULE_2__["SPExperimentUtil"].setDebugExperiments("[[90040,0]]");
        }));
    };
    Canvas.AddTaskAddControlFromToolbox = function (comment, automationId, controlType, isAddDisabled) {
        // Wait for the item to show-up since opening toolbox is an async flow.
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return !!_Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(Canvas.toolboxElement, automationId);
            }
            catch (error) {
                return false;
            }
        }));
        var startTime;
        TAB.AddTask(TAB.MakeTask(function () {
            startTime = performance.now();
            var numberOfControlsBefore = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, controlType).length;
            TAB.Log.Comment(comment);
            var toolboxItem = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(Canvas.toolboxElement, automationId);
            TAB.ClickElement(toolboxItem);
            // Set the waiter here. if we move out this wait, the numberOfControlsBefore will be NaN because the WaitForNumberOfControls
            // function is called immediately when setting the waiter.
            TAB.AddTask(undefined /* task */, Canvas.WaitForNumberOfControls(Canvas.rootCanvasElement, isAddDisabled ? numberOfControlsBefore : numberOfControlsBefore + 1, controlType));
        }), TAB.MakeWaiter(function () {
            // Wait extra second to ensure scroll animation is finished to avoid flakiness.
            return performance.now() - startTime > 1000;
        }));
    };
    /**
     * Open toolbox by clicking the toolbox hint button.
     * @param rootElement - The element where to search for the toolbox hints.
     * @param hintType - The type of the hint button to look for
     * @param index - The index of the button to be clicked
     */
    Canvas.AddTaskOpenToolbox = function (rootElement, hintType, index) {
        if (index === void 0) { index = 0; }
        // Wait for toolbox button to present.
        TAB.AddTask(undefined, Canvas.WaitForWebPartToolboxButton());
        // find the toolbox plus button and click on it
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Open Toolbox');
            var toolboxHintButton = Canvas._getToolBoxHintButtons(rootElement, hintType)[index];
            TAB.ClickElement(toolboxHintButton);
        }));
    };
    Canvas.AddTaskOpenZonePropertyPane = function (zoneIndex) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Open zone property pane');
            var zones = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasZoneId);
            var zoneToolBar = TAB.GetElement(zones[zoneIndex], TAB.searchBy.hasClassName, 'CanvasZoneToolbar');
            var configureButton = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(zoneToolBar, 'configureButton')[0];
            TAB.ClickElement(configureButton);
        }), TAB.AndWaiters(_TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].WaitForPageSave(), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='showPane']")));
    };
    Canvas.AddTaskDeleteZone = function (zoneIndex) {
        if (zoneIndex === void 0) { zoneIndex = 0; }
        TAB.AddTask(TAB.MakeTask(function () {
            var numberOfZonesBefore = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasZoneId).length;
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Click delete button on zone toolbar');
                var zones = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasZoneId);
                var zoneToolBar = TAB.GetElement(zones[zoneIndex], TAB.searchBy.hasClassName, 'CanvasZoneToolbar');
                var deleteButton = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(zoneToolBar, 'deleteButton')[0];
                TAB.ClickElement(deleteButton);
            }), Canvas.WaitForNumberOfControls(Canvas.rootCanvasElement, numberOfZonesBefore - 1, Canvas.CanvasZoneId));
        }));
    };
    Canvas.AddTaskDeleteWebPart = function (layoutIndex, zoneIndex, sectionIndex, controlIndex) {
        if (layoutIndex === void 0) { layoutIndex = 0; }
        if (zoneIndex === void 0) { zoneIndex = 0; }
        if (sectionIndex === void 0) { sectionIndex = 0; }
        if (controlIndex === void 0) { controlIndex = 0; }
        TAB.AddTask(TAB.MakeTask(function () {
            var numberOfZonesBefore = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasControlId).length;
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Open delete button on web part toolbar');
                var canvasControl = Canvas.getControlFromIndex(layoutIndex, zoneIndex, sectionIndex, controlIndex);
                var webPartToolbar = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(canvasControl, 'canvas-control-toolbar');
                var deleteButton = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(webPartToolbar, 'deleteButton');
                TAB.ClickElement(deleteButton);
            }), Canvas.WaitForNumberOfControls(Canvas.rootCanvasElement, numberOfZonesBefore - 1, Canvas.CanvasControlId));
        }));
    };
    Canvas.WaitForWebPartToolboxButton = function () {
        return TAB.MakeWaiter(function () {
            var toolboxHintButton = Canvas._getToolBoxHintButtons(Canvas.rootCanvasElement, HintType.WebPartHint);
            return toolboxHintButton.length > 0;
        });
    };
    Canvas.WaitForNumberOfControls = function (rootElement, numberOfControlsExpected, controlDataAutomationId) {
        return TAB.MakeWaiter(function () {
            var numberOfControls = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(rootElement, controlDataAutomationId).length;
            return numberOfControls === numberOfControlsExpected;
        });
    };
    Canvas.AddTaskBindWebPart = function (webpart, isAddingFromToolbox) {
        // find the newest added webpart and bind here! Create FilePicker Object if needed
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Bind webpart control');
            var root = Canvas._getSelectedWebpartRoot();
            webpart.SetWebpartRoot(function () { return TAB.Win.window.document.getElementById(root.id); }, isAddingFromToolbox);
            Canvas.SelectedWebpart = webpart;
        }), TAB.MakeWaiter(function () {
            try {
                return !isAddingFromToolbox || Canvas.SelectedWebpart.IsWebpartReady();
            }
            catch (error) {
                return false;
            }
        }));
    };
    Canvas.AddTaskChangeZoneLayout = function (zoneIndex, layoutOptionIndex, expectedSections) {
        TAB.AddTask(TAB.MakeTask(function () {
            var zones = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasZoneId);
            TAB.AddTask(TAB.MakeTask(function () {
                TAB.Log.Comment('Change zone layout');
                var choiceGroupElements = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-ChoiceField-input');
                TAB.ClickElement(choiceGroupElements[layoutOptionIndex]);
            }), Canvas.WaitForNumberOfControls(zones[zoneIndex], expectedSections, Canvas.CanvasSessionId));
        }));
    };
    Canvas.AddTaskReduceZone = function (zoneIndex, sectionIndex, expectedSections, expectedWebParts) {
        var sections = Canvas._getSections(0, zoneIndex);
        TAB.AddTask(TAB.MakeTask(function () {
            Canvas.AddTaskChangeZoneLayout(zoneIndex, sectionIndex, expectedSections);
        }, Canvas.WaitForNumberOfControls(sections[0], expectedWebParts, Canvas.CanvasSessionId)));
    };
    /**
     * Validate the number of zones, sections and controls in canvas.
     * @param expectedNumberOfZones - The expected number of zones within canvas.
     * @param expectedNumberOfSectionsPerZone - The expected number of sections in each zone following the order of zones.
     * @param expectedNumberOfControlsPerSection - The expected number of controls in each section following the order of all sections in canvas.
     */
    Canvas.AddTaskCanvasContentValidate = function (expectedNumberOfZones, expectedNumberOfSectionsPerZone, expectedNumberOfControlsPerSection, isEditMode) {
        if (isEditMode === void 0) { isEditMode = true; }
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                var allZones = [].slice.call(Canvas._getZones()); // Convert NodeList to Array
                if (isEditMode) {
                    // Excluding empty placeholder zone that is only rendered in edit mode.
                    allZones.pop();
                }
                if (allZones.length !== expectedNumberOfZones) {
                    return false;
                }
                var areAllZonesHaveExpectedNumberOfSections = allZones.every(function (zone, index) {
                    var sections = Canvas._getSections(0, index);
                    return sections.length === expectedNumberOfSectionsPerZone[index];
                });
                if (!areAllZonesHaveExpectedNumberOfSections) {
                    return false;
                }
                var allSections = [].slice.call(Canvas._getSections()); // Convert NodeList to Array
                // Excluding empty placeholder section.
                allSections.pop();
                var areAllSectionsHaveExpectedNumberOfControls = allSections.every(function (section, index) {
                    var controls = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(section, Canvas.CanvasControlId);
                    return controls.length === expectedNumberOfControlsPerSection[index];
                });
                return areAllSectionsHaveExpectedNumberOfControls;
            }
            catch (error) {
                return false;
            }
        }));
    };
    Canvas.AddRestTaskGetCanvasContentJson = function (siteName) {
        TAB.AddTask(TAB.MakeTask(function () {
            var siteUrl = siteName
                ? TAB.Settings.Get('ProductServer') + ("/sites/" + siteName)
                : TAB.Settings.Get('ProductServer');
            var targetUrl = _TeamSitePage__WEBPACK_IMPORTED_MODULE_0__["TeamSitePage"].PageUrl + "?as=json";
            var result = {};
            TAB.Log.Comment('Sending page "?as=json" request to get JSON data of the page.');
            TAB.Log.Comment("Site URL: {" + siteUrl + "}. Page URL: {" + targetUrl + "}");
            _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].AddTaskSendRestRequest(siteUrl, targetUrl, '', result);
            TAB.AddTask(TAB.MakeTask(function () {
                if (result.retVal) {
                    TAB.Log.Comment('Valid response received');
                    Canvas.CanvasContentJson = JSON.parse(result.retVal.page.Content.CanvasContent1);
                }
                else {
                    TAB.Log.Fail('Failed retrieving CanvasContent1 of current page');
                }
            }));
        }));
    };
    Canvas.AddTaskDropImageFromExternalSources = function () {
        var _this = this;
        // FireMouseEvent is not allowed in Edge due to initMouseEvent deprecation
        // Fix required in TABCore VSO#405141
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskWarning('Fire mouse event is not permitted in Edge.');
            return;
        }
        var blobFileKey = 'dropImageFromExternalSource';
        var dropZoneElementIndex = 'dropZoneControl';
        var imageName = 'logo.jpg';
        var file = TAB[blobFileKey];
        var dragOverX;
        var dragOverY;
        // Create blob image to be dropped
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Create Image Blob');
            Canvas.createBlobFromUrl(blobFileKey, 'https://c.s-microsoft.com/en-us/CMSImages/Microsoft-logo_rgb_gray.jpg?version=1BC84E2E-14C4-6323-7909-D43A63EDAA93', imageName, 'image/jpeg');
        }), TAB.MakeWaiter(function () {
            try {
                file = TAB[blobFileKey];
                return file !== null;
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            // Get a handle on the dragZone used to drop image
            var rteControl = Canvas.getControlFromIndex(0, 0, 0, 0);
            var rect = rteControl.getBoundingClientRect();
            dragOverX = Math.round(rect.left + rteControl.clientWidth / 5);
            dragOverY = Math.round(rect.top + rteControl.clientHeight / 5);
            TAB.Log.Comment('Firing DragOver event');
            _this.triggerDragOverDropZoneEvent(rteControl, file, dragOverX, dragOverY, dropZoneElementIndex);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            var dragZoneControl = TAB[dropZoneElementIndex];
            TAB.Log.Comment('Firing Drop event');
            _this.dropFileFromExternalSourceOnElement(dragZoneControl, file, dragOverX, dragOverY);
        }), TAB.MakeWaiter(function () {
            try {
                var newImageWebPart = void 0;
                var isImagePresent = false;
                newImageWebPart = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='imageFrame']")[0];
                if (newImageWebPart !== undefined) {
                    if (Canvas._getImageUrl(newImageWebPart).indexOf(imageName) > 0) {
                        isImagePresent = true;
                    }
                }
                return isImagePresent;
            }
            catch (e) {
                return false;
            }
        }));
    };
    /**
     * Drag and drop a web part to another position
     * @param dragIndices - The position of the control being dragged formatted as [layoutIndex, zoneIndex, sectionIndex, controlIndex].
     * @param dropIndices - The position of the control after being dropped formatted as [layoutIndex, zoneIndex, sectionIndex, controlIndex].
     * @param dragElementDataAutomationId - The data automation id of the element inside the drag item, used to whether the action succeeds.
     */
    Canvas.AddTaskDragAndDropWebPart = function (dragIndices, dropIndices, dragElementDataAutomationId) {
        Canvas._addTaskDragAndDropCore(function () {
            // dragHandle
            var dragItem = Canvas.getControlFromIndex(dragIndices[0], dragIndices[1], dragIndices[2], dragIndices[3]);
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(dragItem, 'moveButton');
        }, function () { return Canvas.getControlFromIndex(dragIndices[0], dragIndices[1], dragIndices[2], dragIndices[3]); }, // dragItem
        function () { return Canvas.getControlFromIndex(dropIndices[0], dropIndices[1], dropIndices[2], dropIndices[3]); }, // dropItem
        function () {
            // dropToLastPosition
            return dropIndices[3] === Canvas._getControls(dropIndices[0], dropIndices[1], dropIndices[2]).length || // Drop after last item
                // or drop will change the position of the dropped item.
                (dragIndices[0] === dropIndices[0] &&
                    dragIndices[1] === dropIndices[1] &&
                    dragIndices[2] === dropIndices[2] &&
                    dragIndices[3] < dropIndices[3]);
        }, dragElementDataAutomationId, function () { return dragIndices[0] === 1 || dropIndices[0] === 1; });
    };
    /**
     * Drag and drop a web part to another position
     * @param dragIndex - The index of the zone being dragged.
     * @param dropIndex - The index of the zone after being dropped.
     * @param dragElementDataAutomationId - The data automation id of the element inside the drag item, used to whether the action succeeds.
     */
    Canvas.AddTaskDragAndDropZone = function (dragIndex, dropIndex, dragElementDataAutomationId) {
        Canvas._addTaskDragAndDropCore(function () {
            // dragHandle
            var dragItem = Canvas._getZones()[dragIndex];
            return TAB.GetElement(dragItem, TAB.searchBy.customQuery, "[data-drag-handle='ZoneHandle']");
        }, function () { return Canvas._getZones()[dragIndex]; }, // dragItem
        function () { return Canvas._getZones()[dropIndex]; }, // dropItem
        function () { return dropIndex === Canvas._getZones().length || dragIndex < dropIndex; }, dragElementDataAutomationId);
    };
    Canvas.AddTaskChangeEmphasis = function (emphasis, zoneIndex) {
        var buttonElements = [];
        TAB.MakeWaiter(function () {
            buttonElements = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(TAB.Win, emphasis + "BackgroundColorButton");
            return buttonElements.length;
        })
            .Then(TAB.MakeTask(function () {
            TAB.Log.Comment('Change zone emphasis');
            TAB.ClickElement(buttonElements[0]);
        }))
            .WaitFor(this.getEmphasisWaiter(zoneIndex));
    };
    Canvas.AddTaskWaitForAnyCanvasControl = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for any canvas control (RTE or web part) to appear');
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='" + Canvas.CanvasControlId + "']");
        }));
    };
    Canvas.getEmphasisWaiter = function (zoneId) {
        return TAB.MakeWaiter(function () {
            try {
                var zones = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasZoneId);
                return zones[zoneId].parentElement.classList.contains('CanvasZoneContainerEmphasis');
            }
            catch (e) {
                return undefined;
            }
        });
    };
    Canvas.WaitForPropertyPaneChoiceGroupButtons = function () {
        return TAB.MakeWaiter(function () {
            try {
                var choiceGroupElements = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'ms-ChoiceField-input');
                return choiceGroupElements && choiceGroupElements.length > 0;
            }
            catch (e) {
                return undefined;
            }
        });
    };
    Canvas.getControlFromIndex = function (layoutIndex, zoneIndex, sectionIndex, controlIndex) {
        var controls = Canvas._getControls(layoutIndex, zoneIndex, sectionIndex);
        return controls[controlIndex];
    };
    /**
     * The core logic of drag and drop elements implemented by DragZone.
     * @param getDragHandle - Callback to get the drag handler of the drag item. E.g. move button
     * @param getDragItem - Callback to get the item being dragged
     * @param getDropItem - Callback to get the item being dropped
     * @param getShouldDropAfter - Whether should drop after the drop item. It's true when dropping after the last item,
     *  or in the case where the position of dropped item will be changed after the action.
     *  E.g. drag [0, 0, 0, 0] to [0, 0, 1, 0] is actually dragging first item AFTER the second item.
     * @param dragElementDataAutomationId - The data automation id of the element inside the drag item, used to whether the action succeeds.
     */
    Canvas._addTaskDragAndDropCore = function (getDragHandle, getDragItem, getDropItem, getShouldDropAfter, dragElementDataAutomationId, draggedToAndFromVSLayout) {
        // FireMouseEvent is not allowed in Edge due to initMouseEvent deprecation
        // Fix required in TABCore VSO#405141
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskWarning('Fire mouse event is not permitted in Edge.');
            return;
        }
        Canvas._addTaskWaitForScrollTime();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click on drag item to make sure toolbar shows');
            var dragItem = getDragItem();
            dragItem.click();
        }));
        var moveButton, dropItem;
        var itemOffset, targetItemOffset;
        var dropX, dropY;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Dragging element that contains an element with dataAutomationId " + dragElementDataAutomationId);
            moveButton = getDragHandle();
            dropItem = getDropItem();
            itemOffset = TAB.GetElementOffset(moveButton);
            targetItemOffset = TAB.GetElementOffset(dropItem);
            var dragX = Math.round(itemOffset.left + moveButton.clientWidth / 2);
            var dragY = Math.round(itemOffset.top + moveButton.clientHeight / 2);
            TAB.FireMouseEvent(moveButton, TAB.mouseEvent.mouseDown, new TAB.MouseEventData(dragX, dragY));
        }));
        var previousDropX, previousDropY, previousDropLocationExists;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                dropItem = getDropItem();
                targetItemOffset = TAB.GetElementOffset(dropItem);
                dropX = Math.round(targetItemOffset.left + dropItem.clientWidth / 2);
                dropY = getShouldDropAfter()
                    ? Math.round(targetItemOffset.top) + (dropItem.clientHeight * 3) / 4
                    : Math.round(targetItemOffset.top) + dropItem.clientHeight / 4;
                TAB.FireMouseEvent(moveButton, TAB.mouseEvent.mouseMove, new TAB.MouseEventData(dropX, dropY));
                // Make sure the drop position has not changed comparing to last time.
                // It's possible that the page is still scrolling during which time the drop location might be wrong.
                if (dropX === previousDropX && dropY === previousDropY && previousDropLocationExists) {
                    TAB.Log.Comment('Drop indicator shows up!');
                    return true;
                }
                else {
                    previousDropX = dropX;
                    previousDropY = dropY;
                    previousDropLocationExists =
                        TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='dropLocation']")
                            .length > 0;
                    return false;
                }
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            if (draggedToAndFromVSLayout && draggedToAndFromVSLayout()) {
                // We need to dispatch the focus event to updated selected layout index
                var wrapper = TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'CanvasComponentWrapper');
                var focusEv = TAB.Win.document.createEvent('HTMLEvents');
                focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
                wrapper[0].dispatchEvent(focusEv);
            }
            TAB.FireMouseEvent(moveButton, TAB.mouseEvent.mouseUp, new TAB.MouseEventData(dropX, dropY));
        }), TAB.MakeWaiter(function () {
            try {
                var droppedControl = getDropItem();
                var droppedWebPart = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementByDataAutomationId(droppedControl, dragElementDataAutomationId);
                return !!droppedWebPart;
            }
            catch (e) {
                return false;
            }
        }));
    };
    Canvas._getToolBoxHintButtons = function (rootElement, hintType) {
        try {
            var dataAutomationId = hintType === HintType.WebPartHint ? 'toolboxHint-webPart' : 'toolboxHint-zone';
            var tooBoxHintButton = _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(rootElement, dataAutomationId);
            return tooBoxHintButton;
        }
        catch (e) {
            return [];
        }
    };
    Canvas._getSelectedWebpartRoot = function () {
        try {
            var selectedWebpart = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ControlZone--selected');
            return selectedWebpart;
        }
        catch (e) {
            return undefined;
        }
    };
    Canvas._getLayouts = function () {
        return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasLayoutId);
    };
    /**
     * Get all canvas zones in the canvas.
     */
    Canvas._getZones = function (layoutIndex) {
        var rootElement = Canvas.rootCanvasElement;
        if (layoutIndex) {
            var canvasLayout = Canvas._getLayouts()[layoutIndex];
            rootElement = canvasLayout;
        }
        return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(rootElement, Canvas.CanvasZoneId);
    };
    /**
     * Get all sections in the given canvas zone.
     * It returns all sections in the canvas if zoneIndex is undefined.
     *
     * @param zoneIndex - The index of the zone where to get the sections.
     */
    Canvas._getSections = function (layoutIndex, zoneIndex) {
        var zones = Canvas._getZones(layoutIndex);
        if (zoneIndex === undefined) {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasSessionId);
        }
        else {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(zones[zoneIndex], Canvas.CanvasSessionId);
        }
    };
    /**
     * Get all controls in the given section.
     * It returns all controls in the zone if sectionIndex is undefined.
     * It returns all controls in the canvas if zoneIndex is undefined.
     *
     * @param zoneIndex - The index of the zone where to get the controls. When undefined, all controls within canvas are returned
     * @param sectionIndex - The index of the section where to get the controls. When undefined, all controls within given zone are returned.
     */
    Canvas._getControls = function (layoutIndex, zoneIndex, sectionIndex) {
        if (zoneIndex === undefined) {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(Canvas.rootCanvasElement, Canvas.CanvasControlId);
        }
        else if (sectionIndex === undefined) {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(this._getZones(layoutIndex)[zoneIndex], Canvas.CanvasControlId);
        }
        else {
            return _Next__WEBPACK_IMPORTED_MODULE_1__["Next"].GetElementsByDataAutomationId(this._getSections(layoutIndex, zoneIndex)[sectionIndex], Canvas.CanvasControlId);
        }
    };
    Canvas.createBlobFromUrl = function (blobFileKey, // Result will be saved on TAB[blobFileKey].
    url, filename, fileType) {
        // Create a XMLHttpRequest to transform the image from URL to array of data
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'arraybuffer';
        // Ensure the request finishes
        TAB.AddTask(TAB.MakeTask(function () {
            xhr.send();
        }), TAB.MakeWaiter(function () {
            try {
                return xhr.response !== null;
            }
            catch (e) {
                return false;
            }
        }));
        // Construct the Blob from the array of data
        TAB.AddTask(TAB.MakeTask(function () {
            var parts = [new Uint8Array(xhr.response)];
            var propertyBag = {
                type: fileType
            };
            TAB.Log.AddTaskPass('Blob created');
            // File needs to be saved to TAB global variable since it is
            // generated in async fashion. This can be accessed from any TAB test
            // with the same key.
            TAB[blobFileKey] = new TAB.Win.window.File(parts, filename, propertyBag);
        }), TAB.MakeWaiter(function () {
            try {
                return TAB[blobFileKey] !== null;
            }
            catch (e) {
                return false;
            }
        }));
    };
    Canvas.triggerDragOverDropZoneEvent = function (element, file, dragOverX, dragOverY, dropZoneElementIndex) {
        TAB.AddTask(TAB.MakeTask(function () {
            // Create event
            var event = TAB.Win.document.createEvent('DragEvent');
            event.initMouseEvent('dragover', true /* bubble */, true /* cancelable */, TAB.Win.window, 1 /* detailArg */, 1, 1, dragOverX, dragOverY /* coordinates */, false, false, false, false /* modifier keys */, 0 /* left */, element /* relatedTarget */);
            // Add file to dataTransfer of event
            event = Canvas.createFileDataTransferForEvent(event, file);
            // Trigger the event
            TAB.Log.Comment('dispatch dragOver event');
            element.dispatchEvent(event);
        }), TAB.MakeWaiter(function () {
            try {
                // Wait till the mark of drop place is changed.
                TAB[dropZoneElementIndex] = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='dropLocation']");
                return TAB[dropZoneElementIndex] !== undefined;
            }
            catch (e) {
                return false;
            }
        }));
    };
    Canvas.dropFileFromExternalSourceOnElement = function (element, file, dragOverX, dragOverY) {
        if (element.dispatchEvent) {
            // Create event
            var event_1 = TAB.Win.document.createEvent('DragEvent');
            event_1.initMouseEvent('drop', true /* bubble */, true /* cancelable */, TAB.Win.window, 1 /* detailArg */, 1, 1, dragOverX, dragOverY /* coordinates */, false, false, false, false /* modifier keys */, 0 /* left */, element /* relatedTarget */);
            // Add file to dataTransfer of event
            event_1 = Canvas.createFileDataTransferForEvent(event_1, file);
            // Trigger the event
            TAB.Log.Comment('dispatch drop event');
            element.dispatchEvent(event_1);
        }
    };
    Canvas.createFileDataTransferForEvent = function (event, file) {
        // Create dataTransfer
        var dataTransfer = new TAB.Win.window.DataTransfer();
        var mockDataTransfer = {
            dropEffect: 'all',
            effectAllowed: 'all',
            files: [file],
            items: dataTransfer.items,
            types: ['Files'],
            getData: function () { return file; }
        };
        TAB.Log.Comment('Append File to the event');
        // dataTransfer can only be assigned forcibly
        Object.defineProperty(event.constructor.prototype, 'dataTransfer', { value: mockDataTransfer });
        event.dataTransfer.items.add(file);
        return event;
    };
    Canvas._getImageUrl = function (image) {
        return TAB.GetElement(image, TAB.searchBy.tag, 'img').getAttribute('data-sp-originalimgsrc');
    };
    Canvas._addTaskWaitForScrollTime = function () {
        var startTimeInMs;
        TAB.AddTask(TAB.MakeTask(function () {
            startTimeInMs = performance.now();
        }), TAB.MakeWaiter(function () {
            return performance.now() - startTimeInMs >= 2000;
        }));
    };
    Canvas.Webparts = [];
    Canvas.CanvasRootId = 'Canvas';
    Canvas.CanvasZoneId = 'CanvasZone';
    Canvas.CanvasSessionId = 'CanvasSection';
    Canvas.CanvasControlId = 'CanvasControl';
    Canvas.CanvasLayoutId = 'CanvasLayout';
    Canvas.ToolboxId = 'toolbox-callout';
    return Canvas;
}());



/***/ }),

/***/ "mutv":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/BingMapWebpart.js ***!
  \**************************************************/
/*! exports provided: BingMapWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BingMapWebpart", function() { return BingMapWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var BingMapWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(BingMapWebpart, _super);
    function BingMapWebpart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].BingMap, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].BingMap.toString()) || this;
    }
    BingMapWebpart.prototype.AddTaskAddOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this.AddTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='bingMapWrapper']");
        }));
    };
    BingMapWebpart.prototype.AddTaskInputAddress = function (address) {
        TAB.MakeTask(function () {
            var addressInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[id*="searchBoxContainer"] input');
            TAB.Log.AddTaskComment('Input address.');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(addressInput, address);
        }).WaitFor(undefined);
    };
    BingMapWebpart.prototype.AddTaskTriggerSearch = function () {
        TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Search address.');
            var searchButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[id*="searchBoxContainer"] button');
            searchButton.click();
        }).WaitFor(TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='virtualPushPin']") &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
        }));
    };
    BingMapWebpart.prototype.AddTaskSetPushPinLabel = function (label) {
        TAB.MakeTask(function () {
            var labelInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="propertyPaneGroupContent"] input');
            TAB.Log.AddTaskComment('Set push pin label.');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(labelInput, label);
        }).WaitFor(undefined);
    };
    BingMapWebpart.prototype.AddTaskAssertPushPinLabel = function (label) {
        TAB.MakeTask(function () {
            var labelHeader = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="bingMapPushPinTitle"]');
            if (labelHeader.innerText !== label) {
                throw new Error("Assert pushpin label fail. Expected: " + label + "; actual: " + labelHeader.innerText + ";");
            }
        }).WaitFor(undefined);
    };
    BingMapWebpart.prototype.AddTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.leadingId, 'searchBoxContainer')) {
                throw 'Bing Map web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    return BingMapWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "mwqp":
/*!**********************!*\
  !*** ./lib/index.js ***!
  \**********************/
/*! exports provided: BaseCollectionWebPart, WebpartType, KeyCodes, FireKeyboardEvent, BaseWebpart, BingMapWebpart, Carousel, CommandBar, CommandBarItem, ConnectorWebPart, ContextMenu, CreateSitePanelForm, CreateSiteTemplateOption, GroupPrivacyOption, DesignPackageOption, CreateSitePanel, DocumentEmbedWebpart, DynamicDataConsumerWebPart, EmbedWebPart, EmbeddedVideoWebPart, EventPage, EventsWebPart, FieldType, Field, FieldsWebPart, FILE_PICKER_AUTOMATION_ID, FilePickerView, FilePicker, FormsWebPart, GroupCalendarWebPart, GroupMembershipPanel, HeroWebPart, ContentRollupLayout, HighlightedContentWebPart, Layout, ImageSourceType, ImageGalleryWebPart, ImageWebpart, LayoutOption, LinkPreviewWebpart, ListViewWebparWithItemsView, ListViewWebpart, ModernQuickEdit, NewsDigest, NewsFilter, NewsLink, NewsPinning, NewsWebPart, OfficeFeedWebPart, PeopleCardLayout, PeopleWebpart, OrgChartWebPart, PlannerWebpart, QuickChartWebPart, QuickLinksLayoutId, QuickLinksWebPart, RSSConnectorWebPart, RTELinkDialogOperation, RTEWebPart, ScopingControl, SendByEmailDialog, SendByYammerDialog, SiteActivityWebPart, SiteInformationPanel, SitePermissionPanel, SitesWebPart, SuiteNav, TeamsTabPicker, TeamsTabUrlConfigTest, TitleRegion, TwitterWebPart, upload, dataURItoFile, setFileInput, WeatherWebPart, WorldClockWebPart, YammerConversations, YammerHighlights, YouTubeEmbed, SessionStorageKey, CortexMockData, HintType, Canvas, CanvasToolbox, ClassicPage, Comments, CommentsMention, Footer, SPHome, MegaMenu, PageSettingsPanel, PageTemplatePickerOpenType, PageTemplatesPanel, PageVersionsPane, PrePublishPanel, PromotePage, PropertyPane, Router, SocialBar, SiteDesignId, TeamSitePage, TopicPage, TranslationUtil, UndoRedo, Workbench, PublishingPageMonitoring, AudienceTargeting, PartialId, ViewPortLoader, viewPortLoaderRichPageContent, TopicAnnotations, Navigation, ClientFeatures, PageAnchor, ReactTriggerChange, ReactSetValueChange, TenantAdminHomePage, TenantAdminContentTypeGallery, TenantAdminTermStoreAdminCenter, MemoryTestWebPartType, MemoryTestUtils, Cookies, Csom, DocLibUtil, ExtensionUtil, Group, NavType, InPlaceNavUtil, ListItem, List, Next, PageUtil, MuiSettingsPage, areVectorsEqual, SpaceUtil, PerformancePageUtil, ReactUtil, ServiceWorkerUtil, SPCoachmarkUtil, SPFlightUtil, SPExperimentUtil, SPKillSwitchUtil, Site, ADMIN_TAB_USER_INDEX, USER0_TAB_USER_INDEX, USER1_TAB_USER_INDEX, USER2_TAB_USER_INDEX, USER3_TAB_USER_INDEX, UserUtil, Web */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SPTaskLib/Controls */ "iDSo");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseCollectionWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["BaseCollectionWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebpartType", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["WebpartType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KeyCodes", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["KeyCodes"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FireKeyboardEvent", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FireKeyboardEvent"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["BaseWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BingMapWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["BingMapWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Carousel", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["Carousel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommandBar", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["CommandBar"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommandBarItem", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["CommandBarItem"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ConnectorWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ConnectorWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ContextMenu", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ContextMenu"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CreateSitePanelForm", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["CreateSitePanelForm"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CreateSiteTemplateOption", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["CreateSiteTemplateOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupPrivacyOption", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["GroupPrivacyOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DesignPackageOption", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["DesignPackageOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CreateSitePanel", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["CreateSitePanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentEmbedWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["DocumentEmbedWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DynamicDataConsumerWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["DynamicDataConsumerWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EmbedWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["EmbedWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EmbeddedVideoWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["EmbeddedVideoWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventPage", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["EventPage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventsWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["EventsWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FieldType", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FieldType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Field", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["Field"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FieldsWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FieldsWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FILE_PICKER_AUTOMATION_ID", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FILE_PICKER_AUTOMATION_ID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FilePickerView", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FilePickerView"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FilePicker", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FilePicker"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FormsWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["FormsWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupCalendarWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["GroupCalendarWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupMembershipPanel", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["GroupMembershipPanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HeroWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["HeroWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ContentRollupLayout", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ContentRollupLayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HighlightedContentWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["HighlightedContentWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["Layout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageSourceType", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ImageSourceType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageGalleryWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ImageGalleryWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ImageWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LayoutOption", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["LayoutOption"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LinkPreviewWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["LinkPreviewWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ListViewWebparWithItemsView", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ListViewWebparWithItemsView"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ListViewWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ListViewWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ModernQuickEdit", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ModernQuickEdit"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsDigest", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["NewsDigest"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsFilter", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["NewsFilter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsLink", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["NewsLink"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsPinning", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["NewsPinning"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NewsWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["NewsWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OfficeFeedWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["OfficeFeedWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PeopleCardLayout", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["PeopleCardLayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PeopleWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["PeopleWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OrgChartWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["OrgChartWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PlannerWebpart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["PlannerWebpart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuickChartWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["QuickChartWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuickLinksLayoutId", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["QuickLinksLayoutId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuickLinksWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["QuickLinksWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RSSConnectorWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["RSSConnectorWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RTELinkDialogOperation", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["RTELinkDialogOperation"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RTEWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["RTEWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScopingControl", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["ScopingControl"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SendByEmailDialog", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SendByEmailDialog"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SendByYammerDialog", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SendByYammerDialog"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SiteActivityWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SiteActivityWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SiteInformationPanel", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SiteInformationPanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SitePermissionPanel", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SitePermissionPanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SitesWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SitesWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SuiteNav", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["SuiteNav"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsTabPicker", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["TeamsTabPicker"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsTabUrlConfigTest", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["TeamsTabUrlConfigTest"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TitleRegion", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["TitleRegion"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TwitterWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["TwitterWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "upload", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["upload"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "dataURItoFile", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["dataURItoFile"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "setFileInput", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["setFileInput"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeatherWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["WeatherWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WorldClockWebPart", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["WorldClockWebPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "YammerConversations", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["YammerConversations"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "YammerHighlights", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["YammerHighlights"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "YouTubeEmbed", function() { return _SPTaskLib_Controls__WEBPACK_IMPORTED_MODULE_0__["YouTubeEmbed"]; });

/* harmony import */ var _SPTaskLib_Mocks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SPTaskLib/Mocks */ "4upd");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SessionStorageKey", function() { return _SPTaskLib_Mocks__WEBPACK_IMPORTED_MODULE_1__["SessionStorageKey"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CortexMockData", function() { return _SPTaskLib_Mocks__WEBPACK_IMPORTED_MODULE_1__["CortexMockData"]; });

/* harmony import */ var _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SPTaskLib/Pages */ "JWtQ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HintType", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["HintType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Canvas", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["Canvas"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CanvasToolbox", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["CanvasToolbox"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClassicPage", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["ClassicPage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Comments", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["Comments"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommentsMention", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["CommentsMention"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Footer", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["Footer"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHome", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["SPHome"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MegaMenu", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["MegaMenu"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageSettingsPanel", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PageSettingsPanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageTemplatePickerOpenType", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PageTemplatePickerOpenType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageTemplatesPanel", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PageTemplatesPanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageVersionsPane", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PageVersionsPane"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PrePublishPanel", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PrePublishPanel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PromotePage", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PromotePage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PropertyPane", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PropertyPane"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Router", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["Router"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SocialBar", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["SocialBar"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SiteDesignId", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["SiteDesignId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamSitePage", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["TeamSitePage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TopicPage", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["TopicPage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TranslationUtil", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["TranslationUtil"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UndoRedo", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["UndoRedo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Workbench", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["Workbench"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PublishingPageMonitoring", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PublishingPageMonitoring"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AudienceTargeting", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["AudienceTargeting"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PartialId", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["PartialId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ViewPortLoader", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["ViewPortLoader"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "viewPortLoaderRichPageContent", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["viewPortLoaderRichPageContent"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TopicAnnotations", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["TopicAnnotations"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Navigation", function() { return _SPTaskLib_Pages__WEBPACK_IMPORTED_MODULE_2__["Navigation"]; });

/* harmony import */ var _SPTaskLib_Utilities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SPTaskLib/Utilities */ "H50h");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientFeatures", function() { return _SPTaskLib_Utilities__WEBPACK_IMPORTED_MODULE_3__["ClientFeatures"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageAnchor", function() { return _SPTaskLib_Utilities__WEBPACK_IMPORTED_MODULE_3__["PageAnchor"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ReactTriggerChange", function() { return _SPTaskLib_Utilities__WEBPACK_IMPORTED_MODULE_3__["ReactTriggerChange"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ReactSetValueChange", function() { return _SPTaskLib_Utilities__WEBPACK_IMPORTED_MODULE_3__["ReactSetValueChange"]; });

/* harmony import */ var _SPTaskLib_TenantAdmin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SPTaskLib/TenantAdmin */ "06bY");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TenantAdminHomePage", function() { return _SPTaskLib_TenantAdmin__WEBPACK_IMPORTED_MODULE_4__["TenantAdminHomePage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TenantAdminContentTypeGallery", function() { return _SPTaskLib_TenantAdmin__WEBPACK_IMPORTED_MODULE_4__["TenantAdminContentTypeGallery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TenantAdminTermStoreAdminCenter", function() { return _SPTaskLib_TenantAdmin__WEBPACK_IMPORTED_MODULE_4__["TenantAdminTermStoreAdminCenter"]; });

/* harmony import */ var _SPTaskLib_MemoryTest__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SPTaskLib/MemoryTest */ "+rIA");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MemoryTestWebPartType", function() { return _SPTaskLib_MemoryTest__WEBPACK_IMPORTED_MODULE_5__["MemoryTestWebPartType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MemoryTestUtils", function() { return _SPTaskLib_MemoryTest__WEBPACK_IMPORTED_MODULE_5__["MemoryTestUtils"]; });

/* harmony import */ var _SPTaskLib_CookieUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SPTaskLib/CookieUtil */ "rWka");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Cookies", function() { return _SPTaskLib_CookieUtil__WEBPACK_IMPORTED_MODULE_6__["Cookies"]; });

/* harmony import */ var _SPTaskLib_CsomUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SPTaskLib/CsomUtil */ "UXDa");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Csom", function() { return _SPTaskLib_CsomUtil__WEBPACK_IMPORTED_MODULE_7__["Csom"]; });

/* harmony import */ var _SPTaskLib_DocLibUtil__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SPTaskLib/DocLibUtil */ "FN+G");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocLibUtil", function() { return _SPTaskLib_DocLibUtil__WEBPACK_IMPORTED_MODULE_8__["DocLibUtil"]; });

/* harmony import */ var _SPTaskLib_ExtensionUtil__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./SPTaskLib/ExtensionUtil */ "iw6+");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ExtensionUtil", function() { return _SPTaskLib_ExtensionUtil__WEBPACK_IMPORTED_MODULE_9__["ExtensionUtil"]; });

/* harmony import */ var _SPTaskLib_GroupLibrary__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SPTaskLib/GroupLibrary */ "FSRG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Group", function() { return _SPTaskLib_GroupLibrary__WEBPACK_IMPORTED_MODULE_10__["Group"]; });

/* harmony import */ var _SPTaskLib_InPlaceNavUtil__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./SPTaskLib/InPlaceNavUtil */ "xG3W");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NavType", function() { return _SPTaskLib_InPlaceNavUtil__WEBPACK_IMPORTED_MODULE_11__["NavType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InPlaceNavUtil", function() { return _SPTaskLib_InPlaceNavUtil__WEBPACK_IMPORTED_MODULE_11__["InPlaceNavUtil"]; });

/* harmony import */ var _SPTaskLib_ListItemLibrary__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SPTaskLib/ListItemLibrary */ "1A/J");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ListItem", function() { return _SPTaskLib_ListItemLibrary__WEBPACK_IMPORTED_MODULE_12__["ListItem"]; });

/* harmony import */ var _SPTaskLib_ListLibrary__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SPTaskLib/ListLibrary */ "7on5");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "List", function() { return _SPTaskLib_ListLibrary__WEBPACK_IMPORTED_MODULE_13__["List"]; });

/* harmony import */ var _SPTaskLib_Next__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SPTaskLib/Next */ "BJbA");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Next", function() { return _SPTaskLib_Next__WEBPACK_IMPORTED_MODULE_14__["Next"]; });

/* harmony import */ var _SPTaskLib_PageUtil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./SPTaskLib/PageUtil */ "jK1H");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageUtil", function() { return _SPTaskLib_PageUtil__WEBPACK_IMPORTED_MODULE_15__["PageUtil"]; });

/* harmony import */ var _SPTaskLib_MuiSettingsPage__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./SPTaskLib/MuiSettingsPage */ "4VGn");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MuiSettingsPage", function() { return _SPTaskLib_MuiSettingsPage__WEBPACK_IMPORTED_MODULE_16__["MuiSettingsPage"]; });

/* harmony import */ var _SPTaskLib_SpaceUtil__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./SPTaskLib/SpaceUtil */ "IfeM");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "areVectorsEqual", function() { return _SPTaskLib_SpaceUtil__WEBPACK_IMPORTED_MODULE_17__["areVectorsEqual"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SpaceUtil", function() { return _SPTaskLib_SpaceUtil__WEBPACK_IMPORTED_MODULE_17__["SpaceUtil"]; });

/* harmony import */ var _SPTaskLib_PerformancePageUtil__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./SPTaskLib/PerformancePageUtil */ "37hx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PerformancePageUtil", function() { return _SPTaskLib_PerformancePageUtil__WEBPACK_IMPORTED_MODULE_18__["PerformancePageUtil"]; });

/* harmony import */ var _SPTaskLib_ReactUtil__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./SPTaskLib/ReactUtil */ "Qf+y");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ReactUtil", function() { return _SPTaskLib_ReactUtil__WEBPACK_IMPORTED_MODULE_19__["ReactUtil"]; });

/* harmony import */ var _SPTaskLib_ServiceWorkerUtil__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./SPTaskLib/ServiceWorkerUtil */ "UB0n");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServiceWorkerUtil", function() { return _SPTaskLib_ServiceWorkerUtil__WEBPACK_IMPORTED_MODULE_20__["ServiceWorkerUtil"]; });

/* harmony import */ var _SPTaskLib_SPCoachmarkUtil__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./SPTaskLib/SPCoachmarkUtil */ "8oVI");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPCoachmarkUtil", function() { return _SPTaskLib_SPCoachmarkUtil__WEBPACK_IMPORTED_MODULE_21__["SPCoachmarkUtil"]; });

/* harmony import */ var _SPTaskLib_SPFlightUtil__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./SPTaskLib/SPFlightUtil */ "i6xm");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPFlightUtil", function() { return _SPTaskLib_SPFlightUtil__WEBPACK_IMPORTED_MODULE_22__["SPFlightUtil"]; });

/* harmony import */ var _SPTaskLib_SPExperimentUtil__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./SPTaskLib/SPExperimentUtil */ "qDkj");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPExperimentUtil", function() { return _SPTaskLib_SPExperimentUtil__WEBPACK_IMPORTED_MODULE_23__["SPExperimentUtil"]; });

/* harmony import */ var _SPTaskLib_SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./SPTaskLib/SPKillSwitchUtil */ "y5Zv");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPKillSwitchUtil", function() { return _SPTaskLib_SPKillSwitchUtil__WEBPACK_IMPORTED_MODULE_24__["SPKillSwitchUtil"]; });

/* harmony import */ var _SPTaskLib_SiteLibrary__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./SPTaskLib/SiteLibrary */ "2JS8");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Site", function() { return _SPTaskLib_SiteLibrary__WEBPACK_IMPORTED_MODULE_25__["Site"]; });

/* harmony import */ var _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./SPTaskLib/UserUtil */ "jfni");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ADMIN_TAB_USER_INDEX", function() { return _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__["ADMIN_TAB_USER_INDEX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "USER0_TAB_USER_INDEX", function() { return _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__["USER0_TAB_USER_INDEX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "USER1_TAB_USER_INDEX", function() { return _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__["USER1_TAB_USER_INDEX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "USER2_TAB_USER_INDEX", function() { return _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__["USER2_TAB_USER_INDEX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "USER3_TAB_USER_INDEX", function() { return _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__["USER3_TAB_USER_INDEX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UserUtil", function() { return _SPTaskLib_UserUtil__WEBPACK_IMPORTED_MODULE_26__["UserUtil"]; });

/* harmony import */ var _SPTaskLib_WebLibrary__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./SPTaskLib/WebLibrary */ "Ckxo");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Web", function() { return _SPTaskLib_WebLibrary__WEBPACK_IMPORTED_MODULE_27__["Web"]; });

/// <reference path="./typings/tsd.d.ts" />






























/***/ }),

/***/ "pMbQ":
/*!*******************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ImageGalleryWebPart.js ***!
  \*******************************************************/
/*! exports provided: Layout, ImageSourceType, ImageGalleryWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return Layout; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageSourceType", function() { return ImageSourceType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageGalleryWebPart", function() { return ImageGalleryWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");






/**
 * @public
 */
var Layout;
(function (Layout) {
    Layout[Layout["Carousel"] = 1] = "Carousel";
    Layout[Layout["Grid"] = 2] = "Grid";
    Layout[Layout["Masonry"] = 3] = "Masonry";
    Layout[Layout["Brick"] = 4] = "Brick";
})(Layout || (Layout = {}));
/**
 * @public
 */
var ImageSourceType;
(function (ImageSourceType) {
    ImageSourceType[ImageSourceType["Curated"] = 1] = "Curated";
    ImageSourceType[ImageSourceType["Dynamic"] = 2] = "Dynamic";
})(ImageSourceType || (ImageSourceType = {}));
/**
 * @public
 */
var ImageGalleryWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(ImageGalleryWebPart, _super);
    function ImageGalleryWebPart() {
        var _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].ImageGallery, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].ImageGallery.toString()) || this;
        _this._imageSourceType = ImageSourceType.Curated;
        _this._layout = Layout.Grid;
        return _this;
    }
    ImageGalleryWebPart._fireMouseEvent = function (type, elem, centerX, centerY) {
        var evt = document.createEvent('MouseEvents');
        evt.initMouseEvent(type, true, true, window, 1, 1, 1, centerX, centerY, false, false, false, false, 0, elem);
        elem.dispatchEvent(evt);
    };
    Object.defineProperty(ImageGalleryWebPart.prototype, "isCuratedMode", {
        get: function () {
            return this._imageSourceType === ImageSourceType.Curated;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageGalleryWebPart.prototype, "isDynamicMode", {
        get: function () {
            return this._imageSourceType === ImageSourceType.Dynamic;
        },
        enumerable: true,
        configurable: true
    });
    ImageGalleryWebPart.prototype.AddTaskAddWebPart = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Add ImageGallery web part');
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), this._waitForWebPartAndPropertyPaneExist());
    };
    ImageGalleryWebPart.prototype.AddTaskEditItemByIndex = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var imageItem = _this._getItemByIndex(index);
            var editButton = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(imageItem, 'edit-button');
            if (editButton) {
                TAB.Log.AddTaskPass("Edit button found for item at position " + index);
                TAB.Log.AddTaskComment('click edit button on item');
                TAB.ClickElement(editButton);
            }
            else {
                TAB.Log.AddTaskFail("Edit button not found for item at position " + index);
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']"));
    };
    /**
     * Click on an image item to launch lightbox.
     * @param index - The position of the item.
     */
    ImageGalleryWebPart.prototype.AddTaskOpenImageLightboxByIndex = function (index) {
        var _this = this;
        var clickItem;
        TAB.AddTask(TAB.MakeTask(function () {
            clickItem = _this._getItemByIndex(index);
            TAB.Log.Comment("click item at position " + index);
            TAB.ClickElement(clickItem);
        }), TAB.MakeWaiter(function () {
            try {
                var hasLightbox = Boolean(_this._getLightbox(true /* allowFail */));
                if (!hasLightbox) {
                    TAB.ClickElement(clickItem);
                }
                return hasLightbox;
            }
            catch (e) {
                return false;
            }
        }));
    };
    /**
     * When image lightbox is opened, assert the title to be expected value.
     * @param title - The title of the item that should be shown in lightbox.
     */
    ImageGalleryWebPart.prototype.AddTaskAssertTitleInLightbox = function (title) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            try {
                var lightbox = _this._getLightbox(false /* allowFail */);
                TAB.Log.AddTaskComment('Try to find the title element in image lightbox');
                var titleElement = TAB.GetElement(lightbox, TAB.searchBy.customQuery, '[data-automation-id="lightBoxTitle"]');
                if (titleElement.textContent === title) {
                    TAB.Log.AddTaskPass('Found correct title in image lightbox');
                }
                else {
                    TAB.Log.AddTaskFail("Title in image light box is not expected. Expected: " + title + ". Actual: " + titleElement.textContent);
                }
            }
            catch (e) {
                TAB.Log.AddTaskFail(e);
            }
        }));
    };
    ImageGalleryWebPart.prototype.AddTaskDismissImageLightbox = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Try to find the close button in lightbox');
            var lightbox = _this._getLightbox(false /* allowFail */);
            var closeButton = TAB.GetElement(lightbox, TAB.searchBy.hasClassName, 'ms-PanelAction-close');
            if (closeButton) {
                TAB.Log.AddTaskComment('Click close button to close the lightbox');
                TAB.ClickElement(closeButton);
            }
            else {
                TAB.Log.AddTaskFail('Close button not found');
            }
        }), TAB.MakeWaiter(function () {
            try {
                return !_this._getLightbox(true /* allowFail */);
            }
            catch (e) {
                return false;
            }
        }));
    };
    ImageGalleryWebPart.prototype.AddTaskUpdateTitleInPropertyPane = function (title) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Change title of image gallery item');
            var propertyPane = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].GetPropertyPane();
            var inputForTitle = TAB.GetElements(propertyPane, TAB.searchBy.tag, 'INPUT')[0];
            _ReactUtil__WEBPACK_IMPORTED_MODULE_5__["ReactUtil"].TriggerOnChange(inputForTitle, title);
        }));
    };
    ImageGalleryWebPart.prototype.AddTaskChangeLayout = function (layout) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Change layout of image gallery');
            var propertyPane = _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].GetPropertyPane();
            var choiceInputs = TAB.GetElements(propertyPane, TAB.searchBy.customQuery, "[data-automation-id=\"PropertyPaneChoiceGroup-" + layout + "\"]");
            // In the property pane of image gallery web part, there are two choices groups. And in each group
            // the keys of the options are same which will lead to same automation-id. Because the layout choice
            // group is the last one, so always use the last one.
            TAB.ClickElement(choiceInputs[choiceInputs.length - 1]);
        }));
    };
    /**
     * Delete an image by given index.
     * @param index - The index of the image item.
     */
    ImageGalleryWebPart.prototype.AddTaskDeleteItemByIndex = function (index) {
        var _this = this;
        var deletedItemUrl;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("get item at position " + index);
            var items = _this.GetImageElements();
            var deleteItem = items[index];
            deletedItemUrl = _this.GetImageUrlByIndex(index);
            TAB.Log.AddTaskComment("delete item at position " + index);
            if (deleteItem) {
                var deleteButton = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(deleteItem, 'delete-button');
                TAB.ClickElement(deleteButton);
            }
            else {
                TAB.Log.AddTaskFail('Delete button not found');
            }
        }), TAB.MakeWaiter(function () { return _this.GetImageUrlByIndex(index) !== deletedItemUrl; }));
    };
    /**
     * Drag and drop image elements.
     * @param dragIndex - The index of the drag source element.
     * @param dropIndex - The index of the drop target element;
     */
    ImageGalleryWebPart.prototype.AddTaskDragAndDropItem = function (dragIndex, dropIndex) {
        var _this = this;
        if (this._layout === Layout.Carousel ||
            this._layout === Layout.Masonry ||
            this._layout === Layout.Brick) {
            throw new Error("Drag and drop feature is not available for '" + Layout[this._layout] + "' layout");
        }
        if (this._imageSourceType === ImageSourceType.Dynamic) {
            throw new Error('Drag and drop feature is not available for dynamic (document library) mode');
        }
        // FireMouseEvent is not allowed in Edge due to initMouseEvent deprecation
        // Fix required in TABCore VSO#405141
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskWarning('Skipping test: Fire mouse event is not permitted in Edge.');
            return;
        }
        var item;
        var targetElement;
        var itemOffset, targetItemOffset;
        var dropX, dropY;
        var dragElementSrc, dropElementSrc;
        TAB.AddTask(TAB.MakeTask(function () {
            item = _this.GetImageElements()[dragIndex];
            targetElement = _this.GetImageElements()[dropIndex];
            dragElementSrc = _this.GetImageUrlByIndex(dragIndex);
            dropElementSrc = _this.GetImageUrlByIndex(dropIndex);
            itemOffset = TAB.GetElementOffset(item);
            targetItemOffset = TAB.GetElementOffset(targetElement);
            var dragX = Math.round(itemOffset.left + item.clientWidth / 2);
            var dragY = Math.round(itemOffset.top + item.clientHeight / 2);
            dropX = Math.round(targetItemOffset.left + item.clientWidth) - 1;
            dropY = Math.round(targetItemOffset.top + item.clientHeight) - 1;
            // TAB framework doesn't provide drag* mouse events.
            // But here we need drag events to simulate HTML5 drag and drop.
            // It's inspired by https://ghostinspector.com/blog/simulate-drag-and-drop-javascript-casperjs/
            TAB.Log.AddTaskComment('Mouse over dragged element and mousedown');
            ImageGalleryWebPart._fireMouseEvent('mousemove', item, dragX, dragY);
            ImageGalleryWebPart._fireMouseEvent('mouseenter', item, dragX, dragY);
            ImageGalleryWebPart._fireMouseEvent('mouseover', item, dragX, dragY);
            ImageGalleryWebPart._fireMouseEvent('mousedown', item, dragX, dragY);
            TAB.Log.AddTaskComment('Start dragging process over to drop target');
            ImageGalleryWebPart._fireMouseEvent('dragstart', item, dragX, dragY);
            ImageGalleryWebPart._fireMouseEvent('drag', item, dragX, dragY);
            ImageGalleryWebPart._fireMouseEvent('mousemove', item, dragX, dragY);
            ImageGalleryWebPart._fireMouseEvent('drag', item, dropX, dropY);
            ImageGalleryWebPart._fireMouseEvent('mousemove', targetElement, dropX, dropY);
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.AddTaskComment('Trigger dragging process on top of drop target');
                ImageGalleryWebPart._fireMouseEvent('mouseenter', targetElement, dropX, dropY);
                ImageGalleryWebPart._fireMouseEvent('dragenter', targetElement, dropX, dropY);
                ImageGalleryWebPart._fireMouseEvent('mouseover', targetElement, dropX, dropY);
                ImageGalleryWebPart._fireMouseEvent('dragover', targetElement, dropX, dropY);
                var draggingElementSrc = _this.GetImageUrlByIndex(dropIndex);
                return dragElementSrc === draggingElementSrc;
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Release dragged element on top of drop target');
            ImageGalleryWebPart._fireMouseEvent('drop', targetElement, dropX, dropY);
            ImageGalleryWebPart._fireMouseEvent('dragend', item, dropX, dropY);
            ImageGalleryWebPart._fireMouseEvent('mouseup', item, dropX, dropY);
        }), TAB.MakeWaiter(function () {
            return (_this.GetImageUrlByIndex(dropIndex) === dragElementSrc &&
                _this.GetImageUrlByIndex(dropIndex - 1) === dropElementSrc);
        }));
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskSavePage();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskPublishPage();
        TAB.MakeWaiter(function () {
            return (_this.GetImageUrlByIndex(dropIndex) === dragElementSrc &&
                _this.GetImageUrlByIndex(dropIndex - 1) === dropElementSrc);
        }).Wait();
    };
    /**
     * Get image HTML elements. If there is no item, an empty array will be returned.
     */
    ImageGalleryWebPart.prototype.GetImageElements = function () {
        switch (this._layout) {
            case Layout.Grid:
                return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementsByDataAutomationId(this.root, 'image-item');
            default:
                throw new Error("Test is not implemented for " + Layout[this._layout] + " layout");
        }
    };
    /**
     * Return the src url of one image by index.
     * @param index - The index of the image.
     */
    ImageGalleryWebPart.prototype.GetImageUrlByIndex = function (index) {
        var items = this.GetImageElements();
        if (items.length > index) {
            var element = TAB.GetElement(items[index], TAB.searchBy.tag, 'img');
            return element ? element.src : undefined;
        }
        else {
            TAB.Log.Warning('ImageGallery does not have item with index = ' + index);
            return undefined;
        }
    };
    ImageGalleryWebPart.prototype.AddTaskAddImagesFromUploading = function (fileInput) {
        var _this = this;
        this._addTaskOpenFilePickerForAddItem();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].AddTaskCreateFilePicker();
        var itemCount;
        TAB.AddTask(TAB.MakeTask(function () {
            itemCount = _this.GetImageElements().length;
            TAB.Log.AddTaskComment('Add image item from uploading');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_3__["TeamSitePage"].FilePicker.AddTaskUploadItem(fileInput);
        }), TAB.MakeWaiter(function () {
            var count = 0;
            var elements = _this.GetImageElements();
            for (var i = 0; i < elements.length; i++) {
                try {
                    var imgElement = TAB.GetElement(elements[i], TAB.searchBy.tag, 'img');
                    if (!!imgElement) {
                        count++;
                    }
                }
                catch (error) {
                    return undefined;
                }
            }
            return count === itemCount + 1;
        }));
    };
    /**
     * Find the lightbox component.
     * @param allowFail - Whether a fail task will be added if lightbox not found. In some cases,
     *  we don't want to fail the test because it's expected that lightbox is not found.
     *  e.g. In a TAB waiter or asserting lightbox is closed when click on close button.
     */
    ImageGalleryWebPart.prototype._getLightbox = function (allowFail) {
        var lightbox;
        try {
            TAB.Log.AddTaskComment('Try to find image lightbox');
            lightbox = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="lightBoxPanel"]');
            TAB.Log.AddTaskPass('Found Image lightbox');
        }
        catch (e) {
            if (!allowFail) {
                TAB.Log.AddTaskFail(e);
            }
        }
        return lightbox;
    };
    ImageGalleryWebPart.prototype._getItemByIndex = function (index) {
        TAB.Log.AddTaskComment("Try to get item at position " + index);
        var imageItem = this.GetImageElements()[index];
        if (imageItem) {
            TAB.Log.AddTaskPass("Image item found at position " + index);
        }
        else {
            TAB.Log.AddTaskFail("Image item at position " + index + " not found");
        }
        return imageItem;
    };
    ImageGalleryWebPart.prototype._addTaskOpenFilePickerForAddItem = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click +Add button');
            TAB.ClickElement(_this._getAddButton());
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']"));
    };
    /**
     * Get "+Add" button element on web part if exists. Otherwise it will return undefined.
     */
    ImageGalleryWebPart.prototype._getAddButton = function () {
        try {
            if (this.isCuratedMode) {
                return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(this.root, 'addImages-button');
            }
            else {
                return undefined;
            }
        }
        catch (e) {
            return undefined;
        }
    };
    ImageGalleryWebPart.prototype._waitForWebPartAndPropertyPaneExist = function () {
        return TAB.MakeWaiter(function () {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='imageGallery']") &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']"));
        });
    };
    return ImageGalleryWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "pWCE":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/TeamsTabPicker.js ***!
  \**************************************************/
/*! exports provided: TeamsTabPicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TeamsTabPicker", function() { return TeamsTabPicker; });
/**
 * Provides tasks to use when testing the Teams tab picker page.
 * The Teams tab picker page shows the pages and lists on a site which users may choose to display inside a Teams tab.
 * You can view this page by appending /_layouts/15/teamstabconfiguration.aspx to the site URL.
 *
 * @public
 */
var TeamsTabPicker = /** @class */ (function () {
    function TeamsTabPicker() {
    }
    /** Navigate to the Teams tab picker page */
    TeamsTabPicker.AddTaskGoToTeamsTabPickerPage = function (serverUrl, groupAlias) {
        var pageUrl = serverUrl + "/sites/" + groupAlias + "/_layouts/15/teamstabconfiguration.aspx";
        TAB.Log.AddTaskComment('Navigating to Teams tab picker page for site ' + pageUrl);
        TAB.AddTask(TAB.LoadPage(pageUrl), TAB.AndWaiters(TAB.PageReady(), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PagesAndListsPivots']")));
    };
    /** Verify that the pivot control appears */
    TeamsTabPicker.AddTaskVerifyPivots = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring pivots appear');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PagesAndListsPivots']"));
    };
    /** Verify that the pages pivot item appears */
    TeamsTabPicker.AddTaskVerifyPagesPivotItem = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring pages pivot item appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'pagesPivotItem'));
    };
    /** Verify that the lists pivot item appears */
    TeamsTabPicker.AddTaskVerifyListsPivotItem = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring lists pivot item appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'listsPivotItem'));
    };
    /** Verify that the list of available pages appears */
    TeamsTabPicker.AddTaskVerifyPagesList = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring list of available pages appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PagesList']"));
    };
    /** Click the lists pivot and verify that the list of available lists appears */
    TeamsTabPicker.AddTaskVerifyListsList = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring list of available lists appears');
            TeamsTabPicker._addTaskClickListsPivot();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='ListsList']"));
    };
    // The tests below are for the new experience that we are testing by A/B Experimentation.
    /** Verify that the recommended pivot item appears */
    TeamsTabPicker.AddTaskVerifyRecPivotItem = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring recommended pivot item appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'recPivotItem'));
    };
    /** Verify that the doclib pivot item appears */
    TeamsTabPicker.AddTaskVerifyDoclibPivotItem = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring document library pivot item appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'doclibPivotItem'));
    };
    /**  Click the pages pivot and verify that the list of available pages appears */
    TeamsTabPicker.AddTaskVerifyPagesListExpt = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring list of available pages appears');
            TeamsTabPicker._addTaskClickGivenPivot('pagesPivotItem', 'Pages Pivot');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='PagesList']"));
    };
    /** Click the Document Library pivot and verify that the list of available doclibs appears */
    TeamsTabPicker.AddTaskVerifyDoclibsListExpt = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring list of available document libraries appears');
            TeamsTabPicker._addTaskClickGivenPivot('doclibPivotItem', 'Document Library Pivot');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='DoclibsList']"));
    };
    /** Verify that the list of available recommended items appears */
    TeamsTabPicker.AddTaskVerifyRecListExpt = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring list of available recommended items appears');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automationid='RecList']"));
    };
    /**
     * Find (by ID) and click the given item.
     * @param id - The ID of the pivot item to click.
     * @param desc - Description of the pivot item for logging.
     */
    TeamsTabPicker._addTaskClickGivenPivot = function (id, desc) {
        TAB.Log.AddTaskComment('Obtaining the Lists pivot element');
        var pivot = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                pivot = TAB.GetElement(TAB.Win, TAB.searchBy.id, id);
                return Boolean(pivot);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the ' + desc);
            TAB.ClickElement(pivot);
        }), undefined);
    };
    TeamsTabPicker._addTaskClickListsPivot = function () {
        TAB.Log.AddTaskComment('Obtaining the Lists pivot element');
        var listsPivot = undefined;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                listsPivot = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'listsPivotItem');
                return Boolean(listsPivot);
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking the Lists pivot');
            TAB.ClickElement(listsPivot);
        }), undefined);
    };
    return TeamsTabPicker;
}());



/***/ }),

/***/ "qC36":
/*!*****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/QuickLinksWebPart.js ***!
  \*****************************************************/
/*! exports provided: QuickLinksLayoutId, QuickLinksWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuickLinksLayoutId", function() { return QuickLinksLayoutId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuickLinksWebPart", function() { return QuickLinksWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Pages/TeamSitePage */ "UjPA");
/* harmony import */ var _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Pages/PropertyPane */ "M/CL");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");








/**
 * Layout id for QuickLinks Web part.
 * The value of each layout indicates the order in property pane.
 *
 * @public
 */
var QuickLinksLayoutId;
(function (QuickLinksLayoutId) {
    QuickLinksLayoutId[QuickLinksLayoutId["Compact"] = 0] = "Compact";
    QuickLinksLayoutId[QuickLinksLayoutId["FilmStrip"] = 1] = "FilmStrip";
})(QuickLinksLayoutId || (QuickLinksLayoutId = {}));
/**
 * @public
 */
var QuickLinksWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(QuickLinksWebPart, _super);
    function QuickLinksWebPart() {
        var _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].QuickLinks, _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].QuickLinks.toString()) || this;
        _this._layoutType = QuickLinksLayoutId.Compact;
        return _this;
    }
    QuickLinksWebPart.prototype.AddTaskAddWebPartOnTeamSitePage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Add Quick Links Web Part');
            _this.AddTaskSetupNewPage();
            _this._addTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(_this);
        }), this._waitForWebPartEmptyStateToExist());
    };
    QuickLinksWebPart.prototype.AddTaskAddCompactItemFromUrl = function (url) {
        var _this = this;
        this._addTaskOpenFilePickerForAddItem();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskCreateFilePicker();
        var itemCount;
        TAB.AddTask(TAB.MakeTask(function () {
            itemCount = _this.GetQuickLinks().length;
            TAB.Log.Comment('Add compact item for ' + url);
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].FilePicker.AddTaskAddFromUrl(url);
        }), TAB.MakeWaiter(function () {
            return _this.GetQuickLinks().length === itemCount + 1;
        }));
    };
    QuickLinksWebPart.prototype.AddTaskChangeLayout = function (layout) {
        var _this = this;
        this.AddTaskClickConfigureButton();
        var layoutChoices = [];
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Change layout to ' + (layout === QuickLinksLayoutId.Compact ? 'Compact' : 'FilmStrip'));
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
            layoutChoices = TAB.GetElements(propertyPane, TAB.searchBy.hasClassName, 'ms-ChoiceField');
            var layoutInput = TAB.GetElement(layoutChoices[layout], TAB.searchBy.tag, 'INPUT');
            TAB.ClickElement(layoutInput);
        }), TAB.MakeWaiter(function () {
            try {
                var layoutLabel = TAB.GetElement(layoutChoices[layout], TAB.searchBy.tag, 'LABEL');
                var isLayoutChecked = TAB.HasCssClass(layoutLabel, 'is-checked');
                if (isLayoutChecked) {
                    _this._layoutType = layout;
                }
                return isLayoutChecked;
            }
            catch (e) {
                return false;
            }
        }));
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_5__["PropertyPane"].AddTaskClosePropertyPane();
    };
    QuickLinksWebPart.prototype.AddTaskDeleteItemByIndex = function (index) {
        var _this = this;
        var deleteItemTitle;
        TAB.AddTask(TAB.MakeTask(function () {
            var items = _this.GetQuickLinks();
            var deleteItem = items[index];
            deleteItemTitle = _this.GetItemTitleByIndex(index);
            TAB.Log.Comment('delete item ' + deleteItemTitle);
            if (deleteItem) {
                var deleteButton = _Next__WEBPACK_IMPORTED_MODULE_6__["Next"].GetElementByDataAutomationId(deleteItem, 'delete-button');
                var pos = deleteButton.getBoundingClientRect();
                var newX = pos.left + pos.width / 2;
                var newY = pos.top + pos.height / 2;
                TAB.FireMouseEvent(deleteButton, TAB.mouseEvent.mouseDown, new TAB.MouseEventData(newX, newY));
                TAB.ClickElement(deleteButton);
            }
        }), TAB.MakeWaiter(function () { return _this.GetItemTitleByIndex(index) !== deleteItemTitle; }));
    };
    QuickLinksWebPart.prototype.AddTaskDragAndDropItem = function (dragIndex, dropIndex) {
        var _this = this;
        if (this._layoutType === QuickLinksLayoutId.FilmStrip) {
            return;
        }
        // FireMouseEvent is not allowed in Edge due to initMouseEvent deprecation
        // Fix required in TABCore VSO#405141
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskWarning('Fire mouse event is not permitted in Edge.');
            return;
        }
        var item, targetItem, dragMark;
        var itemOffset, targetItemOffset;
        var dropX, dropY, dragX, dragY;
        var dragElementTitle, dropElementTitle;
        var shiftPixel = 10;
        TAB.AddTask(TAB.MakeTask(function () {
            item = _this.GetQuickLinks()[dragIndex];
            targetItem = _this.GetQuickLinks()[dropIndex];
            dragElementTitle = _this.GetItemTitleByIndex(dragIndex);
            dropElementTitle = _this.GetItemTitleByIndex(dropIndex);
            itemOffset = TAB.GetElementOffset(item);
            targetItemOffset = TAB.GetElementOffset(targetItem);
            dragX = Math.round(itemOffset.left + item.clientWidth / 2);
            dragY = Math.round(itemOffset.top + item.clientHeight / 2);
            dropX = Math.round(targetItemOffset.left + item.clientWidth / 2) + shiftPixel;
            dropY = Math.round(targetItemOffset.top + item.clientHeight / 2);
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.FireMouseEvent(item, TAB.mouseEvent.mouseDown, new TAB.MouseEventData(dragX, dragY));
        }), TAB.MakeWaiter(function () {
            // Store the dragMark for compare with dropMark.
            dragMark = TAB.GetElements(_this.root, TAB.searchBy.customQuery, "[data-automation-id='dropLocation']")[0];
            return dragMark !== undefined;
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.FireMouseEvent(item, TAB.mouseEvent.mouseMove, new TAB.MouseEventData(dropX, dropY));
        }), TAB.MakeWaiter(function () {
            try {
                // Wait till the mark of drop place is changed.
                var dropMark = TAB.GetElement(_this.root, TAB.searchBy.customQuery, "[data-automation-id='dropLocation']");
                return dropMark !== dragMark;
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.FireMouseEvent(item, TAB.mouseEvent.mouseUp, new TAB.MouseEventData(dropX, dropY));
        }), undefined);
        // Wait for item to swap position.
        TAB.MakeWaiter(function () {
            return (_this.GetItemTitleByIndex(dropIndex) === dragElementTitle &&
                _this.GetItemTitleByIndex(dropIndex - 1) === dropElementTitle);
        }).Wait();
    };
    QuickLinksWebPart.prototype.IsWebpartReady = function () {
        return (TAB.ElementExists(this.root, TAB.searchBy.customQuery, "[data-automation-id='empty-state-card']") ||
            this.GetQuickLinks().length > 0);
    };
    QuickLinksWebPart.prototype.AddTaskOpenPropertyPaneForItem = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('click edit button on item');
            var quickLink = _this.GetQuickLinks()[index];
            if (quickLink) {
                var editButton = _Next__WEBPACK_IMPORTED_MODULE_6__["Next"].GetElementByDataAutomationId(quickLink, 'edit-button');
                var pos = editButton.getBoundingClientRect();
                var newX = pos.left + pos.width / 2;
                var newY = pos.top + pos.height / 2;
                TAB.FireMouseEvent(editButton, TAB.mouseEvent.mouseDown, new TAB.MouseEventData(newX, newY));
                TAB.ClickElement(editButton);
            }
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']"));
    };
    /**
     * Get quick links list items. If there is no item, it will return an empty array.
     */
    QuickLinksWebPart.prototype.GetQuickLinks = function () {
        if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='empty-state-card']")) {
            return [];
        }
        else {
            return this._layoutType === QuickLinksLayoutId.Compact
                ? TAB.GetElements(this.root, TAB.searchBy.customQuery, "[data-automation-id='compact-card']")
                : TAB.GetElements(this.root, TAB.searchBy.customQuery, "[data-automation-id='tile-card']");
        }
    };
    /**
     * Return the title of one quick link by index. Will return empty string if fail to get title.
     * @param index - index of item in quick links
     */
    QuickLinksWebPart.prototype.GetItemTitleByIndex = function (index) {
        var items = this.GetQuickLinks();
        if (items.length > index) {
            var element = _Next__WEBPACK_IMPORTED_MODULE_6__["Next"].GetElementByDataAutomationId(items[index], 'quick-links-item-title') ||
                _Next__WEBPACK_IMPORTED_MODULE_6__["Next"].GetElementByDataAutomationId(items[index], 'less-text');
            return element ? TAB.GetTextContent(element) : '';
        }
        else {
            TAB.Log.Warning('QuickLinks does not have item with index = ' + index);
            return '';
        }
    };
    QuickLinksWebPart.prototype.AddTaskAddCompactItemFromUploading = function (fileInput) {
        var _this = this;
        this._addTaskOpenFilePickerForAddItem();
        _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].AddTaskCreateFilePicker();
        var itemCount;
        TAB.AddTask(TAB.MakeTask(function () {
            itemCount = _this.GetQuickLinks().length;
            TAB.Log.Comment('Add compact item from uploading');
            _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].FilePicker.AddTaskUploadItem(fileInput);
        }), TAB.MakeWaiter(function () {
            return _this.GetQuickLinks().length === itemCount + 1;
        }));
    };
    QuickLinksWebPart.prototype.AddTaskAssertQuickLinkCount = function (count) {
        var _this = this;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () { return _this.GetQuickLinks().length === count; }));
    };
    QuickLinksWebPart.prototype.AddTaskEnableAudienceTargeting = function () {
        this.AddTaskClickConfigureButton();
        var audienceToggle;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Enable audience targeting on quick link web part');
            audienceToggle = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='quickLinksAudienceToggle']");
            TAB.ClickElement(audienceToggle);
        }), TAB.MakeWaiter(function () { var _a; return ((_a = audienceToggle.getAttribute('aria-checked')) === null || _a === void 0 ? void 0 : _a.localeCompare('true')) === 0; }));
    };
    QuickLinksWebPart.prototype.AddTaskSearchAudience = function (audienceKeyword) {
        var audiencePickerInput;
        this._addTaskGetAudiencePickerInput(function (input) { return (audiencePickerInput = input); });
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Input keyword \"" + audienceKeyword + "\" in audience picker");
            _ReactUtil__WEBPACK_IMPORTED_MODULE_7__["ReactUtil"].TriggerOnChange(audiencePickerInput, audienceKeyword);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialClassName, 'ms-Suggestions-container'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Select profile from audience picker');
            TAB.FireKeyboardEvent(audiencePickerInput, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["KeyCodes"].enter);
        }), TAB.AndWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-PickerPersona-container'), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='quickLinksTargetedIcon']")));
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_5__["PropertyPane"].AddTaskClosePropertyPane();
    };
    QuickLinksWebPart.prototype.AddTaskRemoveAudience = function () {
        var audiencePickerInput;
        var MAX_ITEMS_IN_PEOPLE_PICKER = 50;
        this._addTaskGetAudiencePickerInput(function (input) { return (audiencePickerInput = input); });
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Remove profile from audience picker");
            TAB.FireKeyboardEvent(audiencePickerInput, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["KeyCodes"].backspace);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent'] [data-number-left='" + MAX_ITEMS_IN_PEOPLE_PICKER + "']"));
        _Pages_PropertyPane__WEBPACK_IMPORTED_MODULE_5__["PropertyPane"].AddTaskClosePropertyPane();
    };
    QuickLinksWebPart.prototype.AddTaskSetAudience = function (index, audienceIdGetter) {
        TAB.AddTask(TAB.MakeTask(function () {
            var quickLinksElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id^='QuickLinksWebPart:']");
            // The automation ID looks like `QuickLinksWebPart:822c7a36-453b-4d10-9ab8-ee17976be886`.
            var webPartId = quickLinksElement.getAttribute('data-automation-id').split(':')[1];
            TAB.Win.window._spComponentLoader._instance
                .loadComponentById('974a7777-0990-4136-8fa6-95d80114c2e0')
                .then(function (spWebPartBaseModule) {
                var webPartManagerList = spWebPartBaseModule.ClientSideWebPartManager._webPartManagerList;
                webPartManagerList.forEach(function (webPartManager) {
                    webPartManager._executeForIdsOrAll([webPartId], function (_, webPartInstance) {
                        if (webPartInstance) {
                            var audienceId = typeof audienceIdGetter === 'string' ? audienceIdGetter : audienceIdGetter();
                            webPartInstance.properties.items[index].audiences = [audienceId];
                            webPartInstance.render();
                        }
                    });
                });
            });
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='quickLinksTargetedIcon']"));
    };
    QuickLinksWebPart.prototype.AddTaskAssertAudienceIconCount = function (count) {
        TAB.AddTask(TAB.MakeTask(function () {
            var targetIconElements = TAB.Win.document.querySelectorAll("[data-automation-id='quickLinksTargetedIcon']");
            if (targetIconElements.length === count) {
                TAB.Log.Comment("There are " + count + " audience icons as expected");
            }
            else {
                TAB.Log.Fail("Expect " + count + " audience icons, but actually get " + targetIconElements.length + " icons");
            }
        }));
    };
    Object.defineProperty(QuickLinksWebPart.prototype, "ShouldHaveAddButton", {
        get: function () {
            return _Pages_TeamSitePage__WEBPACK_IMPORTED_MODULE_4__["TeamSitePage"].editMode;
        },
        enumerable: true,
        configurable: true
    });
    QuickLinksWebPart.prototype._waitForWebPartEmptyStateToExist = function () {
        return TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='empty-state-card']");
        });
    };
    QuickLinksWebPart.prototype._addTaskGetAudiencePickerInput = function (callback) {
        var audiencePickerInputSelector = "[data-automation-id='propertyPanePageContent'] .ms-BasePicker-input";
        TAB.AddTask(undefined, TAB.AndWaiters(
        // The audience picker chunk is defer loaded after the property pane is open.
        // So, we need to wait on the input element existed before access it.
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, audiencePickerInputSelector), 
        // Besides, we need to wait on each audience item resolution completed - no spinners anymore.
        TAB.MakeWaiter(function () {
            var spinners = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent'] .ms-Spinner");
            return spinners.length === 0;
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Get audience picker input element");
            var audiencePickerInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, audiencePickerInputSelector);
            callback(audiencePickerInput);
        }));
    };
    QuickLinksWebPart.prototype._addTaskOpenFilePickerForAddItem = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Click +Add button');
            TAB.ClickElement(_this.GetAddButton());
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='sp-filepicker']"));
    };
    QuickLinksWebPart.prototype._addTaskAssertWebPartNotExist = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Assert Quick Links web part not exist');
            var isExist = _this._layoutType
                ? TAB.ElementExists(_this.root, TAB.searchBy.customQuery, "[data-automation-id='compact-card']")
                : TAB.ElementExists(_this.root, TAB.searchBy.customQuery, "[data-automation-id='tile-card']");
            if (isExist) {
                throw 'QuickLinks web part should not exist.';
            }
        }), undefined);
    };
    return QuickLinksWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "qDkj":
/*!*******************************************!*\
  !*** ./lib/SPTaskLib/SPExperimentUtil.js ***!
  \*******************************************/
/*! exports provided: SPExperimentUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SPExperimentUtil", function() { return SPExperimentUtil; });
/**
 * @public
 */
var SPExperimentUtil = /** @class */ (function () {
    function SPExperimentUtil() {
    }
    /**
     * This function will get the variant for an experiment
     * @param experimentId - The id of the experiment
     */
    SPExperimentUtil.getExperimentVariant = function (experimentId) {
        return TAB.Win.window[this.spModuleLoader]._bundledComponents[this.spCoreLibraryComponentId]._SPExperiment.getVariantAndLogExposure(experimentId);
    };
    SPExperimentUtil.setDebugExperiments = function (expOverride) {
        return (TAB.Win.window[this.spModuleLoader] &&
            TAB.Win.window[this.spModuleLoader]._bundledComponents[this.spCoreLibraryComponentId]._SPExperiment.setDebugExperiments(expOverride));
    };
    SPExperimentUtil.spModuleLoader = 'spModuleLoader';
    SPExperimentUtil.spCoreLibraryComponentId = '7263c7d0-1d6a-45ec-8d85-d4d1d234171b';
    return SPExperimentUtil;
}());



/***/ }),

/***/ "qmer":
/*!*****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/WorldClockWebPart.js ***!
  \*****************************************************/
/*! exports provided: WorldClockWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WorldClockWebPart", function() { return WorldClockWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");





var WorldClockDateFormat;
(function (WorldClockDateFormat) {
    WorldClockDateFormat["monthSpaceDayCommaYear"] = "mmm dd, yyyy";
    WorldClockDateFormat["monthSlashDaySlashYear"] = "mm/dd/yyyy";
    WorldClockDateFormat["daySlashMonthSlashYear"] = "dd/mm/yyyy";
    WorldClockDateFormat["yearSlashMonthSlashDay"] = "yyyy/mm/dd";
})(WorldClockDateFormat || (WorldClockDateFormat = {}));
var WorldClockTimeFormat;
(function (WorldClockTimeFormat) {
    WorldClockTimeFormat["time12"] = "hm";
    WorldClockTimeFormat["time24"] = "Hm";
})(WorldClockTimeFormat || (WorldClockTimeFormat = {}));
/**
 * @public
 */
var WorldClockWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(WorldClockWebPart, _super);
    function WorldClockWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].WorldClock, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].WorldClock.toString()) || this;
    }
    WorldClockWebPart.prototype.AddTaskAddOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this._addTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="clockWall"]'));
    };
    WorldClockWebPart.prototype.AddTaskTryAddClockCard = function (locationName, shouldHaveSuggestions) {
        var _this = this;
        var clockCardLength;
        TAB.MakeTask(function () {
            var locationInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="clockCardPlaceholderWrapper"] input');
            TAB.Log.AddTaskComment('Add the clock of ' + locationName + ' .');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(locationInput, locationName);
        }).WaitFor(shouldHaveSuggestions
            ? TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[class*="ms-Suggestions-container"]')
            : TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[class*="ms-Suggestions-none"]'));
        if (!shouldHaveSuggestions) {
            return;
        }
        TAB.MakeTask(function () {
            clockCardLength = _this._getClockCardLength();
            var suggestionsContainer = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Suggestions-container');
            var firstSuggestionItem = TAB.GetElements(suggestionsContainer, TAB.searchBy.hasClassName, 'ms-Suggestions-item')[0];
            var itemButton = TAB.GetElement(firstSuggestionItem, TAB.searchBy.hasClassName, 'ms-Suggestions-itemButton');
            TAB.Log.AddTaskComment('Click the first item in suggestion list');
            TAB.ClickElement(itemButton);
        }).WaitFor(TAB.MakeWaiter(function () {
            return _this._getClockCardLength() === clockCardLength + 1;
        }));
    };
    WorldClockWebPart.prototype.AddTaskOpenWorldClockWebPartPropertyPane = function () {
        var _this = this;
        TAB.Log.AddTaskComment('Open World Clock web part property pane');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AddTaskClickConfigureButton();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneGroupField'] button"));
    };
    WorldClockWebPart.prototype.AddTaskChangeDateAndTimeFormat = function () {
        var _this = this;
        TAB.MakeTask(function () {
            var propertyPane = _this._getPropertyPane();
            var toggleButtons = TAB.GetElements(propertyPane, TAB.searchBy.customQuery, '[class^="ms-Toggle"] button');
            var dateAndTimeFormatButton = toggleButtons[0];
            TAB.Log.AddTaskComment('Click toggle button to show date and time format choice group');
            TAB.ClickElement(dateAndTimeFormatButton);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-ChoiceFieldGroup'));
        Object.keys(WorldClockDateFormat).forEach(function (key) {
            return _this._addTaskSwitchToFormat(WorldClockDateFormat[key]);
        });
        Object.keys(WorldClockTimeFormat).forEach(function (key) {
            return _this._addTaskSwitchToFormat(WorldClockTimeFormat[key]);
        });
    };
    WorldClockWebPart.prototype.AddTaskOpenClockCardPropertyPane = function (index) {
        TAB.MakeTask(function () {
            var editButton = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementsByDataAutomationId(TAB.Win.document.body, 'clock-card-edit-button')[index];
            TAB.ClickElement(editButton);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPaneGroupField'] button"));
    };
    WorldClockWebPart.prototype.AddTaskChangeLocationDisplayName = function (index, locationName) {
        var _this = this;
        this._enableCustomizeDisplayNameAndTimeZone();
        TAB.MakeTask(function () {
            var displayLocationInput = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'world-clock-customize-location-input');
            TAB.Log.AddTaskComment('Set display location value to ' + locationName + ' .');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_4__["ReactUtil"].TriggerOnChange(displayLocationInput, locationName);
        }).WaitFor(TAB.MakeWaiter(function () {
            var clockCard = _this._getClockCardByIndex(index);
            return clockCard.textContent.search(locationName) !== -1;
        }));
    };
    WorldClockWebPart.prototype.AddTaskChangeTimeZone = function (index) {
        var _this = this;
        this._enableCustomizeDisplayNameAndTimeZone();
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click time zone dropdown to show all time zones');
            var propertyPane = _this._getPropertyPane();
            var timeZoneDropDown = TAB.GetElement(propertyPane, TAB.searchBy.hasClassName, 'ms-Dropdown');
            TAB.ClickElement(timeZoneDropDown);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-callout'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Set time zone to number " + index + " of the dropdown");
            var timeZoneButtonsContainer = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-callout');
            var timeZoneButtons = TAB.GetElements(timeZoneButtonsContainer, TAB.searchBy.customQuery, '[type="button"]');
            TAB.ClickElement(timeZoneButtons[index]);
        }).WaitFor(TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-Dropdown-callout');
        })));
    };
    WorldClockWebPart.prototype.AddTaskDeleteClockCard = function () {
        var _this = this;
        var clockCardLength;
        TAB.MakeTask(function () {
            clockCardLength = _this._getClockCardLength();
            var deleteButton = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementsByDataAutomationId(TAB.Win.document.body, 'clock-card-delete-button');
            TAB.Log.AddTaskComment('Delete one clock card of current list');
            TAB.ClickElement(deleteButton[0]);
        }).WaitFor(TAB.MakeWaiter(function () {
            return _this._getClockCardLength() === clockCardLength - 1;
        }));
    };
    WorldClockWebPart.prototype._getPropertyPane = function () {
        return TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
    };
    WorldClockWebPart.prototype._addTaskSwitchToFormat = function (format) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Switch to format " + format);
            var formatGroupRadio = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, "PropertyPaneChoiceGroup-" + format);
            if (formatGroupRadio) {
                TAB.ClickElement(formatGroupRadio);
            }
            else {
                TAB.Log.Fail("Fail to switch to " + format + " format in World Clock");
            }
        }), this._waitForDateFormatIsSelected(format));
    };
    WorldClockWebPart.prototype._waitForDateFormatIsSelected = function (format) {
        return TAB.MakeWaiter(function () {
            var formatGroupRadio = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, "PropertyPaneChoiceGroup-" + format);
            return formatGroupRadio.checked;
        });
    };
    WorldClockWebPart.prototype._getClockCardLength = function () {
        // clock-card
        return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="clock-card"]').length;
    };
    WorldClockWebPart.prototype._getClockCardByIndex = function (index) {
        return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="clock-card"]')[index];
    };
    WorldClockWebPart.prototype._addTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="clockWall"]')) {
                throw 'WorldClock web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    WorldClockWebPart.prototype._enableCustomizeDisplayNameAndTimeZone = function () {
        var _this = this;
        TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Click toggle button to enable customize display location name and time zone');
            var propertyPane = _this._getPropertyPane();
            _this._turnOnToggle(TAB.GetElements(propertyPane, TAB.searchBy.hasClassName, 'ms-Toggle-innerContainer')[0]);
        }).WaitFor(TAB.MakeWaiter(function () {
            var locationInput = _Next__WEBPACK_IMPORTED_MODULE_2__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'world-clock-customize-location-input');
            var propertyPane = _this._getPropertyPane();
            var timeZoneDropDownContainer = TAB.GetElement(propertyPane, TAB.searchBy.hasClassName, 'ms-Dropdown-container');
            return locationInput && timeZoneDropDownContainer;
        }));
    };
    WorldClockWebPart.prototype._turnOnToggle = function (toggleContainer) {
        var toggle = TAB.GetElements(toggleContainer, TAB.searchBy.tag, 'button')[0];
        if (toggle.attributes['aria-checked'].value === 'false') {
            toggle.click();
        }
    };
    return WorldClockWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "rWka":
/*!*************************************!*\
  !*** ./lib/SPTaskLib/CookieUtil.js ***!
  \*************************************/
/*! exports provided: Cookies */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Cookies", function() { return Cookies; });
/* tslint:disable */
/**
 * @public
 */
var Cookies = /** @class */ (function () {
    function Cookies() {
    }
    Cookies.setRedirectCookie = function (serverURL, target) {
        var d = new Date();
        d.setTime(d.getTime() + 1 * (24 * 60 * 60 * 1000));
        TAB.Win.document.cookie =
            'srr=' + target + ';' + Cookies.getCookieDomain(serverURL) + 'expires=' + d.toUTCString() + ';path=/';
    };
    Cookies.getCookieDomain = function (serverURL) {
        var url = serverURL;
        if (url !== null) {
            var pos = url.indexOf('://');
            if (pos !== -1) {
                url = url.substr(pos + 3);
                pos = url.indexOf('/');
                if (pos !== -1) {
                    url = url.substr(0, pos);
                }
                pos = url.indexOf('.');
                if (pos !== -1) {
                    url = url.substr(pos);
                    return 'domain=' + url + ';';
                }
                return '';
            }
        }
        return 'domain=.spoppe.com;';
    };
    return Cookies;
}());



/***/ }),

/***/ "sQpn":
/*!****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/ConnectorWebPart.js ***!
  \****************************************************/
/*! exports provided: ConnectorWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ConnectorWebPart", function() { return ConnectorWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseCollectionWebPart */ "kQju");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");




var CLOSE_BUTTON_QUERY = "[data-automation-id='ConnectorConfigurationPanelCloseButton']";
var IFRAME_QUERY = "[data-automation-id='ConnectorConfigurationIFrame']";
var PANEL_RENDERED_QUERY = "[data-automation-id='ConfigurationPanelRendered']";
/**
 * @public
 */
var ConnectorWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(ConnectorWebPart, _super);
    // Use overrides to allow a derived class to implement an specific type of connector web part, e.g., RSSConnector
    function ConnectorWebPart(type, entryId) {
        if (type === void 0) { type = _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].Connector; }
        if (entryId === void 0) { entryId = _BaseWebpart__WEBPACK_IMPORTED_MODULE_2__["WebpartType"].Connector.toString(); }
        return _super.call(this, type, entryId) || this;
    }
    ConnectorWebPart.prototype.addWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_3__["Canvas"].AddTaskCreateWebPart(_this);
        }), 
        // The data automation id is present if the connector configuration page renders.
        TAB.MakeWaiter(function () {
            TAB.Log.Comment('Waiting for notification that the connector configuration UI rendered in an iFrame');
            return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, PANEL_RENDERED_QUERY);
        }));
    };
    ConnectorWebPart.prototype.closeConfigurationPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Find panel close button element');
            var panelCloseButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, CLOSE_BUTTON_QUERY);
            TAB.Log.Comment('Click panel close button');
            panelCloseButton.click();
        }), undefined);
    };
    ConnectorWebPart.prototype.readConfigurationPageUrl = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Find connector configuration iFrame element');
            var iFrame = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, IFRAME_QUERY);
            TAB.Log.Comment('Extract configuration URL');
            var pageUrl = iFrame.src.replace('&SSO=true', '');
            TAB.Log.Comment("page url: " + pageUrl);
        }), undefined);
    };
    return ConnectorWebPart;
}(_BaseCollectionWebPart__WEBPACK_IMPORTED_MODULE_1__["BaseCollectionWebPart"]));



/***/ }),

/***/ "tJmU":
/*!*****************************************!*\
  !*** ./lib/SPTaskLib/Pages/Comments.js ***!
  \*****************************************/
/*! exports provided: Comments */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Comments", function() { return Comments; });
/* harmony import */ var _Controls_BaseWebpart__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Controls/BaseWebpart */ "35UN");

/**
 * @public
 */
var Comments = /** @class */ (function () {
    function Comments() {
    }
    Comments.AddTaskAddComment = function (text) {
        var numberOfComments = 0;
        this._getNumberOfComments()
            .then(function (commentNumber) { return (numberOfComments = commentNumber); })
            .catch(function (error) { return TAB.Log.AddTaskComment("Error getting number of comments: " + error); });
        TAB.AddTask(this._postCommentTask("[id=\"" + Comments.COMMENT_INPUT + "\"]", "[data-automation-id=\"" + Comments.COMMENT_POST + "\"]", text), this._waitForNumberOfComments(function () { return numberOfComments + 1; }));
    };
    Comments.AddTaskDisableComments = function () {
        TAB.AddTask(undefined, TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-comment-toggle-enabled"]'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Flipping Comments Toggle');
            var Toggle = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-comment-toggle-enabled"]');
            TAB.ClickElement(Toggle);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-comment-toggle-disabled"]'));
    };
    Comments.AddTaskAddReply = function (text) {
        var numberOfComments = 0;
        this._getNumberOfComments()
            .then(function (commentNumber) { return (numberOfComments = commentNumber); })
            .catch(function (error) { return TAB.Log.AddTaskComment("Error getting number of comments: " + error); });
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking reply button');
            var replyButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="comment-reply-button"]');
            TAB.ClickElement(replyButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.leadingId, 'sp-comment-input-reply-'));
        TAB.AddTask(this._postCommentTask('[id^="sp-comment-input-reply-"]', '[data-automation-id^="sp-comment-reply-post-"]', text), this._waitForNumberOfComments(function () { return numberOfComments + 1; }));
    };
    Comments.AddTaskCommentsNotVisible = function () {
        TAB.MakeTask(function () {
            TAB.Log.Comment("Ensuring comments aren't visible before publish");
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'sp-comments')) {
                throw 'Comments component should not be visible';
            }
        });
    };
    Comments.AddTaskCommentsVisible = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Ensuring comments section is visible after publish');
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.id, 'sp-comments'));
    };
    Comments.AddTaskVerifyComments = function (total) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Ensuring " + total + " comments are on the page");
        }), this._waitForNumberOfComments(function () { return total; }));
    };
    Comments.AddTaskDeleteAReply = function () {
        var numberOfComments = 0;
        this._getNumberOfComments()
            .then(function (commentNumber) { return (numberOfComments = commentNumber); })
            .catch(function (error) { return TAB.Log.AddTaskComment("Error getting number of comments: " + error); });
        TAB.Log.AddTaskComment('Deleting a reply');
        this._deleteCommentFlow('[data-automation-id="sp-comment-block-reply"] [data-automation-id="comment-more-button"]');
        TAB.AddTask(undefined, this._waitForNumberOfComments(function () { return numberOfComments - 1; }));
    };
    Comments.AddTaskDeleteRootComment = function () {
        TAB.Log.AddTaskComment('Deleting root comment');
        this._deleteCommentFlow('[data-automation-id="sp-comment-block-root"] [data-automation-id="comment-more-button"]');
        TAB.AddTask(undefined, this._waitForNumberOfComments(function () { return 0; }));
    };
    Comments._deleteCommentFlow = function (moreButtonSelector) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking on more button');
            var moreButton = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, moreButtonSelector)[0];
            TAB.ClickElement(moreButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu-container'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking on delete option');
            var deleteOption = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="comment-delete-button"]');
            TAB.ClickElement(deleteOption);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '.ms-Dialog.is-open'));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking yes on the delete dialog');
            var yesOption = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="yesButton"]');
            TAB.ClickElement(yesOption);
        }), undefined);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for root comment input to receive focus');
        }), TAB.MakeWaiter(function () {
            return TAB.Win.document.activeElement && TAB.Win.document.activeElement.id === Comments.COMMENT_INPUT;
        }));
    };
    Comments._getNumberOfComments = function () {
        return new Promise(function (resolve) {
            TAB.AddTask(TAB.MakeTask(function () {
                resolve(TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="comment-more-button"]')
                    .length);
            }));
        });
    };
    Comments._postCommentTask = function (inputSelector, buttonSelector, text) {
        return TAB.MakeTask(function () {
            TAB.Log.Comment('Adding comment');
            var input = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, inputSelector);
            var postButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, buttonSelector);
            TAB.ClickElement(input);
            TAB.SetTextContent(input, text);
            TAB.FireKeyboardEvent(input, 'keyup', _Controls_BaseWebpart__WEBPACK_IMPORTED_MODULE_0__["KeyCodes"].space);
            TAB.ClickElement(postButton);
        });
    };
    Comments._waitForNumberOfComments = function (numberToWaitFor) {
        return TAB.MakeWaiter(function () {
            return (numberToWaitFor() ===
                TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="comment-more-button"]')
                    .length);
        });
    };
    Comments.COMMENT_INPUT = 'sp-comment-input';
    Comments.COMMENT_POST = 'sp-comment-post';
    return Comments;
}());



/***/ }),

/***/ "ueW2":
/*!**************************************************!*\
  !*** ./lib/SPTaskLib/Controls/WeatherWebPart.js ***!
  \**************************************************/
/*! exports provided: WeatherWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeatherWebPart", function() { return WeatherWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var WeatherWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(WeatherWebPart, _super);
    function WeatherWebPart() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Weather, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].Weather.toString()) || this;
    }
    WeatherWebPart.prototype.AddTaskAddOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this._addTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="weatherWall"]'));
    };
    WeatherWebPart.prototype.AddTaskTryAddWeather = function (locationName, shouldHaveSuggestions) {
        var _this = this;
        var weatherCardLength;
        TAB.MakeTask(function () {
            var locationInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="weatherCardPlaceholder"] input');
            TAB.Log.AddTaskComment('Add the weather of ' + locationName + ' .');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(locationInput, locationName);
        }).WaitFor(shouldHaveSuggestions
            ? TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[class*="ms-Suggestions-container"]')
            : TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[class*="ms-Suggestions-none"]'));
        if (!shouldHaveSuggestions) {
            return;
        }
        TAB.MakeTask(function () {
            weatherCardLength = _this._getWeatherCardLength();
            var suggestionsContainer = TAB.GetElement(TAB.Win, TAB.searchBy.partialClassName, 'ms-Suggestions-container');
            var firstSuggestionItem = TAB.GetElements(suggestionsContainer, TAB.searchBy.partialClassName, 'ms-Suggestions-item')[0];
            var itemButton = TAB.GetElement(firstSuggestionItem, TAB.searchBy.partialClassName, 'ms-Suggestions-itemButton');
            TAB.Log.AddTaskComment('Click the first item in suggestion list');
            TAB.ClickElement(itemButton);
        }).WaitFor(TAB.MakeWaiter(function () {
            return _this._getWeatherCardLength() === weatherCardLength + 1;
        }));
    };
    WeatherWebPart.prototype.AddTaskChangeDisplayLocationName = function (index, customizedLocationName) {
        var _this = this;
        TAB.MakeTask(function () {
            var editButton = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"weather-card-edit-button\"]")[index];
            TAB.ClickElement(editButton);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="propertyPaneGroupField"] button'));
        TAB.MakeTask(function () {
            var toggleButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="propertyPaneGroupField"] button');
            TAB.Log.AddTaskComment('Click toggle button to enable customize display location name');
            TAB.ClickElement(toggleButton);
        }).WaitFor(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"weather-customize-location-input\"]"));
        TAB.MakeTask(function () {
            var displayLocationInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"weather-customize-location-input\"]");
            TAB.Log.AddTaskComment('Set display location value to ' + customizedLocationName + ' .');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(displayLocationInput, customizedLocationName);
        }).WaitFor(TAB.MakeWaiter(function () {
            var weatherCard = _this._getWeatherCardByIndex(index);
            return weatherCard.textContent.search(customizedLocationName) !== -1;
        }));
    };
    WeatherWebPart.prototype.AddTaskDeleteWeatherCard = function () {
        var _this = this;
        var weatherCardLength;
        TAB.MakeTask(function () {
            weatherCardLength = _this._getWeatherCardLength();
            var deleteButton = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"weather-card-delete-button\"]");
            TAB.Log.AddTaskComment('Delete one weather card of current list');
            TAB.ClickElement(deleteButton[0]);
        }).WaitFor(TAB.MakeWaiter(function () {
            return _this._getWeatherCardLength() === weatherCardLength - 1;
        }));
    };
    WeatherWebPart.prototype._getWeatherCardLength = function () {
        return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="weather-card-wrapper"]')
            .length;
    };
    WeatherWebPart.prototype._getWeatherCardByIndex = function (index) {
        return TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="weather-card-wrapper"]')[index];
    };
    WeatherWebPart.prototype._addTaskAssertWebPartNotExist = function () {
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="weatherWall"]')) {
                throw 'Weather web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    return WeatherWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "umcD":
/*!****************************************************!*\
  !*** ./lib/SPTaskLib/Controls/YammerHighlights.js ***!
  \****************************************************/
/*! exports provided: YammerHighlights */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YammerHighlights", function() { return YammerHighlights; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");





/**
 * @public
 */
var YammerHighlights = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(YammerHighlights, _super);
    function YammerHighlights() {
        return _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].YammerHighlights, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].YammerHighlights.toString()) || this;
    }
    YammerHighlights.prototype.AddTaskAddWebPartToPage = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }), TAB.AndWaiters(TAB.AndWaiters(this._waitForPlaceholder(), this._waitForOpenPropertyPane()), this._waitForGroupSearchField()));
    };
    YammerHighlights.prototype.AddTaskAddYammerGroup = function (url) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(_this._groupSearchField, url);
        }));
    };
    YammerHighlights.prototype.AddTaskSearchForYammerGroup = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Searching for Yammer group');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(_this._groupSearchField.getElementsByTagName('input')[0], 'Used For Tab Tests Do Not Delete');
        }), this._waitForGroupSearchResults());
    };
    YammerHighlights.prototype.AddTaskSelectYammerGroup = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Selecting Yammer group');
            var results = _this._groupSearchResults;
            var noResults = _this._groupSearchNoResults;
            if (noResults) {
                TAB.Log.Comment('No groups found');
                _this._failedToSearch = true;
            }
            else if (results && results.length) {
                TAB.Log.Comment('Group found');
                TAB.ClickElement(results[0]);
            }
            else {
                TAB.Log.DidNotRun('No groups found and no search error');
            }
        }), TAB.OrWaiters(TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.partialId, 'selectedItemPersona'), _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'groupSearchFail')));
    };
    YammerHighlights.prototype.CheckForWebpartContent = function () {
        TAB.AddTask(undefined, TAB.OrWaiters(TAB.OrWaiters(this._waitForEmptyContainerWhenSearchFails(), this._waitForPlaceholderFetchError()), this._waitForCardContainer()));
    };
    YammerHighlights.prototype._waitForOpenPropertyPane = function () {
        return TAB.MakeWaiter(function () {
            TAB.Log.Comment('Property pane should open if there is no group added');
            return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"showPane\"]");
        });
    };
    YammerHighlights.prototype._waitForCardContainer = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var el = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(_this.root, 'cardContainer');
            if (el) {
                TAB.Log.Comment('data-automation-id cardContainer found');
            }
            return !!el;
        });
    };
    YammerHighlights.prototype._waitForPlaceholderFetchError = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var el = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(_this.root, 'placeholderContainerFetchError');
            if (el) {
                TAB.Log.DidNotRun('data-automation-id placeholderContainerFetchError found');
            }
            return !!el;
        });
    };
    YammerHighlights.prototype._waitForEmptyContainerWhenSearchFails = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            if (!_this._failedToSearch) {
                return false;
            }
            var cardContainer = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(_this.root, 'cardContainer');
            var errorContainer = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(_this.root, 'placeholderContainerFetchError');
            if (!cardContainer && !errorContainer) {
                TAB.Log.DidNotRun('empty container found');
            }
            return !cardContainer && !errorContainer && _this._failedToSearch;
        });
    };
    YammerHighlights.prototype._waitForGroupSearchField = function () {
        var _this = this;
        return TAB.MakeWaiter(function () { return _this._groupSearchField; });
    };
    YammerHighlights.prototype._waitForGroupSearchResults = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var el = _this._groupSearchResults;
            if (el) {
                TAB.Log.Comment('Found group search results');
            }
            return !!el;
        });
    };
    Object.defineProperty(YammerHighlights.prototype, "_groupSearchField", {
        get: function () {
            TAB.Log.Comment('Getting property pane group url search field');
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win, 'groupSelector');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(YammerHighlights.prototype, "_groupSearchResults", {
        get: function () {
            return TAB.GetElements(TAB.Win, TAB.searchBy.partialClassName, 'yammer-groupSearchSuggestionItem');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(YammerHighlights.prototype, "_groupSearchNoResults", {
        get: function () {
            return _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win, 'groupSearchFail');
        },
        enumerable: true,
        configurable: true
    });
    return YammerHighlights;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "v4Fw":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Pages/ViewPortLoader.js ***!
  \***********************************************/
/*! exports provided: PartialId, ViewPortLoader */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PartialId", function() { return PartialId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ViewPortLoader", function() { return ViewPortLoader; });
/**
 * @internal
 */
var PartialId;
(function (PartialId) {
    PartialId["PageTitle"] = "PageTitle";
    PartialId["QuickLinks"] = "WebPart.QuickLinksWebPart";
    PartialId["Hero"] = "WebPart.HeroWebPart";
    PartialId["Link"] = "WebPart.LinkPreviewWebPart";
    PartialId["Comments"] = "Page.CommentsWrapper";
})(PartialId || (PartialId = {}));
/**
 * @public
 */
var ViewPortLoader = /** @class */ (function () {
    function ViewPortLoader() {
    }
    /**
     * @param partialId - The partial value of `data-viewport-id` attribute.
     *  e.g. The partialId "ContentRollupWebPart" will match the dom element with attribute
     *  'data-viewport-id' equals to 'WebPart.ContentRollupWebPart.internal.ccbef4df-05f8-420f-8c66-809b5b091d92'
     */
    ViewPortLoader.AddTaskEnsureComponentNotReleased = function (partialId) {
        ViewPortLoader._addTaskWaitForComponent(partialId);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Ensure the component with partial id '" + partialId + "' is not released");
        }), TAB.MakeWaiter(function () {
            try {
                return !ViewPortLoader.getElementWithPartialId(partialId).hasChildNodes();
            }
            catch (error) {
                return false;
            }
        }));
    };
    /**
     * @param partialId - The partial value of `data-viewport-id` attribute.
     *  e.g. The partialId "ContentRollupWebPart" will match the dom element with attribute
     *  'data-viewport-id' equals to 'WebPart.ContentRollupWebPart.internal.ccbef4df-05f8-420f-8c66-809b5b091d92'
     */
    ViewPortLoader.AddTaskWaitForComponentReleased = function (partialId) {
        ViewPortLoader._addTaskWaitForComponent(partialId);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Wait until the component with partial id '" + partialId + "' is released");
        }), TAB.MakeWaiter(function () {
            try {
                return ViewPortLoader.getElementWithPartialId(partialId).hasChildNodes();
            }
            catch (error) {
                return false;
            }
        }));
    };
    ViewPortLoader.getElementWithPartialId = function (partialId) {
        return ViewPortLoader.getElementsWithPartialId(partialId)[0];
    };
    /**
     * @param partialId - The partial value of `data-viewport-id` attribute.
     *  e.g. The partialId "ContentRollupWebPart" will match the dom element with attribute
     *  'data-viewport-id' equals to 'WebPart.ContentRollupWebPart.internal.ccbef4df-05f8-420f-8c66-809b5b091d92'
     */
    ViewPortLoader.getElementsWithPartialId = function (partialId) {
        return TAB.GetElements(TAB.Win.window.document, TAB.searchBy.customQuery, "[data-viewport-id*='" + partialId + "']");
    };
    /**
     * @param partialId - The partial value of `data-viewport-id` attribute.
     *  e.g. The partialId "ContentRollupWebPart" will match the dom element with attribute
     *  'data-viewport-id' equals to 'WebPart.ContentRollupWebPart.internal.ccbef4df-05f8-420f-8c66-809b5b091d92'
     */
    ViewPortLoader.AddTaskScrollToComponent = function (partialId) {
        ViewPortLoader._addTaskWaitForComponent(partialId);
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Scroll the component with partial id '" + partialId + "'");
            ViewPortLoader.getElementWithPartialId(partialId).scrollIntoView();
        }));
    };
    ViewPortLoader._addTaskWaitForComponent = function (partialId) {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Wait the component with partial id '" + partialId + "' shows up");
        }), TAB.MakeWaiter(function () {
            try {
                return ViewPortLoader.getElementsWithPartialId(partialId).length > 0;
            }
            catch (error) {
                return false;
            }
        }));
    };
    return ViewPortLoader;
}());



/***/ }),

/***/ "wwnI":
/*!************************************************!*\
  !*** ./lib/SPTaskLib/Pages/PrePublishPanel.js ***!
  \************************************************/
/*! exports provided: PrePublishPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PrePublishPanel", function() { return PrePublishPanel; });
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _TeamSitePage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TeamSitePage */ "UjPA");
/* harmony import */ var _PageSettingsPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PageSettingsPanel */ "YfnZ");



/**
 * @public
 */
var PrePublishPanel = /** @class */ (function () {
    function PrePublishPanel() {
    }
    PrePublishPanel.AddTaskClickPublishButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking the publish button on the page, which opens the pre-publish panel');
            var publishButton = _Next__WEBPACK_IMPORTED_MODULE_0__["Next"].GetElementByDataAutomationId(_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].GetCommandBar(), 'pageCommandBarPublishButton');
            TAB.ClickElement(publishButton);
        }), PrePublishPanel.WaitForPrePublishPanel());
    };
    PrePublishPanel.AddTaskClickPublishButtonOnPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking the publish button on the panel, which publishes the page');
            var publishButton = PrePublishPanel._getPanelPublishButton();
            TAB.ClickElement(publishButton);
        }), PrePublishPanel.WaitForPagePublished());
    };
    PrePublishPanel.AddTaskWaitForRequiredProps = function (propsExist) {
        if (propsExist === void 0) { propsExist = true; }
        TAB.AddTask(TAB.MakeTask(function () {
            var exists = propsExist ? 'exists' : 'does not exist';
            TAB.Log.Comment("Checking that the required properties text " + exists + ", and that the publish button is greyed out");
        }), PrePublishPanel.WaitForRequiredProps(propsExist));
    };
    PrePublishPanel.AddTaskWaitForThumbnail = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Waiting for the thumbnail to show up on the panel');
        }), TAB.MakeWaiter(function () {
            var thumbnail = PrePublishPanel._getThumbnail();
            return thumbnail && TAB.ElementExists(thumbnail, TAB.searchBy.tag, 'img');
        }));
    };
    PrePublishPanel.AddTaskClickPageDetailsLink = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Opening the page details panel by clicking on the link on the prepublish panel');
            var pageDetailsLink = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-OpenPageDetailsLink']");
            TAB.ClickElement(pageDetailsLink);
        }), _PageSettingsPanel__WEBPACK_IMPORTED_MODULE_2__["PageSettingsPanel"].WaitForReactClientFormLoaded());
    };
    PrePublishPanel.AddTaskClosePanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var cancelButton = PrePublishPanel._getCancelButton();
            if (cancelButton) {
                TAB.ClickElement(cancelButton);
            }
        }), PrePublishPanel.WaitForPrePublishPanel(false));
    };
    PrePublishPanel.AddTaskVerifyThumbnailImage = function (imgInfo) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var imageInfo = imgInfo.imageInfo;
            var src = _this._renderedImageUrl;
            if (!src) {
                TAB.Log.Fail('src is empty!');
            }
            if (!imageInfo || !imageInfo.siteId || !imageInfo.webId || !imageInfo.uniqueId) {
                TAB.Log.Fail('imageInfo is invalid!');
            }
            if (_PageSettingsPanel__WEBPACK_IMPORTED_MODULE_2__["PageSettingsPanel"].doesSourceContainGuid(src, imageInfo.siteId) &&
                _PageSettingsPanel__WEBPACK_IMPORTED_MODULE_2__["PageSettingsPanel"].doesSourceContainGuid(src, imageInfo.webId) &&
                _PageSettingsPanel__WEBPACK_IMPORTED_MODULE_2__["PageSettingsPanel"].doesSourceContainGuid(src, imageInfo.uniqueId)) {
                TAB.Log.Pass('Thumbnail is rendering the specified image correctly');
            }
            else {
                TAB.Log.Fail("Thumbnail is rendering some other image. Expected item to have\n            site id: " + imageInfo.siteId + ", web id: " + imageInfo.webId + " unique id: " + imageInfo.uniqueId + "\n            Actual rendered image url is: " + src);
            }
        }));
    };
    PrePublishPanel.WaitForRequiredProps = function (propsExist) {
        if (propsExist === void 0) { propsExist = true; }
        return TAB.AndWaiters(TAB.MakeWaiter(function () {
            return (propsExist ===
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-RequiredPropsLabel']"));
        }), PrePublishPanel.WaitForPublishButton(!propsExist) // If required props, button will be disabled. Else, will be enabled
        );
    };
    PrePublishPanel.WaitForPublishButton = function (buttonEnabled) {
        if (buttonEnabled === void 0) { buttonEnabled = true; }
        return TAB.MakeWaiter(function () {
            var button = PrePublishPanel._getPanelPublishButton();
            return button.hasAttribute('disabled') === !buttonEnabled;
        });
    };
    PrePublishPanel.WaitForPrePublishPanel = function (panelExists) {
        if (panelExists === void 0) { panelExists = true; }
        return TAB.MakeWaiter(function () {
            return (panelExists ===
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublishPanel']"));
        });
    };
    PrePublishPanel.WaitForPagePublished = function () {
        return TAB.AndWaiters(TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublishPanel']");
        }), _TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].WaitForViewModeTransition());
    };
    PrePublishPanel.WaitForViewModeTransition = function () {
        return TAB.MakeWaiter(function () {
            if (!_TeamSitePage__WEBPACK_IMPORTED_MODULE_1__["TeamSitePage"].editMode) {
                return true;
            }
        });
    };
    PrePublishPanel._getPanelPublishButton = function () {
        try {
            var publishButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-SubmitButton']");
            return publishButton;
        }
        catch (error) {
            return undefined;
        }
    };
    PrePublishPanel._getThumbnail = function () {
        try {
            var thumbnail = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublishThumbnail']");
            return thumbnail;
        }
        catch (error) {
            return undefined;
        }
    };
    PrePublishPanel._getCancelButton = function () {
        try {
            var cancelBtn = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='PrePublish-CancelButton']");
            return cancelBtn;
        }
        catch (error) {
            return undefined;
        }
    };
    Object.defineProperty(PrePublishPanel, "_renderedImageUrl", {
        get: function () {
            return PrePublishPanel._getThumbnail().querySelector('img').getAttribute('src');
        },
        enumerable: true,
        configurable: true
    });
    return PrePublishPanel;
}());



/***/ }),

/***/ "x05h":
/*!********************************************!*\
  !*** ./lib/SPTaskLib/Pages/ClassicPage.js ***!
  \********************************************/
/*! exports provided: ClassicPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClassicPage", function() { return ClassicPage; });
/**
 * @public
 */
var ClassicPage = /** @class */ (function () {
    function ClassicPage() {
    }
    ClassicPage.PageReady = function () {
        var waiter = TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'Ribbon.WikiPageTab-title');
        });
        return waiter;
    };
    ClassicPage.AddTaskClickPageTabButton = function () {
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'Ribbon.WikiPageTab-title');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Open Page Ribbon');
            var pageTabButton = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'Ribbon.WikiPageTab-title');
            TAB.ClickElement(pageTabButton.children[0]);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'Ribbon.WikiPageTab');
        }));
    };
    ClassicPage.AddTaskClickEditRibbonButton = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking Edit');
            var pageTabButton = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'Ribbon.WikiPageTab.EditAndCheckout.SaveEdit-SelectedItem');
            TAB.ClickElement(pageTabButton);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-webpart-zone');
        }));
    };
    ClassicPage.AddTaskClickAddWebPartZone = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Clicking Add a Web Part in Header Zone');
            var addWebPartButtons = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-WPAddButton');
            TAB.ClickElement(addWebPartButtons[0]);
        }), TAB.AndWaiters(TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for Web Part Add Panel');
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'WebPartAdderUpdatePanelContainer');
        }), TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for Web Part Add Panel to be visible');
            var webPartAddContainer = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'WebPartAdderUpdatePanelContainer');
            return TAB.GetStyleAttribute(webPartAddContainer, 'display') !== 'none';
        })));
    };
    ClassicPage.AddTaskAddWebPartByCategory = function (category, webPartName) {
        TAB.AddTask(undefined, TAB.AndWaiters(TAB.MakeWaiter(function () {
            // Waiting for Web Part Categories
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-wpadder-categories');
        }), TAB.MakeWaiter(function () {
            // Waiting Web Part Categories to be populated
            var categories = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-wpadder-categories');
            return categories.children.length > 0;
        })));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment("Adding webpart \"" + webPartName + "\" from category \"" + category + "\"");
            // Look for the category user input
            var categoriesList = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-wpadder-categories');
            var categoryFound;
            for (var index = 0; index < categoriesList.children.length; index++) {
                if (categoriesList.children.item(index).title === category) {
                    categoryFound = categoriesList.children.item(index);
                }
            }
            if (!categoryFound) {
                throw new Error("WebPart catagory \"" + category + "\" was not found");
            }
            TAB.ClickElement(categoryFound);
            // Look for webPartName user input
            var webPartsListColumns = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-wpadder-items');
            var webPartsList;
            var webPartFound;
            for (var webPartColumn = 0; webPartColumn < webPartsListColumns.length; webPartColumn++) {
                webPartsList = webPartsListColumns[webPartColumn];
                for (var index = 0; index < webPartsList.children.length; index++) {
                    if (webPartsList.children.item(index).title === webPartName) {
                        webPartFound = webPartsList.children.item(index);
                        break;
                    }
                }
            }
            if (!webPartFound) {
                throw new Error("WebPart name \"" + webPartName + "\" was not found");
            }
            TAB.ClickElement(webPartFound);
            // Click 'Add'
            var webPartButtonArea = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-wpadder-buttonArea');
            TAB.ClickElement(webPartButtonArea.children.item(0));
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.hasClassName, 'ms-webpartzone-cell');
        }));
    };
    ClassicPage.AddTaskSavePage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Saving Page');
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'Ribbon.EditingTools.CPEditTab.EditAndCheckout.SaveEdit-SelectedItem');
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            // click the save button
            var saveButton = TAB.GetElement(TAB.Win, TAB.searchBy.id, 'Ribbon.EditingTools.CPEditTab.EditAndCheckout.SaveEdit-SelectedItem');
            TAB.ClickElement(saveButton);
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(TAB.Win, TAB.searchBy.id, 'MSOZoneCell_WebPartWPQ2');
        }));
    };
    return ClassicPage;
}());



/***/ }),

/***/ "xAAm":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/SPPerfExperimentUtil.js ***!
  \***********************************************/
/*! exports provided: SPPerfExperimentUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SPPerfExperimentUtil", function() { return SPPerfExperimentUtil; });
/**
 * @public
 */
var SPPerfExperimentUtil = /** @class */ (function () {
    function SPPerfExperimentUtil() {
    }
    /**
     * This function will get the variant for an experiment
     * @param experimentId - The id of the experiment
     */
    SPPerfExperimentUtil.getPerfExperimentVariant = function (experimentId) {
        return TAB.Win.window[this.spModuleLoader]._bundledComponents[this.spTelemetryComponentId]._SPPerfExperiment.getVariantAndTrackExperiment(experimentId);
    };
    SPPerfExperimentUtil.spModuleLoader = 'spModuleLoader';
    SPPerfExperimentUtil.spTelemetryComponentId = '8217e442-8ed3-41fd-957d-b112e841286a';
    return SPPerfExperimentUtil;
}());



/***/ }),

/***/ "xG3W":
/*!*****************************************!*\
  !*** ./lib/SPTaskLib/InPlaceNavUtil.js ***!
  \*****************************************/
/*! exports provided: NavType, InPlaceNavUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NavType", function() { return NavType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InPlaceNavUtil", function() { return InPlaceNavUtil; });
/* harmony import */ var _SpaceUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SpaceUtil */ "IfeM");

/**
 * @public
 */
var NavType;
(function (NavType) {
    NavType["HomeToArticle"] = "In-App Navigation: Home page of site-1 to Article page of site-1";
    NavType["ArticleToHome"] = "In-App Navigation: Article page of site-1 to Home page of site-1";
    NavType["Home1ToHome2"] = "X-Site Navigation: Home page of site-1 to Home page of site-2";
    NavType["Home2ToHome1"] = "X-Site Navigation: Home page of site-2 to Home page of site-1";
    NavType["HomeToSPHome"] = "X-App Navigation: Home page of site-1 to SP-Home";
    NavType["SPHomeToHome"] = "X-App Navigation: SP-Home to Home page of site-1";
})(NavType || (NavType = {}));
/**
 * @public
 */
var InPlaceNavUtil = /** @class */ (function () {
    function InPlaceNavUtil() {
    }
    InPlaceNavUtil.AddTaskClickLinkFromHeader = function (index, navType) {
        var NAVBAR_ITEM_CLASS_NAME = 'ms-HorizontalNavItem-link';
        var NAVBAR_CLASS_NAME = 'ms-HorizontalNav ';
        var navBar;
        var navBarElements;
        TAB.Log.AddTaskComment("InPlaceNavUtil: About to do " + navType);
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean((navBar = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.partialClassName, NAVBAR_CLASS_NAME)));
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean((navBarElements = TAB.GetElements(navBar, TAB.searchBy.partialClassName, NAVBAR_ITEM_CLASS_NAME)));
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(navBarElements[index]);
        }));
        TAB.AddTask(undefined, _SpaceUtil__WEBPACK_IMPORTED_MODULE_0__["SpaceUtil"].TimedWait(10000));
    };
    InPlaceNavUtil.AddTaskClickLinkFromLeftNav = function (Url, navType) {
        var LEFT_NAV_GROUPS = 'LeftNavGroups';
        var leftNavGroups;
        var navElement;
        TAB.Log.AddTaskComment("InPlaceNavUtil: About to do " + navType);
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean((leftNavGroups = TAB.GetElement(TAB.Win.document.body, TAB.searchBy.customQuery, "[data-automationid='" + LEFT_NAV_GROUPS + "']")));
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return Boolean((navElement = TAB.GetElement(leftNavGroups, TAB.searchBy.partialHref, Url)));
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(navElement);
        }));
        TAB.AddTask(undefined, _SpaceUtil__WEBPACK_IMPORTED_MODULE_0__["SpaceUtil"].TimedWait(10000));
    };
    InPlaceNavUtil.ClickOnAddedFeaturedLink = function (siteFeaturedLink) {
        // At the time of calling this function, it is expected that the link has been added to Featured Link.
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('InPlaceNavUtil: Featured link clicked');
            TAB.ClickElement(siteFeaturedLink);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='pageCommandBarNewButton']"));
    };
    return InPlaceNavUtil;
}());



/***/ }),

/***/ "xTQM":
/*!***************************************************!*\
  !*** ./lib/SPTaskLib/Controls/OrgChartWebPart.js ***!
  \***************************************************/
/*! exports provided: OrgChartWebPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OrgChartWebPart", function() { return OrgChartWebPart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");




/**
 * @public
 */
var OrgChartWebPart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(OrgChartWebPart, _super);
    function OrgChartWebPart() {
        var _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].OrgChart, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].OrgChart.toString()) || this;
        _this.PersonImageAreaId = 'ms-Persona-imageArea';
        _this._persons = [];
        return _this;
    }
    OrgChartWebPart.prototype.AddTaskAddOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(this.WaitForWebPartToExist());
    };
    OrgChartWebPart.prototype.WaitForWebPartToExist = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, this._constructQuery('[id^="people-searcher-id"]'));
    };
    OrgChartWebPart.prototype.AddTaskTryAddPeople = function (name) {
        var _this = this;
        var addPersonInput;
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AddTaskGenerateAutomationData(name, 3, 8);
            addPersonInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, _this._constructQuery('[id^="people-searcher-id"]'));
            // input the people name
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(addPersonInput, name);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-PeoplePicker-personaContent'));
        TAB.AddTask(TAB.MakeTask(function () {
            // press Enter to select the person
            TAB.FireKeyboardEvent(addPersonInput, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].enter);
        }), TAB.MakeWaiter(function () {
            var allPeopleCards = _this.GetPeopleCards();
            var targetPeopleCard = _this.GetPeopleCard(name);
            // The new people card added is always in the last position
            return allPeopleCards.indexOf(targetPeopleCard) === allPeopleCards.length - 1;
        }));
        TAB.AddTask(undefined, this.WaitForPersonInFocus());
    };
    OrgChartWebPart.prototype.GetPeopleCards = function () {
        return Array.prototype.slice.call(TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="people-card"]'));
    };
    OrgChartWebPart.prototype.GetPeopleCard = function (name) {
        var peopleCards = this.GetPeopleCards();
        var person = this._persons.filter(function (personInfo) { return personInfo.name === name; })[0];
        if (person && person.title) {
            for (var i = 0; i < peopleCards.length; i++) {
                if (peopleCards[i].textContent.search(new RegExp(person.title, 'i')) !== -1) {
                    return peopleCards[i];
                }
            }
        }
        return undefined;
    };
    OrgChartWebPart.prototype.AddTaskOpenLivePersonaCard = function (name, shouldHover) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var peopleCard = _this.GetPeopleCard(name);
            var imageArea = TAB.GetElement(peopleCard, TAB.searchBy.hasClassName, _this.PersonImageAreaId);
            if (shouldHover) {
                // hover on the image of people card
                var mousemoveEvent = TAB.Win.document.createEvent('HTMLEvents');
                mousemoveEvent.initEvent('mousemove', true /*bubble*/, false /*cancelable*/);
                imageArea.dispatchEvent(mousemoveEvent);
            }
            else {
                TAB.ClickElement(imageArea);
            }
        }), 
        // wait for the live persona card to expand
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-log-name="UserInfoBlock"]'));
    };
    OrgChartWebPart.prototype.AddTaskClickPeopleCard = function (name) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking on the people card (no waiter)');
            var peopleCard = _this.GetPeopleCard(name);
            var imageArea = TAB.GetElement(peopleCard, TAB.searchBy.hasClassName, _this.PersonImageAreaId);
            TAB.ClickElement(imageArea);
        }));
    };
    OrgChartWebPart.prototype.AddTaskCloseLivePersonaCard = function (shouldPressEsc) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (shouldPressEsc) {
                var cardElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-log-region="LivePersonaCard"]');
                TAB.FireKeyboardEvent(cardElement, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].escape);
            }
            else {
                // Click outside of live persona card.
                TAB.ClickElement(TAB.Win.document.body);
            }
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-log-region="LivePersonaCard"]');
        }));
    };
    OrgChartWebPart.prototype.AddTaskNavigateToManager = function (index) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var managerCards = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="orgChart-persona-managers"]');
            _this._automationData.directs = [
                Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"])({}, _this._automationData.personInFocus)
            ];
            _this._automationData.personInFocus = _this._automationData.managers.splice(index)[0];
            TAB.Win.window.sessionStorage.setItem('SP_TAB_ORGCHART_AUTOMATIONDATA', JSON.stringify(_this._automationData));
            TAB.ClickElement(managerCards[index].parentElement);
        }), this.WaitForPersonInFocus());
    };
    OrgChartWebPart.prototype.AddTaskChangeManagerLevel = function (level) {
        this.AddTaskClickConfigureButton();
        TAB.AddTask(TAB.MakeTask(function () {
            var propertyPane = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='propertyPanePageContent']");
            var numberInput = TAB.GetElement(propertyPane, TAB.searchBy.customQuery, "[type='number']");
            numberInput.value = level.toString();
            TAB.FireChangeEvent(numberInput);
        }), TAB.MakeWaiter(function () {
            return (TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="orgChart-persona-managers"]').length === level);
        }));
    };
    OrgChartWebPart.prototype.AddTaskRemovePersonInFocus = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            var personInFocus = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="orgChart-persona-personInFocus"]');
            var removeButton = TAB.GetElement(personInFocus.parentElement.parentElement, TAB.searchBy.customQuery, "[data-automationid='splitbuttonprimary']" // from odsp-common, automationid, no dash
            );
            TAB.ClickElement(removeButton.parentElement);
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="orgChart-persona-personInFocus"]');
        }));
    };
    OrgChartWebPart.prototype.AddTaskGenerateAutomationData = function (personName, managers, directs) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            _this._automationData = {
                personInFocus: {
                    id: "i:0#.f|membership|AnnieLindqvist" + personName,
                    email: personName,
                    name: personName,
                    role: 'Senior Engineering Manager'
                },
                managers: [],
                directs: [],
                relatedPeople: [],
                isMe: false // isMe
            };
            for (var i = 0; i < managers; i++) {
                _this._automationData.managers.push({
                    id: "i:0#.f|membership|manager_" + i,
                    email: "manager_" + i,
                    name: personName + "'s Manager " + i,
                    role: "Manager at level " + i
                });
            }
            for (var i = 0; i < directs; i++) {
                _this._automationData.directs.push({
                    id: "i:0#.f|membership|directs_" + i,
                    email: "direct_" + i,
                    name: personName + "'s direct " + i,
                    role: "Software Engineer " + i
                });
            }
            if (TAB.Win.window.sessionStorage) {
                TAB.Win.window.sessionStorage.setItem('SP_TAB_ORGCHART_AUTOMATIONDATA', JSON.stringify(_this._automationData));
            }
        }));
    };
    OrgChartWebPart.prototype.WaitForPersonInFocus = function () {
        var _this = this;
        return TAB.MakeWaiter(function () {
            var personInFocus = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="orgChart-persona-personInFocus"]');
            var primaryText = TAB.GetElement(personInFocus.parentElement, TAB.searchBy.hasClassName, 'ms-Persona-primaryText').innerText;
            return primaryText === _this._automationData.personInFocus.name;
        });
    };
    OrgChartWebPart.prototype.AddTaskAssertWebPartNotExist = function () {
        var _this = this;
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, _this._constructQuery('[id^="people-searcher-id"]'))) {
                throw 'People web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    /**
     * Constructs a query string which limit the query scope down to the page content part.
     * Page content part may be the canvas of a site page, or the event page content of event page.
     * todo: VSO#576400, the ideal solution is web part base should support querying inside web part instance level.
     * @param query - the original query.
     */
    OrgChartWebPart.prototype._constructQuery = function (query) {
        return "[data-automation-id=\"" + _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].CanvasRootId + "\"] " + query + ", [class*=\"eventPageContent\"] " + query;
    };
    OrgChartWebPart.IndexInToolbox = 26;
    return OrgChartWebPart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "xxVG":
/*!***************************************!*\
  !*** ./lib/SPTaskLib/Pages/SPHome.js ***!
  \***************************************/
/*! exports provided: SPHome */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SPHome", function() { return SPHome; });
/**
 * @public
 */
var SPHome = /** @class */ (function () {
    function SPHome() {
    }
    SPHome.loadSPHome = function (serverURL) {
        var spHomeUrl = serverURL + "/_layouts/15/sharepoint.aspx";
        TAB.Log.AddTaskComment('Navigating to SharePoint Home and checking if the main outer container SPH-HomePageView has loaded.');
        TAB.AddTask(TAB.LoadPage(spHomeUrl), TAB.MakeWaiter(function () {
            return (TAB.Win.location.href === spHomeUrl &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='SPH-HomePageView']"));
        }));
    };
    SPHome.handleFRE = function () {
        TAB.Log.AddTaskComment('Checking for existence of FRE and closing it.');
        TAB.AddTask(TAB.MakeTask(function () {
            if (
            // tslint:disable-next-line:no-bitwise
            (TAB.Win.window._spHomePageContext.experienceState & SPHome._SharePointHomeFirstRun) !==
                0) {
                var closeButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id='FRE-closebutton']");
                TAB.ClickElement(closeButton);
            }
        }));
    };
    SPHome.findAndClickButton = function (region, buttonId) {
        var queryString = "[data-automation-id='" + buttonId + "']";
        TAB.Log.AddTaskComment("Checking if the " + buttonId + " button exists.");
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, queryString);
            }
            catch (e) {
                return false;
            }
        }));
        var buttonElement;
        TAB.Log.AddTaskComment("Clicking on the " + buttonId + " button.");
        TAB.AddTask(TAB.MakeTask(function () {
            buttonElement = TAB.GetElement(region, TAB.searchBy.customQuery, queryString);
            TAB.ClickElement(buttonElement);
        }));
    };
    SPHome.waitForSpHomeToRender = function (spHomeUrl) {
        var bodyElem;
        var spHomeWithQueryParam = spHomeUrl + "?spStartSource=homeSite"; // for when navigating via home site "My SharePoint" nav node
        return TAB.MakeWaiter(function () {
            if ((TAB.Win.location.href === spHomeUrl || TAB.Win.location.href === spHomeWithQueryParam) &&
                !bodyElem &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.tag, 'body')) {
                bodyElem = TAB.GetElement(TAB.Win, TAB.searchBy.tag, 'body');
            }
            return (bodyElem &&
                TAB.ElementExists(bodyElem, TAB.searchBy.customQuery, "[data-automation-id='SPH-HomePageView']"));
        });
    };
    SPHome._SharePointHomeFirstRun = 1;
    return SPHome;
}());



/***/ }),

/***/ "y5Zv":
/*!*******************************************!*\
  !*** ./lib/SPTaskLib/SPKillSwitchUtil.js ***!
  \*******************************************/
/*! exports provided: SPKillSwitchUtil */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SPKillSwitchUtil", function() { return SPKillSwitchUtil; });
/**
 * @public
 */
var SPKillSwitchUtil = /** @class */ (function () {
    function SPKillSwitchUtil() {
    }
    /**
     * This function will determine if a kill switch is activated in the global list.
     * @param killSwitchId - The id of the kill switch
     */
    SPKillSwitchUtil.isActivated = function (killSwitchId) {
        return TAB.Win.window[this.spModuleLoader]._bundledComponents[this.spCoreLibraryComponentId]._SPKillSwitch.isActivated(killSwitchId.toLowerCase());
    };
    SPKillSwitchUtil.isBrowserKillSwitchActivated = function (browserKillSwitches) {
        var browser;
        var killSwitchId;
        if (TAB.browserIs.chrome) {
            browser = 'Chrome';
            killSwitchId = browserKillSwitches.Chrome;
        }
        else if (TAB.browserIs.ie) {
            browser = 'IE';
            killSwitchId = browserKillSwitches.IE;
        }
        else if (TAB.browserIs.firefox) {
            browser = 'FireFox';
            killSwitchId = browserKillSwitches.FireFox;
        }
        else {
            browser = 'EdgeChromium';
            killSwitchId = browserKillSwitches.EdgeChromium;
        }
        TAB.Log.Comment("Trying to check if kill switch is activated in browser " + browser);
        if (!killSwitchId) {
            TAB.Log.Fail('KillSwitch is not defined for the browser being tested');
            return false;
        }
        else if (SPKillSwitchUtil.isActivated(killSwitchId)) {
            TAB.Log.DidNotRun("KillSwitch is activated for this test in browser " + browser);
            return true;
        }
        else {
            return false;
        }
    };
    SPKillSwitchUtil.AddTaskWaitForPageContextReady = function () {
        var _this = this;
        TAB.AddTask(undefined, TAB.MakeWaiter(function () {
            try {
                return !!TAB.Win.window[_this.spModuleLoader]._bundledComponents;
            }
            catch (error) {
                return false;
            }
        }));
    };
    SPKillSwitchUtil.spModuleLoader = 'spModuleLoader';
    SPKillSwitchUtil.spCoreLibraryComponentId = '7263c7d0-1d6a-45ec-8d85-d4d1d234171b';
    return SPKillSwitchUtil;
}());



/***/ }),

/***/ "yZcd":
/*!******************************************!*\
  !*** ./lib/SPTaskLib/Pages/SocialBar.js ***!
  \******************************************/
/*! exports provided: SocialBar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SocialBar", function() { return SocialBar; });
/**
 * @public
 */
var SocialBar = /** @class */ (function () {
    function SocialBar() {
    }
    SocialBar.AddTaskCloseLikesPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Closing the social bar panel');
            var closeButton = TAB.GetElement(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel-closeButton');
            TAB.ClickElement(closeButton);
        }), TAB.MakeWaiter(function () {
            var panels = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel');
            return panels.length === 0;
        }));
    };
    SocialBar.AddTaskLikePage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Liking a page');
            var likeButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-socialbar-likebutton"]');
            TAB.ClickElement(likeButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-socialbar-likebutton"] [data-icon-name="LikeSolid"]'));
    };
    SocialBar.AddTaskOpenLikesPanel = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Opening social bar panel');
            var likedByMessage = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-socialbar-likedbymessage"]');
            TAB.ClickElement(likedByMessage);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Panel'));
    };
    SocialBar.AddTaskSocialBarNotVisible = function () {
        TAB.MakeTask(function () {
            TAB.Log.Comment("Ensuring social bar isn't visible before publish");
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-socialbar"]')) {
                TAB.Log.Fail('SocialBar component should not be visible');
            }
        });
    };
    SocialBar.AddTaskUnlikePage = function () {
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Unliking a page');
            var likeButton = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-socialbar-likebutton"]');
            TAB.ClickElement(likeButton);
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="sp-socialbar-likebutton"] [data-icon-name="Like"]'));
    };
    return SocialBar;
}());



/***/ }),

/***/ "yis5":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Controls/ContextMenu.js ***!
  \***********************************************/
/*! exports provided: ContextMenu */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextMenu", function() { return ContextMenu; });
/**
 * @public
 */
var ContextMenu = /** @class */ (function () {
    function ContextMenu(isSubMenu) {
        this.items = [];
        this.root = isSubMenu
            ? TAB.GetElements(TAB.Win, [TAB.searchBy.hasClassName, TAB.searchBy.hasClassName], ['ms-ContextualMenu', 'is-open'])[1]
            : TAB.GetElement(TAB.Win, [TAB.searchBy.hasClassName, TAB.searchBy.hasClassName], ['ms-ContextualMenu', 'is-open']);
        this._getItems();
    }
    ContextMenu.WaitForOpen = function () {
        TAB.Log.AddTaskComment('Waiting for context menu to open.');
        return TAB.MakeWaiter(function () {
            return ContextMenu.MenuAlreadyOpen();
        });
    };
    ContextMenu.WaitForSubMenuOpen = function () {
        TAB.Log.AddTaskComment('Waiting for context sub-menu to open.');
        return TAB.MakeWaiter(function () {
            return ContextMenu.MenuAlreadyOpen(true /*isSubMenu*/);
        });
    };
    ContextMenu.WaitForClose = function () {
        return TAB.MakeWaiter(function () {
            return !ContextMenu.MenuAlreadyOpen();
        });
    };
    ContextMenu.AddTaskDismissContextMenu = function () {
        TAB.Log.AddTaskComment('Dismissing context menu.');
        TAB.AddTaskClickElement(TAB.Win, TAB.searchBy.hasClassName, 'Files', TAB.MakeWaiter(function () {
            var contextMenu = TAB.GetElements(TAB.Win, TAB.searchBy.hasClassName, 'ms-ContextualMenu');
            return contextMenu.length === 0;
        }));
    };
    ContextMenu.MenuAlreadyOpen = function (isSubMenu) {
        try {
            var contextMenu = new ContextMenu(isSubMenu);
            return contextMenu.IsOpen();
        }
        catch (e) {
            return false;
        }
    };
    ContextMenu.VerifyContextualMenuItems = function (expectedItems, requireExactMatch) {
        if (requireExactMatch === void 0) { requireExactMatch = true; }
        var contextMenu = new ContextMenu();
        contextMenu.VerifyItems(expectedItems, requireExactMatch);
    };
    ContextMenu.prototype.IsOpen = function () {
        // Keep waiting if the contextMenu shows 'Loading...'.
        if (this.items[0] && TAB.GetTextContent(this.items[0]) === 'Loading...') {
            return false;
        }
        return true;
    };
    ContextMenu.prototype.GetItemCount = function () {
        return this.items.length;
    };
    ContextMenu.prototype.GetItemBySequence = function (sequence) {
        return this.items[sequence];
    };
    ContextMenu.prototype.VerifyItems = function (expectedItems, requireExactMatch) {
        if (requireExactMatch && expectedItems.length !== this.items.length) {
            throw "Found " + this.items.length + " context menu items but expected " + expectedItems.length;
        }
        for (var i = 0; i < expectedItems.length; i++) {
            var expectedItem = expectedItems[i];
            if (requireExactMatch) {
                this.VerifyItem(i, expectedItem);
            }
            else {
                var item = this.GetItem(expectedItem);
                if (item) {
                    TAB.Log.Pass("Verified expected context menu item \"" + expectedItem.title + "\"");
                }
                else if (expectedItem.isOptional && expectedItem.isOptional()) {
                    TAB.Log.Warning("Did not find optional context menu item \"" + expectedItem.title + "\"");
                }
                else {
                    throw "Did not find context menu item \"" + expectedItem.title + "\"";
                }
            }
        }
    };
    ContextMenu.prototype.VerifyItem = function (index, expectedItem) {
        var contextMenuItem = this.items[index];
        if (!contextMenuItem) {
            throw "No menu item found at index " + index;
        }
        var expectedTitle = expectedItem.title;
        var itemTitle = TAB.GetTextContent(contextMenuItem);
        // Trim icon characters (unless the expected text has icons)
        if (typeof expectedTitle === 'string' && (!expectedTitle || expectedTitle.charCodeAt(0) < 128)) {
            while (itemTitle.charCodeAt(0) > 127) {
                itemTitle = itemTitle.slice(1);
            }
        }
        if (typeof expectedTitle === 'string') {
            TAB.Log.VerifyEquals(itemTitle.toUpperCase(), expectedTitle.toUpperCase(), "Verified expected context menu item " + expectedTitle);
        }
        else {
            TAB.Log.Verify(expectedTitle.test(itemTitle), "Verified expected context menu item matching regex " + expectedTitle);
        }
    };
    ContextMenu.prototype.AddTaskClickItem = function (title) {
        var _this = this;
        var commandInfo = typeof title === 'string' ? { title: title } : title;
        TAB.Log.AddTaskComment("Clicking context menu for item with title \"" + commandInfo.title + "\" or with automationId \"" + commandInfo.automationId + "\".");
        TAB.AddTask(TAB.MakeTask(function () {
            var menuItem = _this.GetItem(title);
            TAB.ClickElement(menuItem);
        }));
    };
    ContextMenu.prototype.AddTaskClickItemByIndex = function (index) {
        var _this = this;
        TAB.Log.AddTaskComment("Clicking context menu for item in index \"" + index + "\".");
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.ClickElement(_this.items[index]);
        }));
    };
    ContextMenu.prototype.GetItem = function (title) {
        this._getItems();
        var elementClass = 'ms-ContextualMenu-itemText';
        var expectedTitle = typeof title === 'object' ? title.title : title;
        var expectedAutomationId = typeof title === 'object' ? title.automationId : undefined;
        for (var _i = 0, _a = this.items; _i < _a.length; _i++) {
            var item = _a[_i];
            var itemTitleSpan = TAB.GetElement(item, TAB.searchBy.hasClassName, elementClass);
            var itemTitle = TAB.GetTextContent(itemTitleSpan);
            var itemAutomationId = item.getAttribute('data-automationid');
            if ((typeof expectedTitle === 'string' && itemTitle.toUpperCase() === expectedTitle.toUpperCase()) ||
                (typeof expectedTitle === 'object' && expectedTitle.test(itemTitle))) {
                return item;
            }
            else if (!expectedTitle) {
                if (!expectedAutomationId || !itemAutomationId) {
                    continue; // There wasn't a title to test, use automationId to test.
                }
                if (expectedAutomationId === itemAutomationId) {
                    return item; // There wasn't a title to test, but the item did match the given automationId
                }
            }
        }
        return undefined;
    };
    ContextMenu.prototype.GetItems = function () {
        var items = this._getItems();
        var wrapperItems = [];
        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {
            var item = items_1[_i];
            var itemTitleSpan = TAB.GetElement(item, TAB.searchBy.hasClassName, 'ms-ContextualMenu-itemText');
            var itemTitle = TAB.GetTextContent(itemTitleSpan);
            var iconElement = TAB.GetElements(item, TAB.searchBy.hasClassName, 'ms-Icon')[0];
            var iconClassName = iconElement ? iconElement.getAttribute('data-icon-name') : '';
            wrapperItems.push({
                Title: itemTitle,
                IconClassName: iconClassName
            });
        }
        return wrapperItems;
    };
    ContextMenu.prototype._getItems = function () {
        var elementText = 'ms-ContextualMenu-link';
        this.items = TAB.GetElements(this.root, TAB.searchBy.hasClassName, elementText);
        return this.items;
    };
    return ContextMenu;
}());



/***/ }),

/***/ "ymC6":
/*!*************************************************!*\
  !*** ./lib/SPTaskLib/Controls/PeopleWebpart.js ***!
  \*************************************************/
/*! exports provided: PeopleCardLayout, PeopleWebpart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PeopleCardLayout", function() { return PeopleCardLayout; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PeopleWebpart", function() { return PeopleWebpart; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "WYdG");
/* harmony import */ var _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseWebpart */ "35UN");
/* harmony import */ var _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Pages/Canvas */ "mmJW");
/* harmony import */ var _ReactUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ReactUtil */ "Qf+y");
/* harmony import */ var _Next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Next */ "BJbA");
/* harmony import */ var _WebLibrary__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../WebLibrary */ "Ckxo");






/**
 * @public
 */
var PeopleCardLayout;
(function (PeopleCardLayout) {
    PeopleCardLayout[PeopleCardLayout["Compact"] = 1] = "Compact";
    PeopleCardLayout[PeopleCardLayout["Large"] = 2] = "Large";
})(PeopleCardLayout || (PeopleCardLayout = {}));
/**
 * @public
 */
var PeopleWebpart = /** @class */ (function (_super) {
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"])(PeopleWebpart, _super);
    function PeopleWebpart() {
        var _this = _super.call(this, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].People, _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["WebpartType"].People.toString()) || this;
        _this.PersonImageAreaId = 'ms-Persona-imageArea';
        _this._persons = [];
        return _this;
    }
    PeopleWebpart.prototype.AddTaskAddOnTeamSitePage = function () {
        var _this = this;
        TAB.MakeTask(function () {
            _this.AddTaskSetupNewPage();
            _this.AddTaskAssertWebPartNotExist();
            _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].AddTaskCreateWebPart(_this);
        }).WaitFor(this.WaitForWebPartToExist());
    };
    PeopleWebpart.prototype.WaitForWebPartToExist = function () {
        return TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, this._constructQuery('[id^="people-searcher-id"]'));
    };
    PeopleWebpart.prototype.AddTaskTryAddPeople = function (name, shouldBeFound) {
        var _this = this;
        var addPersonInput;
        var userResult = {};
        if (shouldBeFound) {
            TAB.AddTask(TAB.MakeTask(function () {
                _WebLibrary__WEBPACK_IMPORTED_MODULE_5__["Web"].addCsomTaskGetUserFromWeb(name, userResult);
            }), TAB.MakeWaiter(function () {
                if (userResult.title !== undefined) {
                    // Store person full name to ensure the person is added successfully
                    _this._persons.push({
                        name: name,
                        title: userResult.title // `userResult.title` equals to person full name which is displayed on the people card
                    });
                    return true;
                }
            }));
        }
        TAB.AddTask(TAB.MakeTask(function () {
            addPersonInput = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, _this._constructQuery('[id^="people-searcher-id"]'));
            // input the people name
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(addPersonInput, name);
        }), shouldBeFound
            ? TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-PeoplePicker-personaContent')
            : TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.hasClassName, 'ms-Suggestions-none'));
        if (!shouldBeFound) {
            return;
        }
        TAB.AddTask(TAB.MakeTask(function () {
            // press Enter to select the person
            TAB.FireKeyboardEvent(addPersonInput, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].enter);
        }), TAB.MakeWaiter(function () {
            var allPeopleCards = _this.GetPeopleCards();
            var targetPeopleCard = _this.GetPeopleCard(name);
            // The new people card added is always in the last position
            return allPeopleCards.indexOf(targetPeopleCard) === allPeopleCards.length - 1;
        }));
    };
    PeopleWebpart.prototype.AddTaskDeletePeople = function (name) {
        var _this = this;
        var targetPeopleCard;
        TAB.AddTask(TAB.MakeTask(function () {
            targetPeopleCard = _this.GetPeopleCard(name);
            var deleteButton = TAB.GetElement(targetPeopleCard, TAB.searchBy.customQuery, '[data-automation-id="peopleCardDeleteButton"]');
            // click delete button
            TAB.ClickElement(deleteButton);
            _this._persons = _this._persons.filter(function (person) { return person.name !== name; });
        }), TAB.MakeWaiter(function () {
            var allPeopleCards = _this.GetPeopleCards();
            return allPeopleCards.indexOf(targetPeopleCard) === -1;
        }));
    };
    PeopleWebpart.prototype.GetPeopleCards = function () {
        return Array.prototype.slice.call(TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, '[data-automation-id="people-card"]'));
    };
    PeopleWebpart.prototype.GetPeopleCard = function (name) {
        var peopleCards = this.GetPeopleCards();
        var person = this._persons.filter(function (personInfo) { return personInfo.name === name; })[0];
        if (person && person.title) {
            for (var i = 0; i < peopleCards.length; i++) {
                if (peopleCards[i].textContent.search(new RegExp(person.title, 'i')) !== -1) {
                    return peopleCards[i];
                }
            }
        }
        return undefined;
    };
    PeopleWebpart.prototype.AddTaskOpenLivePersonaCard = function (name, shouldHover) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            var peopleCard = _this.GetPeopleCard(name);
            var imageArea = TAB.GetElement(peopleCard, TAB.searchBy.hasClassName, _this.PersonImageAreaId);
            if (shouldHover) {
                // hover on the image of people card
                var mousemoveEvent = TAB.Win.document.createEvent('HTMLEvents');
                mousemoveEvent.initEvent('mousemove', true /*bubble*/, false /*cancelable*/);
                imageArea.dispatchEvent(mousemoveEvent);
            }
            else {
                TAB.ClickElement(imageArea);
            }
        }), 
        // wait for the live persona card to expand
        TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, '[data-log-name="UserInfoBlock"]'));
    };
    PeopleWebpart.prototype.AddTaskClickPeopleCard = function (name) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking on the people card (no waiter)');
            var peopleCard = _this.GetPeopleCard(name);
            var imageArea = TAB.GetElement(peopleCard, TAB.searchBy.hasClassName, _this.PersonImageAreaId);
            TAB.ClickElement(imageArea);
        }));
    };
    PeopleWebpart.prototype.AddTaskCloseLivePersonaCard = function (shouldPressEsc) {
        TAB.AddTask(TAB.MakeTask(function () {
            if (shouldPressEsc) {
                var cardElement = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, '[data-log-region="LivePersonaCard"]');
                TAB.FireKeyboardEvent(cardElement, 'keydown', _BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["KeyCodes"].escape);
            }
            else {
                // Click outside of live persona card.
                TAB.ClickElement(TAB.Win.document.body);
            }
        }), TAB.MakeWaiter(function () {
            return !TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, '[data-log-region="LivePersonaCard"]');
        }));
    };
    PeopleWebpart.prototype.AddTaskChangePeopleCardLayout = function (layout) {
        var _this = this;
        TAB.Log.AddTaskComment('Open property pane');
        TAB.AddTask(TAB.MakeTask(function () {
            _this.AddTaskClickConfigureButton();
        }), TAB.MakeWaiter(function () {
            return (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"PropertyPaneChoiceGroup-1\"]") &&
                TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"PropertyPaneChoiceGroup-2\"]"));
        }));
        TAB.Log.AddTaskComment('Click the layout choice radio button');
        var layoutType = PeopleCardLayout[layout][0].toLowerCase() + PeopleCardLayout[layout].slice(1) + "Layout";
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the layout choice group in property pane');
            var layoutChoiceGroup = TAB.GetElements(TAB.Win, TAB.searchBy.customQuery, "[data-automation-id=\"PropertyPaneChoiceGroup-" + layout + "\"]");
            layoutChoiceGroup[0].click();
        }), TAB.WaitForElementToExist(TAB.Win, TAB.searchBy.customQuery, "[data-layout='" + layoutType + "']"));
    };
    PeopleWebpart.prototype.AddTaskEditPeopleLink = function (name, url, title) {
        var _this = this;
        TAB.Log.AddTaskComment('Open page picker');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the people card and click the link button');
            var peopleCard = _this.GetPeopleCard(name);
            var peopleLinkEditButton = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(peopleCard, 'peopleLinkEditButton');
            TAB.ClickElement(peopleLinkEditButton);
        }), _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].WaitForElementsByDataAutomationId(TAB.Win, 'pagePickerUrlTextField'));
        TAB.Log.AddTaskComment('Add the link with URL and title');
        TAB.AddTask(TAB.MakeTask(function () {
            var urlTextField = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'pagePickerUrlTextField');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(urlTextField, url);
            var titleTextField = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'pagePickerTitleTextField');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(titleTextField, title);
            TAB.Log.Comment('Save the URL and title');
            var saveButton = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(TAB.Win.document.body, 'pagePickerSaveButton');
            TAB.ClickElement(saveButton);
        }), TAB.MakeWaiter(function () {
            var peopleLink = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, _this._constructQuery('[data-automation-id="peopleLinkEditButton"]'));
            return peopleLink && peopleLink.textContent === title;
        }));
    };
    PeopleWebpart.prototype.AddTaskEditPeopleDescription = function (name, description) {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Get the people card and edit the description');
            var peopleCard = _this.GetPeopleCard(name);
            var descriptionTextField = _Next__WEBPACK_IMPORTED_MODULE_4__["Next"].GetElementByDataAutomationId(peopleCard, 'peopleDescriptionTextField');
            _ReactUtil__WEBPACK_IMPORTED_MODULE_3__["ReactUtil"].TriggerOnChange(descriptionTextField, description);
        }));
    };
    PeopleWebpart.prototype.AddTaskAssertWebPartNotExist = function () {
        var _this = this;
        TAB.MakeTask(function () {
            if (TAB.ElementExists(TAB.Win, TAB.searchBy.customQuery, _this._constructQuery('[id^="people-searcher-id"]'))) {
                throw 'People web part should not exist.';
            }
        }).WaitFor(undefined);
    };
    /**
     * Constructs a query string which limit the query scope down to the page content part.
     * Page content part may be the canvas of a site page, or the event page content of event page.
     * todo: VSO#576400, the ideal solution is web part base should support querying inside web part instance level.
     * @param query - the original query.
     */
    PeopleWebpart.prototype._constructQuery = function (query) {
        return "[data-automation-id=\"" + _Pages_Canvas__WEBPACK_IMPORTED_MODULE_2__["Canvas"].CanvasRootId + "\"] " + query + ", [class*=\"eventPageContent\"] " + query;
    };
    PeopleWebpart.IndexInToolbox = 26;
    return PeopleWebpart;
}(_BaseWebpart__WEBPACK_IMPORTED_MODULE_1__["BaseWebpart"]));



/***/ }),

/***/ "zI0m":
/*!***********************************************!*\
  !*** ./lib/SPTaskLib/Controls/NewsPinning.js ***!
  \***********************************************/
/*! exports provided: NewsPinning */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewsPinning", function() { return NewsPinning; });
var PinningDataAutomationId;
(function (PinningDataAutomationId) {
    PinningDataAutomationId["PinningPanel"] = "pinningNewsPanel";
    PinningDataAutomationId["AddPinningButton"] = "pinningNewsButton";
    PinningDataAutomationId["PinningList"] = "pinnedList";
    PinningDataAutomationId["RecentList"] = "recentList";
})(PinningDataAutomationId || (PinningDataAutomationId = {}));
var PinningClassName;
(function (PinningClassName) {
    PinningClassName["PinningPanelCloseButton"] = "ms-Panel-closeButton";
    PinningClassName["PinningNewsSearchBox"] = "ms-pinningNewsSearchBox";
})(PinningClassName || (PinningClassName = {}));
/**
 * @public
 */
var NewsPinning = /** @class */ (function () {
    function NewsPinning() {
    }
    NewsPinning._fireMouseEvent = function (type, elem, centerX, centerY) {
        var evt = document.createEvent('MouseEvents');
        evt.initMouseEvent(type, true, true, window, 1, 1, 1, centerX, centerY, false, false, false, false, 0, elem);
        elem.dispatchEvent(evt);
    };
    NewsPinning.prototype.GetRecentNewsTitleByDataAutomationId = function (dataAutomationId) {
        var item = this._getPinningPanelElement(dataAutomationId);
        var element = TAB.GetElement(item, TAB.searchBy.tag, 'a');
        return element ? element.innerText : undefined;
    };
    NewsPinning.prototype.GetPinnedNewsTitleByDataAutomationId = function (dataAutomationId, dragOnPanel) {
        var item = dragOnPanel
            ? this._getPinningPanelElement(dataAutomationId)
            : this._getElementByDataAutomationId(dataAutomationId);
        return item ? item.innerText.trimEnd().trimStart() : undefined;
    };
    NewsPinning.prototype.AddTaskDeleteNews = function (automationId, dragOnPanel) {
        var _this = this;
        var title;
        TAB.AddTask(TAB.MakeTask(function () {
            title = _this.GetPinnedNewsTitleByDataAutomationId(automationId, dragOnPanel);
            TAB.Log.AddTaskComment('Clicking delete pinned news button');
            dragOnPanel
                ? TAB.ClickElement(_this._getPinningPanelElement(automationId + "_removeIcon"))
                : TAB.ClickElement(_this._getElementByDataAutomationId(automationId + "_removeIcon"));
        }), TAB.MakeWaiter(function () {
            TAB.Log.AddTaskComment('Waiting for pinning news delete');
            return _this.GetPinnedNewsTitleByDataAutomationId(automationId, dragOnPanel) !== title;
        }));
    };
    NewsPinning.prototype.AddTaskTimer = function (times) {
        var _this = this;
        var timeElapsed = 0;
        TAB.AddTask(undefined, TAB.AndWaiters(TAB.MakeWaiter(function () {
            while (timeElapsed < times) {
                timeElapsed++;
            }
            return true;
        }), TAB.MakeWaiter(function () {
            return !Boolean(_this._getElementByDataAutomationId('avoidDragPanel'));
        })));
    };
    /*
     * This method takes care of drag and drop on the pinning panel and property pane pinning list.
     * dragWithInList: rearrange element with in the list
     * dragOnPanel: rearrange list on pinning panel
     */
    NewsPinning.prototype.AddTaskDragAndDropItem = function (dropStartAutomationId, dropEndAutomationId, droppingAutomationId, dragWithInList, dragOnPanel) {
        var _this = this;
        // FireMouseEvent is not allowed in Edge due to initMouseEvent deprecation
        // Fix required in TABCore VSO#405141
        if (navigator.userAgent.toLowerCase().indexOf('edge') > -1) {
            TAB.Log.AddTaskWarning('Skipping test: Fire mouse event is not permitted in Edge.');
            return;
        }
        var item;
        var targetElement;
        var itemOffset, targetItemOffset;
        var dropX, dropY;
        var dragElementTitle;
        TAB.Log.AddTaskComment('starting drag and drop');
        TAB.AddTask(TAB.MakeTask(function () {
            item = dragOnPanel
                ? _this._getPinningPanelElement(dropStartAutomationId)
                : _this._getElementByDataAutomationId(dropStartAutomationId);
            targetElement = dragOnPanel
                ? _this._getPinningPanelElement(dropEndAutomationId)
                : _this._getElementByDataAutomationId(dropEndAutomationId);
            itemOffset = TAB.GetElementOffset(item);
            targetItemOffset = TAB.GetElementOffset(targetElement);
            dragElementTitle = dragWithInList
                ? _this.GetPinnedNewsTitleByDataAutomationId(dropStartAutomationId, dragOnPanel)
                : _this.GetRecentNewsTitleByDataAutomationId(dropStartAutomationId);
            TAB.Log.Comment('Drag element title ' + dragElementTitle);
            var dragX = Math.round(itemOffset.left + item.clientWidth / 2);
            var dragY = Math.round(itemOffset.top + item.clientHeight / 2);
            dropX = Math.round(targetItemOffset.left + item.clientWidth / 2);
            dropY = Math.round(targetItemOffset.top + item.clientHeight / 2);
            // TAB framework doesn't provide drag* mouse events.
            // But here we need drag events to simulate HTML5 drag and drop.
            // It's inspired by https://ghostinspector.com/blog/simulate-drag-and-drop-javascript-casperjs/
            TAB.Log.Comment('Mouse over dragged element and mousedown');
            NewsPinning._fireMouseEvent('mousemove', item, dragX, dragY);
            NewsPinning._fireMouseEvent('mouseenter', item, dragX, dragY);
            NewsPinning._fireMouseEvent('mouseover', item, dragX, dragY);
            NewsPinning._fireMouseEvent('mousedown', item, dragX, dragY);
            TAB.Log.Comment('Start dragging process over to drop target');
            NewsPinning._fireMouseEvent('dragstart', item, dragX, dragY);
            NewsPinning._fireMouseEvent('drag', item, dragX, dragY);
            NewsPinning._fireMouseEvent('mousemove', item, dragX, dragY);
            NewsPinning._fireMouseEvent('drag', item, dropX, dropY);
            NewsPinning._fireMouseEvent('mousemove', targetElement, dropX, dropY);
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment('Trigger dragging process under drop target');
                NewsPinning._fireMouseEvent('mouseenter', targetElement, dropX, dropY);
                NewsPinning._fireMouseEvent('dragenter', targetElement, dropX, dropY);
                NewsPinning._fireMouseEvent('mouseover', targetElement, dropX, dropY);
                NewsPinning._fireMouseEvent('dragover', targetElement, dropX, dropY);
                return true;
            }
            catch (e) {
                return false;
            }
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Release dragged element under drop target');
            NewsPinning._fireMouseEvent('drop', targetElement, dropX, dropY);
            NewsPinning._fireMouseEvent('dragend', item, dropX, dropY);
            NewsPinning._fireMouseEvent('mouseup', item, dropX, dropY);
        }), TAB.MakeWaiter(function () {
            try {
                TAB.Log.Comment('Waiting for drop element to render');
                return (_this.GetPinnedNewsTitleByDataAutomationId(droppingAutomationId, dragOnPanel) === dragElementTitle);
            }
            catch (error) {
                return false;
            }
        }));
    };
    NewsPinning.prototype.AddTaskClickAddPinningNews = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for add button");
        }), TAB.MakeWaiter(function () {
            return Boolean(_this._getElementByDataAutomationId(PinningDataAutomationId.AddPinningButton));
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking pinning add button');
            TAB.ClickElement(_this._getElementByDataAutomationId(PinningDataAutomationId.AddPinningButton));
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('Waiting for pinning panel');
            return Boolean(_this._getElementByDataAutomationId(PinningDataAutomationId.PinningPanel));
        }));
    };
    NewsPinning.prototype.AddTaskClickClosePinningPanel = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for panel close button");
        }), TAB.MakeWaiter(function () {
            return Boolean(_this._getElementByClassName(PinningClassName.PinningPanelCloseButton));
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking pinning panel close button');
            TAB.ClickElement(_this._getElementByClassName(PinningClassName.PinningPanelCloseButton));
        }), TAB.MakeWaiter(function () {
            TAB.Log.Comment('Waiting for property pane add button');
            return Boolean(_this._getElementByDataAutomationId(PinningDataAutomationId.AddPinningButton));
        }));
    };
    NewsPinning.prototype.AddTaskCheckPinnedListRenders = function () {
        var _this = this;
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment("Waiting for pinned list");
        }), TAB.MakeWaiter(function () {
            return Boolean(_this._getElementByDataAutomationId(PinningDataAutomationId.PinningList));
        }));
    };
    NewsPinning.prototype.AddTaskCheckPanelPinnedListRenders = function () {
        TAB.AddTask(undefined, this._waitForPinningPanelElement(PinningDataAutomationId.PinningList));
    };
    // ToDo:
    //  Check deleted item is added to recent list
    //  Check the dragged element is not in the recent list
    NewsPinning.prototype.AddTaskCheckPanelRecentListRenders = function () {
        TAB.AddTask(undefined, this._waitForPinningPanelElement(PinningDataAutomationId.RecentList));
    };
    // ToDo:
    // check the news article is rendered in the recent list
    // Drag and drop flow
    NewsPinning.prototype.AddTaskCheckPanelSearchBoxRenders = function () {
        var _this = this;
        var searchNews = 'test';
        TAB.AddTask(undefined, this._waitForPinningPanelElementByClassName(PinningClassName.PinningNewsSearchBox));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.Comment('Clicking inside search box');
            var searchBox = _this._getPinningPanelElementByClassName(PinningClassName.PinningNewsSearchBox);
            var inputBox = _this._getElementByClassName('ms-SearchBox-field', searchBox);
            _this._makeEntry(inputBox, searchNews);
        }), this._waitForPinningPanelElement(PinningDataAutomationId.RecentList));
    };
    NewsPinning.prototype._makeEntry = function (input, text) {
        var focusEv = TAB.Win.document.createEvent('HTMLEvents');
        focusEv.initEvent('focus', true /*bubble*/, false /*cancelable*/);
        input.dispatchEvent(focusEv);
        input.value = text;
        var ev = TAB.Win.document.createEvent('HTMLEvents');
        ev.initEvent('input', true /*bubble*/, false /*cancelable*/);
        input.dispatchEvent(ev);
        // press Enter
        TAB.FireKeyboardEvent(input, 'keydown', 13);
        var blurEv = TAB.Win.document.createEvent('HTMLEvents');
        blurEv.initEvent('blur', true /*bubble*/, false /*cancelable*/);
        input.dispatchEvent(blurEv);
    };
    NewsPinning.prototype._waitForPinningPanelElementByClassName = function (elementClassName) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            return Boolean(_this._getPinningPanelElementByClassName(elementClassName));
        });
    };
    NewsPinning.prototype._getPinningPanelElementByClassName = function (elementClassName) {
        try {
            var pinningPanel = this._getElementByDataAutomationId(PinningDataAutomationId.PinningPanel);
            return TAB.GetElement(pinningPanel, TAB.searchBy.partialClassName, elementClassName);
        }
        catch (e) {
            return undefined;
        }
    };
    NewsPinning.prototype._waitForPinningPanelElement = function (elementId) {
        var _this = this;
        return TAB.MakeWaiter(function () {
            return Boolean(_this._getPinningPanelElement(elementId));
        });
    };
    NewsPinning.prototype._getPinningPanelElement = function (elementId) {
        try {
            var pinningPanel = this._getElementByDataAutomationId(PinningDataAutomationId.PinningPanel);
            return TAB.GetElement(pinningPanel, TAB.searchBy.customQuery, "[data-automation-id=" + elementId + "]");
        }
        catch (e) {
            return undefined;
        }
    };
    NewsPinning.prototype._getElementByDataAutomationId = function (dataAutomationId, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElement(searchObj, TAB.searchBy.customQuery, "[data-automation-id='" + dataAutomationId + "']");
        }
        catch (e) {
            return undefined;
        }
    };
    NewsPinning.prototype._getElementByClassName = function (className, searchObj) {
        if (searchObj === void 0) { searchObj = TAB.Win; }
        try {
            return TAB.GetElement(searchObj, TAB.searchBy.partialClassName, className);
        }
        catch (e) {
            return undefined;
        }
    };
    return NewsPinning;
}());



/***/ }),

/***/ "zTnS":
/*!***************************************************!*\
  !*** ./lib/SPTaskLib/Utilities/ClientFeatures.js ***!
  \***************************************************/
/*! exports provided: ClientFeatures */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientFeatures", function() { return ClientFeatures; });
// tslint:disable
/**
 * This is in SP-Client because there is code in the TAB Tasklib (CommandBar related) that is copied from odsp-next.
 * This code will *only* work in odsp-next applications, not in SPFx application (as it doesn't have the global
 * "_spPageContextInfo").
 * Don't use this in test for sp-client codebase.
 *
 * @public
 */
var ClientFeatures = /** @class */ (function () {
    function ClientFeatures() {
    }
    ClientFeatures.IsODBFeatureEnabled = function (feature, fallback) {
        var result = fallback || false;
        var pageContext = TAB.Win.window._spPageContextInfo;
        var Flighting = TAB.Win.window.Flighting; // Old SharePoint pages use this.
        if (pageContext) {
            if (!pageContext.ExpFeatures && Flighting && Flighting.ExpFeatures) {
                pageContext.ExpFeatures = Flighting.ExpFeatures;
            }
            if (pageContext.ExpFeatures && feature > 0) {
                var elem = Math.floor(feature / 32);
                var mask = 1 << feature % 32;
                result = elem < pageContext.ExpFeatures.length && (pageContext.ExpFeatures[elem] & mask) !== 0;
            }
        }
        // additionally check if there is an override
        var overrides = TAB.Win.window.sessionStorage.getItem(ClientFeatures.KEY_FEATURE_OVERRIDE_STORE);
        if (overrides) {
            var overridesObj = JSON.parse(overrides);
            if (overridesObj.hasOwnProperty(feature)) {
                result = Boolean(overridesObj[feature]);
            }
        }
        return result;
    };
    ClientFeatures.IsTeamSiteSupportPound = function () {
        var pageContext = TAB.Win.window._spPageContextInfo;
        return pageContext && pageContext.supportPoundStorePath && pageContext.supportPercentStorePath;
    };
    ClientFeatures.SetOverrideFeature = function (featureId, isEnabled) {
        var overridesStr = TAB.Win.window.sessionStorage.getItem(ClientFeatures.KEY_FEATURE_OVERRIDE_STORE);
        var overrides = (overridesStr && JSON.parse(overridesStr)) || {};
        overrides[featureId] = isEnabled; // No matter already existed, set to the target enable status
        TAB.Win.window.sessionStorage.setItem(ClientFeatures.KEY_FEATURE_OVERRIDE_STORE, JSON.stringify(overrides));
    };
    ClientFeatures.KEY_FEATURE_OVERRIDE_STORE = 'FeatureOverridesstore';
    return ClientFeatures;
}());

// tslint:enable


/***/ })

/******/ });
//# sourceMappingURL=sp-tab-tasklib.js.map